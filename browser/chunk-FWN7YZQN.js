import{a as L,b as $,c,d as j,e as G,g as V,i as U,j as Y,k as W,l as J,m as K,n as Q,p as Z,r as ee}from"./chunk-FKMIZAYU.js";import{c as z,d as B,g as A}from"./chunk-XMQ3WWIA.js";import{a as q,b as X}from"./chunk-EMML4XWL.js";import{b as H}from"./chunk-TPXSCQ7K.js";import{D as C,Eb as D,Fb as k,Hb as R,Lb as T,Na as p,Pa as s,Sa as n,Ta as i,U as M,Ua as d,Wa as I,Xa as g,Z as w,a as P,ab as o,b as E,bb as F,ca as O,cb as f,ib as N,kb as v,lb as b,q as y,u as x,va as _,ya as l,za as h}from"./chunk-LO2TXSAH.js";var te=(()=>{class r{constructor(e){this.http=e,this.baseUrl="https://psgc.gitlab.io/api"}getProvinces(){return this.http.get(`${this.baseUrl}/provinces/`).pipe(x(e=>Array.isArray(e)?e.map(a=>({code:a.code,name:a.name})).sort((a,t)=>a.name.localeCompare(t.name)):[]),C(e=>(console.error("Error fetching provinces:",e),y([]))))}getCitiesByProvince(e){return this.http.get(`${this.baseUrl}/provinces/${e}/cities-municipalities/`).pipe(x(a=>Array.isArray(a)?a.map(t=>({code:t.code,name:t.name})).sort((t,u)=>t.name.localeCompare(u.name)):[]),C(a=>(console.error("Error fetching cities:",a),y([]))))}getBarangaysByCity(e){return this.http.get(`${this.baseUrl}/cities-municipalities/${e}/barangays/`).pipe(x(a=>Array.isArray(a)?a.map(t=>({code:t.code,name:t.name})).sort((t,u)=>t.name.localeCompare(u.name)):[]),C(a=>(console.error("Error fetching barangays:",a),y([]))))}formatAddress(e,a,t){return`${e}, ${a}, ${t}`}static{this.\u0275fac=function(a){return new(a||r)(w(T))}}static{this.\u0275prov=M({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();function re(r,m){if(r&1&&(n(0,"div",58),o(1),i()),r&2){let e=g();l(),f(" ",e.error," ")}}function oe(r,m){r&1&&(n(0,"span"),o(1,"First name is required"),i())}function ae(r,m){if(r&1&&(n(0,"div",59),p(1,oe,2,0,"span",54),i()),r&2){let e=g();l(),s("ngIf",e.first_name==null||e.first_name.errors==null?null:e.first_name.errors.required)}}function le(r,m){r&1&&(n(0,"span"),o(1,"Last name is required"),i())}function se(r,m){if(r&1&&(n(0,"div",59),p(1,le,2,0,"span",54),i()),r&2){let e=g();l(),s("ngIf",e.last_name==null||e.last_name.errors==null?null:e.last_name.errors.required)}}function me(r,m){r&1&&(n(0,"span"),o(1,"Email is required"),i())}function pe(r,m){r&1&&(n(0,"span"),o(1,"Please enter a valid email"),i())}function de(r,m){if(r&1&&(n(0,"div",59),p(1,me,2,0,"span",54)(2,pe,2,0,"span",54),i()),r&2){let e=g();l(),s("ngIf",e.email==null||e.email.errors==null?null:e.email.errors.required),l(),s("ngIf",e.email==null||e.email.errors==null?null:e.email.errors.email)}}function ce(r,m){r&1&&(n(0,"span"),o(1,"Phone number is required"),i())}function ge(r,m){r&1&&(n(0,"span"),o(1,"Please enter a valid PH mobile number"),i())}function ue(r,m){if(r&1&&(n(0,"div",59),p(1,ce,2,0,"span",54)(2,ge,2,0,"span",54),i()),r&2){let e=g();l(),s("ngIf",e.phone_number==null||e.phone_number.errors==null?null:e.phone_number.errors.required),l(),s("ngIf",e.phone_number==null||e.phone_number.errors==null?null:e.phone_number.errors.pattern)}}function fe(r,m){if(r&1&&(n(0,"option",60),o(1),i()),r&2){let e=m.$implicit;s("value",e.code),l(),f(" ",e.name," ")}}function he(r,m){if(r&1&&(n(0,"option",60),o(1),i()),r&2){let e=m.$implicit;s("value",e.code),l(),f(" ",e.name," ")}}function _e(r,m){if(r&1&&(n(0,"option",60),o(1),i()),r&2){let e=m.$implicit;s("value",e.code),l(),f(" ",e.name," ")}}function ve(r,m){r&1&&(n(0,"div",10)(1,"label",61),o(2,"Organization Name"),i(),d(3,"input",62),i())}function be(r,m){r&1&&(n(0,"span"),o(1,"Password is required"),i())}function ye(r,m){r&1&&(n(0,"span"),o(1,"Password must be at least 8 characters"),i())}function xe(r,m){if(r&1&&(n(0,"div",59),p(1,be,2,0,"span",54)(2,ye,2,0,"span",54),i()),r&2){let e=g();l(),s("ngIf",e.password==null||e.password.errors==null?null:e.password.errors.required),l(),s("ngIf",e.password==null||e.password.errors==null?null:e.password.errors.minlength)}}function Ce(r,m){r&1&&(n(0,"span"),o(1,"Please confirm your password"),i())}function Se(r,m){r&1&&(n(0,"span"),o(1,"Passwords do not match"),i())}function Pe(r,m){if(r&1&&(n(0,"div",59),p(1,Ce,2,0,"span",54)(2,Se,2,0,"span",54),i()),r&2){let e=g();l(),s("ngIf",e.password2==null||e.password2.errors==null?null:e.password2.errors.required),l(),s("ngIf",e.password2==null||e.password2.errors==null?null:e.password2.errors.passwordMismatch)}}function Ee(r,m){if(r&1&&(n(0,"span"),d(1,"span",4),v(2,"safeHtml"),o(3," Register & Start Helping"),i()),r&2){let e=g();l(),s("innerHTML",b(2,1,e.getIcon("heart")),_)}}function Me(r,m){r&1&&(n(0,"span"),o(1,"Registering..."),i())}var qe=(()=>{class r{constructor(e,a,t,u,S){this.fb=e,this.authService=a,this.router=t,this.addressService=u,this.iconService=S,this.loading=!1,this.error="",this.provinces=[],this.cities=[],this.barangays=[],this.loadingProvinces=!1,this.loadingCities=!1,this.loadingBarangays=!1,this.registerForm=this.fb.group({email:["",[c.required,c.email]],password:["",[c.required,c.minLength(8)]],password2:["",[c.required]],first_name:["",[c.required]],last_name:["",[c.required]],role:["donator"],phone_number:["",[c.required,c.pattern(/^(09|\+639)\d{9}$/)]],province:[""],city:[""],barangay:[""],address:[""],organization_name:[""],organization_type:["individual"],donation_capacity:[""],preferred_donation_types:this.fb.group({food:[!1],water:[!1],medical:[!1],clothing:[!1],shelter:[!1],cash:[!1]})},{validators:this.passwordMatchValidator})}ngOnInit(){this.loadProvinces(),this.registerForm.get("province")?.valueChanges.subscribe(e=>{e&&(this.loadCities(e),this.registerForm.patchValue({city:"",barangay:""}),this.cities=[],this.barangays=[])}),this.registerForm.get("city")?.valueChanges.subscribe(e=>{e&&(this.loadBarangays(e),this.registerForm.patchValue({barangay:""}),this.barangays=[])})}loadProvinces(){this.loadingProvinces=!0,this.addressService.getProvinces().subscribe({next:e=>{this.provinces=e,this.loadingProvinces=!1},error:e=>{console.error("Error loading provinces:",e),this.loadingProvinces=!1}})}loadCities(e){this.loadingCities=!0,this.addressService.getCitiesByProvince(e).subscribe({next:a=>{this.cities=a,this.loadingCities=!1},error:a=>{console.error("Error loading cities:",a),this.loadingCities=!1}})}loadBarangays(e){this.loadingBarangays=!0,this.addressService.getBarangaysByCity(e).subscribe({next:a=>{this.barangays=a,this.loadingBarangays=!1},error:a=>{console.error("Error loading barangays:",a),this.loadingBarangays=!1}})}getProvinceName(e){return this.provinces.find(a=>a.code===e)?.name||""}getCityName(e){return this.cities.find(a=>a.code===e)?.name||""}getBarangayName(e){return this.barangays.find(a=>a.code===e)?.name||""}passwordMatchValidator(e){let a=e.get("password"),t=e.get("password2");return a&&t&&a.value!==t.value?t.setErrors({passwordMismatch:!0}):t?.hasError("passwordMismatch")&&t.setErrors(null),null}onSubmit(){if(this.registerForm.valid){this.loading=!0,this.error="";let e="";if(this.registerForm.value.province&&this.registerForm.value.city&&this.registerForm.value.barangay){let t=this.getBarangayName(this.registerForm.value.barangay),u=this.getCityName(this.registerForm.value.city),S=this.getProvinceName(this.registerForm.value.province);e=this.addressService.formatAddress(t,u,S)}let a=E(P({},this.registerForm.value),{address:e||"",role:"donator"});this.authService.register(a).subscribe({next:()=>{this.router.navigate(["/map"])},error:t=>{this.error=t.error?.email?.[0]||t.error?.error||"Registration failed. Please try again.",this.loading=!1}})}else Object.keys(this.registerForm.controls).forEach(e=>{this.registerForm.get(e)?.markAsTouched()})}get email(){return this.registerForm.get("email")}get password(){return this.registerForm.get("password")}get password2(){return this.registerForm.get("password2")}get first_name(){return this.registerForm.get("first_name")}get last_name(){return this.registerForm.get("last_name")}get phone_number(){return this.registerForm.get("phone_number")}get organization_type(){return this.registerForm.get("organization_type")}get province(){return this.registerForm.get("province")}get city(){return this.registerForm.get("city")}get barangay(){return this.registerForm.get("barangay")}getIcon(e,a="md"){return this.iconService.getIcon(e,a)}static{this.\u0275fac=function(a){return new(a||r)(h(Z),h(H),h(z),h(te),h(X))}}static{this.\u0275cmp=O({type:r,selectors:[["app-register-donator"]],standalone:!0,features:[N],decls:150,vars:29,consts:[[1,"container"],[1,"auth-container"],[1,"card"],[1,"card-header"],[3,"innerHTML"],[1,"subtitle"],["class","alert alert-error",4,"ngIf"],[3,"ngSubmit","formGroup"],[1,"section-title"],[1,"grid","grid-2"],[1,"form-group"],["for","first_name"],[1,"required"],["type","text","id","first_name","formControlName","first_name","placeholder","Maria",1,"form-control"],["class","form-error",4,"ngIf"],["for","last_name"],["type","text","id","last_name","formControlName","last_name","placeholder","Santos",1,"form-control"],["for","email"],["type","email","id","email","formControlName","email","placeholder","maria.santos@example.com",1,"form-control"],["for","phone_number"],["type","tel","id","phone_number","formControlName","phone_number","placeholder","09XX XXX XXXX or +639XX XXX XXXX",1,"form-control"],["for","province"],["id","province","formControlName","province",1,"form-control"],["value",""],[3,"value",4,"ngFor","ngForOf"],["for","city"],["id","city","formControlName","city",1,"form-control",3,"disabled"],["for","barangay"],["id","barangay","formControlName","barangay",1,"form-control",3,"disabled"],["for","organization_type"],["id","organization_type","formControlName","organization_type",1,"form-control"],["value","individual"],["value","ngo"],["value","business"],["value","government"],["value","religious"],["value","community"],["class","form-group",4,"ngIf"],["for","donation_capacity"],["id","donation_capacity","formControlName","donation_capacity","placeholder","e.g., Can provide 50 food packs per week, or 1000 bottles of water monthly","rows","2",1,"form-control"],[1,"help-text"],["formGroupName","preferred_donation_types",1,"checkbox-grid"],[1,"checkbox-item"],["type","checkbox","formControlName","food"],["type","checkbox","formControlName","water"],["type","checkbox","formControlName","medical"],["type","checkbox","formControlName","clothing"],["type","checkbox","formControlName","shelter"],["type","checkbox","formControlName","cash"],["for","password"],["type","password","id","password","formControlName","password","placeholder","Enter password (min 8 characters)",1,"form-control"],["for","password2"],["type","password","id","password2","formControlName","password2","placeholder","Confirm password",1,"form-control"],["type","submit",1,"btn","btn-primary","btn-block",3,"disabled"],[4,"ngIf"],[1,"auth-footer"],["routerLink","/login"],["routerLink","/register/affected"],[1,"alert","alert-error"],[1,"form-error"],[3,"value"],["for","organization_name"],["type","text","id","organization_name","formControlName","organization_name","placeholder","Name of your organization",1,"form-control"]],template:function(a,t){a&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2"),d(5,"span",4),v(6,"safeHtml"),o(7," Register as Donator"),i(),n(8,"p",5),o(9,"Help affected people by providing relief goods and assistance"),i()(),p(10,re,2,1,"div",6),n(11,"form",7),I("ngSubmit",function(){return t.onSubmit()}),n(12,"div",8),o(13,"Personal Information"),i(),n(14,"div",9)(15,"div",10)(16,"label",11),o(17,"First Name "),n(18,"span",12),o(19,"*"),i()(),d(20,"input",13),p(21,ae,2,1,"div",14),i(),n(22,"div",10)(23,"label",15),o(24,"Last Name "),n(25,"span",12),o(26,"*"),i()(),d(27,"input",16),p(28,se,2,1,"div",14),i()(),n(29,"div",10)(30,"label",17),o(31,"Email Address "),n(32,"span",12),o(33,"*"),i()(),d(34,"input",18),p(35,de,3,2,"div",14),i(),n(36,"div",10)(37,"label",19),o(38,"Contact Number (Philippines) "),n(39,"span",12),o(40,"*"),i()(),d(41,"input",20),p(42,ue,3,2,"div",14),i(),n(43,"div",8),o(44,"Address (Optional)"),i(),n(45,"div",10)(46,"label",21),o(47,"Province"),i(),n(48,"select",22)(49,"option",23),o(50),i(),p(51,fe,2,2,"option",24),i()(),n(52,"div",10)(53,"label",25),o(54,"City/Municipality"),i(),n(55,"select",26)(56,"option",23),o(57),i(),p(58,he,2,2,"option",24),i()(),n(59,"div",10)(60,"label",27),o(61,"Barangay"),i(),n(62,"select",28)(63,"option",23),o(64),i(),p(65,_e,2,2,"option",24),i()(),n(66,"div",8),o(67,"Organization Information (Optional)"),i(),n(68,"div",10)(69,"label",29),o(70,"I am donating as"),i(),n(71,"select",30)(72,"option",31),o(73,"Individual"),i(),n(74,"option",32),o(75,"NGO / Non-Profit Organization"),i(),n(76,"option",33),o(77,"Business / Corporation"),i(),n(78,"option",34),o(79,"Government Agency"),i(),n(80,"option",35),o(81,"Religious Organization"),i(),n(82,"option",36),o(83,"Community Group"),i()()(),p(84,ve,4,0,"div",37),n(85,"div",10)(86,"label",38),o(87,"Donation Capacity (Optional)"),i(),d(88,"textarea",39),n(89,"small",40),o(90,"Helps us understand your donation capabilities"),i()(),n(91,"div",8),o(92,"Types of Donations You Can Provide"),i(),n(93,"div",41)(94,"label",42),d(95,"input",43),n(96,"span"),o(97,"\u{1F371} Food Packs"),i()(),n(98,"label",42),d(99,"input",44),n(100,"span"),d(101,"span",4),v(102,"safeHtml"),o(103," Water"),i()(),n(104,"label",42),d(105,"input",45),n(106,"span"),o(107,"\u{1F48A} Medical Supplies"),i()(),n(108,"label",42),d(109,"input",46),n(110,"span"),d(111,"span",4),v(112,"safeHtml"),o(113," Clothing"),i()(),n(114,"label",42),d(115,"input",47),n(116,"span"),o(117,"\u26FA Shelter Materials"),i()(),n(118,"label",42),d(119,"input",48),n(120,"span"),o(121,"\u{1F4B0} Cash Donation"),i()()(),n(122,"div",8),o(123,"Account Security"),i(),n(124,"div",10)(125,"label",49),o(126,"Password "),n(127,"span",12),o(128,"*"),i()(),d(129,"input",50),p(130,xe,3,2,"div",14),i(),n(131,"div",10)(132,"label",51),o(133,"Confirm Password "),n(134,"span",12),o(135,"*"),i()(),d(136,"input",52),p(137,Pe,3,2,"div",14),i(),n(138,"button",53),p(139,Ee,4,3,"span",54)(140,Me,2,0,"span",54),i()(),n(141,"div",55)(142,"p"),o(143,"Already have an account? "),n(144,"a",56),o(145,"Login here"),i()(),n(146,"p"),o(147,"Need help yourself? "),n(148,"a",57),o(149,"Register as Affected Person"),i()()()()()()),a&2&&(l(5),s("innerHTML",b(6,23,t.getIcon("heart")),_),l(5),s("ngIf",t.error),l(),s("formGroup",t.registerForm),l(10),s("ngIf",(t.first_name==null?null:t.first_name.invalid)&&(t.first_name==null?null:t.first_name.touched)),l(7),s("ngIf",(t.last_name==null?null:t.last_name.invalid)&&(t.last_name==null?null:t.last_name.touched)),l(7),s("ngIf",(t.email==null?null:t.email.invalid)&&(t.email==null?null:t.email.touched)),l(7),s("ngIf",(t.phone_number==null?null:t.phone_number.invalid)&&(t.phone_number==null?null:t.phone_number.touched)),l(8),F(t.loadingProvinces?"Loading provinces...":"Select Province"),l(),s("ngForOf",t.provinces),l(4),s("disabled",!(t.province!=null&&t.province.value)||t.loadingCities),l(2),f(" ",t.loadingCities?"Loading cities...":t.province!=null&&t.province.value?"Select City/Municipality":"Select province first"," "),l(),s("ngForOf",t.cities),l(4),s("disabled",!(t.city!=null&&t.city.value)||t.loadingBarangays),l(2),f(" ",t.loadingBarangays?"Loading barangays...":t.city!=null&&t.city.value?"Select Barangay":"Select city first"," "),l(),s("ngForOf",t.barangays),l(19),s("ngIf",(t.organization_type==null?null:t.organization_type.value)!=="individual"),l(17),s("innerHTML",b(102,25,t.getIcon("water")),_),l(10),s("innerHTML",b(112,27,t.getIcon("clothing")),_),l(19),s("ngIf",(t.password==null?null:t.password.invalid)&&(t.password==null?null:t.password.touched)),l(7),s("ngIf",(t.password2==null?null:t.password2.invalid)&&(t.password2==null?null:t.password2.touched)),l(),s("disabled",t.loading||t.registerForm.invalid),l(),s("ngIf",!t.loading),l(),s("ngIf",t.loading))},dependencies:[R,D,k,ee,V,K,Q,$,L,J,j,G,U,W,Y,A,B,q],styles:[".auth-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:80vh;padding:20px}.auth-container.role-selection[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{max-width:900px}.card[_ngcontent-%COMP%]{max-width:600px;width:100%}.text-center[_ngcontent-%COMP%]{text-align:center}.subtitle[_ngcontent-%COMP%]{color:#6b7280;font-size:1rem;margin-top:8px;font-weight:400}.role-cards[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:24px;margin:30px 0}.role-card[_ngcontent-%COMP%]{padding:32px 24px;border:3px solid #e5e7eb;border-radius:16px;text-align:center;cursor:pointer;transition:all .3s ease;background:#fff}.role-card[_ngcontent-%COMP%]:hover{transform:translateY(-8px);box-shadow:0 12px 24px #00000026}.role-card.affected[_ngcontent-%COMP%]{border-color:#fecaca}.role-card.affected[_ngcontent-%COMP%]:hover{border-color:#dc2626;background:#fef2f2}.role-card.donator[_ngcontent-%COMP%]{border-color:#bfdbfe}.role-card.donator[_ngcontent-%COMP%]:hover{border-color:#3b82f6;background:#eff6ff}.role-icon[_ngcontent-%COMP%]{font-size:4rem;margin-bottom:16px}.role-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.5rem;color:#111827;margin-bottom:8px}.role-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#6b7280;margin-bottom:20px;font-size:1rem}.role-features[_ngcontent-%COMP%]{list-style:none;padding:0;margin:20px 0;text-align:left}.role-features[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:8px 0;color:#374151;font-size:.95rem}.role-card[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:16px;width:100%;padding:12px 24px;font-size:1rem;font-weight:600;border:none;border-radius:8px;cursor:pointer;transition:all .2s}.btn-affected[_ngcontent-%COMP%]{background:#dc2626;color:#fff}.btn-affected[_ngcontent-%COMP%]:hover{background:#b91c1c;transform:scale(1.05)}.btn-donator[_ngcontent-%COMP%]{background:#3b82f6;color:#fff}.btn-donator[_ngcontent-%COMP%]:hover{background:#2563eb;transform:scale(1.05)}.btn-block[_ngcontent-%COMP%]{width:100%}.auth-footer[_ngcontent-%COMP%]{text-align:center;margin-top:20px;padding-top:20px;border-top:1px solid #e5e7eb}.auth-footer[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#2563eb;text-decoration:none}.auth-footer[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}@media (max-width: 768px){.role-cards[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:20px}.role-card[_ngcontent-%COMP%]{padding:24px 20px}.role-icon[_ngcontent-%COMP%]{font-size:3rem}}.subtitle[_ngcontent-%COMP%]{color:#6b7280;font-size:.9rem;margin-top:8px;font-weight:400}.section-title[_ngcontent-%COMP%]{font-size:1rem;font-weight:600;color:#374151;margin:24px 0 16px;padding-bottom:8px;border-bottom:2px solid #e5e7eb}.section-title[_ngcontent-%COMP%]:first-of-type{margin-top:0}.help-text[_ngcontent-%COMP%]{display:block;font-size:.85rem;color:#6b7280;margin-top:4px;font-style:italic}.checkbox-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin:16px 0}.checkbox-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:12px 16px;background:#f9fafb;border:2px solid #e5e7eb;border-radius:8px;cursor:pointer;transition:all .2s;font-weight:500}.checkbox-item[_ngcontent-%COMP%]:hover{border-color:#3b82f6;background:#eff6ff}.checkbox-item[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:18px;height:18px;cursor:pointer;accent-color:#3b82f6}.checkbox-item[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + span[_ngcontent-%COMP%]{color:#3b82f6}.required[_ngcontent-%COMP%]{color:#dc2626}.card-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#3b82f6}.btn-primary[_ngcontent-%COMP%]{background:#3b82f6}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background:#2563eb}@media (max-width: 768px){.checkbox-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})}}return r})();export{qe as RegisterDonatorComponent};
