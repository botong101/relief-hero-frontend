import{c as gs,d as Mo,f as Qr,g as No}from"./chunk-PUAS7KUQ.js";import{a as Ss,b as Is,c as bs}from"./chunk-5ADN5T44.js";import{a as _s,b as tr,c as Dn,d as er,e as xs,f as Kr,g as ws,h as Jr,i as ys,j as Cs,k as vs,o as $r,p as Es,q as to,r as As}from"./chunk-FKMIZAYU.js";import{a as ms,c as qr}from"./chunk-XMQ3WWIA.js";import{a as Ki,b as $i}from"./chunk-EMML4XWL.js";import{a as Ts}from"./chunk-3IKG3DOQ.js";import{a as Oo,b as Ji}from"./chunk-TPXSCQ7K.js";import{B as Mr,Db as fs,Eb as Xr,Fb as Qi,Gb as Yr,Hb as qi,Jb as To,Lb as ps,Na as Ht,Pa as W,Qa as Di,Ra as hs,Sa as T,Ta as O,U as cs,Ua as nt,Va as Se,Wa as St,Xa as Q,Z as So,_ as Gr,a as rs,ab as k,b as os,bb as dn,ca as ji,cb as de,d as ss,db as bo,e as as,eb as Nn,f as Gi,fb as On,gb as Ln,ib as Yi,jb as us,kb as dt,l as ls,la as yt,lb as pt,ma as Ct,mb as jr,ta as Xi,tb as ds,va as ft,wa as Io,ya as B,za as vn}from"./chunk-LO2TXSAH.js";var Ns=ss((eo,Ms)=>{"use strict";(function(d,m){typeof eo=="object"&&typeof Ms<"u"?m(eo):typeof define=="function"&&define.amd?define(["exports"],m):(d=typeof globalThis<"u"?globalThis:d||self,m(d.leaflet={}))})(eo,function(d){"use strict";var m="1.9.4";function c(n){var s,h,g,y;for(h=1,g=arguments.length;h<g;h++){y=arguments[h];for(s in y)n[s]=y[s]}return n}var w=Object.create||function(){function n(){}return function(s){return n.prototype=s,new n}}();function _(n,s){var h=Array.prototype.slice;if(n.bind)return n.bind.apply(n,h.call(arguments,1));var g=h.call(arguments,2);return function(){return n.apply(s,g.length?g.concat(h.call(arguments)):arguments)}}var C=0;function M(n){return"_leaflet_id"in n||(n._leaflet_id=++C),n._leaflet_id}function P(n,s,h){var g,y,A,D;return D=function(){g=!1,y&&(A.apply(h,y),y=!1)},A=function(){g?y=arguments:(n.apply(h,arguments),setTimeout(D,s),g=!0)},A}function H(n,s,h){var g=s[1],y=s[0],A=g-y;return n===g&&h?n:((n-y)%A+A)%A+y}function E(){return!1}function Z(n,s){if(s===!1)return n;var h=Math.pow(10,s===void 0?6:s);return Math.round(n*h)/h}function $(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")}function Bt(n){return $(n).split(/\s+/)}function st(n,s){Object.prototype.hasOwnProperty.call(n,"options")||(n.options=n.options?w(n.options):{});for(var h in s)n.options[h]=s[h];return n.options}function Te(n,s,h){var g=[];for(var y in n)g.push(encodeURIComponent(h?y.toUpperCase():y)+"="+encodeURIComponent(n[y]));return(!s||s.indexOf("?")===-1?"?":"&")+g.join("&")}var _e=/\{ *([\w_ -]+) *\}/g;function Lt(n,s){return n.replace(_e,function(h,g){var y=s[g];if(y===void 0)throw new Error("No value provided for variable "+h);return typeof y=="function"&&(y=y(s)),y})}var gt=Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"};function Ft(n,s){for(var h=0;h<n.length;h++)if(n[h]===s)return h;return-1}var Ye="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function Ut(n){return window["webkit"+n]||window["moz"+n]||window["ms"+n]}var tt=0;function Gt(n){var s=+new Date,h=Math.max(0,16-(s-tt));return tt=s+h,window.setTimeout(n,h)}var et=window.requestAnimationFrame||Ut("RequestAnimationFrame")||Gt,ti=window.cancelAnimationFrame||Ut("CancelAnimationFrame")||Ut("CancelRequestAnimationFrame")||function(n){window.clearTimeout(n)};function oe(n,s,h){if(h&&et===Gt)n.call(s);else return et.call(window,_(n,s))}function wt(n){n&&ti.call(window,n)}var ne={__proto__:null,extend:c,create:w,bind:_,get lastId(){return C},stamp:M,throttle:P,wrapNum:H,falseFn:E,formatNum:Z,trim:$,splitWords:Bt,setOptions:st,getParamString:Te,template:Lt,isArray:gt,indexOf:Ft,emptyImageUrl:Ye,requestFn:et,cancelFn:ti,requestAnimFrame:oe,cancelAnimFrame:wt};function le(){}le.extend=function(n){var s=function(){st(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},h=s.__super__=this.prototype,g=w(h);g.constructor=s,s.prototype=g;for(var y in this)Object.prototype.hasOwnProperty.call(this,y)&&y!=="prototype"&&y!=="__super__"&&(s[y]=this[y]);return n.statics&&c(s,n.statics),n.includes&&(Y(n.includes),c.apply(null,[g].concat(n.includes))),c(g,n),delete g.statics,delete g.includes,g.options&&(g.options=h.options?w(h.options):{},c(g.options,n.options)),g._initHooks=[],g.callInitHooks=function(){if(!this._initHooksCalled){h.callInitHooks&&h.callInitHooks.call(this),this._initHooksCalled=!0;for(var A=0,D=g._initHooks.length;A<D;A++)g._initHooks[A].call(this)}},s},le.include=function(n){var s=this.prototype.options;return c(this.prototype,n),n.options&&(this.prototype.options=s,this.mergeOptions(n.options)),this},le.mergeOptions=function(n){return c(this.prototype.options,n),this},le.addInitHook=function(n){var s=Array.prototype.slice.call(arguments,1),h=typeof n=="function"?n:function(){this[n].apply(this,s)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(h),this};function Y(n){if(!(typeof L>"u"||!L||!L.Mixin)){n=gt(n)?n:[n];for(var s=0;s<n.length;s++)n[s]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var $t={on:function(n,s,h){if(typeof n=="object")for(var g in n)this._on(g,n[g],s);else{n=Bt(n);for(var y=0,A=n.length;y<A;y++)this._on(n[y],s,h)}return this},off:function(n,s,h){if(!arguments.length)delete this._events;else if(typeof n=="object")for(var g in n)this._off(g,n[g],s);else{n=Bt(n);for(var y=arguments.length===1,A=0,D=n.length;A<D;A++)y?this._off(n[A]):this._off(n[A],s,h)}return this},_on:function(n,s,h,g){if(typeof s!="function"){console.warn("wrong listener type: "+typeof s);return}if(this._listens(n,s,h)===!1){h===this&&(h=void 0);var y={fn:s,ctx:h};g&&(y.once=!0),this._events=this._events||{},this._events[n]=this._events[n]||[],this._events[n].push(y)}},_off:function(n,s,h){var g,y,A;if(this._events&&(g=this._events[n],!!g)){if(arguments.length===1){if(this._firingCount)for(y=0,A=g.length;y<A;y++)g[y].fn=E;delete this._events[n];return}if(typeof s!="function"){console.warn("wrong listener type: "+typeof s);return}var D=this._listens(n,s,h);if(D!==!1){var z=g[D];this._firingCount&&(z.fn=E,this._events[n]=g=g.slice()),g.splice(D,1)}}},fire:function(n,s,h){if(!this.listens(n,h))return this;var g=c({},s,{type:n,target:this,sourceTarget:s&&s.sourceTarget||this});if(this._events){var y=this._events[n];if(y){this._firingCount=this._firingCount+1||1;for(var A=0,D=y.length;A<D;A++){var z=y[A],j=z.fn;z.once&&this.off(n,j,z.ctx),j.call(z.ctx||this,g)}this._firingCount--}}return h&&this._propagateEvent(g),this},listens:function(n,s,h,g){typeof n!="string"&&console.warn('"string" type argument expected');var y=s;typeof s!="function"&&(g=!!s,y=void 0,h=void 0);var A=this._events&&this._events[n];if(A&&A.length&&this._listens(n,y,h)!==!1)return!0;if(g){for(var D in this._eventParents)if(this._eventParents[D].listens(n,s,h,g))return!0}return!1},_listens:function(n,s,h){if(!this._events)return!1;var g=this._events[n]||[];if(!s)return!!g.length;h===this&&(h=void 0);for(var y=0,A=g.length;y<A;y++)if(g[y].fn===s&&g[y].ctx===h)return y;return!1},once:function(n,s,h){if(typeof n=="object")for(var g in n)this._on(g,n[g],s,!0);else{n=Bt(n);for(var y=0,A=n.length;y<A;y++)this._on(n[y],s,h,!0)}return this},addEventParent:function(n){return this._eventParents=this._eventParents||{},this._eventParents[M(n)]=n,this},removeEventParent:function(n){return this._eventParents&&delete this._eventParents[M(n)],this},_propagateEvent:function(n){for(var s in this._eventParents)this._eventParents[s].fire(n.type,c({layer:n.target,propagatedFrom:n.target},n),!0)}};$t.addEventListener=$t.on,$t.removeEventListener=$t.clearAllEventListeners=$t.off,$t.addOneTimeEventListener=$t.once,$t.fireEvent=$t.fire,$t.hasEventListeners=$t.listens;var Mt=le.extend($t);function bt(n,s,h){this.x=h?Math.round(n):n,this.y=h?Math.round(s):s}var Sn=Math.trunc||function(n){return n>0?Math.floor(n):Math.ceil(n)};bt.prototype={clone:function(){return new bt(this.x,this.y)},add:function(n){return this.clone()._add(At(n))},_add:function(n){return this.x+=n.x,this.y+=n.y,this},subtract:function(n){return this.clone()._subtract(At(n))},_subtract:function(n){return this.x-=n.x,this.y-=n.y,this},divideBy:function(n){return this.clone()._divideBy(n)},_divideBy:function(n){return this.x/=n,this.y/=n,this},multiplyBy:function(n){return this.clone()._multiplyBy(n)},_multiplyBy:function(n){return this.x*=n,this.y*=n,this},scaleBy:function(n){return new bt(this.x*n.x,this.y*n.y)},unscaleBy:function(n){return new bt(this.x/n.x,this.y/n.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Sn(this.x),this.y=Sn(this.y),this},distanceTo:function(n){n=At(n);var s=n.x-this.x,h=n.y-this.y;return Math.sqrt(s*s+h*h)},equals:function(n){return n=At(n),n.x===this.x&&n.y===this.y},contains:function(n){return n=At(n),Math.abs(n.x)<=Math.abs(this.x)&&Math.abs(n.y)<=Math.abs(this.y)},toString:function(){return"Point("+Z(this.x)+", "+Z(this.y)+")"}};function At(n,s,h){return n instanceof bt?n:gt(n)?new bt(n[0],n[1]):n==null?n:typeof n=="object"&&"x"in n&&"y"in n?new bt(n.x,n.y):new bt(n,s,h)}function ge(n,s){if(n)for(var h=s?[n,s]:n,g=0,y=h.length;g<y;g++)this.extend(h[g])}ge.prototype={extend:function(n){var s,h;if(!n)return this;if(n instanceof bt||typeof n[0]=="number"||"x"in n)s=h=At(n);else if(n=ie(n),s=n.min,h=n.max,!s||!h)return this;return!this.min&&!this.max?(this.min=s.clone(),this.max=h.clone()):(this.min.x=Math.min(s.x,this.min.x),this.max.x=Math.max(h.x,this.max.x),this.min.y=Math.min(s.y,this.min.y),this.max.y=Math.max(h.y,this.max.y)),this},getCenter:function(n){return At((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,n)},getBottomLeft:function(){return At(this.min.x,this.max.y)},getTopRight:function(){return At(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(n){var s,h;return typeof n[0]=="number"||n instanceof bt?n=At(n):n=ie(n),n instanceof ge?(s=n.min,h=n.max):s=h=n,s.x>=this.min.x&&h.x<=this.max.x&&s.y>=this.min.y&&h.y<=this.max.y},intersects:function(n){n=ie(n);var s=this.min,h=this.max,g=n.min,y=n.max,A=y.x>=s.x&&g.x<=h.x,D=y.y>=s.y&&g.y<=h.y;return A&&D},overlaps:function(n){n=ie(n);var s=this.min,h=this.max,g=n.min,y=n.max,A=y.x>s.x&&g.x<h.x,D=y.y>s.y&&g.y<h.y;return A&&D},isValid:function(){return!!(this.min&&this.max)},pad:function(n){var s=this.min,h=this.max,g=Math.abs(s.x-h.x)*n,y=Math.abs(s.y-h.y)*n;return ie(At(s.x-g,s.y-y),At(h.x+g,h.y+y))},equals:function(n){return n?(n=ie(n),this.min.equals(n.getTopLeft())&&this.max.equals(n.getBottomRight())):!1}};function ie(n,s){return!n||n instanceof ge?n:new ge(n,s)}function Ie(n,s){if(n)for(var h=s?[n,s]:n,g=0,y=h.length;g<y;g++)this.extend(h[g])}Ie.prototype={extend:function(n){var s=this._southWest,h=this._northEast,g,y;if(n instanceof ee)g=n,y=n;else if(n instanceof Ie){if(g=n._southWest,y=n._northEast,!g||!y)return this}else return n?this.extend(it(n)||Zt(n)):this;return!s&&!h?(this._southWest=new ee(g.lat,g.lng),this._northEast=new ee(y.lat,y.lng)):(s.lat=Math.min(g.lat,s.lat),s.lng=Math.min(g.lng,s.lng),h.lat=Math.max(y.lat,h.lat),h.lng=Math.max(y.lng,h.lng)),this},pad:function(n){var s=this._southWest,h=this._northEast,g=Math.abs(s.lat-h.lat)*n,y=Math.abs(s.lng-h.lng)*n;return new Ie(new ee(s.lat-g,s.lng-y),new ee(h.lat+g,h.lng+y))},getCenter:function(){return new ee((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new ee(this.getNorth(),this.getWest())},getSouthEast:function(){return new ee(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(n){typeof n[0]=="number"||n instanceof ee||"lat"in n?n=it(n):n=Zt(n);var s=this._southWest,h=this._northEast,g,y;return n instanceof Ie?(g=n.getSouthWest(),y=n.getNorthEast()):g=y=n,g.lat>=s.lat&&y.lat<=h.lat&&g.lng>=s.lng&&y.lng<=h.lng},intersects:function(n){n=Zt(n);var s=this._southWest,h=this._northEast,g=n.getSouthWest(),y=n.getNorthEast(),A=y.lat>=s.lat&&g.lat<=h.lat,D=y.lng>=s.lng&&g.lng<=h.lng;return A&&D},overlaps:function(n){n=Zt(n);var s=this._southWest,h=this._northEast,g=n.getSouthWest(),y=n.getNorthEast(),A=y.lat>s.lat&&g.lat<h.lat,D=y.lng>s.lng&&g.lng<h.lng;return A&&D},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(n,s){return n?(n=Zt(n),this._southWest.equals(n.getSouthWest(),s)&&this._northEast.equals(n.getNorthEast(),s)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function Zt(n,s){return n instanceof Ie?n:new Ie(n,s)}function ee(n,s,h){if(isNaN(n)||isNaN(s))throw new Error("Invalid LatLng object: ("+n+", "+s+")");this.lat=+n,this.lng=+s,h!==void 0&&(this.alt=+h)}ee.prototype={equals:function(n,s){if(!n)return!1;n=it(n);var h=Math.max(Math.abs(this.lat-n.lat),Math.abs(this.lng-n.lng));return h<=(s===void 0?1e-9:s)},toString:function(n){return"LatLng("+Z(this.lat,n)+", "+Z(this.lng,n)+")"},distanceTo:function(n){return fe.distance(this,it(n))},wrap:function(){return fe.wrapLatLng(this)},toBounds:function(n){var s=180*n/40075017,h=s/Math.cos(Math.PI/180*this.lat);return Zt([this.lat-s,this.lng-h],[this.lat+s,this.lng+h])},clone:function(){return new ee(this.lat,this.lng,this.alt)}};function it(n,s,h){return n instanceof ee?n:gt(n)&&typeof n[0]!="object"?n.length===3?new ee(n[0],n[1],n[2]):n.length===2?new ee(n[0],n[1]):null:n==null?n:typeof n=="object"&&"lat"in n?new ee(n.lat,"lng"in n?n.lng:n.lon,n.alt):s===void 0?null:new ee(n,s,h)}var pn={latLngToPoint:function(n,s){var h=this.projection.project(n),g=this.scale(s);return this.transformation._transform(h,g)},pointToLatLng:function(n,s){var h=this.scale(s),g=this.transformation.untransform(n,h);return this.projection.unproject(g)},project:function(n){return this.projection.project(n)},unproject:function(n){return this.projection.unproject(n)},scale:function(n){return 256*Math.pow(2,n)},zoom:function(n){return Math.log(n/256)/Math.LN2},getProjectedBounds:function(n){if(this.infinite)return null;var s=this.projection.bounds,h=this.scale(n),g=this.transformation.transform(s.min,h),y=this.transformation.transform(s.max,h);return new ge(g,y)},infinite:!1,wrapLatLng:function(n){var s=this.wrapLng?H(n.lng,this.wrapLng,!0):n.lng,h=this.wrapLat?H(n.lat,this.wrapLat,!0):n.lat,g=n.alt;return new ee(h,s,g)},wrapLatLngBounds:function(n){var s=n.getCenter(),h=this.wrapLatLng(s),g=s.lat-h.lat,y=s.lng-h.lng;if(g===0&&y===0)return n;var A=n.getSouthWest(),D=n.getNorthEast(),z=new ee(A.lat-g,A.lng-y),j=new ee(D.lat-g,D.lng-y);return new Ie(z,j)}},fe=c({},pn,{wrapLng:[-180,180],R:6371e3,distance:function(n,s){var h=Math.PI/180,g=n.lat*h,y=s.lat*h,A=Math.sin((s.lat-n.lat)*h/2),D=Math.sin((s.lng-n.lng)*h/2),z=A*A+Math.cos(g)*Math.cos(y)*D*D,j=2*Math.atan2(Math.sqrt(z),Math.sqrt(1-z));return this.R*j}}),ei=6378137,Vn={R:ei,MAX_LATITUDE:85.0511287798,project:function(n){var s=Math.PI/180,h=this.MAX_LATITUDE,g=Math.max(Math.min(h,n.lat),-h),y=Math.sin(g*s);return new bt(this.R*n.lng*s,this.R*Math.log((1+y)/(1-y))/2)},unproject:function(n){var s=180/Math.PI;return new ee((2*Math.atan(Math.exp(n.y/this.R))-Math.PI/2)*s,n.x*s/this.R)},bounds:function(){var n=ei*Math.PI;return new ge([-n,-n],[n,n])}()};function ke(n,s,h,g){if(gt(n)){this._a=n[0],this._b=n[1],this._c=n[2],this._d=n[3];return}this._a=n,this._b=s,this._c=h,this._d=g}ke.prototype={transform:function(n,s){return this._transform(n.clone(),s)},_transform:function(n,s){return s=s||1,n.x=s*(this._a*n.x+this._b),n.y=s*(this._c*n.y+this._d),n},untransform:function(n,s){return s=s||1,new bt((n.x/s-this._b)/this._a,(n.y/s-this._d)/this._c)}};function Zn(n,s,h,g){return new ke(n,s,h,g)}var jt=c({},fe,{code:"EPSG:3857",projection:Vn,transformation:function(){var n=.5/(Math.PI*Vn.R);return Zn(n,.5,-n,.5)}()}),mi=c({},jt,{code:"EPSG:900913"});function gn(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function ni(n,s){var h="",g,y,A,D,z,j;for(g=0,A=n.length;g<A;g++){for(z=n[g],y=0,D=z.length;y<D;y++)j=z[y],h+=(y?"L":"M")+j.x+" "+j.y;h+=s?_t.svg?"z":"x":""}return h||"M0 0"}var Ne=document.documentElement.style,ii="ActiveXObject"in window,Xt=ii&&!document.addEventListener,_i="msLaunchUri"in navigator&&!("documentMode"in document),mt=be("webkit"),xi=be("android"),ir=be("android 2")||be("android 3"),Ri=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),rr=xi&&be("Google")&&Ri<537&&!("AudioNode"in window),Qe=!!window.opera,or=!_i&&be("chrome"),In=be("gecko")&&!mt&&!Qe&&!ii,Ve=!or&&be("safari"),sr=be("phantom"),wi="OTransition"in Ne,lo=navigator.platform.indexOf("Win")===0,Ee=ii&&"transition"in Ne,rt="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!ir,Pi="MozPerspective"in Ne,se=!window.L_DISABLE_3D&&(Ee||rt||Pi)&&!wi&&!sr,ce=typeof orientation<"u"||be("mobile"),yi=ce&&mt,ar=ce&&rt,lr=!window.PointerEvent&&window.MSPointerEvent,Qt=!!(window.PointerEvent||lr),Ci="ontouchstart"in window||!!window.TouchEvent,Nr=!window.L_NO_TOUCH&&(Ci||Qt),Or=ce&&Qe,ln=ce&&In,cr=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Wn=function(){var n=!1;try{var s=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("testPassiveEventSupport",E,s),window.removeEventListener("testPassiveEventSupport",E,s)}catch{}return n}(),ri=function(){return!!document.createElement("canvas").getContext}(),oi=!!(document.createElementNS&&gn("svg").createSVGRect),mn=!!oi&&function(){var n=document.createElement("div");return n.innerHTML="<svg/>",(n.firstChild&&n.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),co=!oi&&function(){try{var n=document.createElement("div");n.innerHTML='<v:shape adj="1"/>';var s=n.firstChild;return s.style.behavior="url(#default#VML)",s&&typeof s.adj=="object"}catch{return!1}}(),Gn=navigator.platform.indexOf("Mac")===0,hr=navigator.platform.indexOf("Linux")===0;function be(n){return navigator.userAgent.toLowerCase().indexOf(n)>=0}var _t={ie:ii,ielt9:Xt,edge:_i,webkit:mt,android:xi,android23:ir,androidStock:rr,opera:Qe,chrome:or,gecko:In,safari:Ve,phantom:sr,opera12:wi,win:lo,ie3d:Ee,webkit3d:rt,gecko3d:Pi,any3d:se,mobile:ce,mobileWebkit:yi,mobileWebkit3d:ar,msPointer:lr,pointer:Qt,touch:Nr,touchNative:Ci,mobileOpera:Or,mobileGecko:ln,retina:cr,passiveEvents:Wn,canvas:ri,svg:oi,vml:co,inlineSvg:mn,mac:Gn,linux:hr},jn=_t.msPointer?"MSPointerDown":"pointerdown",ct=_t.msPointer?"MSPointerMove":"pointermove",Xn=_t.msPointer?"MSPointerUp":"pointerup",Bi=_t.msPointer?"MSPointerCancel":"pointercancel",qe={touchstart:jn,touchmove:ct,touchend:Xn,touchcancel:Bi},Lr={touchstart:Pn,touchmove:Ei,touchend:Ei,touchcancel:Ei},si={},vi=!1;function Dr(n,s,h){return s==="touchstart"&&Rn(),Lr[s]?(h=Lr[s].bind(this,h),n.addEventListener(qe[s],h,!1),h):(console.warn("wrong event specified:",s),E)}function ho(n,s,h){if(!qe[s]){console.warn("wrong event specified:",s);return}n.removeEventListener(qe[s],h,!1)}function uo(n){si[n.pointerId]=n}function fo(n){si[n.pointerId]&&(si[n.pointerId]=n)}function Rr(n){delete si[n.pointerId]}function Rn(){vi||(document.addEventListener(jn,uo,!0),document.addEventListener(ct,fo,!0),document.addEventListener(Xn,Rr,!0),document.addEventListener(Bi,Rr,!0),vi=!0)}function Ei(n,s){if(s.pointerType!==(s.MSPOINTER_TYPE_MOUSE||"mouse")){s.touches=[];for(var h in si)s.touches.push(si[h]);s.changedTouches=[s],n(s)}}function Pn(n,s){s.MSPOINTER_TYPE_TOUCH&&s.pointerType===s.MSPOINTER_TYPE_TOUCH&&Re(s),Ei(n,s)}function ur(n){var s={},h,g;for(g in n)h=n[g],s[g]=h&&h.bind?h.bind(n):h;return n=s,s.type="dblclick",s.detail=2,s.isTrusted=!1,s._simulated=!0,s}var q=200;function po(n,s){n.addEventListener("dblclick",s);var h=0,g;function y(A){if(A.detail!==1){g=A.detail;return}if(!(A.pointerType==="mouse"||A.sourceCapabilities&&!A.sourceCapabilities.firesTouchEvents)){var D=_r(A);if(!(D.some(function(j){return j instanceof HTMLLabelElement&&j.attributes.for})&&!D.some(function(j){return j instanceof HTMLInputElement||j instanceof HTMLSelectElement}))){var z=Date.now();z-h<=q?(g++,g===2&&s(ur(A))):g=1,h=z}}}return n.addEventListener("click",y),{dblclick:s,simDblclick:y}}function ve(n,s){n.removeEventListener("dblclick",s.dblclick),n.removeEventListener("click",s.simDblclick)}var Bn=U(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Ai=U(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Jt=Ai==="webkitTransition"||Ai==="OTransition"?Ai+"End":"transitionend";function qt(n){return typeof n=="string"?document.getElementById(n):n}function Rt(n,s){var h=n.style[s]||n.currentStyle&&n.currentStyle[s];if((!h||h==="auto")&&document.defaultView){var g=document.defaultView.getComputedStyle(n,null);h=g?g[s]:null}return h==="auto"?null:h}function Wt(n,s,h){var g=document.createElement(n);return g.className=s||"",h&&h.appendChild(g),g}function pe(n){var s=n.parentNode;s&&s.removeChild(n)}function ai(n){for(;n.firstChild;)n.removeChild(n.firstChild)}function xe(n){var s=n.parentNode;s&&s.lastChild!==n&&s.appendChild(n)}function Ke(n){var s=n.parentNode;s&&s.firstChild!==n&&s.insertBefore(n,s.firstChild)}function dr(n,s){if(n.classList!==void 0)return n.classList.contains(s);var h=kn(n);return h.length>0&&new RegExp("(^|\\s)"+s+"(\\s|$)").test(h)}function xt(n,s){if(n.classList!==void 0)for(var h=Bt(s),g=0,y=h.length;g<y;g++)n.classList.add(h[g]);else if(!dr(n,s)){var A=kn(n);fr(n,(A?A+" ":"")+s)}}function me(n,s){n.classList!==void 0?n.classList.remove(s):fr(n,$((" "+kn(n)+" ").replace(" "+s+" "," ")))}function fr(n,s){n.className.baseVal===void 0?n.className=s:n.className.baseVal=s}function kn(n){return n.correspondingElement&&(n=n.correspondingElement),n.className.baseVal===void 0?n.className:n.className.baseVal}function kt(n,s){"opacity"in n.style?n.style.opacity=s:"filter"in n.style&&Fe(n,s)}function Fe(n,s){var h=!1,g="DXImageTransform.Microsoft.Alpha";try{h=n.filters.item(g)}catch{if(s===1)return}s=Math.round(s*100),h?(h.Enabled=s!==100,h.Opacity=s):n.style.filter+=" progid:"+g+"(opacity="+s+")"}function U(n){for(var s=document.documentElement.style,h=0;h<n.length;h++)if(n[h]in s)return n[h];return!1}function I(n,s,h){var g=s||new bt(0,0);n.style[Bn]=(_t.ie3d?"translate("+g.x+"px,"+g.y+"px)":"translate3d("+g.x+"px,"+g.y+"px,0)")+(h?" scale("+h+")":"")}function at(n,s){n._leaflet_pos=s,_t.any3d?I(n,s):(n.style.left=s.x+"px",n.style.top=s.y+"px")}function we(n){return n._leaflet_pos||new bt(0,0)}var Ue,Si,Ii;if("onselectstart"in document)Ue=function(){Tt(window,"selectstart",Re)},Si=function(){lt(window,"selectstart",Re)};else{var Ze=U(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Ue=function(){if(Ze){var n=document.documentElement.style;Ii=n[Ze],n[Ze]="none"}},Si=function(){Ze&&(document.documentElement.style[Ze]=Ii,Ii=void 0)}}function vt(){Tt(window,"dragstart",Re)}function ki(){lt(window,"dragstart",Re)}var bi,pr;function Ti(n){for(;n.tabIndex===-1;)n=n.parentNode;n.style&&(Yn(),bi=n,pr=n.style.outlineStyle,n.style.outlineStyle="none",Tt(window,"keydown",Yn))}function Yn(){bi&&(bi.style.outlineStyle=pr,bi=void 0,pr=void 0,lt(window,"keydown",Yn))}function Fi(n){do n=n.parentNode;while((!n.offsetWidth||!n.offsetHeight)&&n!==document.body);return n}function gr(n){var s=n.getBoundingClientRect();return{x:s.width/n.offsetWidth||1,y:s.height/n.offsetHeight||1,boundingClientRect:s}}var go={__proto__:null,TRANSFORM:Bn,TRANSITION:Ai,TRANSITION_END:Jt,get:qt,getStyle:Rt,create:Wt,remove:pe,empty:ai,toFront:xe,toBack:Ke,hasClass:dr,addClass:xt,removeClass:me,setClass:fr,getClass:kn,setOpacity:kt,testProp:U,setTransform:I,setPosition:at,getPosition:we,get disableTextSelection(){return Ue},get enableTextSelection(){return Si},disableImageDrag:vt,enableImageDrag:ki,preventOutline:Ti,restoreOutline:Yn,getSizedParentNode:Fi,getScale:gr};function Tt(n,s,h,g){if(s&&typeof s=="object")for(var y in s)Me(n,y,s[y],h);else{s=Bt(s);for(var A=0,D=s.length;A<D;A++)Me(n,s[A],h,g)}return this}var De="_leaflet_events";function lt(n,s,h,g){if(arguments.length===1)Pr(n),delete n[De];else if(s&&typeof s=="object")for(var y in s)mr(n,y,s[y],h);else if(s=Bt(s),arguments.length===2)Pr(n,function(z){return Ft(s,z)!==-1});else for(var A=0,D=s.length;A<D;A++)mr(n,s[A],h,g);return this}function Pr(n,s){for(var h in n[De]){var g=h.split(/\d/)[0];(!s||s(g))&&mr(n,g,null,null,h)}}var Nt={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Me(n,s,h,g){var y=s+M(h)+(g?"_"+M(g):"");if(n[De]&&n[De][y])return this;var A=function(z){return h.call(g||n,z||window.event)},D=A;!_t.touchNative&&_t.pointer&&s.indexOf("touch")===0?A=Dr(n,s,A):_t.touch&&s==="dblclick"?A=po(n,A):"addEventListener"in n?s==="touchstart"||s==="touchmove"||s==="wheel"||s==="mousewheel"?n.addEventListener(Nt[s]||s,A,_t.passiveEvents?{passive:!1}:!1):s==="mouseenter"||s==="mouseleave"?(A=function(z){z=z||window.event,xr(n,z)&&D(z)},n.addEventListener(Nt[s],A,!1)):n.addEventListener(s,D,!1):n.attachEvent("on"+s,A),n[De]=n[De]||{},n[De][y]=A}function mr(n,s,h,g,y){y=y||s+M(h)+(g?"_"+M(g):"");var A=n[De]&&n[De][y];if(!A)return this;!_t.touchNative&&_t.pointer&&s.indexOf("touch")===0?ho(n,s,A):_t.touch&&s==="dblclick"?ve(n,A):"removeEventListener"in n?n.removeEventListener(Nt[s]||s,A,!1):n.detachEvent("on"+s,A),n[De][y]=null}function bn(n){return n.stopPropagation?n.stopPropagation():n.originalEvent?n.originalEvent._stopped=!0:n.cancelBubble=!0,this}function Ui(n){return Me(n,"wheel",bn),this}function cn(n){return Tt(n,"mousedown touchstart dblclick contextmenu",bn),n._leaflet_disable_click=!0,this}function Re(n){return n.preventDefault?n.preventDefault():n.returnValue=!1,this}function hn(n){return Re(n),bn(n),this}function _r(n){if(n.composedPath)return n.composedPath();for(var s=[],h=n.target;h;)s.push(h),h=h.parentNode;return s}function li(n,s){if(!s)return new bt(n.clientX,n.clientY);var h=gr(s),g=h.boundingClientRect;return new bt((n.clientX-g.left)/h.x-s.clientLeft,(n.clientY-g.top)/h.y-s.clientTop)}var Br=_t.linux&&_t.chrome?window.devicePixelRatio:_t.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function ci(n){return _t.edge?n.wheelDeltaY/2:n.deltaY&&n.deltaMode===0?-n.deltaY/Br:n.deltaY&&n.deltaMode===1?-n.deltaY*20:n.deltaY&&n.deltaMode===2?-n.deltaY*60:n.deltaX||n.deltaZ?0:n.wheelDelta?(n.wheelDeltaY||n.wheelDelta)/2:n.detail&&Math.abs(n.detail)<32765?-n.detail*20:n.detail?n.detail/-32765*60:0}function xr(n,s){var h=s.relatedTarget;if(!h)return!0;try{for(;h&&h!==n;)h=h.parentNode}catch{return!1}return h!==n}var We={__proto__:null,on:Tt,off:lt,stopPropagation:bn,disableScrollPropagation:Ui,disableClickPropagation:cn,preventDefault:Re,stop:hn,getPropagationPath:_r,getMousePosition:li,getWheelDelta:ci,isExternalTarget:xr,addListener:Tt,removeListener:lt},wr=Mt.extend({run:function(n,s,h,g){this.stop(),this._el=n,this._inProgress=!0,this._duration=h||.25,this._easeOutPower=1/Math.max(g||.5,.2),this._startPos=we(n),this._offset=s.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=oe(this._animate,this),this._step()},_step:function(n){var s=+new Date-this._startTime,h=this._duration*1e3;s<h?this._runFrame(this._easeOut(s/h),n):(this._runFrame(1),this._complete())},_runFrame:function(n,s){var h=this._startPos.add(this._offset.multiplyBy(n));s&&h._round(),at(this._el,h),this.fire("step")},_complete:function(){wt(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(n){return 1-Math.pow(1-n,this._easeOutPower)}}),Vt=Mt.extend({options:{crs:jt,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(n,s){s=st(this,s),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(n),this._initLayout(),this._onResize=_(this._onResize,this),this._initEvents(),s.maxBounds&&this.setMaxBounds(s.maxBounds),s.zoom!==void 0&&(this._zoom=this._limitZoom(s.zoom)),s.center&&s.zoom!==void 0&&this.setView(it(s.center),s.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Ai&&_t.any3d&&!_t.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Tt(this._proxy,Jt,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(n,s,h){if(s=s===void 0?this._zoom:this._limitZoom(s),n=this._limitCenter(it(n),s,this.options.maxBounds),h=h||{},this._stop(),this._loaded&&!h.reset&&h!==!0){h.animate!==void 0&&(h.zoom=c({animate:h.animate},h.zoom),h.pan=c({animate:h.animate,duration:h.duration},h.pan));var g=this._zoom!==s?this._tryAnimatedZoom&&this._tryAnimatedZoom(n,s,h.zoom):this._tryAnimatedPan(n,h.pan);if(g)return clearTimeout(this._sizeTimer),this}return this._resetView(n,s,h.pan&&h.pan.noMoveStart),this},setZoom:function(n,s){return this._loaded?this.setView(this.getCenter(),n,{zoom:s}):(this._zoom=n,this)},zoomIn:function(n,s){return n=n||(_t.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+n,s)},zoomOut:function(n,s){return n=n||(_t.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-n,s)},setZoomAround:function(n,s,h){var g=this.getZoomScale(s),y=this.getSize().divideBy(2),A=n instanceof bt?n:this.latLngToContainerPoint(n),D=A.subtract(y).multiplyBy(1-1/g),z=this.containerPointToLatLng(y.add(D));return this.setView(z,s,{zoom:h})},_getBoundsCenterZoom:function(n,s){s=s||{},n=n.getBounds?n.getBounds():Zt(n);var h=At(s.paddingTopLeft||s.padding||[0,0]),g=At(s.paddingBottomRight||s.padding||[0,0]),y=this.getBoundsZoom(n,!1,h.add(g));if(y=typeof s.maxZoom=="number"?Math.min(s.maxZoom,y):y,y===1/0)return{center:n.getCenter(),zoom:y};var A=g.subtract(h).divideBy(2),D=this.project(n.getSouthWest(),y),z=this.project(n.getNorthEast(),y),j=this.unproject(D.add(z).divideBy(2).add(A),y);return{center:j,zoom:y}},fitBounds:function(n,s){if(n=Zt(n),!n.isValid())throw new Error("Bounds are not valid.");var h=this._getBoundsCenterZoom(n,s);return this.setView(h.center,h.zoom,s)},fitWorld:function(n){return this.fitBounds([[-90,-180],[90,180]],n)},panTo:function(n,s){return this.setView(n,this._zoom,{pan:s})},panBy:function(n,s){if(n=At(n).round(),s=s||{},!n.x&&!n.y)return this.fire("moveend");if(s.animate!==!0&&!this.getSize().contains(n))return this._resetView(this.unproject(this.project(this.getCenter()).add(n)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new wr,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),s.noMoveStart||this.fire("movestart"),s.animate!==!1){xt(this._mapPane,"leaflet-pan-anim");var h=this._getMapPanePos().subtract(n).round();this._panAnim.run(this._mapPane,h,s.duration||.25,s.easeLinearity)}else this._rawPanBy(n),this.fire("move").fire("moveend");return this},flyTo:function(n,s,h){if(h=h||{},h.animate===!1||!_t.any3d)return this.setView(n,s,h);this._stop();var g=this.project(this.getCenter()),y=this.project(n),A=this.getSize(),D=this._zoom;n=it(n),s=s===void 0?D:s;var z=Math.max(A.x,A.y),j=z*this.getZoomScale(D,s),K=y.distanceTo(g)||1,ht=1.42,It=ht*ht;function zt(Le){var Wr=Le?-1:1,ya=Le?j:z,Ca=j*j-z*z+Wr*It*It*K*K,va=2*ya*It*K,Ao=Ca/va,is=Math.sqrt(Ao*Ao+1)-Ao,Ea=is<1e-9?-18:Math.log(is);return Ea}function tn(Le){return(Math.exp(Le)-Math.exp(-Le))/2}function ze(Le){return(Math.exp(Le)+Math.exp(-Le))/2}function Cn(Le){return tn(Le)/ze(Le)}var on=zt(0);function Wi(Le){return z*(ze(on)/ze(on+ht*Le))}function ma(Le){return z*(ze(on)*Cn(on+ht*Le)-tn(on))/It}function _a(Le){return 1-Math.pow(1-Le,1.5)}var xa=Date.now(),es=(zt(1)-on)/ht,wa=h.duration?1e3*h.duration:1e3*es*.8;function ns(){var Le=(Date.now()-xa)/wa,Wr=_a(Le)*es;Le<=1?(this._flyToFrame=oe(ns,this),this._move(this.unproject(g.add(y.subtract(g).multiplyBy(ma(Wr)/K)),D),this.getScaleZoom(z/Wi(Wr),D),{flyTo:!0})):this._move(n,s)._moveEnd(!0)}return this._moveStart(!0,h.noMoveStart),ns.call(this),this},flyToBounds:function(n,s){var h=this._getBoundsCenterZoom(n,s);return this.flyTo(h.center,h.zoom,s)},setMaxBounds:function(n){return n=Zt(n),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),n.isValid()?(this.options.maxBounds=n,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(n){var s=this.options.minZoom;return this.options.minZoom=n,this._loaded&&s!==n&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(n):this},setMaxZoom:function(n){var s=this.options.maxZoom;return this.options.maxZoom=n,this._loaded&&s!==n&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(n):this},panInsideBounds:function(n,s){this._enforcingBounds=!0;var h=this.getCenter(),g=this._limitCenter(h,this._zoom,Zt(n));return h.equals(g)||this.panTo(g,s),this._enforcingBounds=!1,this},panInside:function(n,s){s=s||{};var h=At(s.paddingTopLeft||s.padding||[0,0]),g=At(s.paddingBottomRight||s.padding||[0,0]),y=this.project(this.getCenter()),A=this.project(n),D=this.getPixelBounds(),z=ie([D.min.add(h),D.max.subtract(g)]),j=z.getSize();if(!z.contains(A)){this._enforcingBounds=!0;var K=A.subtract(z.getCenter()),ht=z.extend(A).getSize().subtract(j);y.x+=K.x<0?-ht.x:ht.x,y.y+=K.y<0?-ht.y:ht.y,this.panTo(this.unproject(y),s),this._enforcingBounds=!1}return this},invalidateSize:function(n){if(!this._loaded)return this;n=c({animate:!1,pan:!0},n===!0?{animate:!0}:n);var s=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var h=this.getSize(),g=s.divideBy(2).round(),y=h.divideBy(2).round(),A=g.subtract(y);return!A.x&&!A.y?this:(n.animate&&n.pan?this.panBy(A):(n.pan&&this._rawPanBy(A),this.fire("move"),n.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(_(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:s,newSize:h}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(n){if(n=this._locateOptions=c({timeout:1e4,watch:!1},n),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var s=_(this._handleGeolocationResponse,this),h=_(this._handleGeolocationError,this);return n.watch?this._locationWatchId=navigator.geolocation.watchPosition(s,h,n):navigator.geolocation.getCurrentPosition(s,h,n),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(n){if(this._container._leaflet_id){var s=n.code,h=n.message||(s===1?"permission denied":s===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:s,message:"Geolocation error: "+h+"."})}},_handleGeolocationResponse:function(n){if(this._container._leaflet_id){var s=n.coords.latitude,h=n.coords.longitude,g=new ee(s,h),y=g.toBounds(n.coords.accuracy*2),A=this._locateOptions;if(A.setView){var D=this.getBoundsZoom(y);this.setView(g,A.maxZoom?Math.min(D,A.maxZoom):D)}var z={latlng:g,bounds:y,timestamp:n.timestamp};for(var j in n.coords)typeof n.coords[j]=="number"&&(z[j]=n.coords[j]);this.fire("locationfound",z)}},addHandler:function(n,s){if(!s)return this;var h=this[n]=new s(this);return this._handlers.push(h),this.options[n]&&h.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),pe(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(wt(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var n;for(n in this._layers)this._layers[n].remove();for(n in this._panes)pe(this._panes[n]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(n,s){var h="leaflet-pane"+(n?" leaflet-"+n.replace("Pane","")+"-pane":""),g=Wt("div",h,s||this._mapPane);return n&&(this._panes[n]=g),g},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var n=this.getPixelBounds(),s=this.unproject(n.getBottomLeft()),h=this.unproject(n.getTopRight());return new Ie(s,h)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(n,s,h){n=Zt(n),h=At(h||[0,0]);var g=this.getZoom()||0,y=this.getMinZoom(),A=this.getMaxZoom(),D=n.getNorthWest(),z=n.getSouthEast(),j=this.getSize().subtract(h),K=ie(this.project(z,g),this.project(D,g)).getSize(),ht=_t.any3d?this.options.zoomSnap:1,It=j.x/K.x,zt=j.y/K.y,tn=s?Math.max(It,zt):Math.min(It,zt);return g=this.getScaleZoom(tn,g),ht&&(g=Math.round(g/(ht/100))*(ht/100),g=s?Math.ceil(g/ht)*ht:Math.floor(g/ht)*ht),Math.max(y,Math.min(A,g))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new bt(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(n,s){var h=this._getTopLeftPoint(n,s);return new ge(h,h.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(n){return this.options.crs.getProjectedBounds(n===void 0?this.getZoom():n)},getPane:function(n){return typeof n=="string"?this._panes[n]:n},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(n,s){var h=this.options.crs;return s=s===void 0?this._zoom:s,h.scale(n)/h.scale(s)},getScaleZoom:function(n,s){var h=this.options.crs;s=s===void 0?this._zoom:s;var g=h.zoom(n*h.scale(s));return isNaN(g)?1/0:g},project:function(n,s){return s=s===void 0?this._zoom:s,this.options.crs.latLngToPoint(it(n),s)},unproject:function(n,s){return s=s===void 0?this._zoom:s,this.options.crs.pointToLatLng(At(n),s)},layerPointToLatLng:function(n){var s=At(n).add(this.getPixelOrigin());return this.unproject(s)},latLngToLayerPoint:function(n){var s=this.project(it(n))._round();return s._subtract(this.getPixelOrigin())},wrapLatLng:function(n){return this.options.crs.wrapLatLng(it(n))},wrapLatLngBounds:function(n){return this.options.crs.wrapLatLngBounds(Zt(n))},distance:function(n,s){return this.options.crs.distance(it(n),it(s))},containerPointToLayerPoint:function(n){return At(n).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(n){return At(n).add(this._getMapPanePos())},containerPointToLatLng:function(n){var s=this.containerPointToLayerPoint(At(n));return this.layerPointToLatLng(s)},latLngToContainerPoint:function(n){return this.layerPointToContainerPoint(this.latLngToLayerPoint(it(n)))},mouseEventToContainerPoint:function(n){return li(n,this._container)},mouseEventToLayerPoint:function(n){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(n))},mouseEventToLatLng:function(n){return this.layerPointToLatLng(this.mouseEventToLayerPoint(n))},_initContainer:function(n){var s=this._container=qt(n);if(s){if(s._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Tt(s,"scroll",this._onScroll,this),this._containerId=M(s)},_initLayout:function(){var n=this._container;this._fadeAnimated=this.options.fadeAnimation&&_t.any3d,xt(n,"leaflet-container"+(_t.touch?" leaflet-touch":"")+(_t.retina?" leaflet-retina":"")+(_t.ielt9?" leaflet-oldie":"")+(_t.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var s=Rt(n,"position");s!=="absolute"&&s!=="relative"&&s!=="fixed"&&s!=="sticky"&&(n.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var n=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),at(this._mapPane,new bt(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(xt(n.markerPane,"leaflet-zoom-hide"),xt(n.shadowPane,"leaflet-zoom-hide"))},_resetView:function(n,s,h){at(this._mapPane,new bt(0,0));var g=!this._loaded;this._loaded=!0,s=this._limitZoom(s),this.fire("viewprereset");var y=this._zoom!==s;this._moveStart(y,h)._move(n,s)._moveEnd(y),this.fire("viewreset"),g&&this.fire("load")},_moveStart:function(n,s){return n&&this.fire("zoomstart"),s||this.fire("movestart"),this},_move:function(n,s,h,g){s===void 0&&(s=this._zoom);var y=this._zoom!==s;return this._zoom=s,this._lastCenter=n,this._pixelOrigin=this._getNewPixelOrigin(n),g?h&&h.pinch&&this.fire("zoom",h):((y||h&&h.pinch)&&this.fire("zoom",h),this.fire("move",h)),this},_moveEnd:function(n){return n&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return wt(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(n){at(this._mapPane,this._getMapPanePos().subtract(n))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(n){this._targets={},this._targets[M(this._container)]=this;var s=n?lt:Tt;s(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&s(window,"resize",this._onResize,this),_t.any3d&&this.options.transform3DLimit&&(n?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){wt(this._resizeRequest),this._resizeRequest=oe(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var n=this._getMapPanePos();Math.max(Math.abs(n.x),Math.abs(n.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(n,s){for(var h=[],g,y=s==="mouseout"||s==="mouseover",A=n.target||n.srcElement,D=!1;A;){if(g=this._targets[M(A)],g&&(s==="click"||s==="preclick")&&this._draggableMoved(g)){D=!0;break}if(g&&g.listens(s,!0)&&(y&&!xr(A,n)||(h.push(g),y))||A===this._container)break;A=A.parentNode}return!h.length&&!D&&!y&&this.listens(s,!0)&&(h=[this]),h},_isClickDisabled:function(n){for(;n&&n!==this._container;){if(n._leaflet_disable_click)return!0;n=n.parentNode}},_handleDOMEvent:function(n){var s=n.target||n.srcElement;if(!(!this._loaded||s._leaflet_disable_events||n.type==="click"&&this._isClickDisabled(s))){var h=n.type;h==="mousedown"&&Ti(s),this._fireDOMEvent(n,h)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(n,s,h){if(n.type==="click"){var g=c({},n);g.type="preclick",this._fireDOMEvent(g,g.type,h)}var y=this._findEventTargets(n,s);if(h){for(var A=[],D=0;D<h.length;D++)h[D].listens(s,!0)&&A.push(h[D]);y=A.concat(y)}if(y.length){s==="contextmenu"&&Re(n);var z=y[0],j={originalEvent:n};if(n.type!=="keypress"&&n.type!=="keydown"&&n.type!=="keyup"){var K=z.getLatLng&&(!z._radius||z._radius<=10);j.containerPoint=K?this.latLngToContainerPoint(z.getLatLng()):this.mouseEventToContainerPoint(n),j.layerPoint=this.containerPointToLayerPoint(j.containerPoint),j.latlng=K?z.getLatLng():this.layerPointToLatLng(j.layerPoint)}for(D=0;D<y.length;D++)if(y[D].fire(s,j,!0),j.originalEvent._stopped||y[D].options.bubblingMouseEvents===!1&&Ft(this._mouseEvents,s)!==-1)return}},_draggableMoved:function(n){return n=n.dragging&&n.dragging.enabled()?n:this,n.dragging&&n.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var n=0,s=this._handlers.length;n<s;n++)this._handlers[n].disable()},whenReady:function(n,s){return this._loaded?n.call(s||this,{target:this}):this.on("load",n,s),this},_getMapPanePos:function(){return we(this._mapPane)||new bt(0,0)},_moved:function(){var n=this._getMapPanePos();return n&&!n.equals([0,0])},_getTopLeftPoint:function(n,s){var h=n&&s!==void 0?this._getNewPixelOrigin(n,s):this.getPixelOrigin();return h.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(n,s){var h=this.getSize()._divideBy(2);return this.project(n,s)._subtract(h)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(n,s,h){var g=this._getNewPixelOrigin(h,s);return this.project(n,s)._subtract(g)},_latLngBoundsToNewLayerBounds:function(n,s,h){var g=this._getNewPixelOrigin(h,s);return ie([this.project(n.getSouthWest(),s)._subtract(g),this.project(n.getNorthWest(),s)._subtract(g),this.project(n.getSouthEast(),s)._subtract(g),this.project(n.getNorthEast(),s)._subtract(g)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(n){return this.latLngToLayerPoint(n).subtract(this._getCenterLayerPoint())},_limitCenter:function(n,s,h){if(!h)return n;var g=this.project(n,s),y=this.getSize().divideBy(2),A=new ge(g.subtract(y),g.add(y)),D=this._getBoundsOffset(A,h,s);return Math.abs(D.x)<=1&&Math.abs(D.y)<=1?n:this.unproject(g.add(D),s)},_limitOffset:function(n,s){if(!s)return n;var h=this.getPixelBounds(),g=new ge(h.min.add(n),h.max.add(n));return n.add(this._getBoundsOffset(g,s))},_getBoundsOffset:function(n,s,h){var g=ie(this.project(s.getNorthEast(),h),this.project(s.getSouthWest(),h)),y=g.min.subtract(n.min),A=g.max.subtract(n.max),D=this._rebound(y.x,-A.x),z=this._rebound(y.y,-A.y);return new bt(D,z)},_rebound:function(n,s){return n+s>0?Math.round(n-s)/2:Math.max(0,Math.ceil(n))-Math.max(0,Math.floor(s))},_limitZoom:function(n){var s=this.getMinZoom(),h=this.getMaxZoom(),g=_t.any3d?this.options.zoomSnap:1;return g&&(n=Math.round(n/g)*g),Math.max(s,Math.min(h,n))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){me(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(n,s){var h=this._getCenterOffset(n)._trunc();return(s&&s.animate)!==!0&&!this.getSize().contains(h)?!1:(this.panBy(h,s),!0)},_createAnimProxy:function(){var n=this._proxy=Wt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(n),this.on("zoomanim",function(s){var h=Bn,g=this._proxy.style[h];I(this._proxy,this.project(s.center,s.zoom),this.getZoomScale(s.zoom,1)),g===this._proxy.style[h]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){pe(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var n=this.getCenter(),s=this.getZoom();I(this._proxy,this.project(n,s),this.getZoomScale(s,1))},_catchTransitionEnd:function(n){this._animatingZoom&&n.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(n,s,h){if(this._animatingZoom)return!0;if(h=h||{},!this._zoomAnimated||h.animate===!1||this._nothingToAnimate()||Math.abs(s-this._zoom)>this.options.zoomAnimationThreshold)return!1;var g=this.getZoomScale(s),y=this._getCenterOffset(n)._divideBy(1-1/g);return h.animate!==!0&&!this.getSize().contains(y)?!1:(oe(function(){this._moveStart(!0,h.noMoveStart||!1)._animateZoom(n,s,!0)},this),!0)},_animateZoom:function(n,s,h,g){this._mapPane&&(h&&(this._animatingZoom=!0,this._animateToCenter=n,this._animateToZoom=s,xt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:n,zoom:s,noUpdate:g}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(_(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&me(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function mo(n,s){return new Vt(n,s)}var un=le.extend({options:{position:"topright"},initialize:function(n){st(this,n)},getPosition:function(){return this.options.position},setPosition:function(n){var s=this._map;return s&&s.removeControl(this),this.options.position=n,s&&s.addControl(this),this},getContainer:function(){return this._container},addTo:function(n){this.remove(),this._map=n;var s=this._container=this.onAdd(n),h=this.getPosition(),g=n._controlCorners[h];return xt(s,"leaflet-control"),h.indexOf("bottom")!==-1?g.insertBefore(s,g.firstChild):g.appendChild(s),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(pe(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(n){this._map&&n&&n.screenX>0&&n.screenY>0&&this._map.getContainer().focus()}}),Mi=function(n){return new un(n)};Vt.include({addControl:function(n){return n.addTo(this),this},removeControl:function(n){return n.remove(),this},_initControlPos:function(){var n=this._controlCorners={},s="leaflet-",h=this._controlContainer=Wt("div",s+"control-container",this._container);function g(y,A){var D=s+y+" "+s+A;n[y+A]=Wt("div",D,h)}g("top","left"),g("top","right"),g("bottom","left"),g("bottom","right")},_clearControlPos:function(){for(var n in this._controlCorners)pe(this._controlCorners[n]);pe(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var kr=un.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(n,s,h,g){return h<g?-1:g<h?1:0}},initialize:function(n,s,h){st(this,h),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var g in n)this._addLayer(n[g],g);for(g in s)this._addLayer(s[g],g,!0)},onAdd:function(n){this._initLayout(),this._update(),this._map=n,n.on("zoomend",this._checkDisabledLayers,this);for(var s=0;s<this._layers.length;s++)this._layers[s].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(n){return un.prototype.addTo.call(this,n),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var n=0;n<this._layers.length;n++)this._layers[n].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(n,s){return this._addLayer(n,s),this._map?this._update():this},addOverlay:function(n,s){return this._addLayer(n,s,!0),this._map?this._update():this},removeLayer:function(n){n.off("add remove",this._onLayerChange,this);var s=this._getLayer(M(n));return s&&this._layers.splice(this._layers.indexOf(s),1),this._map?this._update():this},expand:function(){xt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var n=this._map.getSize().y-(this._container.offsetTop+50);return n<this._section.clientHeight?(xt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=n+"px"):me(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return me(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var n="leaflet-control-layers",s=this._container=Wt("div",n),h=this.options.collapsed;s.setAttribute("aria-haspopup",!0),cn(s),Ui(s);var g=this._section=Wt("section",n+"-list");h&&(this._map.on("click",this.collapse,this),Tt(s,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var y=this._layersLink=Wt("a",n+"-toggle",s);y.href="#",y.title="Layers",y.setAttribute("role","button"),Tt(y,{keydown:function(A){A.keyCode===13&&this._expandSafely()},click:function(A){Re(A),this._expandSafely()}},this),h||this.expand(),this._baseLayersList=Wt("div",n+"-base",g),this._separator=Wt("div",n+"-separator",g),this._overlaysList=Wt("div",n+"-overlays",g),s.appendChild(g)},_getLayer:function(n){for(var s=0;s<this._layers.length;s++)if(this._layers[s]&&M(this._layers[s].layer)===n)return this._layers[s]},_addLayer:function(n,s,h){this._map&&n.on("add remove",this._onLayerChange,this),this._layers.push({layer:n,name:s,overlay:h}),this.options.sortLayers&&this._layers.sort(_(function(g,y){return this.options.sortFunction(g.layer,y.layer,g.name,y.name)},this)),this.options.autoZIndex&&n.setZIndex&&(this._lastZIndex++,n.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;ai(this._baseLayersList),ai(this._overlaysList),this._layerControlInputs=[];var n,s,h,g,y=0;for(h=0;h<this._layers.length;h++)g=this._layers[h],this._addItem(g),s=s||g.overlay,n=n||!g.overlay,y+=g.overlay?0:1;return this.options.hideSingleBase&&(n=n&&y>1,this._baseLayersList.style.display=n?"":"none"),this._separator.style.display=s&&n?"":"none",this},_onLayerChange:function(n){this._handlingClick||this._update();var s=this._getLayer(M(n.target)),h=s.overlay?n.type==="add"?"overlayadd":"overlayremove":n.type==="add"?"baselayerchange":null;h&&this._map.fire(h,s)},_createRadioElement:function(n,s){var h='<input type="radio" class="leaflet-control-layers-selector" name="'+n+'"'+(s?' checked="checked"':"")+"/>",g=document.createElement("div");return g.innerHTML=h,g.firstChild},_addItem:function(n){var s=document.createElement("label"),h=this._map.hasLayer(n.layer),g;n.overlay?(g=document.createElement("input"),g.type="checkbox",g.className="leaflet-control-layers-selector",g.defaultChecked=h):g=this._createRadioElement("leaflet-base-layers_"+M(this),h),this._layerControlInputs.push(g),g.layerId=M(n.layer),Tt(g,"click",this._onInputClick,this);var y=document.createElement("span");y.innerHTML=" "+n.name;var A=document.createElement("span");s.appendChild(A),A.appendChild(g),A.appendChild(y);var D=n.overlay?this._overlaysList:this._baseLayersList;return D.appendChild(s),this._checkDisabledLayers(),s},_onInputClick:function(){if(!this._preventClick){var n=this._layerControlInputs,s,h,g=[],y=[];this._handlingClick=!0;for(var A=n.length-1;A>=0;A--)s=n[A],h=this._getLayer(s.layerId).layer,s.checked?g.push(h):s.checked||y.push(h);for(A=0;A<y.length;A++)this._map.hasLayer(y[A])&&this._map.removeLayer(y[A]);for(A=0;A<g.length;A++)this._map.hasLayer(g[A])||this._map.addLayer(g[A]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var n=this._layerControlInputs,s,h,g=this._map.getZoom(),y=n.length-1;y>=0;y--)s=n[y],h=this._getLayer(s.layerId).layer,s.disabled=h.options.minZoom!==void 0&&g<h.options.minZoom||h.options.maxZoom!==void 0&&g>h.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var n=this._section;this._preventClick=!0,Tt(n,"click",Re),this.expand();var s=this;setTimeout(function(){lt(n,"click",Re),s._preventClick=!1})}}),ae=function(n,s,h){return new kr(n,s,h)},zi=un.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(n){var s="leaflet-control-zoom",h=Wt("div",s+" leaflet-bar"),g=this.options;return this._zoomInButton=this._createButton(g.zoomInText,g.zoomInTitle,s+"-in",h,this._zoomIn),this._zoomOutButton=this._createButton(g.zoomOutText,g.zoomOutTitle,s+"-out",h,this._zoomOut),this._updateDisabled(),n.on("zoomend zoomlevelschange",this._updateDisabled,this),h},onRemove:function(n){n.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(n){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(n.shiftKey?3:1))},_zoomOut:function(n){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(n.shiftKey?3:1))},_createButton:function(n,s,h,g,y){var A=Wt("a",h,g);return A.innerHTML=n,A.href="#",A.title=s,A.setAttribute("role","button"),A.setAttribute("aria-label",s),cn(A),Tt(A,"click",hn),Tt(A,"click",y,this),Tt(A,"click",this._refocusOnMap,this),A},_updateDisabled:function(){var n=this._map,s="leaflet-disabled";me(this._zoomInButton,s),me(this._zoomOutButton,s),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||n._zoom===n.getMinZoom())&&(xt(this._zoomOutButton,s),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||n._zoom===n.getMaxZoom())&&(xt(this._zoomInButton,s),this._zoomInButton.setAttribute("aria-disabled","true"))}});Vt.mergeOptions({zoomControl:!0}),Vt.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new zi,this.addControl(this.zoomControl))});var Hi=function(n){return new zi(n)},Tn=un.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(n){var s="leaflet-control-scale",h=Wt("div",s),g=this.options;return this._addScales(g,s+"-line",h),n.on(g.updateWhenIdle?"moveend":"move",this._update,this),n.whenReady(this._update,this),h},onRemove:function(n){n.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(n,s,h){n.metric&&(this._mScale=Wt("div",s,h)),n.imperial&&(this._iScale=Wt("div",s,h))},_update:function(){var n=this._map,s=n.getSize().y/2,h=n.distance(n.containerPointToLatLng([0,s]),n.containerPointToLatLng([this.options.maxWidth,s]));this._updateScales(h)},_updateScales:function(n){this.options.metric&&n&&this._updateMetric(n),this.options.imperial&&n&&this._updateImperial(n)},_updateMetric:function(n){var s=this._getRoundNum(n),h=s<1e3?s+" m":s/1e3+" km";this._updateScale(this._mScale,h,s/n)},_updateImperial:function(n){var s=n*3.2808399,h,g,y;s>5280?(h=s/5280,g=this._getRoundNum(h),this._updateScale(this._iScale,g+" mi",g/h)):(y=this._getRoundNum(s),this._updateScale(this._iScale,y+" ft",y/s))},_updateScale:function(n,s,h){n.style.width=Math.round(this.options.maxWidth*h)+"px",n.innerHTML=s},_getRoundNum:function(n){var s=Math.pow(10,(Math.floor(n)+"").length-1),h=n/s;return h=h>=10?10:h>=5?5:h>=3?3:h>=2?2:1,s*h}}),_o=function(n){return new Tn(n)},G='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Dt=un.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(_t.inlineSvg?G+" ":"")+"Leaflet</a>"},initialize:function(n){st(this,n),this._attributions={}},onAdd:function(n){n.attributionControl=this,this._container=Wt("div","leaflet-control-attribution"),cn(this._container);for(var s in n._layers)n._layers[s].getAttribution&&this.addAttribution(n._layers[s].getAttribution());return this._update(),n.on("layeradd",this._addAttribution,this),this._container},onRemove:function(n){n.off("layeradd",this._addAttribution,this)},_addAttribution:function(n){n.layer.getAttribution&&(this.addAttribution(n.layer.getAttribution()),n.layer.once("remove",function(){this.removeAttribution(n.layer.getAttribution())},this))},setPrefix:function(n){return this.options.prefix=n,this._update(),this},addAttribution:function(n){return n?(this._attributions[n]||(this._attributions[n]=0),this._attributions[n]++,this._update(),this):this},removeAttribution:function(n){return n?(this._attributions[n]&&(this._attributions[n]--,this._update()),this):this},_update:function(){if(this._map){var n=[];for(var s in this._attributions)this._attributions[s]&&n.push(s);var h=[];this.options.prefix&&h.push(this.options.prefix),n.length&&h.push(n.join(", ")),this._container.innerHTML=h.join(' <span aria-hidden="true">|</span> ')}}});Vt.mergeOptions({attributionControl:!0}),Vt.addInitHook(function(){this.options.attributionControl&&new Dt().addTo(this)});var Pe=function(n){return new Dt(n)};un.Layers=kr,un.Zoom=zi,un.Scale=Tn,un.Attribution=Dt,Mi.layers=ae,Mi.zoom=Hi,Mi.scale=_o,Mi.attribution=Pe;var nn=le.extend({initialize:function(n){this._map=n},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});nn.addTo=function(n,s){return n.addHandler(s,this),this};var Fr={Events:$t},Ur=_t.touch?"touchstart mousedown":"mousedown",Fn=Mt.extend({options:{clickTolerance:3},initialize:function(n,s,h,g){st(this,g),this._element=n,this._dragStartTarget=s||n,this._preventOutline=h},enable:function(){this._enabled||(Tt(this._dragStartTarget,Ur,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Fn._dragging===this&&this.finishDrag(!0),lt(this._dragStartTarget,Ur,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(n){if(this._enabled&&(this._moved=!1,!dr(this._element,"leaflet-zoom-anim"))){if(n.touches&&n.touches.length!==1){Fn._dragging===this&&this.finishDrag();return}if(!(Fn._dragging||n.shiftKey||n.which!==1&&n.button!==1&&!n.touches)&&(Fn._dragging=this,this._preventOutline&&Ti(this._element),vt(),Ue(),!this._moving)){this.fire("down");var s=n.touches?n.touches[0]:n,h=Fi(this._element);this._startPoint=new bt(s.clientX,s.clientY),this._startPos=we(this._element),this._parentScale=gr(h);var g=n.type==="mousedown";Tt(document,g?"mousemove":"touchmove",this._onMove,this),Tt(document,g?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(n){if(this._enabled){if(n.touches&&n.touches.length>1){this._moved=!0;return}var s=n.touches&&n.touches.length===1?n.touches[0]:n,h=new bt(s.clientX,s.clientY)._subtract(this._startPoint);!h.x&&!h.y||Math.abs(h.x)+Math.abs(h.y)<this.options.clickTolerance||(h.x/=this._parentScale.x,h.y/=this._parentScale.y,Re(n),this._moved||(this.fire("dragstart"),this._moved=!0,xt(document.body,"leaflet-dragging"),this._lastTarget=n.target||n.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),xt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(h),this._moving=!0,this._lastEvent=n,this._updatePosition())}},_updatePosition:function(){var n={originalEvent:this._lastEvent};this.fire("predrag",n),at(this._element,this._newPos),this.fire("drag",n)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(n){me(document.body,"leaflet-dragging"),this._lastTarget&&(me(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),lt(document,"mousemove touchmove",this._onMove,this),lt(document,"mouseup touchend touchcancel",this._onUp,this),ki(),Si();var s=this._moved&&this._moving;this._moving=!1,Fn._dragging=!1,s&&this.fire("dragend",{noInertia:n,distance:this._newPos.distanceTo(this._startPos)})}});function zr(n,s,h){var g,y=[1,4,2,8],A,D,z,j,K,ht,It,zt;for(A=0,ht=n.length;A<ht;A++)n[A]._code=qn(n[A],s);for(z=0;z<4;z++){for(It=y[z],g=[],A=0,ht=n.length,D=ht-1;A<ht;D=A++)j=n[A],K=n[D],j._code&It?K._code&It||(zt=Oi(K,j,It,s,h),zt._code=qn(zt,s),g.push(zt)):(K._code&It&&(zt=Oi(K,j,It,s,h),zt._code=qn(zt,s),g.push(zt)),g.push(j));n=g}return n}function yr(n,s){var h,g,y,A,D,z,j,K,ht;if(!n||n.length===0)throw new Error("latlngs not passed");Je(n)||(console.warn("latlngs are not flat! Only the first ring will be used"),n=n[0]);var It=it([0,0]),zt=Zt(n),tn=zt.getNorthWest().distanceTo(zt.getSouthWest())*zt.getNorthEast().distanceTo(zt.getNorthWest());tn<1700&&(It=Ae(n));var ze=n.length,Cn=[];for(h=0;h<ze;h++){var on=it(n[h]);Cn.push(s.project(it([on.lat-It.lat,on.lng-It.lng])))}for(z=j=K=0,h=0,g=ze-1;h<ze;g=h++)y=Cn[h],A=Cn[g],D=y.y*A.x-A.y*y.x,j+=(y.x+A.x)*D,K+=(y.y+A.y)*D,z+=D*3;z===0?ht=Cn[0]:ht=[j/z,K/z];var Wi=s.unproject(At(ht));return it([Wi.lat+It.lat,Wi.lng+It.lng])}function Ae(n){for(var s=0,h=0,g=0,y=0;y<n.length;y++){var A=it(n[y]);s+=A.lat,h+=A.lng,g++}return it([s/g,h/g])}var Cr={__proto__:null,clipPolygon:zr,polygonCenter:yr,centroid:Ae};function Qn(n,s){if(!s||!n.length)return n.slice();var h=s*s;return n=xo(n,h),n=he(n,h),n}function Ni(n,s,h){return Math.sqrt(Kn(n,s,h,!0))}function Vi(n,s,h){return Kn(n,s,h)}function he(n,s){var h=n.length,g=typeof Uint8Array<"u"?Uint8Array:Array,y=new g(h);y[0]=y[h-1]=1,Et(n,y,s,0,h-1);var A,D=[];for(A=0;A<h;A++)y[A]&&D.push(n[A]);return D}function Et(n,s,h,g,y){var A=0,D,z,j;for(z=g+1;z<=y-1;z++)j=Kn(n[z],n[g],n[y],!0),j>A&&(D=z,A=j);A>h&&(s[D]=1,Et(n,s,h,g,D),Et(n,s,h,D,y))}function xo(n,s){for(var h=[n[0]],g=1,y=0,A=n.length;g<A;g++)wo(n[g],n[y])>s&&(h.push(n[g]),y=g);return y<A-1&&h.push(n[A-1]),h}var ue;function Hr(n,s,h,g,y){var A=g?ue:qn(n,h),D=qn(s,h),z,j,K;for(ue=D;;){if(!(A|D))return[n,s];if(A&D)return!1;z=A||D,j=Oi(n,s,z,h,y),K=qn(j,h),z===A?(n=j,A=K):(s=j,D=K)}}function Oi(n,s,h,g,y){var A=s.x-n.x,D=s.y-n.y,z=g.min,j=g.max,K,ht;return h&8?(K=n.x+A*(j.y-n.y)/D,ht=j.y):h&4?(K=n.x+A*(z.y-n.y)/D,ht=z.y):h&2?(K=j.x,ht=n.y+D*(j.x-n.x)/A):h&1&&(K=z.x,ht=n.y+D*(z.x-n.x)/A),new bt(K,ht,y)}function qn(n,s){var h=0;return n.x<s.min.x?h|=1:n.x>s.max.x&&(h|=2),n.y<s.min.y?h|=4:n.y>s.max.y&&(h|=8),h}function wo(n,s){var h=s.x-n.x,g=s.y-n.y;return h*h+g*g}function Kn(n,s,h,g){var y=s.x,A=s.y,D=h.x-y,z=h.y-A,j=D*D+z*z,K;return j>0&&(K=((n.x-y)*D+(n.y-A)*z)/j,K>1?(y=h.x,A=h.y):K>0&&(y+=D*K,A+=z*K)),D=n.x-y,z=n.y-A,g?D*D+z*z:new bt(y,A)}function Je(n){return!gt(n[0])||typeof n[0][0]!="object"&&typeof n[0][0]<"u"}function Zi(n){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Je(n)}function vr(n,s){var h,g,y,A,D,z,j,K;if(!n||n.length===0)throw new Error("latlngs not passed");Je(n)||(console.warn("latlngs are not flat! Only the first ring will be used"),n=n[0]);var ht=it([0,0]),It=Zt(n),zt=It.getNorthWest().distanceTo(It.getSouthWest())*It.getNorthEast().distanceTo(It.getNorthWest());zt<1700&&(ht=Ae(n));var tn=n.length,ze=[];for(h=0;h<tn;h++){var Cn=it(n[h]);ze.push(s.project(it([Cn.lat-ht.lat,Cn.lng-ht.lng])))}for(h=0,g=0;h<tn-1;h++)g+=ze[h].distanceTo(ze[h+1])/2;if(g===0)K=ze[0];else for(h=0,A=0;h<tn-1;h++)if(D=ze[h],z=ze[h+1],y=D.distanceTo(z),A+=y,A>g){j=(A-g)/y,K=[z.x-j*(z.x-D.x),z.y-j*(z.y-D.y)];break}var on=s.unproject(At(K));return it([on.lat+ht.lat,on.lng+ht.lng])}var Vr={__proto__:null,simplify:Qn,pointToSegmentDistance:Ni,closestPointOnSegment:Vi,clipSegment:Hr,_getEdgeIntersection:Oi,_getBitCode:qn,_sqClosestPointOnSegment:Kn,isFlat:Je,_flat:Zi,polylineCenter:vr},Er={project:function(n){return new bt(n.lng,n.lat)},unproject:function(n){return new ee(n.y,n.x)},bounds:new ge([-180,-90],[180,90])},Un={R:6378137,R_MINOR:6356752314245179e-9,bounds:new ge([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(n){var s=Math.PI/180,h=this.R,g=n.lat*s,y=this.R_MINOR/h,A=Math.sqrt(1-y*y),D=A*Math.sin(g),z=Math.tan(Math.PI/4-g/2)/Math.pow((1-D)/(1+D),A/2);return g=-h*Math.log(Math.max(z,1e-10)),new bt(n.lng*s*h,g)},unproject:function(n){for(var s=180/Math.PI,h=this.R,g=this.R_MINOR/h,y=Math.sqrt(1-g*g),A=Math.exp(-n.y/h),D=Math.PI/2-2*Math.atan(A),z=0,j=.1,K;z<15&&Math.abs(j)>1e-7;z++)K=y*Math.sin(D),K=Math.pow((1-K)/(1+K),y/2),j=Math.PI/2-2*Math.atan(A*K)-D,D+=j;return new ee(D*s,n.x*s/h)}},Ar={__proto__:null,LonLat:Er,Mercator:Un,SphericalMercator:Vn},yo=c({},fe,{code:"EPSG:3395",projection:Un,transformation:function(){var n=.5/(Math.PI*Un.R);return Zn(n,.5,-n,.5)}()}),hi=c({},fe,{code:"EPSG:4326",projection:Er,transformation:Zn(1/180,1,-1/180,.5)}),Co=c({},pn,{projection:Er,transformation:Zn(1,0,-1,0),scale:function(n){return Math.pow(2,n)},zoom:function(n){return Math.log(n)/Math.LN2},distance:function(n,s){var h=s.lng-n.lng,g=s.lat-n.lat;return Math.sqrt(h*h+g*g)},infinite:!0});pn.Earth=fe,pn.EPSG3395=yo,pn.EPSG3857=jt,pn.EPSG900913=mi,pn.EPSG4326=hi,pn.Simple=Co;var Oe=Mt.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(n){return n.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(n){return n&&n.removeLayer(this),this},getPane:function(n){return this._map.getPane(n?this.options[n]||n:this.options.pane)},addInteractiveTarget:function(n){return this._map._targets[M(n)]=this,this},removeInteractiveTarget:function(n){return delete this._map._targets[M(n)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(n){var s=n.target;if(s.hasLayer(this)){if(this._map=s,this._zoomAnimated=s._zoomAnimated,this.getEvents){var h=this.getEvents();s.on(h,this),this.once("remove",function(){s.off(h,this)},this)}this.onAdd(s),this.fire("add"),s.fire("layeradd",{layer:this})}}});Vt.include({addLayer:function(n){if(!n._layerAdd)throw new Error("The provided object is not a Layer.");var s=M(n);return this._layers[s]?this:(this._layers[s]=n,n._mapToAdd=this,n.beforeAdd&&n.beforeAdd(this),this.whenReady(n._layerAdd,n),this)},removeLayer:function(n){var s=M(n);return this._layers[s]?(this._loaded&&n.onRemove(this),delete this._layers[s],this._loaded&&(this.fire("layerremove",{layer:n}),n.fire("remove")),n._map=n._mapToAdd=null,this):this},hasLayer:function(n){return M(n)in this._layers},eachLayer:function(n,s){for(var h in this._layers)n.call(s,this._layers[h]);return this},_addLayers:function(n){n=n?gt(n)?n:[n]:[];for(var s=0,h=n.length;s<h;s++)this.addLayer(n[s])},_addZoomLimit:function(n){(!isNaN(n.options.maxZoom)||!isNaN(n.options.minZoom))&&(this._zoomBoundLayers[M(n)]=n,this._updateZoomLevels())},_removeZoomLimit:function(n){var s=M(n);this._zoomBoundLayers[s]&&(delete this._zoomBoundLayers[s],this._updateZoomLevels())},_updateZoomLevels:function(){var n=1/0,s=-1/0,h=this._getZoomSpan();for(var g in this._zoomBoundLayers){var y=this._zoomBoundLayers[g].options;n=y.minZoom===void 0?n:Math.min(n,y.minZoom),s=y.maxZoom===void 0?s:Math.max(s,y.maxZoom)}this._layersMaxZoom=s===-1/0?void 0:s,this._layersMinZoom=n===1/0?void 0:n,h!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Mn=Oe.extend({initialize:function(n,s){st(this,s),this._layers={};var h,g;if(n)for(h=0,g=n.length;h<g;h++)this.addLayer(n[h])},addLayer:function(n){var s=this.getLayerId(n);return this._layers[s]=n,this._map&&this._map.addLayer(n),this},removeLayer:function(n){var s=n in this._layers?n:this.getLayerId(n);return this._map&&this._layers[s]&&this._map.removeLayer(this._layers[s]),delete this._layers[s],this},hasLayer:function(n){var s=typeof n=="number"?n:this.getLayerId(n);return s in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(n){var s=Array.prototype.slice.call(arguments,1),h,g;for(h in this._layers)g=this._layers[h],g[n]&&g[n].apply(g,s);return this},onAdd:function(n){this.eachLayer(n.addLayer,n)},onRemove:function(n){this.eachLayer(n.removeLayer,n)},eachLayer:function(n,s){for(var h in this._layers)n.call(s,this._layers[h]);return this},getLayer:function(n){return this._layers[n]},getLayers:function(){var n=[];return this.eachLayer(n.push,n),n},setZIndex:function(n){return this.invoke("setZIndex",n)},getLayerId:function(n){return M(n)}}),rn=function(n,s){return new Mn(n,s)},_n=Mn.extend({addLayer:function(n){return this.hasLayer(n)?this:(n.addEventParent(this),Mn.prototype.addLayer.call(this,n),this.fire("layeradd",{layer:n}))},removeLayer:function(n){return this.hasLayer(n)?(n in this._layers&&(n=this._layers[n]),n.removeEventParent(this),Mn.prototype.removeLayer.call(this,n),this.fire("layerremove",{layer:n})):this},setStyle:function(n){return this.invoke("setStyle",n)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var n=new Ie;for(var s in this._layers){var h=this._layers[s];n.extend(h.getBounds?h.getBounds():h.getLatLng())}return n}}),xn=function(n,s){return new _n(n,s)},ui=le.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(n){st(this,n)},createIcon:function(n){return this._createIcon("icon",n)},createShadow:function(n){return this._createIcon("shadow",n)},_createIcon:function(n,s){var h=this._getIconUrl(n);if(!h){if(n==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var g=this._createImg(h,s&&s.tagName==="IMG"?s:null);return this._setIconStyles(g,n),(this.options.crossOrigin||this.options.crossOrigin==="")&&(g.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),g},_setIconStyles:function(n,s){var h=this.options,g=h[s+"Size"];typeof g=="number"&&(g=[g,g]);var y=At(g),A=At(s==="shadow"&&h.shadowAnchor||h.iconAnchor||y&&y.divideBy(2,!0));n.className="leaflet-marker-"+s+" "+(h.className||""),A&&(n.style.marginLeft=-A.x+"px",n.style.marginTop=-A.y+"px"),y&&(n.style.width=y.x+"px",n.style.height=y.y+"px")},_createImg:function(n,s){return s=s||document.createElement("img"),s.src=n,s},_getIconUrl:function(n){return _t.retina&&this.options[n+"RetinaUrl"]||this.options[n+"Url"]}});function Sr(n){return new ui(n)}var Li=ui.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(n){return typeof Li.imagePath!="string"&&(Li.imagePath=this._detectIconPath()),(this.options.imagePath||Li.imagePath)+ui.prototype._getIconUrl.call(this,n)},_stripUrl:function(n){var s=function(h,g,y){var A=g.exec(h);return A&&A[y]};return n=s(n,/^url\((['"])?(.+)\1\)$/,2),n&&s(n,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var n=Wt("div","leaflet-default-icon-path",document.body),s=Rt(n,"background-image")||Rt(n,"backgroundImage");if(document.body.removeChild(n),s=this._stripUrl(s),s)return s;var h=document.querySelector('link[href$="leaflet.css"]');return h?h.href.substring(0,h.href.length-11-1):""}}),Ir=nn.extend({initialize:function(n){this._marker=n},addHooks:function(){var n=this._marker._icon;this._draggable||(this._draggable=new Fn(n,n,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),xt(n,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&me(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(n){var s=this._marker,h=s._map,g=this._marker.options.autoPanSpeed,y=this._marker.options.autoPanPadding,A=we(s._icon),D=h.getPixelBounds(),z=h.getPixelOrigin(),j=ie(D.min._subtract(z).add(y),D.max._subtract(z).subtract(y));if(!j.contains(A)){var K=At((Math.max(j.max.x,A.x)-j.max.x)/(D.max.x-j.max.x)-(Math.min(j.min.x,A.x)-j.min.x)/(D.min.x-j.min.x),(Math.max(j.max.y,A.y)-j.max.y)/(D.max.y-j.max.y)-(Math.min(j.min.y,A.y)-j.min.y)/(D.min.y-j.min.y)).multiplyBy(g);h.panBy(K,{animate:!1}),this._draggable._newPos._add(K),this._draggable._startPos._add(K),at(s._icon,this._draggable._newPos),this._onDrag(n),this._panRequest=oe(this._adjustPan.bind(this,n))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(n){this._marker.options.autoPan&&(wt(this._panRequest),this._panRequest=oe(this._adjustPan.bind(this,n)))},_onDrag:function(n){var s=this._marker,h=s._shadow,g=we(s._icon),y=s._map.layerPointToLatLng(g);h&&at(h,g),s._latlng=y,n.latlng=y,n.oldLatLng=this._oldLatLng,s.fire("move",n).fire("drag",n)},_onDragEnd:function(n){wt(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",n)}}),$e=Oe.extend({options:{icon:new Li,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(n,s){st(this,s),this._latlng=it(n)},onAdd:function(n){this._zoomAnimated=this._zoomAnimated&&n.options.markerZoomAnimation,this._zoomAnimated&&n.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(n){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&n.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(n){var s=this._latlng;return this._latlng=it(n),this.update(),this.fire("move",{oldLatLng:s,latlng:this._latlng})},setZIndexOffset:function(n){return this.options.zIndexOffset=n,this.update()},getIcon:function(){return this.options.icon},setIcon:function(n){return this.options.icon=n,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var n=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(n)}return this},_initIcon:function(){var n=this.options,s="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),h=n.icon.createIcon(this._icon),g=!1;h!==this._icon&&(this._icon&&this._removeIcon(),g=!0,n.title&&(h.title=n.title),h.tagName==="IMG"&&(h.alt=n.alt||"")),xt(h,s),n.keyboard&&(h.tabIndex="0",h.setAttribute("role","button")),this._icon=h,n.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Tt(h,"focus",this._panOnFocus,this);var y=n.icon.createShadow(this._shadow),A=!1;y!==this._shadow&&(this._removeShadow(),A=!0),y&&(xt(y,s),y.alt=""),this._shadow=y,n.opacity<1&&this._updateOpacity(),g&&this.getPane().appendChild(this._icon),this._initInteraction(),y&&A&&this.getPane(n.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&lt(this._icon,"focus",this._panOnFocus,this),pe(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&pe(this._shadow),this._shadow=null},_setPos:function(n){this._icon&&at(this._icon,n),this._shadow&&at(this._shadow,n),this._zIndex=n.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(n){this._icon&&(this._icon.style.zIndex=this._zIndex+n)},_animateZoom:function(n){var s=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center).round();this._setPos(s)},_initInteraction:function(){if(this.options.interactive&&(xt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Ir)){var n=this.options.draggable;this.dragging&&(n=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Ir(this),n&&this.dragging.enable()}},setOpacity:function(n){return this.options.opacity=n,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var n=this.options.opacity;this._icon&&kt(this._icon,n),this._shadow&&kt(this._shadow,n)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var n=this._map;if(n){var s=this.options.icon.options,h=s.iconSize?At(s.iconSize):At(0,0),g=s.iconAnchor?At(s.iconAnchor):At(0,0);n.panInside(this._latlng,{paddingTopLeft:g,paddingBottomRight:h.subtract(g)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function vo(n,s){return new $e(n,s)}var wn=Oe.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(n){this._renderer=n.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(n){return st(this,n),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&n&&Object.prototype.hasOwnProperty.call(n,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),zn=wn.extend({options:{fill:!0,radius:10},initialize:function(n,s){st(this,s),this._latlng=it(n),this._radius=this.options.radius},setLatLng:function(n){var s=this._latlng;return this._latlng=it(n),this.redraw(),this.fire("move",{oldLatLng:s,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(n){return this.options.radius=this._radius=n,this.redraw()},getRadius:function(){return this._radius},setStyle:function(n){var s=n&&n.radius||this._radius;return wn.prototype.setStyle.call(this,n),this.setRadius(s),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var n=this._radius,s=this._radiusY||n,h=this._clickTolerance(),g=[n+h,s+h];this._pxBounds=new ge(this._point.subtract(g),this._point.add(g))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(n){return n.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Yt(n,s){return new zn(n,s)}var di=zn.extend({initialize:function(n,s,h){if(typeof s=="number"&&(s=c({},h,{radius:s})),st(this,s),this._latlng=it(n),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(n){return this._mRadius=n,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var n=[this._radius,this._radiusY||this._radius];return new Ie(this._map.layerPointToLatLng(this._point.subtract(n)),this._map.layerPointToLatLng(this._point.add(n)))},setStyle:wn.prototype.setStyle,_project:function(){var n=this._latlng.lng,s=this._latlng.lat,h=this._map,g=h.options.crs;if(g.distance===fe.distance){var y=Math.PI/180,A=this._mRadius/fe.R/y,D=h.project([s+A,n]),z=h.project([s-A,n]),j=D.add(z).divideBy(2),K=h.unproject(j).lat,ht=Math.acos((Math.cos(A*y)-Math.sin(s*y)*Math.sin(K*y))/(Math.cos(s*y)*Math.cos(K*y)))/y;(isNaN(ht)||ht===0)&&(ht=A/Math.cos(Math.PI/180*s)),this._point=j.subtract(h.getPixelOrigin()),this._radius=isNaN(ht)?0:j.x-h.project([K,n-ht]).x,this._radiusY=j.y-D.y}else{var It=g.unproject(g.project(this._latlng).subtract([this._mRadius,0]));this._point=h.latLngToLayerPoint(this._latlng),this._radius=this._point.x-h.latLngToLayerPoint(It).x}this._updateBounds()}});function p(n,s,h){return new di(n,s,h)}var t=wn.extend({options:{smoothFactor:1,noClip:!1},initialize:function(n,s){st(this,s),this._setLatLngs(n)},getLatLngs:function(){return this._latlngs},setLatLngs:function(n){return this._setLatLngs(n),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(n){for(var s=1/0,h=null,g=Kn,y,A,D=0,z=this._parts.length;D<z;D++)for(var j=this._parts[D],K=1,ht=j.length;K<ht;K++){y=j[K-1],A=j[K];var It=g(n,y,A,!0);It<s&&(s=It,h=g(n,y,A))}return h&&(h.distance=Math.sqrt(s)),h},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return vr(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(n,s){return s=s||this._defaultShape(),n=it(n),s.push(n),this._bounds.extend(n),this.redraw()},_setLatLngs:function(n){this._bounds=new Ie,this._latlngs=this._convertLatLngs(n)},_defaultShape:function(){return Je(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(n){for(var s=[],h=Je(n),g=0,y=n.length;g<y;g++)h?(s[g]=it(n[g]),this._bounds.extend(s[g])):s[g]=this._convertLatLngs(n[g]);return s},_project:function(){var n=new ge;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,n),this._bounds.isValid()&&n.isValid()&&(this._rawPxBounds=n,this._updateBounds())},_updateBounds:function(){var n=this._clickTolerance(),s=new bt(n,n);this._rawPxBounds&&(this._pxBounds=new ge([this._rawPxBounds.min.subtract(s),this._rawPxBounds.max.add(s)]))},_projectLatlngs:function(n,s,h){var g=n[0]instanceof ee,y=n.length,A,D;if(g){for(D=[],A=0;A<y;A++)D[A]=this._map.latLngToLayerPoint(n[A]),h.extend(D[A]);s.push(D)}else for(A=0;A<y;A++)this._projectLatlngs(n[A],s,h)},_clipPoints:function(){var n=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(n))){if(this.options.noClip){this._parts=this._rings;return}var s=this._parts,h,g,y,A,D,z,j;for(h=0,y=0,A=this._rings.length;h<A;h++)for(j=this._rings[h],g=0,D=j.length;g<D-1;g++)z=Hr(j[g],j[g+1],n,g,!0),z&&(s[y]=s[y]||[],s[y].push(z[0]),(z[1]!==j[g+1]||g===D-2)&&(s[y].push(z[1]),y++))}},_simplifyPoints:function(){for(var n=this._parts,s=this.options.smoothFactor,h=0,g=n.length;h<g;h++)n[h]=Qn(n[h],s)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(n,s){var h,g,y,A,D,z,j=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(n))return!1;for(h=0,A=this._parts.length;h<A;h++)for(z=this._parts[h],g=0,D=z.length,y=D-1;g<D;y=g++)if(!(!s&&g===0)&&Ni(n,z[y],z[g])<=j)return!0;return!1}});function e(n,s){return new t(n,s)}t._flat=Zi;var i=t.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return yr(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(n){var s=t.prototype._convertLatLngs.call(this,n),h=s.length;return h>=2&&s[0]instanceof ee&&s[0].equals(s[h-1])&&s.pop(),s},_setLatLngs:function(n){t.prototype._setLatLngs.call(this,n),Je(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Je(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var n=this._renderer._bounds,s=this.options.weight,h=new bt(s,s);if(n=new ge(n.min.subtract(h),n.max.add(h)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(n))){if(this.options.noClip){this._parts=this._rings;return}for(var g=0,y=this._rings.length,A;g<y;g++)A=zr(this._rings[g],n,!0),A.length&&this._parts.push(A)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(n){var s=!1,h,g,y,A,D,z,j,K;if(!this._pxBounds||!this._pxBounds.contains(n))return!1;for(A=0,j=this._parts.length;A<j;A++)for(h=this._parts[A],D=0,K=h.length,z=K-1;D<K;z=D++)g=h[D],y=h[z],g.y>n.y!=y.y>n.y&&n.x<(y.x-g.x)*(n.y-g.y)/(y.y-g.y)+g.x&&(s=!s);return s||t.prototype._containsPoint.call(this,n,!0)}});function r(n,s){return new i(n,s)}var o=_n.extend({initialize:function(n,s){st(this,s),this._layers={},n&&this.addData(n)},addData:function(n){var s=gt(n)?n:n.features,h,g,y;if(s){for(h=0,g=s.length;h<g;h++)y=s[h],(y.geometries||y.geometry||y.features||y.coordinates)&&this.addData(y);return this}var A=this.options;if(A.filter&&!A.filter(n))return this;var D=a(n,A);return D?(D.feature=b(n),D.defaultOptions=D.options,this.resetStyle(D),A.onEachFeature&&A.onEachFeature(n,D),this.addLayer(D)):this},resetStyle:function(n){return n===void 0?this.eachLayer(this.resetStyle,this):(n.options=c({},n.defaultOptions),this._setLayerStyle(n,this.options.style),this)},setStyle:function(n){return this.eachLayer(function(s){this._setLayerStyle(s,n)},this)},_setLayerStyle:function(n,s){n.setStyle&&(typeof s=="function"&&(s=s(n.feature)),n.setStyle(s))}});function a(n,s){var h=n.type==="Feature"?n.geometry:n,g=h?h.coordinates:null,y=[],A=s&&s.pointToLayer,D=s&&s.coordsToLatLng||u,z,j,K,ht;if(!g&&!h)return null;switch(h.type){case"Point":return z=D(g),l(A,n,z,s);case"MultiPoint":for(K=0,ht=g.length;K<ht;K++)z=D(g[K]),y.push(l(A,n,z,s));return new _n(y);case"LineString":case"MultiLineString":return j=f(g,h.type==="LineString"?0:1,D),new t(j,s);case"Polygon":case"MultiPolygon":return j=f(g,h.type==="Polygon"?1:2,D),new i(j,s);case"GeometryCollection":for(K=0,ht=h.geometries.length;K<ht;K++){var It=a({geometry:h.geometries[K],type:"Feature",properties:n.properties},s);It&&y.push(It)}return new _n(y);case"FeatureCollection":for(K=0,ht=h.features.length;K<ht;K++){var zt=a(h.features[K],s);zt&&y.push(zt)}return new _n(y);default:throw new Error("Invalid GeoJSON object.")}}function l(n,s,h,g){return n?n(s,h):new $e(h,g&&g.markersInheritOptions&&g)}function u(n){return new ee(n[1],n[0],n[2])}function f(n,s,h){for(var g=[],y=0,A=n.length,D;y<A;y++)D=s?f(n[y],s-1,h):(h||u)(n[y]),g.push(D);return g}function x(n,s){return n=it(n),n.alt!==void 0?[Z(n.lng,s),Z(n.lat,s),Z(n.alt,s)]:[Z(n.lng,s),Z(n.lat,s)]}function v(n,s,h,g){for(var y=[],A=0,D=n.length;A<D;A++)y.push(s?v(n[A],Je(n[A])?0:s-1,h,g):x(n[A],g));return!s&&h&&y.length>0&&y.push(y[0].slice()),y}function S(n,s){return n.feature?c({},n.feature,{geometry:s}):b(s)}function b(n){return n.type==="Feature"||n.type==="FeatureCollection"?n:{type:"Feature",properties:{},geometry:n}}var N={toGeoJSON:function(n){return S(this,{type:"Point",coordinates:x(this.getLatLng(),n)})}};$e.include(N),di.include(N),zn.include(N),t.include({toGeoJSON:function(n){var s=!Je(this._latlngs),h=v(this._latlngs,s?1:0,!1,n);return S(this,{type:(s?"Multi":"")+"LineString",coordinates:h})}}),i.include({toGeoJSON:function(n){var s=!Je(this._latlngs),h=s&&!Je(this._latlngs[0]),g=v(this._latlngs,h?2:s?1:0,!0,n);return s||(g=[g]),S(this,{type:(h?"Multi":"")+"Polygon",coordinates:g})}}),Mn.include({toMultiPoint:function(n){var s=[];return this.eachLayer(function(h){s.push(h.toGeoJSON(n).geometry.coordinates)}),S(this,{type:"MultiPoint",coordinates:s})},toGeoJSON:function(n){var s=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(s==="MultiPoint")return this.toMultiPoint(n);var h=s==="GeometryCollection",g=[];return this.eachLayer(function(y){if(y.toGeoJSON){var A=y.toGeoJSON(n);if(h)g.push(A.geometry);else{var D=b(A);D.type==="FeatureCollection"?g.push.apply(g,D.features):g.push(D)}}}),h?S(this,{geometries:g,type:"GeometryCollection"}):{type:"FeatureCollection",features:g}}});function R(n,s){return new o(n,s)}var F=R,V=Oe.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(n,s,h){this._url=n,this._bounds=Zt(s),st(this,h)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(xt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){pe(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(n){return this.options.opacity=n,this._image&&this._updateOpacity(),this},setStyle:function(n){return n.opacity&&this.setOpacity(n.opacity),this},bringToFront:function(){return this._map&&xe(this._image),this},bringToBack:function(){return this._map&&Ke(this._image),this},setUrl:function(n){return this._url=n,this._image&&(this._image.src=n),this},setBounds:function(n){return this._bounds=Zt(n),this._map&&this._reset(),this},getEvents:function(){var n={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var n=this._url.tagName==="IMG",s=this._image=n?this._url:Wt("img");if(xt(s,"leaflet-image-layer"),this._zoomAnimated&&xt(s,"leaflet-zoom-animated"),this.options.className&&xt(s,this.options.className),s.onselectstart=E,s.onmousemove=E,s.onload=_(this.fire,this,"load"),s.onerror=_(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(s.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),n){this._url=s.src;return}s.src=this._url,s.alt=this.options.alt},_animateZoom:function(n){var s=this._map.getZoomScale(n.zoom),h=this._map._latLngBoundsToNewLayerBounds(this._bounds,n.zoom,n.center).min;I(this._image,h,s)},_reset:function(){var n=this._image,s=new ge(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),h=s.getSize();at(n,s.min),n.style.width=h.x+"px",n.style.height=h.y+"px"},_updateOpacity:function(){kt(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var n=this.options.errorOverlayUrl;n&&this._url!==n&&(this._url=n,this._image.src=n)},getCenter:function(){return this._bounds.getCenter()}}),J=function(n,s,h){return new V(n,s,h)},ot=V.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var n=this._url.tagName==="VIDEO",s=this._image=n?this._url:Wt("video");if(xt(s,"leaflet-image-layer"),this._zoomAnimated&&xt(s,"leaflet-zoom-animated"),this.options.className&&xt(s,this.options.className),s.onselectstart=E,s.onmousemove=E,s.onloadeddata=_(this.fire,this,"load"),n){for(var h=s.getElementsByTagName("source"),g=[],y=0;y<h.length;y++)g.push(h[y].src);this._url=h.length>0?g:[s.src];return}gt(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(s.style,"objectFit")&&(s.style.objectFit="fill"),s.autoplay=!!this.options.autoplay,s.loop=!!this.options.loop,s.muted=!!this.options.muted,s.playsInline=!!this.options.playsInline;for(var A=0;A<this._url.length;A++){var D=Wt("source");D.src=this._url[A],s.appendChild(D)}}});function X(n,s,h){return new ot(n,s,h)}var Pt=V.extend({_initImage:function(){var n=this._image=this._url;xt(n,"leaflet-image-layer"),this._zoomAnimated&&xt(n,"leaflet-zoom-animated"),this.options.className&&xt(n,this.options.className),n.onselectstart=E,n.onmousemove=E}});function Ot(n,s,h){return new Pt(n,s,h)}var ye=Oe.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(n,s){n&&(n instanceof ee||gt(n))?(this._latlng=it(n),st(this,s)):(st(this,n),this._source=s),this.options.content&&(this._content=this.options.content)},openOn:function(n){return n=arguments.length?n:this._source._map,n.hasLayer(this)||n.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(n){return this._map?this.close():(arguments.length?this._source=n:n=this._source,this._prepareOpen(),this.openOn(n._map)),this},onAdd:function(n){this._zoomAnimated=n._zoomAnimated,this._container||this._initLayout(),n._fadeAnimated&&kt(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),n._fadeAnimated&&kt(this._container,1),this.bringToFront(),this.options.interactive&&(xt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(n){n._fadeAnimated?(kt(this._container,0),this._removeTimeout=setTimeout(_(pe,void 0,this._container),200)):pe(this._container),this.options.interactive&&(me(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(n){return this._latlng=it(n),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(n){return this._content=n,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var n={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&xe(this._container),this},bringToBack:function(){return this._map&&Ke(this._container),this},_prepareOpen:function(n){var s=this._source;if(!s._map)return!1;if(s instanceof _n){s=null;var h=this._source._layers;for(var g in h)if(h[g]._map){s=h[g];break}if(!s)return!1;this._source=s}if(!n)if(s.getCenter)n=s.getCenter();else if(s.getLatLng)n=s.getLatLng();else if(s.getBounds)n=s.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(n),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var n=this._contentNode,s=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof s=="string")n.innerHTML=s;else{for(;n.hasChildNodes();)n.removeChild(n.firstChild);n.appendChild(s)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var n=this._map.latLngToLayerPoint(this._latlng),s=At(this.options.offset),h=this._getAnchor();this._zoomAnimated?at(this._container,n.add(h)):s=s.add(n).add(h);var g=this._containerBottom=-s.y,y=this._containerLeft=-Math.round(this._containerWidth/2)+s.x;this._container.style.bottom=g+"px",this._container.style.left=y+"px"}},_getAnchor:function(){return[0,0]}});Vt.include({_initOverlay:function(n,s,h,g){var y=s;return y instanceof n||(y=new n(g).setContent(s)),h&&y.setLatLng(h),y}}),Oe.include({_initOverlay:function(n,s,h,g){var y=h;return y instanceof n?(st(y,g),y._source=this):(y=s&&!g?s:new n(g,this),y.setContent(h)),y}});var Ge=ye.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(n){return n=arguments.length?n:this._source._map,!n.hasLayer(this)&&n._popup&&n._popup.options.autoClose&&n.removeLayer(n._popup),n._popup=this,ye.prototype.openOn.call(this,n)},onAdd:function(n){ye.prototype.onAdd.call(this,n),n.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof wn||this._source.on("preclick",bn))},onRemove:function(n){ye.prototype.onRemove.call(this,n),n.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof wn||this._source.off("preclick",bn))},getEvents:function(){var n=ye.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(n.preclick=this.close),this.options.keepInView&&(n.moveend=this._adjustPan),n},_initLayout:function(){var n="leaflet-popup",s=this._container=Wt("div",n+" "+(this.options.className||"")+" leaflet-zoom-animated"),h=this._wrapper=Wt("div",n+"-content-wrapper",s);if(this._contentNode=Wt("div",n+"-content",h),cn(s),Ui(this._contentNode),Tt(s,"contextmenu",bn),this._tipContainer=Wt("div",n+"-tip-container",s),this._tip=Wt("div",n+"-tip",this._tipContainer),this.options.closeButton){var g=this._closeButton=Wt("a",n+"-close-button",s);g.setAttribute("role","button"),g.setAttribute("aria-label","Close popup"),g.href="#close",g.innerHTML='<span aria-hidden="true">&#215;</span>',Tt(g,"click",function(y){Re(y),this.close()},this)}},_updateLayout:function(){var n=this._contentNode,s=n.style;s.width="",s.whiteSpace="nowrap";var h=n.offsetWidth;h=Math.min(h,this.options.maxWidth),h=Math.max(h,this.options.minWidth),s.width=h+1+"px",s.whiteSpace="",s.height="";var g=n.offsetHeight,y=this.options.maxHeight,A="leaflet-popup-scrolled";y&&g>y?(s.height=y+"px",xt(n,A)):me(n,A),this._containerWidth=this._container.offsetWidth},_animateZoom:function(n){var s=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center),h=this._getAnchor();at(this._container,s.add(h))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var n=this._map,s=parseInt(Rt(this._container,"marginBottom"),10)||0,h=this._container.offsetHeight+s,g=this._containerWidth,y=new bt(this._containerLeft,-h-this._containerBottom);y._add(we(this._container));var A=n.layerPointToContainerPoint(y),D=At(this.options.autoPanPadding),z=At(this.options.autoPanPaddingTopLeft||D),j=At(this.options.autoPanPaddingBottomRight||D),K=n.getSize(),ht=0,It=0;A.x+g+j.x>K.x&&(ht=A.x+g-K.x+j.x),A.x-ht-z.x<0&&(ht=A.x-z.x),A.y+h+j.y>K.y&&(It=A.y+h-K.y+j.y),A.y-It-z.y<0&&(It=A.y-z.y),(ht||It)&&(this.options.keepInView&&(this._autopanning=!0),n.fire("autopanstart").panBy([ht,It]))}},_getAnchor:function(){return At(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),je=function(n,s){return new Ge(n,s)};Vt.mergeOptions({closePopupOnClick:!0}),Vt.include({openPopup:function(n,s,h){return this._initOverlay(Ge,n,s,h).openOn(this),this},closePopup:function(n){return n=arguments.length?n:this._popup,n&&n.close(),this}}),Oe.include({bindPopup:function(n,s){return this._popup=this._initOverlay(Ge,this._popup,n,s),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(n){return this._popup&&(this instanceof _n||(this._popup._source=this),this._popup._prepareOpen(n||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(n){return this._popup&&this._popup.setContent(n),this},getPopup:function(){return this._popup},_openPopup:function(n){if(!(!this._popup||!this._map)){hn(n);var s=n.layer||n.target;if(this._popup._source===s&&!(s instanceof wn)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(n.latlng);return}this._popup._source=s,this.openPopup(n.latlng)}},_movePopup:function(n){this._popup.setLatLng(n.latlng)},_onKeyPress:function(n){n.originalEvent.keyCode===13&&this._openPopup(n)}});var te=ye.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(n){ye.prototype.onAdd.call(this,n),this.setOpacity(this.options.opacity),n.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(n){ye.prototype.onRemove.call(this,n),n.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var n=ye.prototype.getEvents.call(this);return this.options.permanent||(n.preclick=this.close),n},_initLayout:function(){var n="leaflet-tooltip",s=n+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Wt("div",s),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+M(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(n){var s,h,g=this._map,y=this._container,A=g.latLngToContainerPoint(g.getCenter()),D=g.layerPointToContainerPoint(n),z=this.options.direction,j=y.offsetWidth,K=y.offsetHeight,ht=At(this.options.offset),It=this._getAnchor();z==="top"?(s=j/2,h=K):z==="bottom"?(s=j/2,h=0):z==="center"?(s=j/2,h=K/2):z==="right"?(s=0,h=K/2):z==="left"?(s=j,h=K/2):D.x<A.x?(z="right",s=0,h=K/2):(z="left",s=j+(ht.x+It.x)*2,h=K/2),n=n.subtract(At(s,h,!0)).add(ht).add(It),me(y,"leaflet-tooltip-right"),me(y,"leaflet-tooltip-left"),me(y,"leaflet-tooltip-top"),me(y,"leaflet-tooltip-bottom"),xt(y,"leaflet-tooltip-"+z),at(y,n)},_updatePosition:function(){var n=this._map.latLngToLayerPoint(this._latlng);this._setPosition(n)},setOpacity:function(n){this.options.opacity=n,this._container&&kt(this._container,n)},_animateZoom:function(n){var s=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center);this._setPosition(s)},_getAnchor:function(){return At(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Be=function(n,s){return new te(n,s)};Vt.include({openTooltip:function(n,s,h){return this._initOverlay(te,n,s,h).openOn(this),this},closeTooltip:function(n){return n.close(),this}}),Oe.include({bindTooltip:function(n,s){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(te,this._tooltip,n,s),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(n){if(!(!n&&this._tooltipHandlersAdded)){var s=n?"off":"on",h={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?h.add=this._openTooltip:(h.mouseover=this._openTooltip,h.mouseout=this.closeTooltip,h.click=this._openTooltip,this._map?this._addFocusListeners():h.add=this._addFocusListeners),this._tooltip.options.sticky&&(h.mousemove=this._moveTooltip),this[s](h),this._tooltipHandlersAdded=!n}},openTooltip:function(n){return this._tooltip&&(this instanceof _n||(this._tooltip._source=this),this._tooltip._prepareOpen(n)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(n){return this._tooltip&&this._tooltip.setContent(n),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(n){var s=typeof n.getElement=="function"&&n.getElement();s&&(Tt(s,"focus",function(){this._tooltip._source=n,this.openTooltip()},this),Tt(s,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(n){var s=typeof n.getElement=="function"&&n.getElement();s&&s.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(n){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var s=this;this._map.once("moveend",function(){s._openOnceFlag=!1,s._openTooltip(n)});return}this._tooltip._source=n.layer||n.target,this.openTooltip(this._tooltip.options.sticky?n.latlng:void 0)}},_moveTooltip:function(n){var s=n.latlng,h,g;this._tooltip.options.sticky&&n.originalEvent&&(h=this._map.mouseEventToContainerPoint(n.originalEvent),g=this._map.containerPointToLayerPoint(h),s=this._map.layerPointToLatLng(g)),this._tooltip.setLatLng(s)}});var Xe=ui.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(n){var s=n&&n.tagName==="DIV"?n:document.createElement("div"),h=this.options;if(h.html instanceof Element?(ai(s),s.appendChild(h.html)):s.innerHTML=h.html!==!1?h.html:"",h.bgPos){var g=At(h.bgPos);s.style.backgroundPosition=-g.x+"px "+-g.y+"px"}return this._setIconStyles(s,"icon"),s},createShadow:function(){return null}});function fi(n){return new Xe(n)}ui.Default=Li;var yn=Oe.extend({options:{tileSize:256,opacity:1,updateWhenIdle:_t.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(n){st(this,n)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(n){n._addZoomLimit(this)},onRemove:function(n){this._removeAllTiles(),pe(this._container),n._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(xe(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Ke(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(n){return this.options.opacity=n,this._updateOpacity(),this},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var n=this._clampZoom(this._map.getZoom());n!==this._tileZoom&&(this._tileZoom=n,this._updateLevels()),this._update()}return this},getEvents:function(){var n={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=P(this._onMoveEnd,this.options.updateInterval,this)),n.move=this._onMove),this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},createTile:function(){return document.createElement("div")},getTileSize:function(){var n=this.options.tileSize;return n instanceof bt?n:new bt(n,n)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(n){for(var s=this.getPane().children,h=-n(-1/0,1/0),g=0,y=s.length,A;g<y;g++)A=s[g].style.zIndex,s[g]!==this._container&&A&&(h=n(h,+A));isFinite(h)&&(this.options.zIndex=h+n(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!_t.ielt9){kt(this._container,this.options.opacity);var n=+new Date,s=!1,h=!1;for(var g in this._tiles){var y=this._tiles[g];if(!(!y.current||!y.loaded)){var A=Math.min(1,(n-y.loaded)/200);kt(y.el,A),A<1?s=!0:(y.active?h=!0:this._onOpaqueTile(y),y.active=!0)}}h&&!this._noPrune&&this._pruneTiles(),s&&(wt(this._fadeFrame),this._fadeFrame=oe(this._updateOpacity,this))}},_onOpaqueTile:E,_initContainer:function(){this._container||(this._container=Wt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var n=this._tileZoom,s=this.options.maxZoom;if(n!==void 0){for(var h in this._levels)h=Number(h),this._levels[h].el.children.length||h===n?(this._levels[h].el.style.zIndex=s-Math.abs(n-h),this._onUpdateLevel(h)):(pe(this._levels[h].el),this._removeTilesAtZoom(h),this._onRemoveLevel(h),delete this._levels[h]);var g=this._levels[n],y=this._map;return g||(g=this._levels[n]={},g.el=Wt("div","leaflet-tile-container leaflet-zoom-animated",this._container),g.el.style.zIndex=s,g.origin=y.project(y.unproject(y.getPixelOrigin()),n).round(),g.zoom=n,this._setZoomTransform(g,y.getCenter(),y.getZoom()),E(g.el.offsetWidth),this._onCreateLevel(g)),this._level=g,g}},_onUpdateLevel:E,_onRemoveLevel:E,_onCreateLevel:E,_pruneTiles:function(){if(this._map){var n,s,h=this._map.getZoom();if(h>this.options.maxZoom||h<this.options.minZoom){this._removeAllTiles();return}for(n in this._tiles)s=this._tiles[n],s.retain=s.current;for(n in this._tiles)if(s=this._tiles[n],s.current&&!s.active){var g=s.coords;this._retainParent(g.x,g.y,g.z,g.z-5)||this._retainChildren(g.x,g.y,g.z,g.z+2)}for(n in this._tiles)this._tiles[n].retain||this._removeTile(n)}},_removeTilesAtZoom:function(n){for(var s in this._tiles)this._tiles[s].coords.z===n&&this._removeTile(s)},_removeAllTiles:function(){for(var n in this._tiles)this._removeTile(n)},_invalidateAll:function(){for(var n in this._levels)pe(this._levels[n].el),this._onRemoveLevel(Number(n)),delete this._levels[n];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(n,s,h,g){var y=Math.floor(n/2),A=Math.floor(s/2),D=h-1,z=new bt(+y,+A);z.z=+D;var j=this._tileCoordsToKey(z),K=this._tiles[j];return K&&K.active?(K.retain=!0,!0):(K&&K.loaded&&(K.retain=!0),D>g?this._retainParent(y,A,D,g):!1)},_retainChildren:function(n,s,h,g){for(var y=2*n;y<2*n+2;y++)for(var A=2*s;A<2*s+2;A++){var D=new bt(y,A);D.z=h+1;var z=this._tileCoordsToKey(D),j=this._tiles[z];if(j&&j.active){j.retain=!0;continue}else j&&j.loaded&&(j.retain=!0);h+1<g&&this._retainChildren(y,A,h+1,g)}},_resetView:function(n){var s=n&&(n.pinch||n.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),s,s)},_animateZoom:function(n){this._setView(n.center,n.zoom,!0,n.noUpdate)},_clampZoom:function(n){var s=this.options;return s.minNativeZoom!==void 0&&n<s.minNativeZoom?s.minNativeZoom:s.maxNativeZoom!==void 0&&s.maxNativeZoom<n?s.maxNativeZoom:n},_setView:function(n,s,h,g){var y=Math.round(s);this.options.maxZoom!==void 0&&y>this.options.maxZoom||this.options.minZoom!==void 0&&y<this.options.minZoom?y=void 0:y=this._clampZoom(y);var A=this.options.updateWhenZooming&&y!==this._tileZoom;(!g||A)&&(this._tileZoom=y,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),y!==void 0&&this._update(n),h||this._pruneTiles(),this._noPrune=!!h),this._setZoomTransforms(n,s)},_setZoomTransforms:function(n,s){for(var h in this._levels)this._setZoomTransform(this._levels[h],n,s)},_setZoomTransform:function(n,s,h){var g=this._map.getZoomScale(h,n.zoom),y=n.origin.multiplyBy(g).subtract(this._map._getNewPixelOrigin(s,h)).round();_t.any3d?I(n.el,y,g):at(n.el,y)},_resetGrid:function(){var n=this._map,s=n.options.crs,h=this._tileSize=this.getTileSize(),g=this._tileZoom,y=this._map.getPixelWorldBounds(this._tileZoom);y&&(this._globalTileRange=this._pxBoundsToTileRange(y)),this._wrapX=s.wrapLng&&!this.options.noWrap&&[Math.floor(n.project([0,s.wrapLng[0]],g).x/h.x),Math.ceil(n.project([0,s.wrapLng[1]],g).x/h.y)],this._wrapY=s.wrapLat&&!this.options.noWrap&&[Math.floor(n.project([s.wrapLat[0],0],g).y/h.x),Math.ceil(n.project([s.wrapLat[1],0],g).y/h.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(n){var s=this._map,h=s._animatingZoom?Math.max(s._animateToZoom,s.getZoom()):s.getZoom(),g=s.getZoomScale(h,this._tileZoom),y=s.project(n,this._tileZoom).floor(),A=s.getSize().divideBy(g*2);return new ge(y.subtract(A),y.add(A))},_update:function(n){var s=this._map;if(s){var h=this._clampZoom(s.getZoom());if(n===void 0&&(n=s.getCenter()),this._tileZoom!==void 0){var g=this._getTiledPixelBounds(n),y=this._pxBoundsToTileRange(g),A=y.getCenter(),D=[],z=this.options.keepBuffer,j=new ge(y.getBottomLeft().subtract([z,-z]),y.getTopRight().add([z,-z]));if(!(isFinite(y.min.x)&&isFinite(y.min.y)&&isFinite(y.max.x)&&isFinite(y.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var K in this._tiles){var ht=this._tiles[K].coords;(ht.z!==this._tileZoom||!j.contains(new bt(ht.x,ht.y)))&&(this._tiles[K].current=!1)}if(Math.abs(h-this._tileZoom)>1){this._setView(n,h);return}for(var It=y.min.y;It<=y.max.y;It++)for(var zt=y.min.x;zt<=y.max.x;zt++){var tn=new bt(zt,It);if(tn.z=this._tileZoom,!!this._isValidTile(tn)){var ze=this._tiles[this._tileCoordsToKey(tn)];ze?ze.current=!0:D.push(tn)}}if(D.sort(function(on,Wi){return on.distanceTo(A)-Wi.distanceTo(A)}),D.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Cn=document.createDocumentFragment();for(zt=0;zt<D.length;zt++)this._addTile(D[zt],Cn);this._level.el.appendChild(Cn)}}}},_isValidTile:function(n){var s=this._map.options.crs;if(!s.infinite){var h=this._globalTileRange;if(!s.wrapLng&&(n.x<h.min.x||n.x>h.max.x)||!s.wrapLat&&(n.y<h.min.y||n.y>h.max.y))return!1}if(!this.options.bounds)return!0;var g=this._tileCoordsToBounds(n);return Zt(this.options.bounds).overlaps(g)},_keyToBounds:function(n){return this._tileCoordsToBounds(this._keyToTileCoords(n))},_tileCoordsToNwSe:function(n){var s=this._map,h=this.getTileSize(),g=n.scaleBy(h),y=g.add(h),A=s.unproject(g,n.z),D=s.unproject(y,n.z);return[A,D]},_tileCoordsToBounds:function(n){var s=this._tileCoordsToNwSe(n),h=new Ie(s[0],s[1]);return this.options.noWrap||(h=this._map.wrapLatLngBounds(h)),h},_tileCoordsToKey:function(n){return n.x+":"+n.y+":"+n.z},_keyToTileCoords:function(n){var s=n.split(":"),h=new bt(+s[0],+s[1]);return h.z=+s[2],h},_removeTile:function(n){var s=this._tiles[n];s&&(pe(s.el),delete this._tiles[n],this.fire("tileunload",{tile:s.el,coords:this._keyToTileCoords(n)}))},_initTile:function(n){xt(n,"leaflet-tile");var s=this.getTileSize();n.style.width=s.x+"px",n.style.height=s.y+"px",n.onselectstart=E,n.onmousemove=E,_t.ielt9&&this.options.opacity<1&&kt(n,this.options.opacity)},_addTile:function(n,s){var h=this._getTilePos(n),g=this._tileCoordsToKey(n),y=this.createTile(this._wrapCoords(n),_(this._tileReady,this,n));this._initTile(y),this.createTile.length<2&&oe(_(this._tileReady,this,n,null,y)),at(y,h),this._tiles[g]={el:y,coords:n,current:!0},s.appendChild(y),this.fire("tileloadstart",{tile:y,coords:n})},_tileReady:function(n,s,h){s&&this.fire("tileerror",{error:s,tile:h,coords:n});var g=this._tileCoordsToKey(n);h=this._tiles[g],h&&(h.loaded=+new Date,this._map._fadeAnimated?(kt(h.el,0),wt(this._fadeFrame),this._fadeFrame=oe(this._updateOpacity,this)):(h.active=!0,this._pruneTiles()),s||(xt(h.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:h.el,coords:n})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),_t.ielt9||!this._map._fadeAnimated?oe(this._pruneTiles,this):setTimeout(_(this._pruneTiles,this),250)))},_getTilePos:function(n){return n.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(n){var s=new bt(this._wrapX?H(n.x,this._wrapX):n.x,this._wrapY?H(n.y,this._wrapY):n.y);return s.z=n.z,s},_pxBoundsToTileRange:function(n){var s=this.getTileSize();return new ge(n.min.unscaleBy(s).floor(),n.max.unscaleBy(s).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var n in this._tiles)if(!this._tiles[n].loaded)return!1;return!0}});function Eo(n){return new yn(n)}var pi=yn.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(n,s){this._url=n,s=st(this,s),s.detectRetina&&_t.retina&&s.maxZoom>0?(s.tileSize=Math.floor(s.tileSize/2),s.zoomReverse?(s.zoomOffset--,s.minZoom=Math.min(s.maxZoom,s.minZoom+1)):(s.zoomOffset++,s.maxZoom=Math.max(s.minZoom,s.maxZoom-1)),s.minZoom=Math.max(0,s.minZoom)):s.zoomReverse?s.minZoom=Math.min(s.maxZoom,s.minZoom):s.maxZoom=Math.max(s.minZoom,s.maxZoom),typeof s.subdomains=="string"&&(s.subdomains=s.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(n,s){return this._url===n&&s===void 0&&(s=!0),this._url=n,s||this.redraw(),this},createTile:function(n,s){var h=document.createElement("img");return Tt(h,"load",_(this._tileOnLoad,this,s,h)),Tt(h,"error",_(this._tileOnError,this,s,h)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(h.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(h.referrerPolicy=this.options.referrerPolicy),h.alt="",h.src=this.getTileUrl(n),h},getTileUrl:function(n){var s={r:_t.retina?"@2x":"",s:this._getSubdomain(n),x:n.x,y:n.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var h=this._globalTileRange.max.y-n.y;this.options.tms&&(s.y=h),s["-y"]=h}return Lt(this._url,c(s,this.options))},_tileOnLoad:function(n,s){_t.ielt9?setTimeout(_(n,this,null,s),0):n(null,s)},_tileOnError:function(n,s,h){var g=this.options.errorTileUrl;g&&s.getAttribute("src")!==g&&(s.src=g),n(h,s)},_onTileRemove:function(n){n.tile.onload=null},_getZoomForUrl:function(){var n=this._tileZoom,s=this.options.maxZoom,h=this.options.zoomReverse,g=this.options.zoomOffset;return h&&(n=s-n),n+g},_getSubdomain:function(n){var s=Math.abs(n.x+n.y)%this.options.subdomains.length;return this.options.subdomains[s]},_abortLoading:function(){var n,s;for(n in this._tiles)if(this._tiles[n].coords.z!==this._tileZoom&&(s=this._tiles[n].el,s.onload=E,s.onerror=E,!s.complete)){s.src=Ye;var h=this._tiles[n].coords;pe(s),delete this._tiles[n],this.fire("tileabort",{tile:s,coords:h})}},_removeTile:function(n){var s=this._tiles[n];if(s)return s.el.setAttribute("src",Ye),yn.prototype._removeTile.call(this,n)},_tileReady:function(n,s,h){if(!(!this._map||h&&h.getAttribute("src")===Ye))return yn.prototype._tileReady.call(this,n,s,h)}});function Vo(n,s){return new pi(n,s)}var Zo=pi.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(n,s){this._url=n;var h=c({},this.defaultWmsParams);for(var g in s)g in this.options||(h[g]=s[g]);s=st(this,s);var y=s.detectRetina&&_t.retina?2:1,A=this.getTileSize();h.width=A.x*y,h.height=A.y*y,this.wmsParams=h},onAdd:function(n){this._crs=this.options.crs||n.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var s=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[s]=this._crs.code,pi.prototype.onAdd.call(this,n)},getTileUrl:function(n){var s=this._tileCoordsToNwSe(n),h=this._crs,g=ie(h.project(s[0]),h.project(s[1])),y=g.min,A=g.max,D=(this._wmsVersion>=1.3&&this._crs===hi?[y.y,y.x,A.y,A.x]:[y.x,y.y,A.x,A.y]).join(","),z=pi.prototype.getTileUrl.call(this,n);return z+Te(this.wmsParams,z,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+D},setParams:function(n,s){return c(this.wmsParams,n),s||this.redraw(),this}});function ua(n,s){return new Zo(n,s)}pi.WMS=Zo,Vo.wms=ua;var Jn=Oe.extend({options:{padding:.1},initialize:function(n){st(this,n),M(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),xt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var n={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(n.zoomanim=this._onAnimZoom),n},_onAnimZoom:function(n){this._updateTransform(n.center,n.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(n,s){var h=this._map.getZoomScale(s,this._zoom),g=this._map.getSize().multiplyBy(.5+this.options.padding),y=this._map.project(this._center,s),A=g.multiplyBy(-h).add(y).subtract(this._map._getNewPixelOrigin(n,s));_t.any3d?I(this._container,A,h):at(this._container,A)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var n in this._layers)this._layers[n]._reset()},_onZoomEnd:function(){for(var n in this._layers)this._layers[n]._project()},_updatePaths:function(){for(var n in this._layers)this._layers[n]._update()},_update:function(){var n=this.options.padding,s=this._map.getSize(),h=this._map.containerPointToLayerPoint(s.multiplyBy(-n)).round();this._bounds=new ge(h,h.add(s.multiplyBy(1+n*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Wo=Jn.extend({options:{tolerance:0},getEvents:function(){var n=Jn.prototype.getEvents.call(this);return n.viewprereset=this._onViewPreReset,n},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Jn.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var n=this._container=document.createElement("canvas");Tt(n,"mousemove",this._onMouseMove,this),Tt(n,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Tt(n,"mouseout",this._handleMouseOut,this),n._leaflet_disable_events=!0,this._ctx=n.getContext("2d")},_destroyContainer:function(){wt(this._redrawRequest),delete this._ctx,pe(this._container),lt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var n;this._redrawBounds=null;for(var s in this._layers)n=this._layers[s],n._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Jn.prototype._update.call(this);var n=this._bounds,s=this._container,h=n.getSize(),g=_t.retina?2:1;at(s,n.min),s.width=g*h.x,s.height=g*h.y,s.style.width=h.x+"px",s.style.height=h.y+"px",_t.retina&&this._ctx.scale(2,2),this._ctx.translate(-n.min.x,-n.min.y),this.fire("update")}},_reset:function(){Jn.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(n){this._updateDashArray(n),this._layers[M(n)]=n;var s=n._order={layer:n,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=s),this._drawLast=s,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(n){this._requestRedraw(n)},_removePath:function(n){var s=n._order,h=s.next,g=s.prev;h?h.prev=g:this._drawLast=g,g?g.next=h:this._drawFirst=h,delete n._order,delete this._layers[M(n)],this._requestRedraw(n)},_updatePath:function(n){this._extendRedrawBounds(n),n._project(),n._update(),this._requestRedraw(n)},_updateStyle:function(n){this._updateDashArray(n),this._requestRedraw(n)},_updateDashArray:function(n){if(typeof n.options.dashArray=="string"){var s=n.options.dashArray.split(/[, ]+/),h=[],g,y;for(y=0;y<s.length;y++){if(g=Number(s[y]),isNaN(g))return;h.push(g)}n.options._dashArray=h}else n.options._dashArray=n.options.dashArray},_requestRedraw:function(n){this._map&&(this._extendRedrawBounds(n),this._redrawRequest=this._redrawRequest||oe(this._redraw,this))},_extendRedrawBounds:function(n){if(n._pxBounds){var s=(n.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new ge,this._redrawBounds.extend(n._pxBounds.min.subtract([s,s])),this._redrawBounds.extend(n._pxBounds.max.add([s,s]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var n=this._redrawBounds;if(n){var s=n.getSize();this._ctx.clearRect(n.min.x,n.min.y,s.x,s.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var n,s=this._redrawBounds;if(this._ctx.save(),s){var h=s.getSize();this._ctx.beginPath(),this._ctx.rect(s.min.x,s.min.y,h.x,h.y),this._ctx.clip()}this._drawing=!0;for(var g=this._drawFirst;g;g=g.next)n=g.layer,(!s||n._pxBounds&&n._pxBounds.intersects(s))&&n._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(n,s){if(this._drawing){var h,g,y,A,D=n._parts,z=D.length,j=this._ctx;if(z){for(j.beginPath(),h=0;h<z;h++){for(g=0,y=D[h].length;g<y;g++)A=D[h][g],j[g?"lineTo":"moveTo"](A.x,A.y);s&&j.closePath()}this._fillStroke(j,n)}}},_updateCircle:function(n){if(!(!this._drawing||n._empty())){var s=n._point,h=this._ctx,g=Math.max(Math.round(n._radius),1),y=(Math.max(Math.round(n._radiusY),1)||g)/g;y!==1&&(h.save(),h.scale(1,y)),h.beginPath(),h.arc(s.x,s.y/y,g,0,Math.PI*2,!1),y!==1&&h.restore(),this._fillStroke(h,n)}},_fillStroke:function(n,s){var h=s.options;h.fill&&(n.globalAlpha=h.fillOpacity,n.fillStyle=h.fillColor||h.color,n.fill(h.fillRule||"evenodd")),h.stroke&&h.weight!==0&&(n.setLineDash&&n.setLineDash(s.options&&s.options._dashArray||[]),n.globalAlpha=h.opacity,n.lineWidth=h.weight,n.strokeStyle=h.color,n.lineCap=h.lineCap,n.lineJoin=h.lineJoin,n.stroke())},_onClick:function(n){for(var s=this._map.mouseEventToLayerPoint(n),h,g,y=this._drawFirst;y;y=y.next)h=y.layer,h.options.interactive&&h._containsPoint(s)&&(!(n.type==="click"||n.type==="preclick")||!this._map._draggableMoved(h))&&(g=h);this._fireEvent(g?[g]:!1,n)},_onMouseMove:function(n){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var s=this._map.mouseEventToLayerPoint(n);this._handleMouseHover(n,s)}},_handleMouseOut:function(n){var s=this._hoveredLayer;s&&(me(this._container,"leaflet-interactive"),this._fireEvent([s],n,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(n,s){if(!this._mouseHoverThrottled){for(var h,g,y=this._drawFirst;y;y=y.next)h=y.layer,h.options.interactive&&h._containsPoint(s)&&(g=h);g!==this._hoveredLayer&&(this._handleMouseOut(n),g&&(xt(this._container,"leaflet-interactive"),this._fireEvent([g],n,"mouseover"),this._hoveredLayer=g)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,n),this._mouseHoverThrottled=!0,setTimeout(_(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(n,s,h){this._map._fireDOMEvent(s,h||s.type,n)},_bringToFront:function(n){var s=n._order;if(s){var h=s.next,g=s.prev;if(h)h.prev=g;else return;g?g.next=h:h&&(this._drawFirst=h),s.prev=this._drawLast,this._drawLast.next=s,s.next=null,this._drawLast=s,this._requestRedraw(n)}},_bringToBack:function(n){var s=n._order;if(s){var h=s.next,g=s.prev;if(g)g.next=h;else return;h?h.prev=g:g&&(this._drawLast=g),s.prev=null,s.next=this._drawFirst,this._drawFirst.prev=s,this._drawFirst=s,this._requestRedraw(n)}}});function Go(n){return _t.canvas?new Wo(n):null}var br=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(n){return document.createElement("<lvml:"+n+' class="lvml">')}}catch{}return function(n){return document.createElement("<"+n+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),da={_initContainer:function(){this._container=Wt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Jn.prototype._update.call(this),this.fire("update"))},_initPath:function(n){var s=n._container=br("shape");xt(s,"leaflet-vml-shape "+(this.options.className||"")),s.coordsize="1 1",n._path=br("path"),s.appendChild(n._path),this._updateStyle(n),this._layers[M(n)]=n},_addPath:function(n){var s=n._container;this._container.appendChild(s),n.options.interactive&&n.addInteractiveTarget(s)},_removePath:function(n){var s=n._container;pe(s),n.removeInteractiveTarget(s),delete this._layers[M(n)]},_updateStyle:function(n){var s=n._stroke,h=n._fill,g=n.options,y=n._container;y.stroked=!!g.stroke,y.filled=!!g.fill,g.stroke?(s||(s=n._stroke=br("stroke")),y.appendChild(s),s.weight=g.weight+"px",s.color=g.color,s.opacity=g.opacity,g.dashArray?s.dashStyle=gt(g.dashArray)?g.dashArray.join(" "):g.dashArray.replace(/( *, *)/g," "):s.dashStyle="",s.endcap=g.lineCap.replace("butt","flat"),s.joinstyle=g.lineJoin):s&&(y.removeChild(s),n._stroke=null),g.fill?(h||(h=n._fill=br("fill")),y.appendChild(h),h.color=g.fillColor||g.color,h.opacity=g.fillOpacity):h&&(y.removeChild(h),n._fill=null)},_updateCircle:function(n){var s=n._point.round(),h=Math.round(n._radius),g=Math.round(n._radiusY||h);this._setPath(n,n._empty()?"M0 0":"AL "+s.x+","+s.y+" "+h+","+g+" 0,"+65535*360)},_setPath:function(n,s){n._path.v=s},_bringToFront:function(n){xe(n._container)},_bringToBack:function(n){Ke(n._container)}},Zr=_t.vml?br:gn,Tr=Jn.extend({_initContainer:function(){this._container=Zr("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Zr("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){pe(this._container),lt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Jn.prototype._update.call(this);var n=this._bounds,s=n.getSize(),h=this._container;(!this._svgSize||!this._svgSize.equals(s))&&(this._svgSize=s,h.setAttribute("width",s.x),h.setAttribute("height",s.y)),at(h,n.min),h.setAttribute("viewBox",[n.min.x,n.min.y,s.x,s.y].join(" ")),this.fire("update")}},_initPath:function(n){var s=n._path=Zr("path");n.options.className&&xt(s,n.options.className),n.options.interactive&&xt(s,"leaflet-interactive"),this._updateStyle(n),this._layers[M(n)]=n},_addPath:function(n){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(n._path),n.addInteractiveTarget(n._path)},_removePath:function(n){pe(n._path),n.removeInteractiveTarget(n._path),delete this._layers[M(n)]},_updatePath:function(n){n._project(),n._update()},_updateStyle:function(n){var s=n._path,h=n.options;s&&(h.stroke?(s.setAttribute("stroke",h.color),s.setAttribute("stroke-opacity",h.opacity),s.setAttribute("stroke-width",h.weight),s.setAttribute("stroke-linecap",h.lineCap),s.setAttribute("stroke-linejoin",h.lineJoin),h.dashArray?s.setAttribute("stroke-dasharray",h.dashArray):s.removeAttribute("stroke-dasharray"),h.dashOffset?s.setAttribute("stroke-dashoffset",h.dashOffset):s.removeAttribute("stroke-dashoffset")):s.setAttribute("stroke","none"),h.fill?(s.setAttribute("fill",h.fillColor||h.color),s.setAttribute("fill-opacity",h.fillOpacity),s.setAttribute("fill-rule",h.fillRule||"evenodd")):s.setAttribute("fill","none"))},_updatePoly:function(n,s){this._setPath(n,ni(n._parts,s))},_updateCircle:function(n){var s=n._point,h=Math.max(Math.round(n._radius),1),g=Math.max(Math.round(n._radiusY),1)||h,y="a"+h+","+g+" 0 1,0 ",A=n._empty()?"M0 0":"M"+(s.x-h)+","+s.y+y+h*2+",0 "+y+-h*2+",0 ";this._setPath(n,A)},_setPath:function(n,s){n._path.setAttribute("d",s)},_bringToFront:function(n){xe(n._path)},_bringToBack:function(n){Ke(n._path)}});_t.vml&&Tr.include(da);function jo(n){return _t.svg||_t.vml?new Tr(n):null}Vt.include({getRenderer:function(n){var s=n.options.renderer||this._getPaneRenderer(n.options.pane)||this.options.renderer||this._renderer;return s||(s=this._renderer=this._createRenderer()),this.hasLayer(s)||this.addLayer(s),s},_getPaneRenderer:function(n){if(n==="overlayPane"||n===void 0)return!1;var s=this._paneRenderers[n];return s===void 0&&(s=this._createRenderer({pane:n}),this._paneRenderers[n]=s),s},_createRenderer:function(n){return this.options.preferCanvas&&Go(n)||jo(n)}});var Xo=i.extend({initialize:function(n,s){i.prototype.initialize.call(this,this._boundsToLatLngs(n),s)},setBounds:function(n){return this.setLatLngs(this._boundsToLatLngs(n))},_boundsToLatLngs:function(n){return n=Zt(n),[n.getSouthWest(),n.getNorthWest(),n.getNorthEast(),n.getSouthEast()]}});function fa(n,s){return new Xo(n,s)}Tr.create=Zr,Tr.pointsToPath=ni,o.geometryToLayer=a,o.coordsToLatLng=u,o.coordsToLatLngs=f,o.latLngToCoords=x,o.latLngsToCoords=v,o.getFeature=S,o.asFeature=b,Vt.mergeOptions({boxZoom:!0});var Yo=nn.extend({initialize:function(n){this._map=n,this._container=n._container,this._pane=n._panes.overlayPane,this._resetStateTimeout=0,n.on("unload",this._destroy,this)},addHooks:function(){Tt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){lt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){pe(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(n){if(!n.shiftKey||n.which!==1&&n.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Ue(),vt(),this._startPoint=this._map.mouseEventToContainerPoint(n),Tt(document,{contextmenu:hn,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(n){this._moved||(this._moved=!0,this._box=Wt("div","leaflet-zoom-box",this._container),xt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(n);var s=new ge(this._point,this._startPoint),h=s.getSize();at(this._box,s.min),this._box.style.width=h.x+"px",this._box.style.height=h.y+"px"},_finish:function(){this._moved&&(pe(this._box),me(this._container,"leaflet-crosshair")),Si(),ki(),lt(document,{contextmenu:hn,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(n){if(!(n.which!==1&&n.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(_(this._resetState,this),0);var s=new Ie(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(s).fire("boxzoomend",{boxZoomBounds:s})}},_onKeyDown:function(n){n.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Vt.addInitHook("addHandler","boxZoom",Yo),Vt.mergeOptions({doubleClickZoom:!0});var Qo=nn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(n){var s=this._map,h=s.getZoom(),g=s.options.zoomDelta,y=n.originalEvent.shiftKey?h-g:h+g;s.options.doubleClickZoom==="center"?s.setZoom(y):s.setZoomAround(n.containerPoint,y)}});Vt.addInitHook("addHandler","doubleClickZoom",Qo),Vt.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var qo=nn.extend({addHooks:function(){if(!this._draggable){var n=this._map;this._draggable=new Fn(n._mapPane,n._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),n.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),n.on("zoomend",this._onZoomEnd,this),n.whenReady(this._onZoomEnd,this))}xt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){me(this._map._container,"leaflet-grab"),me(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var n=this._map;if(n._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var s=Zt(this._map.options.maxBounds);this._offsetLimit=ie(this._map.latLngToContainerPoint(s.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(s.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;n.fire("movestart").fire("dragstart"),n.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(n){if(this._map.options.inertia){var s=this._lastTime=+new Date,h=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(h),this._times.push(s),this._prunePositions(s)}this._map.fire("move",n).fire("drag",n)},_prunePositions:function(n){for(;this._positions.length>1&&n-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var n=this._map.getSize().divideBy(2),s=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=s.subtract(n).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(n,s){return n-(n-s)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var n=this._draggable._newPos.subtract(this._draggable._startPos),s=this._offsetLimit;n.x<s.min.x&&(n.x=this._viscousLimit(n.x,s.min.x)),n.y<s.min.y&&(n.y=this._viscousLimit(n.y,s.min.y)),n.x>s.max.x&&(n.x=this._viscousLimit(n.x,s.max.x)),n.y>s.max.y&&(n.y=this._viscousLimit(n.y,s.max.y)),this._draggable._newPos=this._draggable._startPos.add(n)}},_onPreDragWrap:function(){var n=this._worldWidth,s=Math.round(n/2),h=this._initialWorldOffset,g=this._draggable._newPos.x,y=(g-s+h)%n+s-h,A=(g+s+h)%n-s-h,D=Math.abs(y+h)<Math.abs(A+h)?y:A;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=D},_onDragEnd:function(n){var s=this._map,h=s.options,g=!h.inertia||n.noInertia||this._times.length<2;if(s.fire("dragend",n),g)s.fire("moveend");else{this._prunePositions(+new Date);var y=this._lastPos.subtract(this._positions[0]),A=(this._lastTime-this._times[0])/1e3,D=h.easeLinearity,z=y.multiplyBy(D/A),j=z.distanceTo([0,0]),K=Math.min(h.inertiaMaxSpeed,j),ht=z.multiplyBy(K/j),It=K/(h.inertiaDeceleration*D),zt=ht.multiplyBy(-It/2).round();!zt.x&&!zt.y?s.fire("moveend"):(zt=s._limitOffset(zt,s.options.maxBounds),oe(function(){s.panBy(zt,{duration:It,easeLinearity:D,noMoveStart:!0,animate:!0})}))}}});Vt.addInitHook("addHandler","dragging",qo),Vt.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Ko=nn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(n){this._map=n,this._setPanDelta(n.options.keyboardPanDelta),this._setZoomDelta(n.options.zoomDelta)},addHooks:function(){var n=this._map._container;n.tabIndex<=0&&(n.tabIndex="0"),Tt(n,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),lt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var n=document.body,s=document.documentElement,h=n.scrollTop||s.scrollTop,g=n.scrollLeft||s.scrollLeft;this._map._container.focus(),window.scrollTo(g,h)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(n){var s=this._panKeys={},h=this.keyCodes,g,y;for(g=0,y=h.left.length;g<y;g++)s[h.left[g]]=[-1*n,0];for(g=0,y=h.right.length;g<y;g++)s[h.right[g]]=[n,0];for(g=0,y=h.down.length;g<y;g++)s[h.down[g]]=[0,n];for(g=0,y=h.up.length;g<y;g++)s[h.up[g]]=[0,-1*n]},_setZoomDelta:function(n){var s=this._zoomKeys={},h=this.keyCodes,g,y;for(g=0,y=h.zoomIn.length;g<y;g++)s[h.zoomIn[g]]=n;for(g=0,y=h.zoomOut.length;g<y;g++)s[h.zoomOut[g]]=-n},_addHooks:function(){Tt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){lt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(n){if(!(n.altKey||n.ctrlKey||n.metaKey)){var s=n.keyCode,h=this._map,g;if(s in this._panKeys){if(!h._panAnim||!h._panAnim._inProgress)if(g=this._panKeys[s],n.shiftKey&&(g=At(g).multiplyBy(3)),h.options.maxBounds&&(g=h._limitOffset(At(g),h.options.maxBounds)),h.options.worldCopyJump){var y=h.wrapLatLng(h.unproject(h.project(h.getCenter()).add(g)));h.panTo(y)}else h.panBy(g)}else if(s in this._zoomKeys)h.setZoom(h.getZoom()+(n.shiftKey?3:1)*this._zoomKeys[s]);else if(s===27&&h._popup&&h._popup.options.closeOnEscapeKey)h.closePopup();else return;hn(n)}}});Vt.addInitHook("addHandler","keyboard",Ko),Vt.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Jo=nn.extend({addHooks:function(){Tt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){lt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(n){var s=ci(n),h=this._map.options.wheelDebounceTime;this._delta+=s,this._lastMousePos=this._map.mouseEventToContainerPoint(n),this._startTime||(this._startTime=+new Date);var g=Math.max(h-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(_(this._performZoom,this),g),hn(n)},_performZoom:function(){var n=this._map,s=n.getZoom(),h=this._map.options.zoomSnap||0;n._stop();var g=this._delta/(this._map.options.wheelPxPerZoomLevel*4),y=4*Math.log(2/(1+Math.exp(-Math.abs(g))))/Math.LN2,A=h?Math.ceil(y/h)*h:y,D=n._limitZoom(s+(this._delta>0?A:-A))-s;this._delta=0,this._startTime=null,D&&(n.options.scrollWheelZoom==="center"?n.setZoom(s+D):n.setZoomAround(this._lastMousePos,s+D))}});Vt.addInitHook("addHandler","scrollWheelZoom",Jo);var pa=600;Vt.mergeOptions({tapHold:_t.touchNative&&_t.safari&&_t.mobile,tapTolerance:15});var $o=nn.extend({addHooks:function(){Tt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){lt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(n){if(clearTimeout(this._holdTimeout),n.touches.length===1){var s=n.touches[0];this._startPos=this._newPos=new bt(s.clientX,s.clientY),this._holdTimeout=setTimeout(_(function(){this._cancel(),this._isTapValid()&&(Tt(document,"touchend",Re),Tt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",s))},this),pa),Tt(document,"touchend touchcancel contextmenu",this._cancel,this),Tt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function n(){lt(document,"touchend",Re),lt(document,"touchend touchcancel",n)},_cancel:function(){clearTimeout(this._holdTimeout),lt(document,"touchend touchcancel contextmenu",this._cancel,this),lt(document,"touchmove",this._onMove,this)},_onMove:function(n){var s=n.touches[0];this._newPos=new bt(s.clientX,s.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(n,s){var h=new MouseEvent(n,{bubbles:!0,cancelable:!0,view:window,screenX:s.screenX,screenY:s.screenY,clientX:s.clientX,clientY:s.clientY});h._simulated=!0,s.target.dispatchEvent(h)}});Vt.addInitHook("addHandler","tapHold",$o),Vt.mergeOptions({touchZoom:_t.touch,bounceAtZoomLimits:!0});var ts=nn.extend({addHooks:function(){xt(this._map._container,"leaflet-touch-zoom"),Tt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){me(this._map._container,"leaflet-touch-zoom"),lt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(n){var s=this._map;if(!(!n.touches||n.touches.length!==2||s._animatingZoom||this._zooming)){var h=s.mouseEventToContainerPoint(n.touches[0]),g=s.mouseEventToContainerPoint(n.touches[1]);this._centerPoint=s.getSize()._divideBy(2),this._startLatLng=s.containerPointToLatLng(this._centerPoint),s.options.touchZoom!=="center"&&(this._pinchStartLatLng=s.containerPointToLatLng(h.add(g)._divideBy(2))),this._startDist=h.distanceTo(g),this._startZoom=s.getZoom(),this._moved=!1,this._zooming=!0,s._stop(),Tt(document,"touchmove",this._onTouchMove,this),Tt(document,"touchend touchcancel",this._onTouchEnd,this),Re(n)}},_onTouchMove:function(n){if(!(!n.touches||n.touches.length!==2||!this._zooming)){var s=this._map,h=s.mouseEventToContainerPoint(n.touches[0]),g=s.mouseEventToContainerPoint(n.touches[1]),y=h.distanceTo(g)/this._startDist;if(this._zoom=s.getScaleZoom(y,this._startZoom),!s.options.bounceAtZoomLimits&&(this._zoom<s.getMinZoom()&&y<1||this._zoom>s.getMaxZoom()&&y>1)&&(this._zoom=s._limitZoom(this._zoom)),s.options.touchZoom==="center"){if(this._center=this._startLatLng,y===1)return}else{var A=h._add(g)._divideBy(2)._subtract(this._centerPoint);if(y===1&&A.x===0&&A.y===0)return;this._center=s.unproject(s.project(this._pinchStartLatLng,this._zoom).subtract(A),this._zoom)}this._moved||(s._moveStart(!0,!1),this._moved=!0),wt(this._animRequest);var D=_(s._move,s,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=oe(D,this,!0),Re(n)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,wt(this._animRequest),lt(document,"touchmove",this._onTouchMove,this),lt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Vt.addInitHook("addHandler","touchZoom",ts),Vt.BoxZoom=Yo,Vt.DoubleClickZoom=Qo,Vt.Drag=qo,Vt.Keyboard=Ko,Vt.ScrollWheelZoom=Jo,Vt.TapHold=$o,Vt.TouchZoom=ts,d.Bounds=ge,d.Browser=_t,d.CRS=pn,d.Canvas=Wo,d.Circle=di,d.CircleMarker=zn,d.Class=le,d.Control=un,d.DivIcon=Xe,d.DivOverlay=ye,d.DomEvent=We,d.DomUtil=go,d.Draggable=Fn,d.Evented=Mt,d.FeatureGroup=_n,d.GeoJSON=o,d.GridLayer=yn,d.Handler=nn,d.Icon=ui,d.ImageOverlay=V,d.LatLng=ee,d.LatLngBounds=Ie,d.Layer=Oe,d.LayerGroup=Mn,d.LineUtil=Vr,d.Map=Vt,d.Marker=$e,d.Mixin=Fr,d.Path=wn,d.Point=bt,d.PolyUtil=Cr,d.Polygon=i,d.Polyline=t,d.Popup=Ge,d.PosAnimation=wr,d.Projection=Ar,d.Rectangle=Xo,d.Renderer=Jn,d.SVG=Tr,d.SVGOverlay=Pt,d.TileLayer=pi,d.Tooltip=te,d.Transformation=ke,d.Util=ne,d.VideoOverlay=ot,d.bind=_,d.bounds=ie,d.canvas=Go,d.circle=p,d.circleMarker=Yt,d.control=Mi,d.divIcon=fi,d.extend=c,d.featureGroup=xn,d.geoJSON=R,d.geoJson=F,d.gridLayer=Eo,d.icon=Sr,d.imageOverlay=J,d.latLng=it,d.latLngBounds=Zt,d.layerGroup=rn,d.map=mo,d.marker=vo,d.point=At,d.polygon=r,d.polyline=e,d.popup=je,d.rectangle=fa,d.setOptions=st,d.stamp=M,d.svg=jo,d.svgOverlay=Ot,d.tileLayer=Vo,d.tooltip=Be,d.transformation=Zn,d.version=m,d.videoOverlay=X;var ga=window.L;d.noConflict=function(){return window.L=ga,this},window.L=d})});var Bs=ss((oo,Ps)=>{"use strict";(function(d,m){typeof oo=="object"&&typeof Ps<"u"?m(oo):typeof define=="function"&&define.amd?define(["exports"],m):(d=typeof globalThis<"u"?globalThis:d||self,m(d.ZXing={}))})(oo,function(d){"use strict";function m(p){return p==null}var c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,t){p.__proto__=t}||function(p,t){for(var e in t)t.hasOwnProperty(e)&&(p[e]=t[e])};function w(p,t){c(p,t);function e(){this.constructor=p}p.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function _(p,t){var e=Object.setPrototypeOf;e?e(p,t):p.__proto__=t}function C(p,t){t===void 0&&(t=p.constructor);var e=Error.captureStackTrace;e&&e(p,t)}var M=function(p){w(t,p);function t(e){var i=this.constructor,r=p.call(this,e)||this;return Object.defineProperty(r,"name",{value:i.name,enumerable:!1}),_(r,i.prototype),C(r),r}return t}(Error);let P=(()=>{class p extends M{constructor(e=void 0){super(e),this.message=e}getKind(){return this.constructor.kind}}return p.kind="Exception",p})(),H=(()=>{class p extends P{}return p.kind="ArgumentException",p})(),E=(()=>{class p extends P{}return p.kind="IllegalArgumentException",p})();class Z{constructor(t){if(this.binarizer=t,t===null)throw new E("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(t,e){return this.binarizer.getBlackRow(t,e)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(t,e,i,r){let o=this.binarizer.getLuminanceSource().crop(t,e,i,r);return new Z(this.binarizer.createBinarizer(o))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){let t=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new Z(this.binarizer.createBinarizer(t))}rotateCounterClockwise45(){let t=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new Z(this.binarizer.createBinarizer(t))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}let $=(()=>{class p extends P{static getChecksumInstance(){return new p}}return p.kind="ChecksumException",p})();class Bt{constructor(t){this.source=t}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class st{static arraycopy(t,e,i,r,o){for(;o--;)i[r++]=t[e++]}static currentTimeMillis(){return Date.now()}}let Te=(()=>{class p extends P{}return p.kind="IndexOutOfBoundsException",p})(),_e=(()=>{class p extends Te{constructor(e=void 0,i=void 0){super(i),this.index=e,this.message=i}}return p.kind="ArrayIndexOutOfBoundsException",p})();class Lt{static fill(t,e){for(let i=0,r=t.length;i<r;i++)t[i]=e}static fillWithin(t,e,i,r){Lt.rangeCheck(t.length,e,i);for(let o=e;o<i;o++)t[o]=r}static rangeCheck(t,e,i){if(e>i)throw new E("fromIndex("+e+") > toIndex("+i+")");if(e<0)throw new _e(e);if(i>t)throw new _e(i)}static asList(...t){return t}static create(t,e,i){return Array.from({length:t}).map(o=>Array.from({length:e}).fill(i))}static createInt32Array(t,e,i){return Array.from({length:t}).map(o=>Int32Array.from({length:e}).fill(i))}static equals(t,e){if(!t||!e||!t.length||!e.length||t.length!==e.length)return!1;for(let i=0,r=t.length;i<r;i++)if(t[i]!==e[i])return!1;return!0}static hashCode(t){if(t===null)return 0;let e=1;for(let i of t)e=31*e+i;return e}static fillUint8Array(t,e){for(let i=0;i!==t.length;i++)t[i]=e}static copyOf(t,e){return t.slice(0,e)}static copyOfUint8Array(t,e){if(t.length<=e){let i=new Uint8Array(e);return i.set(t),i}return t.slice(0,e)}static copyOfRange(t,e,i){let r=i-e,o=new Int32Array(r);return st.arraycopy(t,e,o,0,r),o}static binarySearch(t,e,i){i===void 0&&(i=Lt.numberComparator);let r=0,o=t.length-1;for(;r<=o;){let a=o+r>>1,l=i(e,t[a]);if(l>0)r=a+1;else if(l<0)o=a-1;else return a}return-r-1}static numberComparator(t,e){return t-e}}class gt{static numberOfTrailingZeros(t){let e;if(t===0)return 32;let i=31;return e=t<<16,e!==0&&(i-=16,t=e),e=t<<8,e!==0&&(i-=8,t=e),e=t<<4,e!==0&&(i-=4,t=e),e=t<<2,e!==0&&(i-=2,t=e),i-(t<<1>>>31)}static numberOfLeadingZeros(t){if(t===0)return 32;let e=1;return t>>>16||(e+=16,t<<=16),t>>>24||(e+=8,t<<=8),t>>>28||(e+=4,t<<=4),t>>>30||(e+=2,t<<=2),e-=t>>>31,e}static toHexString(t){return t.toString(16)}static toBinaryString(t){return String(parseInt(String(t),2))}static bitCount(t){return t=t-(t>>>1&1431655765),t=(t&858993459)+(t>>>2&858993459),t=t+(t>>>4)&252645135,t=t+(t>>>8),t=t+(t>>>16),t&63}static truncDivision(t,e){return Math.trunc(t/e)}static parseInt(t,e=void 0){return parseInt(t,e)}}gt.MIN_VALUE_32_BITS=-2147483648,gt.MAX_VALUE=Number.MAX_SAFE_INTEGER;class Ft{constructor(t,e){t===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=t,e==null?this.bits=Ft.makeArray(t):this.bits=e)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(t){if(t>this.bits.length*32){let e=Ft.makeArray(t);st.arraycopy(this.bits,0,e,0,this.bits.length),this.bits=e}}get(t){return(this.bits[Math.floor(t/32)]&1<<(t&31))!==0}set(t){this.bits[Math.floor(t/32)]|=1<<(t&31)}flip(t){this.bits[Math.floor(t/32)]^=1<<(t&31)}getNextSet(t){let e=this.size;if(t>=e)return e;let i=this.bits,r=Math.floor(t/32),o=i[r];o&=~((1<<(t&31))-1);let a=i.length;for(;o===0;){if(++r===a)return e;o=i[r]}let l=r*32+gt.numberOfTrailingZeros(o);return l>e?e:l}getNextUnset(t){let e=this.size;if(t>=e)return e;let i=this.bits,r=Math.floor(t/32),o=~i[r];o&=~((1<<(t&31))-1);let a=i.length;for(;o===0;){if(++r===a)return e;o=~i[r]}let l=r*32+gt.numberOfTrailingZeros(o);return l>e?e:l}setBulk(t,e){this.bits[Math.floor(t/32)]=e}setRange(t,e){if(e<t||t<0||e>this.size)throw new E;if(e===t)return;e--;let i=Math.floor(t/32),r=Math.floor(e/32),o=this.bits;for(let a=i;a<=r;a++){let l=a>i?0:t&31,f=(2<<(a<r?31:e&31))-(1<<l);o[a]|=f}}clear(){let t=this.bits.length,e=this.bits;for(let i=0;i<t;i++)e[i]=0}isRange(t,e,i){if(e<t||t<0||e>this.size)throw new E;if(e===t)return!0;e--;let r=Math.floor(t/32),o=Math.floor(e/32),a=this.bits;for(let l=r;l<=o;l++){let u=l>r?0:t&31,x=(2<<(l<o?31:e&31))-(1<<u)&4294967295;if((a[l]&x)!==(i?x:0))return!1}return!0}appendBit(t){this.ensureCapacity(this.size+1),t&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(t,e){if(e<0||e>32)throw new E("Num bits must be between 0 and 32");this.ensureCapacity(this.size+e);for(let i=e;i>0;i--)this.appendBit((t>>i-1&1)===1)}appendBitArray(t){let e=t.size;this.ensureCapacity(this.size+e);for(let i=0;i<e;i++)this.appendBit(t.get(i))}xor(t){if(this.size!==t.size)throw new E("Sizes don't match");let e=this.bits;for(let i=0,r=e.length;i<r;i++)e[i]^=t.bits[i]}toBytes(t,e,i,r){for(let o=0;o<r;o++){let a=0;for(let l=0;l<8;l++)this.get(t)&&(a|=1<<7-l),t++;e[i+o]=a}}getBitArray(){return this.bits}reverse(){let t=new Int32Array(this.bits.length),e=Math.floor((this.size-1)/32),i=e+1,r=this.bits;for(let o=0;o<i;o++){let a=r[o];a=a>>1&1431655765|(a&1431655765)<<1,a=a>>2&858993459|(a&858993459)<<2,a=a>>4&252645135|(a&252645135)<<4,a=a>>8&16711935|(a&16711935)<<8,a=a>>16&65535|(a&65535)<<16,t[e-o]=a}if(this.size!==i*32){let o=i*32-this.size,a=t[0]>>>o;for(let l=1;l<i;l++){let u=t[l];a|=u<<32-o,t[l-1]=a,a=u>>>o}t[i-1]=a}this.bits=t}static makeArray(t){return new Int32Array(Math.floor((t+31)/32))}equals(t){if(!(t instanceof Ft))return!1;let e=t;return this.size===e.size&&Lt.equals(this.bits,e.bits)}hashCode(){return 31*this.size+Lt.hashCode(this.bits)}toString(){let t="";for(let e=0,i=this.size;e<i;e++)e&7||(t+=" "),t+=this.get(e)?"X":".";return t}clone(){return new Ft(this.size,this.bits.slice())}}var Ye=function(p){return p[p.OTHER=0]="OTHER",p[p.PURE_BARCODE=1]="PURE_BARCODE",p[p.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",p[p.TRY_HARDER=3]="TRY_HARDER",p[p.CHARACTER_SET=4]="CHARACTER_SET",p[p.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",p[p.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",p[p.ASSUME_GS1=7]="ASSUME_GS1",p[p.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",p[p.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",p[p.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS",p}(Ye||{}),Ut=Ye;let tt=(()=>{class p extends P{static getFormatInstance(){return new p}}return p.kind="FormatException",p})();var Gt=function(p){return p[p.Cp437=0]="Cp437",p[p.ISO8859_1=1]="ISO8859_1",p[p.ISO8859_2=2]="ISO8859_2",p[p.ISO8859_3=3]="ISO8859_3",p[p.ISO8859_4=4]="ISO8859_4",p[p.ISO8859_5=5]="ISO8859_5",p[p.ISO8859_6=6]="ISO8859_6",p[p.ISO8859_7=7]="ISO8859_7",p[p.ISO8859_8=8]="ISO8859_8",p[p.ISO8859_9=9]="ISO8859_9",p[p.ISO8859_10=10]="ISO8859_10",p[p.ISO8859_11=11]="ISO8859_11",p[p.ISO8859_13=12]="ISO8859_13",p[p.ISO8859_14=13]="ISO8859_14",p[p.ISO8859_15=14]="ISO8859_15",p[p.ISO8859_16=15]="ISO8859_16",p[p.SJIS=16]="SJIS",p[p.Cp1250=17]="Cp1250",p[p.Cp1251=18]="Cp1251",p[p.Cp1252=19]="Cp1252",p[p.Cp1256=20]="Cp1256",p[p.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",p[p.UTF8=22]="UTF8",p[p.ASCII=23]="ASCII",p[p.Big5=24]="Big5",p[p.GB18030=25]="GB18030",p[p.EUC_KR=26]="EUC_KR",p}(Gt||{});class et{constructor(t,e,i,...r){this.valueIdentifier=t,this.name=i,typeof e=="number"?this.values=Int32Array.from([e]):this.values=e,this.otherEncodingNames=r,et.VALUE_IDENTIFIER_TO_ECI.set(t,this),et.NAME_TO_ECI.set(i,this);let o=this.values;for(let a=0,l=o.length;a!==l;a++){let u=o[a];et.VALUES_TO_ECI.set(u,this)}for(let a of r)et.NAME_TO_ECI.set(a,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(t){if(t<0||t>=900)throw new tt("incorect value");let e=et.VALUES_TO_ECI.get(t);if(e===void 0)throw new tt("incorect value");return e}static getCharacterSetECIByName(t){let e=et.NAME_TO_ECI.get(t);if(e===void 0)throw new tt("incorect value");return e}equals(t){if(!(t instanceof et))return!1;let e=t;return this.getName()===e.getName()}}et.VALUE_IDENTIFIER_TO_ECI=new Map,et.VALUES_TO_ECI=new Map,et.NAME_TO_ECI=new Map,et.Cp437=new et(Gt.Cp437,Int32Array.from([0,2]),"Cp437"),et.ISO8859_1=new et(Gt.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),et.ISO8859_2=new et(Gt.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),et.ISO8859_3=new et(Gt.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),et.ISO8859_4=new et(Gt.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),et.ISO8859_5=new et(Gt.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),et.ISO8859_6=new et(Gt.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),et.ISO8859_7=new et(Gt.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),et.ISO8859_8=new et(Gt.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),et.ISO8859_9=new et(Gt.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),et.ISO8859_10=new et(Gt.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),et.ISO8859_11=new et(Gt.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),et.ISO8859_13=new et(Gt.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),et.ISO8859_14=new et(Gt.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),et.ISO8859_15=new et(Gt.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),et.ISO8859_16=new et(Gt.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),et.SJIS=new et(Gt.SJIS,20,"SJIS","Shift_JIS"),et.Cp1250=new et(Gt.Cp1250,21,"Cp1250","windows-1250"),et.Cp1251=new et(Gt.Cp1251,22,"Cp1251","windows-1251"),et.Cp1252=new et(Gt.Cp1252,23,"Cp1252","windows-1252"),et.Cp1256=new et(Gt.Cp1256,24,"Cp1256","windows-1256"),et.UnicodeBigUnmarked=new et(Gt.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),et.UTF8=new et(Gt.UTF8,26,"UTF8","UTF-8"),et.ASCII=new et(Gt.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),et.Big5=new et(Gt.Big5,28,"Big5"),et.GB18030=new et(Gt.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),et.EUC_KR=new et(Gt.EUC_KR,30,"EUC_KR","EUC-KR");let ti=(()=>{class p extends P{}return p.kind="UnsupportedOperationException",p})();class oe{static decode(t,e){let i=this.encodingName(e);return this.customDecoder?this.customDecoder(t,i):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(i)?this.decodeFallback(t,i):new TextDecoder(i).decode(t)}static shouldDecodeOnFallback(t){return!oe.isBrowser()&&t==="ISO-8859-1"}static encode(t,e){let i=this.encodingName(e);return this.customEncoder?this.customEncoder(t,i):typeof TextEncoder>"u"?this.encodeFallback(t):new TextEncoder().encode(t)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(t){return typeof t=="string"?t:t.getName()}static encodingCharacterSet(t){return t instanceof et?t:et.getCharacterSetECIByName(t)}static decodeFallback(t,e){let i=this.encodingCharacterSet(e);if(oe.isDecodeFallbackSupported(i)){let r="";for(let o=0,a=t.length;o<a;o++){let l=t[o].toString(16);l.length<2&&(l="0"+l),r+="%"+l}return decodeURIComponent(r)}if(i.equals(et.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(t.buffer));throw new ti(`Encoding ${this.encodingName(e)} not supported by fallback.`)}static isDecodeFallbackSupported(t){return t.equals(et.UTF8)||t.equals(et.ISO8859_1)||t.equals(et.ASCII)}static encodeFallback(t){let i=btoa(unescape(encodeURIComponent(t))).split(""),r=[];for(let o=0;o<i.length;o++)r.push(i[o].charCodeAt(0));return new Uint8Array(r)}}class wt{static castAsNonUtf8Char(t,e=null){let i=e?e.getName():this.ISO88591;return oe.decode(new Uint8Array([t]),i)}static guessEncoding(t,e){if(e!=null&&e.get(Ut.CHARACTER_SET)!==void 0)return e.get(Ut.CHARACTER_SET).toString();let i=t.length,r=!0,o=!0,a=!0,l=0,u=0,f=0,x=0,v=0,S=0,b=0,N=0,R=0,F=0,V=0,J=t.length>3&&t[0]===239&&t[1]===187&&t[2]===191;for(let ot=0;ot<i&&(r||o||a);ot++){let X=t[ot]&255;a&&(l>0?X&128?l--:a=!1:X&128&&(X&64?(l++,X&32?(l++,X&16?(l++,X&8?a=!1:x++):f++):u++):a=!1)),r&&(X>127&&X<160?r=!1:X>159&&(X<192||X===215||X===247)&&V++),o&&(v>0?X<64||X===127||X>252?o=!1:v--:X===128||X===160||X>239?o=!1:X>160&&X<224?(S++,N=0,b++,b>R&&(R=b)):X>127?(v++,b=0,N++,N>F&&(F=N)):(b=0,N=0))}return a&&l>0&&(a=!1),o&&v>0&&(o=!1),a&&(J||u+f+x>0)?wt.UTF8:o&&(wt.ASSUME_SHIFT_JIS||R>=3||F>=3)?wt.SHIFT_JIS:r&&o?R===2&&S===2||V*10>=i?wt.SHIFT_JIS:wt.ISO88591:r?wt.ISO88591:o?wt.SHIFT_JIS:a?wt.UTF8:wt.PLATFORM_DEFAULT_ENCODING}static format(t,...e){let i=-1;function r(a,l,u,f,x,v){if(a==="%%")return"%";if(e[++i]===void 0)return;a=f?parseInt(f.substr(1)):void 0;let S=x?parseInt(x.substr(1)):void 0,b;switch(v){case"s":b=e[i];break;case"c":b=e[i][0];break;case"f":b=parseFloat(e[i]).toFixed(a);break;case"p":b=parseFloat(e[i]).toPrecision(a);break;case"e":b=parseFloat(e[i]).toExponential(a);break;case"x":b=parseInt(e[i]).toString(S||16);break;case"d":b=parseFloat(parseInt(e[i],S||10).toPrecision(a)).toFixed(0);break}b=typeof b=="object"?JSON.stringify(b):(+b).toString(S);let N=parseInt(u),R=u&&u[0]+""=="0"?"0":" ";for(;b.length<N;)b=l!==void 0?b+R:R+b;return b}let o=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return t.replace(o,r)}static getBytes(t,e){return oe.encode(t,e)}static getCharCode(t,e=0){return t.charCodeAt(e)}static getCharAt(t){return String.fromCharCode(t)}}wt.SHIFT_JIS=et.SJIS.getName(),wt.GB2312="GB2312",wt.ISO88591=et.ISO8859_1.getName(),wt.EUC_JP="EUC_JP",wt.UTF8=et.UTF8.getName(),wt.PLATFORM_DEFAULT_ENCODING=wt.UTF8,wt.ASSUME_SHIFT_JIS=!1;class ne{constructor(t=""){this.value=t}enableDecoding(t){return this.encoding=t,this}append(t){return typeof t=="string"?this.value+=t.toString():this.encoding?this.value+=wt.castAsNonUtf8Char(t,this.encoding):this.value+=String.fromCharCode(t),this}appendChars(t,e,i){for(let r=e;e<e+i;r++)this.append(t[r]);return this}length(){return this.value.length}charAt(t){return this.value.charAt(t)}deleteCharAt(t){this.value=this.value.substr(0,t)+this.value.substring(t+1)}setCharAt(t,e){this.value=this.value.substr(0,t)+e+this.value.substr(t+1)}substring(t,e){return this.value.substring(t,e)}setLengthToZero(){this.value=""}toString(){return this.value}insert(t,e){this.value=this.value.substr(0,t)+e+this.value.substr(t+e.length)}}class le{constructor(t,e,i,r){if(this.width=t,this.height=e,this.rowSize=i,this.bits=r,e==null&&(e=t),this.height=e,t<1||e<1)throw new E("Both dimensions must be greater than 0");i==null&&(i=Math.floor((t+31)/32)),this.rowSize=i,r==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(t){let e=t.length,i=t[0].length,r=new le(i,e);for(let o=0;o<e;o++){let a=t[o];for(let l=0;l<i;l++)a[l]&&r.set(l,o)}return r}static parseFromString(t,e,i){if(t===null)throw new E("stringRepresentation cannot be null");let r=new Array(t.length),o=0,a=0,l=-1,u=0,f=0;for(;f<t.length;)if(t.charAt(f)===`
`||t.charAt(f)==="\r"){if(o>a){if(l===-1)l=o-a;else if(o-a!==l)throw new E("row lengths do not match");a=o,u++}f++}else if(t.substring(f,f+e.length)===e)f+=e.length,r[o]=!0,o++;else if(t.substring(f,f+i.length)===i)f+=i.length,r[o]=!1,o++;else throw new E("illegal character encountered: "+t.substring(f));if(o>a){if(l===-1)l=o-a;else if(o-a!==l)throw new E("row lengths do not match");u++}let x=new le(l,u);for(let v=0;v<o;v++)r[v]&&x.set(Math.floor(v%l),Math.floor(v/l));return x}get(t,e){let i=e*this.rowSize+Math.floor(t/32);return(this.bits[i]>>>(t&31)&1)!==0}set(t,e){let i=e*this.rowSize+Math.floor(t/32);this.bits[i]|=1<<(t&31)&4294967295}unset(t,e){let i=e*this.rowSize+Math.floor(t/32);this.bits[i]&=~(1<<(t&31)&4294967295)}flip(t,e){let i=e*this.rowSize+Math.floor(t/32);this.bits[i]^=1<<(t&31)&4294967295}xor(t){if(this.width!==t.getWidth()||this.height!==t.getHeight()||this.rowSize!==t.getRowSize())throw new E("input matrix dimensions do not match");let e=new Ft(Math.floor(this.width/32)+1),i=this.rowSize,r=this.bits;for(let o=0,a=this.height;o<a;o++){let l=o*i,u=t.getRow(o,e).getBitArray();for(let f=0;f<i;f++)r[l+f]^=u[f]}}clear(){let t=this.bits,e=t.length;for(let i=0;i<e;i++)t[i]=0}setRegion(t,e,i,r){if(e<0||t<0)throw new E("Left and top must be nonnegative");if(r<1||i<1)throw new E("Height and width must be at least 1");let o=t+i,a=e+r;if(a>this.height||o>this.width)throw new E("The region must fit inside the matrix");let l=this.rowSize,u=this.bits;for(let f=e;f<a;f++){let x=f*l;for(let v=t;v<o;v++)u[x+Math.floor(v/32)]|=1<<(v&31)&4294967295}}getRow(t,e){e==null||e.getSize()<this.width?e=new Ft(this.width):e.clear();let i=this.rowSize,r=this.bits,o=t*i;for(let a=0;a<i;a++)e.setBulk(a*32,r[o+a]);return e}setRow(t,e){st.arraycopy(e.getBitArray(),0,this.bits,t*this.rowSize,this.rowSize)}rotate180(){let t=this.getWidth(),e=this.getHeight(),i=new Ft(t),r=new Ft(t);for(let o=0,a=Math.floor((e+1)/2);o<a;o++)i=this.getRow(o,i),r=this.getRow(e-1-o,r),i.reverse(),r.reverse(),this.setRow(o,r),this.setRow(e-1-o,i)}getEnclosingRectangle(){let t=this.width,e=this.height,i=this.rowSize,r=this.bits,o=t,a=e,l=-1,u=-1;for(let f=0;f<e;f++)for(let x=0;x<i;x++){let v=r[f*i+x];if(v!==0){if(f<a&&(a=f),f>u&&(u=f),x*32<o){let S=0;for(;!(v<<31-S&4294967295);)S++;x*32+S<o&&(o=x*32+S)}if(x*32+31>l){let S=31;for(;!(v>>>S);)S--;x*32+S>l&&(l=x*32+S)}}}return l<o||u<a?null:Int32Array.from([o,a,l-o+1,u-a+1])}getTopLeftOnBit(){let t=this.rowSize,e=this.bits,i=0;for(;i<e.length&&e[i]===0;)i++;if(i===e.length)return null;let r=i/t,o=i%t*32,a=e[i],l=0;for(;!(a<<31-l&4294967295);)l++;return o+=l,Int32Array.from([o,r])}getBottomRightOnBit(){let t=this.rowSize,e=this.bits,i=e.length-1;for(;i>=0&&e[i]===0;)i--;if(i<0)return null;let r=Math.floor(i/t),o=Math.floor(i%t)*32,a=e[i],l=31;for(;!(a>>>l);)l--;return o+=l,Int32Array.from([o,r])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(t){if(!(t instanceof le))return!1;let e=t;return this.width===e.width&&this.height===e.height&&this.rowSize===e.rowSize&&Lt.equals(this.bits,e.bits)}hashCode(){let t=this.width;return t=31*t+this.width,t=31*t+this.height,t=31*t+this.rowSize,t=31*t+Lt.hashCode(this.bits),t}toString(t="X ",e="  ",i=`
`){return this.buildToString(t,e,i)}buildToString(t,e,i){let r=new ne;for(let o=0,a=this.height;o<a;o++){for(let l=0,u=this.width;l<u;l++)r.append(this.get(l,o)?t:e);r.append(i)}return r.toString()}clone(){return new le(this.width,this.height,this.rowSize,this.bits.slice())}}let Y=(()=>{class p extends P{static getNotFoundInstance(){return new p}}return p.kind="NotFoundException",p})();class $t extends Bt{constructor(t){super(t),this.luminances=$t.EMPTY,this.buckets=new Int32Array($t.LUMINANCE_BUCKETS)}getBlackRow(t,e){let i=this.getLuminanceSource(),r=i.getWidth();e==null||e.getSize()<r?e=new Ft(r):e.clear(),this.initArrays(r);let o=i.getRow(t,this.luminances),a=this.buckets;for(let u=0;u<r;u++)a[(o[u]&255)>>$t.LUMINANCE_SHIFT]++;let l=$t.estimateBlackPoint(a);if(r<3)for(let u=0;u<r;u++)(o[u]&255)<l&&e.set(u);else{let u=o[0]&255,f=o[1]&255;for(let x=1;x<r-1;x++){let v=o[x+1]&255;(f*4-u-v)/2<l&&e.set(x),u=f,f=v}}return e}getBlackMatrix(){let t=this.getLuminanceSource(),e=t.getWidth(),i=t.getHeight(),r=new le(e,i);this.initArrays(e);let o=this.buckets;for(let u=1;u<5;u++){let f=Math.floor(i*u/5),x=t.getRow(f,this.luminances),v=Math.floor(e*4/5);for(let S=Math.floor(e/5);S<v;S++){let b=x[S]&255;o[b>>$t.LUMINANCE_SHIFT]++}}let a=$t.estimateBlackPoint(o),l=t.getMatrix();for(let u=0;u<i;u++){let f=u*e;for(let x=0;x<e;x++)(l[f+x]&255)<a&&r.set(x,u)}return r}createBinarizer(t){return new $t(t)}initArrays(t){this.luminances.length<t&&(this.luminances=new Uint8ClampedArray(t));let e=this.buckets;for(let i=0;i<$t.LUMINANCE_BUCKETS;i++)e[i]=0}static estimateBlackPoint(t){let e=t.length,i=0,r=0,o=0;for(let x=0;x<e;x++)t[x]>o&&(r=x,o=t[x]),t[x]>i&&(i=t[x]);let a=0,l=0;for(let x=0;x<e;x++){let v=x-r,S=t[x]*v*v;S>l&&(a=x,l=S)}if(r>a){let x=r;r=a,a=x}if(a-r<=e/16)throw new Y;let u=a-1,f=-1;for(let x=a-1;x>r;x--){let v=x-r,S=v*v*(a-x)*(i-t[x]);S>f&&(u=x,f=S)}return u<<$t.LUMINANCE_SHIFT}}$t.LUMINANCE_BITS=5,$t.LUMINANCE_SHIFT=8-$t.LUMINANCE_BITS,$t.LUMINANCE_BUCKETS=1<<$t.LUMINANCE_BITS,$t.EMPTY=Uint8ClampedArray.from([0]);class Mt extends $t{constructor(t){super(t),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;let t=this.getLuminanceSource(),e=t.getWidth(),i=t.getHeight();if(e>=Mt.MINIMUM_DIMENSION&&i>=Mt.MINIMUM_DIMENSION){let r=t.getMatrix(),o=e>>Mt.BLOCK_SIZE_POWER;e&Mt.BLOCK_SIZE_MASK&&o++;let a=i>>Mt.BLOCK_SIZE_POWER;i&Mt.BLOCK_SIZE_MASK&&a++;let l=Mt.calculateBlackPoints(r,o,a,e,i),u=new le(e,i);Mt.calculateThresholdForBlock(r,o,a,e,i,l,u),this.matrix=u}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(t){return new Mt(t)}static calculateThresholdForBlock(t,e,i,r,o,a,l){let u=o-Mt.BLOCK_SIZE,f=r-Mt.BLOCK_SIZE;for(let x=0;x<i;x++){let v=x<<Mt.BLOCK_SIZE_POWER;v>u&&(v=u);let S=Mt.cap(x,2,i-3);for(let b=0;b<e;b++){let N=b<<Mt.BLOCK_SIZE_POWER;N>f&&(N=f);let R=Mt.cap(b,2,e-3),F=0;for(let J=-2;J<=2;J++){let ot=a[S+J];F+=ot[R-2]+ot[R-1]+ot[R]+ot[R+1]+ot[R+2]}let V=F/25;Mt.thresholdBlock(t,N,v,V,r,l)}}}static cap(t,e,i){return t<e?e:t>i?i:t}static thresholdBlock(t,e,i,r,o,a){for(let l=0,u=i*o+e;l<Mt.BLOCK_SIZE;l++,u+=o)for(let f=0;f<Mt.BLOCK_SIZE;f++)(t[u+f]&255)<=r&&a.set(e+f,i+l)}static calculateBlackPoints(t,e,i,r,o){let a=o-Mt.BLOCK_SIZE,l=r-Mt.BLOCK_SIZE,u=new Array(i);for(let f=0;f<i;f++){u[f]=new Int32Array(e);let x=f<<Mt.BLOCK_SIZE_POWER;x>a&&(x=a);for(let v=0;v<e;v++){let S=v<<Mt.BLOCK_SIZE_POWER;S>l&&(S=l);let b=0,N=255,R=0;for(let V=0,J=x*r+S;V<Mt.BLOCK_SIZE;V++,J+=r){for(let ot=0;ot<Mt.BLOCK_SIZE;ot++){let X=t[J+ot]&255;b+=X,X<N&&(N=X),X>R&&(R=X)}if(R-N>Mt.MIN_DYNAMIC_RANGE)for(V++,J+=r;V<Mt.BLOCK_SIZE;V++,J+=r)for(let ot=0;ot<Mt.BLOCK_SIZE;ot++)b+=t[J+ot]&255}let F=b>>Mt.BLOCK_SIZE_POWER*2;if(R-N<=Mt.MIN_DYNAMIC_RANGE&&(F=N/2,f>0&&v>0)){let V=(u[f-1][v]+2*u[f][v-1]+u[f-1][v-1])/4;N<V&&(F=V)}u[f][v]=F}}return u}}Mt.BLOCK_SIZE_POWER=3,Mt.BLOCK_SIZE=1<<Mt.BLOCK_SIZE_POWER,Mt.BLOCK_SIZE_MASK=Mt.BLOCK_SIZE-1,Mt.MINIMUM_DIMENSION=Mt.BLOCK_SIZE*5,Mt.MIN_DYNAMIC_RANGE=24;class bt{constructor(t,e){this.width=t,this.height=e}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(t,e,i,r){throw new ti("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new ti("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new ti("This luminance source does not support rotation by 45 degrees.")}toString(){let t=new Uint8ClampedArray(this.width),e=new ne;for(let i=0;i<this.height;i++){let r=this.getRow(i,t);for(let o=0;o<this.width;o++){let a=r[o]&255,l;a<64?l="#":a<128?l="+":a<192?l=".":l=" ",e.append(l)}e.append(`
`)}return e.toString()}}class Sn extends bt{constructor(t){super(t.getWidth(),t.getHeight()),this.delegate=t}getRow(t,e){let i=this.delegate.getRow(t,e),r=this.getWidth();for(let o=0;o<r;o++)i[o]=255-(i[o]&255);return i}getMatrix(){let t=this.delegate.getMatrix(),e=this.getWidth()*this.getHeight(),i=new Uint8ClampedArray(e);for(let r=0;r<e;r++)i[r]=255-(t[r]&255);return i}isCropSupported(){return this.delegate.isCropSupported()}crop(t,e,i,r){return new Sn(this.delegate.crop(t,e,i,r))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new Sn(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new Sn(this.delegate.rotateCounterClockwise45())}}class At extends bt{constructor(t){super(t.width,t.height),this.canvas=t,this.tempCanvasElement=null,this.buffer=At.makeBufferFromCanvasImageData(t)}static makeBufferFromCanvasImageData(t){let e=t.getContext("2d").getImageData(0,0,t.width,t.height);return At.toGrayscaleBuffer(e.data,t.width,t.height)}static toGrayscaleBuffer(t,e,i){let r=new Uint8ClampedArray(e*i);for(let o=0,a=0,l=t.length;o<l;o+=4,a++){let u;if(t[o+3]===0)u=255;else{let x=t[o],v=t[o+1],S=t[o+2];u=306*x+601*v+117*S+512>>10}r[a]=u}return r}getRow(t,e){if(t<0||t>=this.getHeight())throw new E("Requested row is outside the image: "+t);let i=this.getWidth(),r=t*i;return e===null?e=this.buffer.slice(r,r+i):(e.length<i&&(e=new Uint8ClampedArray(i)),e.set(this.buffer.slice(r,r+i))),e}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(t,e,i,r){return super.crop(t,e,i,r),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){let t=this.canvas.ownerDocument.createElement("canvas");t.width=this.canvas.width,t.height=this.canvas.height,this.tempCanvasElement=t}return this.tempCanvasElement}rotate(t){let e=this.getTempCanvasElement(),i=e.getContext("2d"),r=t*At.DEGREE_TO_RADIANS,o=this.canvas.width,a=this.canvas.height,l=Math.ceil(Math.abs(Math.cos(r))*o+Math.abs(Math.sin(r))*a),u=Math.ceil(Math.abs(Math.sin(r))*o+Math.abs(Math.cos(r))*a);return e.width=l,e.height=u,i.translate(l/2,u/2),i.rotate(r),i.drawImage(this.canvas,o/-2,a/-2),this.buffer=At.makeBufferFromCanvasImageData(e),this}invert(){return new Sn(this)}}At.DEGREE_TO_RADIANS=Math.PI/180;class ge{constructor(t,e,i){this.deviceId=t,this.label=e,this.kind="videoinput",this.groupId=i||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var ie=(globalThis||global||self||window||void 0)&&(globalThis||global||self||window||void 0).__awaiter||function(p,t,e,i){function r(o){return o instanceof e?o:new e(function(a){a(o)})}return new(e||(e=Promise))(function(o,a){function l(x){try{f(i.next(x))}catch(v){a(v)}}function u(x){try{f(i.throw(x))}catch(v){a(v)}}function f(x){x.done?o(x.value):r(x.value).then(l,u)}f((i=i.apply(p,t||[])).next())})};class Ie{constructor(t,e=500,i){this.reader=t,this.timeBetweenScansMillis=e,this._hints=i,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(t){this._timeBetweenDecodingAttempts=t<0?0:t}set hints(t){this._hints=t||null}get hints(){return this._hints}listVideoInputDevices(){return ie(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");let t=yield navigator.mediaDevices.enumerateDevices(),e=[];for(let i of t){let r=i.kind==="video"?"videoinput":i.kind;if(r!=="videoinput")continue;let o=i.deviceId||i.id,a=i.label||`Video device ${e.length+1}`,l=i.groupId,u={deviceId:o,label:a,kind:r,groupId:l};e.push(u)}return e})}getVideoInputDevices(){return ie(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(e=>new ge(e.deviceId,e.label))})}findDeviceById(t){return ie(this,void 0,void 0,function*(){let e=yield this.listVideoInputDevices();return e?e.find(i=>i.deviceId===t):null})}decodeFromInputVideoDevice(t,e){return ie(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(t,e)})}decodeOnceFromVideoDevice(t,e){return ie(this,void 0,void 0,function*(){this.reset();let i;t?i={deviceId:{exact:t}}:i={facingMode:"environment"};let r={video:i};return yield this.decodeOnceFromConstraints(r,e)})}decodeOnceFromConstraints(t,e){return ie(this,void 0,void 0,function*(){let i=yield navigator.mediaDevices.getUserMedia(t);return yield this.decodeOnceFromStream(i,e)})}decodeOnceFromStream(t,e){return ie(this,void 0,void 0,function*(){this.reset();let i=yield this.attachStreamToVideo(t,e);return yield this.decodeOnce(i)})}decodeFromInputVideoDeviceContinuously(t,e,i){return ie(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(t,e,i)})}decodeFromVideoDevice(t,e,i){return ie(this,void 0,void 0,function*(){let r;t?r={deviceId:{exact:t}}:r={facingMode:"environment"};let o={video:r};return yield this.decodeFromConstraints(o,e,i)})}decodeFromConstraints(t,e,i){return ie(this,void 0,void 0,function*(){let r=yield navigator.mediaDevices.getUserMedia(t);return yield this.decodeFromStream(r,e,i)})}decodeFromStream(t,e,i){return ie(this,void 0,void 0,function*(){this.reset();let r=yield this.attachStreamToVideo(t,e);return yield this.decodeContinuously(r,i)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(t,e){return ie(this,void 0,void 0,function*(){let i=this.prepareVideoElement(e);return this.addVideoSource(i,t),this.videoElement=i,this.stream=t,yield this.playVideoOnLoadAsync(i),i})}playVideoOnLoadAsync(t){return new Promise((e,i)=>this.playVideoOnLoad(t,()=>e()))}playVideoOnLoad(t,e){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(t),t.addEventListener("ended",this.videoEndedListener),t.addEventListener("canplay",this.videoCanPlayListener),t.addEventListener("playing",e),this.tryPlayVideo(t)}isVideoPlaying(t){return t.currentTime>0&&!t.paused&&!t.ended&&t.readyState>2}tryPlayVideo(t){return ie(this,void 0,void 0,function*(){if(this.isVideoPlaying(t)){console.warn("Trying to play video that is already playing.");return}try{yield t.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(t,e){let i=document.getElementById(t);if(!i)throw new H(`element with id '${t}' not found`);if(i.nodeName.toLowerCase()!==e.toLowerCase())throw new H(`element with id '${t}' must be an ${e} element`);return i}decodeFromImage(t,e){if(!t&&!e)throw new H("either imageElement with a src set or an url must be provided");return e&&!t?this.decodeFromImageUrl(e):this.decodeFromImageElement(t)}decodeFromVideo(t,e){if(!t&&!e)throw new H("Either an element with a src set or an URL must be provided");return e&&!t?this.decodeFromVideoUrl(e):this.decodeFromVideoElement(t)}decodeFromVideoContinuously(t,e,i){if(t===void 0&&e===void 0)throw new H("Either an element with a src set or an URL must be provided");return e&&!t?this.decodeFromVideoUrlContinuously(e,i):this.decodeFromVideoElementContinuously(t,i)}decodeFromImageElement(t){if(!t)throw new H("An image element must be provided.");this.reset();let e=this.prepareImageElement(t);this.imageElement=e;let i;return this.isImageLoaded(e)?i=this.decodeOnce(e,!1,!0):i=this._decodeOnLoadImage(e),i}decodeFromVideoElement(t){let e=this._decodeFromVideoElementSetup(t);return this._decodeOnLoadVideo(e)}decodeFromVideoElementContinuously(t,e){let i=this._decodeFromVideoElementSetup(t);return this._decodeOnLoadVideoContinuously(i,e)}_decodeFromVideoElementSetup(t){if(!t)throw new H("A video element must be provided.");this.reset();let e=this.prepareVideoElement(t);return this.videoElement=e,e}decodeFromImageUrl(t){if(!t)throw new H("An URL must be provided.");this.reset();let e=this.prepareImageElement();this.imageElement=e;let i=this._decodeOnLoadImage(e);return e.src=t,i}decodeFromVideoUrl(t){if(!t)throw new H("An URL must be provided.");this.reset();let e=this.prepareVideoElement(),i=this.decodeFromVideoElement(e);return e.src=t,i}decodeFromVideoUrlContinuously(t,e){if(!t)throw new H("An URL must be provided.");this.reset();let i=this.prepareVideoElement(),r=this.decodeFromVideoElementContinuously(i,e);return i.src=t,r}_decodeOnLoadImage(t){return new Promise((e,i)=>{this.imageLoadedListener=()=>this.decodeOnce(t,!1,!0).then(e,i),t.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(t){return ie(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(t),yield this.decodeOnce(t)})}_decodeOnLoadVideoContinuously(t,e){return ie(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(t),this.decodeContinuously(t,e)})}isImageLoaded(t){return!(!t.complete||t.naturalWidth===0)}prepareImageElement(t){let e;return typeof t>"u"&&(e=document.createElement("img"),e.width=200,e.height=200),typeof t=="string"&&(e=this.getMediaElement(t,"img")),t instanceof HTMLImageElement&&(e=t),e}prepareVideoElement(t){let e;return!t&&typeof document<"u"&&(e=document.createElement("video"),e.width=200,e.height=200),typeof t=="string"&&(e=this.getMediaElement(t,"video")),t instanceof HTMLVideoElement&&(e=t),e.setAttribute("autoplay","true"),e.setAttribute("muted","true"),e.setAttribute("playsinline","true"),e}decodeOnce(t,e=!0,i=!0){this._stopAsyncDecode=!1;let r=(o,a)=>{if(this._stopAsyncDecode){a(new Y("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{let l=this.decode(t);o(l)}catch(l){let u=e&&l instanceof Y,x=(l instanceof $||l instanceof tt)&&i;if(u||x)return setTimeout(r,this._timeBetweenDecodingAttempts,o,a);a(l)}};return new Promise((o,a)=>r(o,a))}decodeContinuously(t,e){this._stopContinuousDecode=!1;let i=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{let r=this.decode(t);e(r,null),setTimeout(i,this.timeBetweenScansMillis)}catch(r){e(null,r);let o=r instanceof $||r instanceof tt,a=r instanceof Y;(o||a)&&setTimeout(i,this._timeBetweenDecodingAttempts)}};i()}decode(t){let e=this.createBinaryBitmap(t);return this.decodeBitmap(e)}_isHTMLVideoElement(t){return t.videoWidth!==0}drawFrameOnCanvas(t,e,i){e||(e={sx:0,sy:0,sWidth:t.videoWidth,sHeight:t.videoHeight,dx:0,dy:0,dWidth:t.videoWidth,dHeight:t.videoHeight}),i||(i=this.captureCanvasContext),i.drawImage(t,e.sx,e.sy,e.sWidth,e.sHeight,e.dx,e.dy,e.dWidth,e.dHeight)}drawImageOnCanvas(t,e,i=this.captureCanvasContext){e||(e={sx:0,sy:0,sWidth:t.naturalWidth,sHeight:t.naturalHeight,dx:0,dy:0,dWidth:t.naturalWidth,dHeight:t.naturalHeight}),i||(i=this.captureCanvasContext),i.drawImage(t,e.sx,e.sy,e.sWidth,e.sHeight,e.dx,e.dy,e.dWidth,e.dHeight)}createBinaryBitmap(t){let e=this.getCaptureCanvasContext(t);this._isHTMLVideoElement(t)?this.drawFrameOnCanvas(t):this.drawImageOnCanvas(t);let i=this.getCaptureCanvas(t),r=new At(i),o=new Mt(r);return new Z(o)}getCaptureCanvasContext(t){if(!this.captureCanvasContext){let i=this.getCaptureCanvas(t).getContext("2d");this.captureCanvasContext=i}return this.captureCanvasContext}getCaptureCanvas(t){if(!this.captureCanvas){let e=this.createCaptureCanvas(t);this.captureCanvas=e}return this.captureCanvas}decodeBitmap(t){return this.reader.decode(t,this._hints)}createCaptureCanvas(t){if(typeof document>"u")return this._destroyCaptureCanvas(),null;let e=document.createElement("canvas"),i,r;return typeof t<"u"&&(t instanceof HTMLVideoElement?(i=t.videoWidth,r=t.videoHeight):t instanceof HTMLImageElement&&(i=t.naturalWidth||t.width,r=t.naturalHeight||t.height)),e.style.width=i+"px",e.style.height=r+"px",e.width=i,e.height=r,e}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(t=>t.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(t,e){try{t.srcObject=e}catch{t.src=URL.createObjectURL(e)}}cleanVideoSource(t){try{t.srcObject=null}catch{t.src=""}this.videoElement.removeAttribute("src")}}class Zt{constructor(t,e,i=e==null?0:8*e.length,r,o,a=st.currentTimeMillis()){this.text=t,this.rawBytes=e,this.numBits=i,this.resultPoints=r,this.format=o,this.timestamp=a,this.text=t,this.rawBytes=e,i==null?this.numBits=e==null?0:8*e.length:this.numBits=i,this.resultPoints=r,this.format=o,this.resultMetadata=null,a==null?this.timestamp=st.currentTimeMillis():this.timestamp=a}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(t,e){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(t,e)}putAllMetadata(t){t!==null&&(this.resultMetadata===null?this.resultMetadata=t:this.resultMetadata=new Map(t))}addResultPoints(t){let e=this.resultPoints;if(e===null)this.resultPoints=t;else if(t!==null&&t.length>0){let i=new Array(e.length+t.length);st.arraycopy(e,0,i,0,e.length),st.arraycopy(t,0,i,e.length,t.length),this.resultPoints=i}}getTimestamp(){return this.timestamp}toString(){return this.text}}var ee=function(p){return p[p.AZTEC=0]="AZTEC",p[p.CODABAR=1]="CODABAR",p[p.CODE_39=2]="CODE_39",p[p.CODE_93=3]="CODE_93",p[p.CODE_128=4]="CODE_128",p[p.DATA_MATRIX=5]="DATA_MATRIX",p[p.EAN_8=6]="EAN_8",p[p.EAN_13=7]="EAN_13",p[p.ITF=8]="ITF",p[p.MAXICODE=9]="MAXICODE",p[p.PDF_417=10]="PDF_417",p[p.QR_CODE=11]="QR_CODE",p[p.RSS_14=12]="RSS_14",p[p.RSS_EXPANDED=13]="RSS_EXPANDED",p[p.UPC_A=14]="UPC_A",p[p.UPC_E=15]="UPC_E",p[p.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION",p}(ee||{}),it=ee,pn=function(p){return p[p.OTHER=0]="OTHER",p[p.ORIENTATION=1]="ORIENTATION",p[p.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",p[p.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",p[p.ISSUE_NUMBER=4]="ISSUE_NUMBER",p[p.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",p[p.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",p[p.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",p[p.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",p[p.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",p[p.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY",p}(pn||{}),fe=pn;class ei{constructor(t,e,i,r,o=-1,a=-1){this.rawBytes=t,this.text=e,this.byteSegments=i,this.ecLevel=r,this.structuredAppendSequenceNumber=o,this.structuredAppendParity=a,this.numBits=t==null?0:8*t.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(t){this.numBits=t}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(t){this.errorsCorrected=t}getErasures(){return this.erasures}setErasures(t){this.erasures=t}getOther(){return this.other}setOther(t){this.other=t}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class Vn{exp(t){return this.expTable[t]}log(t){if(t===0)throw new E;return this.logTable[t]}static addOrSubtract(t,e){return t^e}}class ke{constructor(t,e){if(e.length===0)throw new E;this.field=t;let i=e.length;if(i>1&&e[0]===0){let r=1;for(;r<i&&e[r]===0;)r++;r===i?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(i-r),st.arraycopy(e,r,this.coefficients,0,this.coefficients.length))}else this.coefficients=e}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(t){return this.coefficients[this.coefficients.length-1-t]}evaluateAt(t){if(t===0)return this.getCoefficient(0);let e=this.coefficients,i;if(t===1){i=0;for(let a=0,l=e.length;a!==l;a++){let u=e[a];i=Vn.addOrSubtract(i,u)}return i}i=e[0];let r=e.length,o=this.field;for(let a=1;a<r;a++)i=Vn.addOrSubtract(o.multiply(t,i),e[a]);return i}addOrSubtract(t){if(!this.field.equals(t.field))throw new E("GenericGFPolys do not have same GenericGF field");if(this.isZero())return t;if(t.isZero())return this;let e=this.coefficients,i=t.coefficients;if(e.length>i.length){let a=e;e=i,i=a}let r=new Int32Array(i.length),o=i.length-e.length;st.arraycopy(i,0,r,0,o);for(let a=o;a<i.length;a++)r[a]=Vn.addOrSubtract(e[a-o],i[a]);return new ke(this.field,r)}multiply(t){if(!this.field.equals(t.field))throw new E("GenericGFPolys do not have same GenericGF field");if(this.isZero()||t.isZero())return this.field.getZero();let e=this.coefficients,i=e.length,r=t.coefficients,o=r.length,a=new Int32Array(i+o-1),l=this.field;for(let u=0;u<i;u++){let f=e[u];for(let x=0;x<o;x++)a[u+x]=Vn.addOrSubtract(a[u+x],l.multiply(f,r[x]))}return new ke(l,a)}multiplyScalar(t){if(t===0)return this.field.getZero();if(t===1)return this;let e=this.coefficients.length,i=this.field,r=new Int32Array(e),o=this.coefficients;for(let a=0;a<e;a++)r[a]=i.multiply(o[a],t);return new ke(i,r)}multiplyByMonomial(t,e){if(t<0)throw new E;if(e===0)return this.field.getZero();let i=this.coefficients,r=i.length,o=new Int32Array(r+t),a=this.field;for(let l=0;l<r;l++)o[l]=a.multiply(i[l],e);return new ke(a,o)}divide(t){if(!this.field.equals(t.field))throw new E("GenericGFPolys do not have same GenericGF field");if(t.isZero())throw new E("Divide by 0");let e=this.field,i=e.getZero(),r=this,o=t.getCoefficient(t.getDegree()),a=e.inverse(o);for(;r.getDegree()>=t.getDegree()&&!r.isZero();){let l=r.getDegree()-t.getDegree(),u=e.multiply(r.getCoefficient(r.getDegree()),a),f=t.multiplyByMonomial(l,u),x=e.buildMonomial(l,u);i=i.addOrSubtract(x),r=r.addOrSubtract(f)}return[i,r]}toString(){let t="";for(let e=this.getDegree();e>=0;e--){let i=this.getCoefficient(e);if(i!==0){if(i<0?(t+=" - ",i=-i):t.length>0&&(t+=" + "),e===0||i!==1){let r=this.field.log(i);r===0?t+="1":r===1?t+="a":(t+="a^",t+=r)}e!==0&&(e===1?t+="x":(t+="x^",t+=e))}}return t}}let Zn=(()=>{class p extends P{}return p.kind="ArithmeticException",p})();class jt extends Vn{constructor(t,e,i){super(),this.primitive=t,this.size=e,this.generatorBase=i;let r=new Int32Array(e),o=1;for(let l=0;l<e;l++)r[l]=o,o*=2,o>=e&&(o^=t,o&=e-1);this.expTable=r;let a=new Int32Array(e);for(let l=0;l<e-1;l++)a[r[l]]=l;this.logTable=a,this.zero=new ke(this,Int32Array.from([0])),this.one=new ke(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(t,e){if(t<0)throw new E;if(e===0)return this.zero;let i=new Int32Array(t+1);return i[0]=e,new ke(this,i)}inverse(t){if(t===0)throw new Zn;return this.expTable[this.size-this.logTable[t]-1]}multiply(t,e){return t===0||e===0?0:this.expTable[(this.logTable[t]+this.logTable[e])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+gt.toHexString(this.primitive)+","+this.size+")"}equals(t){return t===this}}jt.AZTEC_DATA_12=new jt(4201,4096,1),jt.AZTEC_DATA_10=new jt(1033,1024,1),jt.AZTEC_DATA_6=new jt(67,64,1),jt.AZTEC_PARAM=new jt(19,16,1),jt.QR_CODE_FIELD_256=new jt(285,256,0),jt.DATA_MATRIX_FIELD_256=new jt(301,256,1),jt.AZTEC_DATA_8=jt.DATA_MATRIX_FIELD_256,jt.MAXICODE_FIELD_64=jt.AZTEC_DATA_6;let mi=(()=>{class p extends P{}return p.kind="ReedSolomonException",p})(),gn=(()=>{class p extends P{}return p.kind="IllegalStateException",p})();class ni{constructor(t){this.field=t}decode(t,e){let i=this.field,r=new ke(i,t),o=new Int32Array(e),a=!0;for(let b=0;b<e;b++){let N=r.evaluateAt(i.exp(b+i.getGeneratorBase()));o[o.length-1-b]=N,N!==0&&(a=!1)}if(a)return;let l=new ke(i,o),u=this.runEuclideanAlgorithm(i.buildMonomial(e,1),l,e),f=u[0],x=u[1],v=this.findErrorLocations(f),S=this.findErrorMagnitudes(x,v);for(let b=0;b<v.length;b++){let N=t.length-1-i.log(v[b]);if(N<0)throw new mi("Bad error location");t[N]=jt.addOrSubtract(t[N],S[b])}}runEuclideanAlgorithm(t,e,i){if(t.getDegree()<e.getDegree()){let b=t;t=e,e=b}let r=this.field,o=t,a=e,l=r.getZero(),u=r.getOne();for(;a.getDegree()>=(i/2|0);){let b=o,N=l;if(o=a,l=u,o.isZero())throw new mi("r_{i-1} was zero");a=b;let R=r.getZero(),F=o.getCoefficient(o.getDegree()),V=r.inverse(F);for(;a.getDegree()>=o.getDegree()&&!a.isZero();){let J=a.getDegree()-o.getDegree(),ot=r.multiply(a.getCoefficient(a.getDegree()),V);R=R.addOrSubtract(r.buildMonomial(J,ot)),a=a.addOrSubtract(o.multiplyByMonomial(J,ot))}if(u=R.multiply(l).addOrSubtract(N),a.getDegree()>=o.getDegree())throw new gn("Division algorithm failed to reduce polynomial?")}let f=u.getCoefficient(0);if(f===0)throw new mi("sigmaTilde(0) was zero");let x=r.inverse(f),v=u.multiplyScalar(x),S=a.multiplyScalar(x);return[v,S]}findErrorLocations(t){let e=t.getDegree();if(e===1)return Int32Array.from([t.getCoefficient(1)]);let i=new Int32Array(e),r=0,o=this.field;for(let a=1;a<o.getSize()&&r<e;a++)t.evaluateAt(a)===0&&(i[r]=o.inverse(a),r++);if(r!==e)throw new mi("Error locator degree does not match number of roots");return i}findErrorMagnitudes(t,e){let i=e.length,r=new Int32Array(i),o=this.field;for(let a=0;a<i;a++){let l=o.inverse(e[a]),u=1;for(let f=0;f<i;f++)if(a!==f){let x=o.multiply(e[f],l),v=x&1?x&-2:x|1;u=o.multiply(u,v)}r[a]=o.multiply(t.evaluateAt(l),o.inverse(u)),o.getGeneratorBase()!==0&&(r[a]=o.multiply(r[a],l))}return r}}var Ne=function(p){return p[p.UPPER=0]="UPPER",p[p.LOWER=1]="LOWER",p[p.MIXED=2]="MIXED",p[p.DIGIT=3]="DIGIT",p[p.PUNCT=4]="PUNCT",p[p.BINARY=5]="BINARY",p}(Ne||{});let ii=(()=>{class p{decode(e){this.ddata=e;let i=e.getBits(),r=this.extractBits(i),o=this.correctBits(r),a=p.convertBoolArrayToByteArray(o),l=p.getEncodedData(o),u=new ei(a,l,null,null);return u.setNumBits(o.length),u}static highLevelDecode(e){return this.getEncodedData(e)}static getEncodedData(e){let i=e.length,r=Ne.UPPER,o=Ne.UPPER,a="",l=0;for(;l<i;)if(o===Ne.BINARY){if(i-l<5)break;let u=p.readCode(e,l,5);if(l+=5,u===0){if(i-l<11)break;u=p.readCode(e,l,11)+31,l+=11}for(let f=0;f<u;f++){if(i-l<8){l=i;break}let x=p.readCode(e,l,8);a+=wt.castAsNonUtf8Char(x),l+=8}o=r}else{let u=o===Ne.DIGIT?4:5;if(i-l<u)break;let f=p.readCode(e,l,u);l+=u;let x=p.getCharacter(o,f);x.startsWith("CTRL_")?(r=o,o=p.getTable(x.charAt(5)),x.charAt(6)==="L"&&(r=o)):(a+=x,o=r)}return a}static getTable(e){switch(e){case"L":return Ne.LOWER;case"P":return Ne.PUNCT;case"M":return Ne.MIXED;case"D":return Ne.DIGIT;case"B":return Ne.BINARY;case"U":default:return Ne.UPPER}}static getCharacter(e,i){switch(e){case Ne.UPPER:return p.UPPER_TABLE[i];case Ne.LOWER:return p.LOWER_TABLE[i];case Ne.MIXED:return p.MIXED_TABLE[i];case Ne.PUNCT:return p.PUNCT_TABLE[i];case Ne.DIGIT:return p.DIGIT_TABLE[i];default:throw new gn("Bad table")}}correctBits(e){let i,r;this.ddata.getNbLayers()<=2?(r=6,i=jt.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(r=8,i=jt.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(r=10,i=jt.AZTEC_DATA_10):(r=12,i=jt.AZTEC_DATA_12);let o=this.ddata.getNbDatablocks(),a=e.length/r;if(a<o)throw new tt;let l=e.length%r,u=new Int32Array(a);for(let b=0;b<a;b++,l+=r)u[b]=p.readCode(e,l,r);try{new ni(i).decode(u,a-o)}catch(b){throw new tt(b)}let f=(1<<r)-1,x=0;for(let b=0;b<o;b++){let N=u[b];if(N===0||N===f)throw new tt;(N===1||N===f-1)&&x++}let v=new Array(o*r-x),S=0;for(let b=0;b<o;b++){let N=u[b];if(N===1||N===f-1)v.fill(N>1,S,S+r-1),S+=r-1;else for(let R=r-1;R>=0;--R)v[S++]=(N&1<<R)!==0}return v}extractBits(e){let i=this.ddata.isCompact(),r=this.ddata.getNbLayers(),o=(i?11:14)+r*4,a=new Int32Array(o),l=new Array(this.totalBitsInLayer(r,i));if(i)for(let u=0;u<a.length;u++)a[u]=u;else{let u=o+1+2*gt.truncDivision(gt.truncDivision(o,2)-1,15),f=o/2,x=gt.truncDivision(u,2);for(let v=0;v<f;v++){let S=v+gt.truncDivision(v,15);a[f-v-1]=x-S-1,a[f+v]=x+S+1}}for(let u=0,f=0;u<r;u++){let x=(r-u)*4+(i?9:12),v=u*2,S=o-1-v;for(let b=0;b<x;b++){let N=b*2;for(let R=0;R<2;R++)l[f+N+R]=e.get(a[v+R],a[v+b]),l[f+2*x+N+R]=e.get(a[v+b],a[S-R]),l[f+4*x+N+R]=e.get(a[S-R],a[S-b]),l[f+6*x+N+R]=e.get(a[S-b],a[v+R])}f+=x*8}return l}static readCode(e,i,r){let o=0;for(let a=i;a<i+r;a++)o<<=1,e[a]&&(o|=1);return o}static readByte(e,i){let r=e.length-i;return r>=8?p.readCode(e,i,8):p.readCode(e,i,r)<<8-r}static convertBoolArrayToByteArray(e){let i=new Uint8Array((e.length+7)/8);for(let r=0;r<i.length;r++)i[r]=p.readByte(e,8*r);return i}totalBitsInLayer(e,i){return((i?88:112)+16*e)*e}}return p.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],p.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],p.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],p.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],p.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"],p})();class Xt{constructor(){}static round(t){return t===NaN?0:t<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:t>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:t+(t<0?-.5:.5)|0}static distance(t,e,i,r){let o=t-i,a=e-r;return Math.sqrt(o*o+a*a)}static sum(t){let e=0;for(let i=0,r=t.length;i!==r;i++){let o=t[i];e+=o}return e}}class _i{static floatToIntBits(t){return t}}_i.MAX_VALUE=Number.MAX_SAFE_INTEGER;class mt{constructor(t,e){this.x=t,this.y=e}getX(){return this.x}getY(){return this.y}equals(t){if(t instanceof mt){let e=t;return this.x===e.x&&this.y===e.y}return!1}hashCode(){return 31*_i.floatToIntBits(this.x)+_i.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(t){let e=this.distance(t[0],t[1]),i=this.distance(t[1],t[2]),r=this.distance(t[0],t[2]),o,a,l;if(i>=e&&i>=r?(a=t[0],o=t[1],l=t[2]):r>=i&&r>=e?(a=t[1],o=t[0],l=t[2]):(a=t[2],o=t[0],l=t[1]),this.crossProductZ(o,a,l)<0){let u=o;o=l,l=u}t[0]=o,t[1]=a,t[2]=l}static distance(t,e){return Xt.distance(t.x,t.y,e.x,e.y)}static crossProductZ(t,e,i){let r=e.x,o=e.y;return(i.x-r)*(t.y-o)-(i.y-o)*(t.x-r)}}class xi{constructor(t,e){this.bits=t,this.points=e}getBits(){return this.bits}getPoints(){return this.points}}class ir extends xi{constructor(t,e,i,r,o){super(t,e),this.compact=i,this.nbDatablocks=r,this.nbLayers=o}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}let Ri=(()=>{class p{constructor(e,i,r,o){this.image=e,this.height=e.getHeight(),this.width=e.getWidth(),i==null&&(i=p.INIT_SIZE),r==null&&(r=e.getWidth()/2|0),o==null&&(o=e.getHeight()/2|0);let a=i/2|0;if(this.leftInit=r-a,this.rightInit=r+a,this.upInit=o-a,this.downInit=o+a,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new Y}detect(){let e=this.leftInit,i=this.rightInit,r=this.upInit,o=this.downInit,a=!1,l=!0,u=!1,f=!1,x=!1,v=!1,S=!1,b=this.width,N=this.height;for(;l;){l=!1;let R=!0;for(;(R||!f)&&i<b;)R=this.containsBlackPoint(r,o,i,!1),R?(i++,l=!0,f=!0):f||i++;if(i>=b){a=!0;break}let F=!0;for(;(F||!x)&&o<N;)F=this.containsBlackPoint(e,i,o,!0),F?(o++,l=!0,x=!0):x||o++;if(o>=N){a=!0;break}let V=!0;for(;(V||!v)&&e>=0;)V=this.containsBlackPoint(r,o,e,!1),V?(e--,l=!0,v=!0):v||e--;if(e<0){a=!0;break}let J=!0;for(;(J||!S)&&r>=0;)J=this.containsBlackPoint(e,i,r,!0),J?(r--,l=!0,S=!0):S||r--;if(r<0){a=!0;break}l&&(u=!0)}if(!a&&u){let R=i-e,F=null;for(let X=1;F===null&&X<R;X++)F=this.getBlackPointOnSegment(e,o-X,e+X,o);if(F==null)throw new Y;let V=null;for(let X=1;V===null&&X<R;X++)V=this.getBlackPointOnSegment(e,r+X,e+X,r);if(V==null)throw new Y;let J=null;for(let X=1;J===null&&X<R;X++)J=this.getBlackPointOnSegment(i,r+X,i-X,r);if(J==null)throw new Y;let ot=null;for(let X=1;ot===null&&X<R;X++)ot=this.getBlackPointOnSegment(i,o-X,i-X,o);if(ot==null)throw new Y;return this.centerEdges(ot,F,J,V)}else throw new Y}getBlackPointOnSegment(e,i,r,o){let a=Xt.round(Xt.distance(e,i,r,o)),l=(r-e)/a,u=(o-i)/a,f=this.image;for(let x=0;x<a;x++){let v=Xt.round(e+x*l),S=Xt.round(i+x*u);if(f.get(v,S))return new mt(v,S)}return null}centerEdges(e,i,r,o){let a=e.getX(),l=e.getY(),u=i.getX(),f=i.getY(),x=r.getX(),v=r.getY(),S=o.getX(),b=o.getY(),N=p.CORR;return a<this.width/2?[new mt(S-N,b+N),new mt(u+N,f+N),new mt(x-N,v-N),new mt(a+N,l-N)]:[new mt(S+N,b+N),new mt(u+N,f-N),new mt(x-N,v+N),new mt(a-N,l-N)]}containsBlackPoint(e,i,r,o){let a=this.image;if(o){for(let l=e;l<=i;l++)if(a.get(l,r))return!0}else for(let l=e;l<=i;l++)if(a.get(r,l))return!0;return!1}}return p.INIT_SIZE=10,p.CORR=1,p})();class rr{static checkAndNudgePoints(t,e){let i=t.getWidth(),r=t.getHeight(),o=!0;for(let a=0;a<e.length&&o;a+=2){let l=Math.floor(e[a]),u=Math.floor(e[a+1]);if(l<-1||l>i||u<-1||u>r)throw new Y;o=!1,l===-1?(e[a]=0,o=!0):l===i&&(e[a]=i-1,o=!0),u===-1?(e[a+1]=0,o=!0):u===r&&(e[a+1]=r-1,o=!0)}o=!0;for(let a=e.length-2;a>=0&&o;a-=2){let l=Math.floor(e[a]),u=Math.floor(e[a+1]);if(l<-1||l>i||u<-1||u>r)throw new Y;o=!1,l===-1?(e[a]=0,o=!0):l===i&&(e[a]=i-1,o=!0),u===-1?(e[a+1]=0,o=!0):u===r&&(e[a+1]=r-1,o=!0)}}}class Qe{constructor(t,e,i,r,o,a,l,u,f){this.a11=t,this.a21=e,this.a31=i,this.a12=r,this.a22=o,this.a32=a,this.a13=l,this.a23=u,this.a33=f}static quadrilateralToQuadrilateral(t,e,i,r,o,a,l,u,f,x,v,S,b,N,R,F){let V=Qe.quadrilateralToSquare(t,e,i,r,o,a,l,u);return Qe.squareToQuadrilateral(f,x,v,S,b,N,R,F).times(V)}transformPoints(t){let e=t.length,i=this.a11,r=this.a12,o=this.a13,a=this.a21,l=this.a22,u=this.a23,f=this.a31,x=this.a32,v=this.a33;for(let S=0;S<e;S+=2){let b=t[S],N=t[S+1],R=o*b+u*N+v;t[S]=(i*b+a*N+f)/R,t[S+1]=(r*b+l*N+x)/R}}transformPointsWithValues(t,e){let i=this.a11,r=this.a12,o=this.a13,a=this.a21,l=this.a22,u=this.a23,f=this.a31,x=this.a32,v=this.a33,S=t.length;for(let b=0;b<S;b++){let N=t[b],R=e[b],F=o*N+u*R+v;t[b]=(i*N+a*R+f)/F,e[b]=(r*N+l*R+x)/F}}static squareToQuadrilateral(t,e,i,r,o,a,l,u){let f=t-i+o-l,x=e-r+a-u;if(f===0&&x===0)return new Qe(i-t,o-i,t,r-e,a-r,e,0,0,1);{let v=i-o,S=l-o,b=r-a,N=u-a,R=v*N-S*b,F=(f*N-S*x)/R,V=(v*x-f*b)/R;return new Qe(i-t+F*i,l-t+V*l,t,r-e+F*r,u-e+V*u,e,F,V,1)}}static quadrilateralToSquare(t,e,i,r,o,a,l,u){return Qe.squareToQuadrilateral(t,e,i,r,o,a,l,u).buildAdjoint()}buildAdjoint(){return new Qe(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(t){return new Qe(this.a11*t.a11+this.a21*t.a12+this.a31*t.a13,this.a11*t.a21+this.a21*t.a22+this.a31*t.a23,this.a11*t.a31+this.a21*t.a32+this.a31*t.a33,this.a12*t.a11+this.a22*t.a12+this.a32*t.a13,this.a12*t.a21+this.a22*t.a22+this.a32*t.a23,this.a12*t.a31+this.a22*t.a32+this.a32*t.a33,this.a13*t.a11+this.a23*t.a12+this.a33*t.a13,this.a13*t.a21+this.a23*t.a22+this.a33*t.a23,this.a13*t.a31+this.a23*t.a32+this.a33*t.a33)}}class or extends rr{sampleGrid(t,e,i,r,o,a,l,u,f,x,v,S,b,N,R,F,V,J,ot){let X=Qe.quadrilateralToQuadrilateral(r,o,a,l,u,f,x,v,S,b,N,R,F,V,J,ot);return this.sampleGridWithTransform(t,e,i,X)}sampleGridWithTransform(t,e,i,r){if(e<=0||i<=0)throw new Y;let o=new le(e,i),a=new Float32Array(2*e);for(let l=0;l<i;l++){let u=a.length,f=l+.5;for(let x=0;x<u;x+=2)a[x]=x/2+.5,a[x+1]=f;r.transformPoints(a),rr.checkAndNudgePoints(t,a);try{for(let x=0;x<u;x+=2)t.get(Math.floor(a[x]),Math.floor(a[x+1]))&&o.set(x/2,l)}catch{throw new Y}}return o}}class In{static setGridSampler(t){In.gridSampler=t}static getInstance(){return In.gridSampler}}In.gridSampler=new or;class Ve{constructor(t,e){this.x=t,this.y=e}toResultPoint(){return new mt(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class sr{constructor(t){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=t}detect(){return this.detectMirror(!1)}detectMirror(t){let e=this.getMatrixCenter(),i=this.getBullsEyeCorners(e);if(t){let a=i[0];i[0]=i[2],i[2]=a}this.extractParameters(i);let r=this.sampleGrid(this.image,i[this.shift%4],i[(this.shift+1)%4],i[(this.shift+2)%4],i[(this.shift+3)%4]),o=this.getMatrixCornerPoints(i);return new ir(r,o,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(t){if(!this.isValidPoint(t[0])||!this.isValidPoint(t[1])||!this.isValidPoint(t[2])||!this.isValidPoint(t[3]))throw new Y;let e=2*this.nbCenterLayers,i=new Int32Array([this.sampleLine(t[0],t[1],e),this.sampleLine(t[1],t[2],e),this.sampleLine(t[2],t[3],e),this.sampleLine(t[3],t[0],e)]);this.shift=this.getRotation(i,e);let r=0;for(let a=0;a<4;a++){let l=i[(this.shift+a)%4];this.compact?(r<<=7,r+=l>>1&127):(r<<=10,r+=(l>>2&992)+(l>>1&31))}let o=this.getCorrectedParameterData(r,this.compact);this.compact?(this.nbLayers=(o>>6)+1,this.nbDataBlocks=(o&63)+1):(this.nbLayers=(o>>11)+1,this.nbDataBlocks=(o&2047)+1)}getRotation(t,e){let i=0;t.forEach((r,o,a)=>{let l=(r>>e-2<<1)+(r&1);i=(i<<3)+l}),i=((i&1)<<11)+(i>>1);for(let r=0;r<4;r++)if(gt.bitCount(i^this.EXPECTED_CORNER_BITS[r])<=2)return r;throw new Y}getCorrectedParameterData(t,e){let i,r;e?(i=7,r=2):(i=10,r=4);let o=i-r,a=new Int32Array(i);for(let u=i-1;u>=0;--u)a[u]=t&15,t>>=4;try{new ni(jt.AZTEC_PARAM).decode(a,o)}catch{throw new Y}let l=0;for(let u=0;u<r;u++)l=(l<<4)+a[u];return l}getBullsEyeCorners(t){let e=t,i=t,r=t,o=t,a=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let v=this.getFirstDifferent(e,a,1,-1),S=this.getFirstDifferent(i,a,1,1),b=this.getFirstDifferent(r,a,-1,1),N=this.getFirstDifferent(o,a,-1,-1);if(this.nbCenterLayers>2){let R=this.distancePoint(N,v)*this.nbCenterLayers/(this.distancePoint(o,e)*(this.nbCenterLayers+2));if(R<.75||R>1.25||!this.isWhiteOrBlackRectangle(v,S,b,N))break}e=v,i=S,r=b,o=N,a=!a}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new Y;this.compact=this.nbCenterLayers===5;let l=new mt(e.getX()+.5,e.getY()-.5),u=new mt(i.getX()+.5,i.getY()+.5),f=new mt(r.getX()-.5,r.getY()+.5),x=new mt(o.getX()-.5,o.getY()-.5);return this.expandSquare([l,u,f,x],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let t,e,i,r;try{let l=new Ri(this.image).detect();t=l[0],e=l[1],i=l[2],r=l[3]}catch{let u=this.image.getWidth()/2,f=this.image.getHeight()/2;t=this.getFirstDifferent(new Ve(u+7,f-7),!1,1,-1).toResultPoint(),e=this.getFirstDifferent(new Ve(u+7,f+7),!1,1,1).toResultPoint(),i=this.getFirstDifferent(new Ve(u-7,f+7),!1,-1,1).toResultPoint(),r=this.getFirstDifferent(new Ve(u-7,f-7),!1,-1,-1).toResultPoint()}let o=Xt.round((t.getX()+r.getX()+e.getX()+i.getX())/4),a=Xt.round((t.getY()+r.getY()+e.getY()+i.getY())/4);try{let l=new Ri(this.image,15,o,a).detect();t=l[0],e=l[1],i=l[2],r=l[3]}catch{t=this.getFirstDifferent(new Ve(o+7,a-7),!1,1,-1).toResultPoint(),e=this.getFirstDifferent(new Ve(o+7,a+7),!1,1,1).toResultPoint(),i=this.getFirstDifferent(new Ve(o-7,a+7),!1,-1,1).toResultPoint(),r=this.getFirstDifferent(new Ve(o-7,a-7),!1,-1,-1).toResultPoint()}return o=Xt.round((t.getX()+r.getX()+e.getX()+i.getX())/4),a=Xt.round((t.getY()+r.getY()+e.getY()+i.getY())/4),new Ve(o,a)}getMatrixCornerPoints(t){return this.expandSquare(t,2*this.nbCenterLayers,this.getDimension())}sampleGrid(t,e,i,r,o){let a=In.getInstance(),l=this.getDimension(),u=l/2-this.nbCenterLayers,f=l/2+this.nbCenterLayers;return a.sampleGrid(t,l,l,u,u,f,u,f,f,u,f,e.getX(),e.getY(),i.getX(),i.getY(),r.getX(),r.getY(),o.getX(),o.getY())}sampleLine(t,e,i){let r=0,o=this.distanceResultPoint(t,e),a=o/i,l=t.getX(),u=t.getY(),f=a*(e.getX()-t.getX())/o,x=a*(e.getY()-t.getY())/o;for(let v=0;v<i;v++)this.image.get(Xt.round(l+v*f),Xt.round(u+v*x))&&(r|=1<<i-v-1);return r}isWhiteOrBlackRectangle(t,e,i,r){let o=3;t=new Ve(t.getX()-o,t.getY()+o),e=new Ve(e.getX()-o,e.getY()-o),i=new Ve(i.getX()+o,i.getY()-o),r=new Ve(r.getX()+o,r.getY()+o);let a=this.getColor(r,t);if(a===0)return!1;let l=this.getColor(t,e);return l!==a||(l=this.getColor(e,i),l!==a)?!1:(l=this.getColor(i,r),l===a)}getColor(t,e){let i=this.distancePoint(t,e),r=(e.getX()-t.getX())/i,o=(e.getY()-t.getY())/i,a=0,l=t.getX(),u=t.getY(),f=this.image.get(t.getX(),t.getY()),x=Math.ceil(i);for(let S=0;S<x;S++)l+=r,u+=o,this.image.get(Xt.round(l),Xt.round(u))!==f&&a++;let v=a/i;return v>.1&&v<.9?0:v<=.1===f?1:-1}getFirstDifferent(t,e,i,r){let o=t.getX()+i,a=t.getY()+r;for(;this.isValid(o,a)&&this.image.get(o,a)===e;)o+=i,a+=r;for(o-=i,a-=r;this.isValid(o,a)&&this.image.get(o,a)===e;)o+=i;for(o-=i;this.isValid(o,a)&&this.image.get(o,a)===e;)a+=r;return a-=r,new Ve(o,a)}expandSquare(t,e,i){let r=i/(2*e),o=t[0].getX()-t[2].getX(),a=t[0].getY()-t[2].getY(),l=(t[0].getX()+t[2].getX())/2,u=(t[0].getY()+t[2].getY())/2,f=new mt(l+r*o,u+r*a),x=new mt(l-r*o,u-r*a);o=t[1].getX()-t[3].getX(),a=t[1].getY()-t[3].getY(),l=(t[1].getX()+t[3].getX())/2,u=(t[1].getY()+t[3].getY())/2;let v=new mt(l+r*o,u+r*a),S=new mt(l-r*o,u-r*a);return[f,v,x,S]}isValid(t,e){return t>=0&&t<this.image.getWidth()&&e>0&&e<this.image.getHeight()}isValidPoint(t){let e=Xt.round(t.getX()),i=Xt.round(t.getY());return this.isValid(e,i)}distancePoint(t,e){return Xt.distance(t.getX(),t.getY(),e.getX(),e.getY())}distanceResultPoint(t,e){return Xt.distance(t.getX(),t.getY(),e.getX(),e.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(gt.truncDivision(this.nbLayers-4,8)+1)+15}}class wi{decode(t,e=null){let i=null,r=new sr(t.getBlackMatrix()),o=null,a=null;try{let x=r.detectMirror(!1);o=x.getPoints(),this.reportFoundResultPoints(e,o),a=new ii().decode(x)}catch(x){i=x}if(a==null)try{let x=r.detectMirror(!0);o=x.getPoints(),this.reportFoundResultPoints(e,o),a=new ii().decode(x)}catch(x){throw i??x}let l=new Zt(a.getText(),a.getRawBytes(),a.getNumBits(),o,it.AZTEC,st.currentTimeMillis()),u=a.getByteSegments();u!=null&&l.putMetadata(fe.BYTE_SEGMENTS,u);let f=a.getECLevel();return f!=null&&l.putMetadata(fe.ERROR_CORRECTION_LEVEL,f),l}reportFoundResultPoints(t,e){if(t!=null){let i=t.get(Ut.NEED_RESULT_POINT_CALLBACK);i!=null&&e.forEach((r,o,a)=>{i.foundPossibleResultPoint(r)})}}reset(){}}class lo extends Ie{constructor(t=500){super(new wi,t)}}class Ee{decode(t,e){try{return this.doDecode(t,e)}catch{if(e&&e.get(Ut.TRY_HARDER)===!0&&t.isRotateSupported()){let o=t.rotateCounterClockwise(),a=this.doDecode(o,e),l=a.getResultMetadata(),u=270;l!==null&&l.get(fe.ORIENTATION)===!0&&(u=u+l.get(fe.ORIENTATION)%360),a.putMetadata(fe.ORIENTATION,u);let f=a.getResultPoints();if(f!==null){let x=o.getHeight();for(let v=0;v<f.length;v++)f[v]=new mt(x-f[v].getY()-1,f[v].getX())}return a}else throw new Y}}reset(){}doDecode(t,e){let i=t.getWidth(),r=t.getHeight(),o=new Ft(i),a=e&&e.get(Ut.TRY_HARDER)===!0,l=Math.max(1,r>>(a?8:5)),u;a?u=r:u=15;let f=Math.trunc(r/2);for(let x=0;x<u;x++){let v=Math.trunc((x+1)/2),S=(x&1)===0,b=f+l*(S?v:-v);if(b<0||b>=r)break;try{o=t.getBlackRow(b,o)}catch{continue}for(let N=0;N<2;N++){if(N===1&&(o.reverse(),e&&e.get(Ut.NEED_RESULT_POINT_CALLBACK)===!0)){let R=new Map;e.forEach((F,V)=>R.set(V,F)),R.delete(Ut.NEED_RESULT_POINT_CALLBACK),e=R}try{let R=this.decodeRow(b,o,e);if(N===1){R.putMetadata(fe.ORIENTATION,180);let F=R.getResultPoints();F!==null&&(F[0]=new mt(i-F[0].getX()-1,F[0].getY()),F[1]=new mt(i-F[1].getX()-1,F[1].getY()))}return R}catch{}}}throw new Y}static recordPattern(t,e,i){let r=i.length;for(let f=0;f<r;f++)i[f]=0;let o=t.getSize();if(e>=o)throw new Y;let a=!t.get(e),l=0,u=e;for(;u<o;){if(t.get(u)!==a)i[l]++;else{if(++l===r)break;i[l]=1,a=!a}u++}if(!(l===r||l===r-1&&u===o))throw new Y}static recordPatternInReverse(t,e,i){let r=i.length,o=t.get(e);for(;e>0&&r>=0;)t.get(--e)!==o&&(r--,o=!o);if(r>=0)throw new Y;Ee.recordPattern(t,e+1,i)}static patternMatchVariance(t,e,i){let r=t.length,o=0,a=0;for(let f=0;f<r;f++)o+=t[f],a+=e[f];if(o<a)return Number.POSITIVE_INFINITY;let l=o/a;i*=l;let u=0;for(let f=0;f<r;f++){let x=t[f],v=e[f]*l,S=x>v?x-v:v-x;if(S>i)return Number.POSITIVE_INFINITY;u+=S}return u/o}}class rt extends Ee{static findStartPattern(t){let e=t.getSize(),i=t.getNextSet(0),r=0,o=Int32Array.from([0,0,0,0,0,0]),a=i,l=!1,u=6;for(let f=i;f<e;f++)if(t.get(f)!==l)o[r]++;else{if(r===u-1){let x=rt.MAX_AVG_VARIANCE,v=-1;for(let S=rt.CODE_START_A;S<=rt.CODE_START_C;S++){let b=Ee.patternMatchVariance(o,rt.CODE_PATTERNS[S],rt.MAX_INDIVIDUAL_VARIANCE);b<x&&(x=b,v=S)}if(v>=0&&t.isRange(Math.max(0,a-(f-a)/2),a,!1))return Int32Array.from([a,f,v]);a+=o[0]+o[1],o=o.slice(2,o.length-1),o[r-1]=0,o[r]=0,r--}else r++;o[r]=1,l=!l}throw new Y}static decodeCode(t,e,i){Ee.recordPattern(t,i,e);let r=rt.MAX_AVG_VARIANCE,o=-1;for(let a=0;a<rt.CODE_PATTERNS.length;a++){let l=rt.CODE_PATTERNS[a],u=this.patternMatchVariance(e,l,rt.MAX_INDIVIDUAL_VARIANCE);u<r&&(r=u,o=a)}if(o>=0)return o;throw new Y}decodeRow(t,e,i){let r=i&&i.get(Ut.ASSUME_GS1)===!0,o=rt.findStartPattern(e),a=o[2],l=0,u=new Uint8Array(20);u[l++]=a;let f;switch(a){case rt.CODE_START_A:f=rt.CODE_CODE_A;break;case rt.CODE_START_B:f=rt.CODE_CODE_B;break;case rt.CODE_START_C:f=rt.CODE_CODE_C;break;default:throw new tt}let x=!1,v=!1,S="",b=o[0],N=o[1],R=Int32Array.from([0,0,0,0,0,0]),F=0,V=0,J=a,ot=0,X=!0,Pt=!1,Ot=!1;for(;!x;){let yn=v;switch(v=!1,F=V,V=rt.decodeCode(e,R,N),u[l++]=V,V!==rt.CODE_STOP&&(X=!0),V!==rt.CODE_STOP&&(ot++,J+=ot*V),b=N,N+=R.reduce((Eo,pi)=>Eo+pi,0),V){case rt.CODE_START_A:case rt.CODE_START_B:case rt.CODE_START_C:throw new tt}switch(f){case rt.CODE_CODE_A:if(V<64)Ot===Pt?S+=String.fromCharCode(32+V):S+=String.fromCharCode(32+V+128),Ot=!1;else if(V<96)Ot===Pt?S+=String.fromCharCode(V-64):S+=String.fromCharCode(V+64),Ot=!1;else switch(V!==rt.CODE_STOP&&(X=!1),V){case rt.CODE_FNC_1:r&&(S.length===0?S+="]C1":S+="");break;case rt.CODE_FNC_2:case rt.CODE_FNC_3:break;case rt.CODE_FNC_4_A:!Pt&&Ot?(Pt=!0,Ot=!1):Pt&&Ot?(Pt=!1,Ot=!1):Ot=!0;break;case rt.CODE_SHIFT:v=!0,f=rt.CODE_CODE_B;break;case rt.CODE_CODE_B:f=rt.CODE_CODE_B;break;case rt.CODE_CODE_C:f=rt.CODE_CODE_C;break;case rt.CODE_STOP:x=!0;break}break;case rt.CODE_CODE_B:if(V<96)Ot===Pt?S+=String.fromCharCode(32+V):S+=String.fromCharCode(32+V+128),Ot=!1;else switch(V!==rt.CODE_STOP&&(X=!1),V){case rt.CODE_FNC_1:r&&(S.length===0?S+="]C1":S+="");break;case rt.CODE_FNC_2:case rt.CODE_FNC_3:break;case rt.CODE_FNC_4_B:!Pt&&Ot?(Pt=!0,Ot=!1):Pt&&Ot?(Pt=!1,Ot=!1):Ot=!0;break;case rt.CODE_SHIFT:v=!0,f=rt.CODE_CODE_A;break;case rt.CODE_CODE_A:f=rt.CODE_CODE_A;break;case rt.CODE_CODE_C:f=rt.CODE_CODE_C;break;case rt.CODE_STOP:x=!0;break}break;case rt.CODE_CODE_C:if(V<100)V<10&&(S+="0"),S+=V;else switch(V!==rt.CODE_STOP&&(X=!1),V){case rt.CODE_FNC_1:r&&(S.length===0?S+="]C1":S+="");break;case rt.CODE_CODE_A:f=rt.CODE_CODE_A;break;case rt.CODE_CODE_B:f=rt.CODE_CODE_B;break;case rt.CODE_STOP:x=!0;break}break}yn&&(f=f===rt.CODE_CODE_A?rt.CODE_CODE_B:rt.CODE_CODE_A)}let ye=N-b;if(N=e.getNextUnset(N),!e.isRange(N,Math.min(e.getSize(),N+(N-b)/2),!1))throw new Y;if(J-=ot*F,J%103!==F)throw new $;let Ge=S.length;if(Ge===0)throw new Y;Ge>0&&X&&(f===rt.CODE_CODE_C?S=S.substring(0,Ge-2):S=S.substring(0,Ge-1));let je=(o[1]+o[0])/2,te=b+ye/2,Be=u.length,Xe=new Uint8Array(Be);for(let yn=0;yn<Be;yn++)Xe[yn]=u[yn];let fi=[new mt(je,t),new mt(te,t)];return new Zt(S,Xe,0,fi,it.CODE_128,new Date().getTime())}}rt.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],rt.MAX_AVG_VARIANCE=.25,rt.MAX_INDIVIDUAL_VARIANCE=.7,rt.CODE_SHIFT=98,rt.CODE_CODE_C=99,rt.CODE_CODE_B=100,rt.CODE_CODE_A=101,rt.CODE_FNC_1=102,rt.CODE_FNC_2=97,rt.CODE_FNC_3=96,rt.CODE_FNC_4_A=101,rt.CODE_FNC_4_B=100,rt.CODE_START_A=103,rt.CODE_START_B=104,rt.CODE_START_C=105,rt.CODE_STOP=106;let Pi=(()=>{class p extends Ee{constructor(e=!1,i=!1){super(),this.usingCheckDigit=e,this.extendedMode=i,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(e,i,r){let o=this.counters;o.fill(0),this.decodeRowResult="";let a=p.findAsteriskPattern(i,o),l=i.getNextSet(a[1]),u=i.getSize(),f,x;do{p.recordPattern(i,l,o);let F=p.toNarrowWidePattern(o);if(F<0)throw new Y;f=p.patternToChar(F),this.decodeRowResult+=f,x=l;for(let V of o)l+=V;l=i.getNextSet(l)}while(f!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let v=0;for(let F of o)v+=F;let S=l-x-v;if(l!==u&&S*2<v)throw new Y;if(this.usingCheckDigit){let F=this.decodeRowResult.length-1,V=0;for(let J=0;J<F;J++)V+=p.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(J));if(this.decodeRowResult.charAt(F)!==p.ALPHABET_STRING.charAt(V%43))throw new $;this.decodeRowResult=this.decodeRowResult.substring(0,F)}if(this.decodeRowResult.length===0)throw new Y;let b;this.extendedMode?b=p.decodeExtended(this.decodeRowResult):b=this.decodeRowResult;let N=(a[1]+a[0])/2,R=x+v/2;return new Zt(b,null,0,[new mt(N,e),new mt(R,e)],it.CODE_39,new Date().getTime())}static findAsteriskPattern(e,i){let r=e.getSize(),o=e.getNextSet(0),a=0,l=o,u=!1,f=i.length;for(let x=o;x<r;x++)if(e.get(x)!==u)i[a]++;else{if(a===f-1){if(this.toNarrowWidePattern(i)===p.ASTERISK_ENCODING&&e.isRange(Math.max(0,l-Math.floor((x-l)/2)),l,!1))return[l,x];l+=i[0]+i[1],i.copyWithin(0,2,2+a-1),i[a-1]=0,i[a]=0,a--}else a++;i[a]=1,u=!u}throw new Y}static toNarrowWidePattern(e){let i=e.length,r=0,o;do{let a=2147483647;for(let f of e)f<a&&f>r&&(a=f);r=a,o=0;let l=0,u=0;for(let f=0;f<i;f++){let x=e[f];x>r&&(u|=1<<i-1-f,o++,l+=x)}if(o===3){for(let f=0;f<i&&o>0;f++){let x=e[f];if(x>r&&(o--,x*2>=l))return-1}return u}}while(o>3);return-1}static patternToChar(e){for(let i=0;i<p.CHARACTER_ENCODINGS.length;i++)if(p.CHARACTER_ENCODINGS[i]===e)return p.ALPHABET_STRING.charAt(i);if(e===p.ASTERISK_ENCODING)return"*";throw new Y}static decodeExtended(e){let i=e.length,r="";for(let o=0;o<i;o++){let a=e.charAt(o);if(a==="+"||a==="$"||a==="%"||a==="/"){let l=e.charAt(o+1),u="\0";switch(a){case"+":if(l>="A"&&l<="Z")u=String.fromCharCode(l.charCodeAt(0)+32);else throw new tt;break;case"$":if(l>="A"&&l<="Z")u=String.fromCharCode(l.charCodeAt(0)-64);else throw new tt;break;case"%":if(l>="A"&&l<="E")u=String.fromCharCode(l.charCodeAt(0)-38);else if(l>="F"&&l<="J")u=String.fromCharCode(l.charCodeAt(0)-11);else if(l>="K"&&l<="O")u=String.fromCharCode(l.charCodeAt(0)+16);else if(l>="P"&&l<="T")u=String.fromCharCode(l.charCodeAt(0)+43);else if(l==="U")u="\0";else if(l==="V")u="@";else if(l==="W")u="`";else if(l==="X"||l==="Y"||l==="Z")u="\x7F";else throw new tt;break;case"/":if(l>="A"&&l<="O")u=String.fromCharCode(l.charCodeAt(0)-32);else if(l==="Z")u=":";else throw new tt;break}r+=u,o++}else r+=a}return r}}return p.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",p.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],p.ASTERISK_ENCODING=148,p})();class se extends Ee{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(t,e,i){let r=this.decodeStart(e),o=this.decodeEnd(e),a=new ne;se.decodeMiddle(e,r[1],o[0],a);let l=a.toString(),u=null;i!=null&&(u=i.get(Ut.ALLOWED_LENGTHS)),u==null&&(u=se.DEFAULT_ALLOWED_LENGTHS);let f=l.length,x=!1,v=0;for(let N of u){if(f===N){x=!0;break}N>v&&(v=N)}if(!x&&f>v&&(x=!0),!x)throw new tt;let S=[new mt(r[1],t),new mt(o[0],t)];return new Zt(l,null,0,S,it.ITF,new Date().getTime())}static decodeMiddle(t,e,i,r){let o=new Int32Array(10),a=new Int32Array(5),l=new Int32Array(5);for(o.fill(0),a.fill(0),l.fill(0);e<i;){Ee.recordPattern(t,e,o);for(let f=0;f<5;f++){let x=2*f;a[f]=o[x],l[f]=o[x+1]}let u=se.decodeDigit(a);r.append(u.toString()),u=this.decodeDigit(l),r.append(u.toString()),o.forEach(function(f){e+=f})}}decodeStart(t){let e=se.skipWhiteSpace(t),i=se.findGuardPattern(t,e,se.START_PATTERN);return this.narrowLineWidth=(i[1]-i[0])/4,this.validateQuietZone(t,i[0]),i}validateQuietZone(t,e){let i=this.narrowLineWidth*10;i=i<e?i:e;for(let r=e-1;i>0&&r>=0&&!t.get(r);r--)i--;if(i!==0)throw new Y}static skipWhiteSpace(t){let e=t.getSize(),i=t.getNextSet(0);if(i===e)throw new Y;return i}decodeEnd(t){t.reverse();try{let e=se.skipWhiteSpace(t),i;try{i=se.findGuardPattern(t,e,se.END_PATTERN_REVERSED[0])}catch(o){o instanceof Y&&(i=se.findGuardPattern(t,e,se.END_PATTERN_REVERSED[1]))}this.validateQuietZone(t,i[0]);let r=i[0];return i[0]=t.getSize()-i[1],i[1]=t.getSize()-r,i}finally{t.reverse()}}static findGuardPattern(t,e,i){let r=i.length,o=new Int32Array(r),a=t.getSize(),l=!1,u=0,f=e;o.fill(0);for(let x=e;x<a;x++)if(t.get(x)!==l)o[u]++;else{if(u===r-1){if(Ee.patternMatchVariance(o,i,se.MAX_INDIVIDUAL_VARIANCE)<se.MAX_AVG_VARIANCE)return[f,x];f+=o[0]+o[1],st.arraycopy(o,2,o,0,u-1),o[u-1]=0,o[u]=0,u--}else u++;o[u]=1,l=!l}throw new Y}static decodeDigit(t){let e=se.MAX_AVG_VARIANCE,i=-1,r=se.PATTERNS.length;for(let o=0;o<r;o++){let a=se.PATTERNS[o],l=Ee.patternMatchVariance(t,a,se.MAX_INDIVIDUAL_VARIANCE);l<e?(e=l,i=o):l===e&&(i=-1)}if(i>=0)return i%10;throw new Y}}se.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],se.MAX_AVG_VARIANCE=.38,se.MAX_INDIVIDUAL_VARIANCE=.5,se.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],se.START_PATTERN=Int32Array.from([1,1,1,1]),se.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class ce extends Ee{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(t){let e=!1,i,r=0,o=Int32Array.from([0,0,0]);for(;!e;){o=Int32Array.from([0,0,0]),i=ce.findGuardPattern(t,r,!1,this.START_END_PATTERN,o);let a=i[0];r=i[1];let l=a-(r-a);l>=0&&(e=t.isRange(l,a,!1))}return i}static checkChecksum(t){return ce.checkStandardUPCEANChecksum(t)}static checkStandardUPCEANChecksum(t){let e=t.length;if(e===0)return!1;let i=parseInt(t.charAt(e-1),10);return ce.getStandardUPCEANChecksum(t.substring(0,e-1))===i}static getStandardUPCEANChecksum(t){let e=t.length,i=0;for(let r=e-1;r>=0;r-=2){let o=t.charAt(r).charCodeAt(0)-48;if(o<0||o>9)throw new tt;i+=o}i*=3;for(let r=e-2;r>=0;r-=2){let o=t.charAt(r).charCodeAt(0)-48;if(o<0||o>9)throw new tt;i+=o}return(1e3-i)%10}static decodeEnd(t,e){return ce.findGuardPattern(t,e,!1,ce.START_END_PATTERN,new Int32Array(ce.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(t,e,i,r){return this.findGuardPattern(t,e,i,r,new Int32Array(r.length))}static findGuardPattern(t,e,i,r,o){let a=t.getSize();e=i?t.getNextUnset(e):t.getNextSet(e);let l=0,u=e,f=r.length,x=i;for(let v=e;v<a;v++)if(t.get(v)!==x)o[l]++;else{if(l===f-1){if(Ee.patternMatchVariance(o,r,ce.MAX_INDIVIDUAL_VARIANCE)<ce.MAX_AVG_VARIANCE)return Int32Array.from([u,v]);u+=o[0]+o[1];let S=o.slice(2,o.length-1);for(let b=0;b<l-1;b++)o[b]=S[b];o[l-1]=0,o[l]=0,l--}else l++;o[l]=1,x=!x}throw new Y}static decodeDigit(t,e,i,r){this.recordPattern(t,i,e);let o=this.MAX_AVG_VARIANCE,a=-1,l=r.length;for(let u=0;u<l;u++){let f=r[u],x=Ee.patternMatchVariance(e,f,ce.MAX_INDIVIDUAL_VARIANCE);x<o&&(o=x,a=u)}if(a>=0)return a;throw new Y}}ce.MAX_AVG_VARIANCE=.48,ce.MAX_INDIVIDUAL_VARIANCE=.7,ce.START_END_PATTERN=Int32Array.from([1,1,1]),ce.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),ce.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),ce.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class yi{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(t,e,i){let r=this.decodeRowStringBuffer,o=this.decodeMiddle(e,i,r),a=r.toString(),l=yi.parseExtensionString(a),u=[new mt((i[0]+i[1])/2,t),new mt(o,t)],f=new Zt(a,null,0,u,it.UPC_EAN_EXTENSION,new Date().getTime());return l!=null&&f.putAllMetadata(l),f}decodeMiddle(t,e,i){let r=this.decodeMiddleCounters;r[0]=0,r[1]=0,r[2]=0,r[3]=0;let o=t.getSize(),a=e[1],l=0;for(let f=0;f<5&&a<o;f++){let x=ce.decodeDigit(t,r,a,ce.L_AND_G_PATTERNS);i+=String.fromCharCode(48+x%10);for(let v of r)a+=v;x>=10&&(l|=1<<4-f),f!==4&&(a=t.getNextSet(a),a=t.getNextUnset(a))}if(i.length!==5)throw new Y;let u=this.determineCheckDigit(l);if(yi.extensionChecksum(i.toString())!==u)throw new Y;return a}static extensionChecksum(t){let e=t.length,i=0;for(let r=e-2;r>=0;r-=2)i+=t.charAt(r).charCodeAt(0)-48;i*=3;for(let r=e-1;r>=0;r-=2)i+=t.charAt(r).charCodeAt(0)-48;return i*=3,i%10}determineCheckDigit(t){for(let e=0;e<10;e++)if(t===this.CHECK_DIGIT_ENCODINGS[e])return e;throw new Y}static parseExtensionString(t){if(t.length!==5)return null;let e=yi.parseExtension5String(t);return e==null?null:new Map([[fe.SUGGESTED_PRICE,e]])}static parseExtension5String(t){let e;switch(t.charAt(0)){case"0":e="\xA3";break;case"5":e="$";break;case"9":switch(t){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}e="";break;default:e="";break}let i=parseInt(t.substring(1)),r=(i/100).toString(),o=i%100,a=o<10?"0"+o:o.toString();return e+r+"."+a}}class ar{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(t,e,i){let r=this.decodeRowStringBuffer,o=this.decodeMiddle(e,i,r),a=r.toString(),l=ar.parseExtensionString(a),u=[new mt((i[0]+i[1])/2,t),new mt(o,t)],f=new Zt(a,null,0,u,it.UPC_EAN_EXTENSION,new Date().getTime());return l!=null&&f.putAllMetadata(l),f}decodeMiddle(t,e,i){let r=this.decodeMiddleCounters;r[0]=0,r[1]=0,r[2]=0,r[3]=0;let o=t.getSize(),a=e[1],l=0;for(let u=0;u<2&&a<o;u++){let f=ce.decodeDigit(t,r,a,ce.L_AND_G_PATTERNS);i+=String.fromCharCode(48+f%10);for(let x of r)a+=x;f>=10&&(l|=1<<1-u),u!==1&&(a=t.getNextSet(a),a=t.getNextUnset(a))}if(i.length!==2)throw new Y;if(parseInt(i.toString())%4!==l)throw new Y;return a}static parseExtensionString(t){return t.length!==2?null:new Map([[fe.ISSUE_NUMBER,parseInt(t)]])}}class lr{static decodeRow(t,e,i){let r=ce.findGuardPattern(e,i,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new yi().decodeRow(t,e,r)}catch{return new ar().decodeRow(t,e,r)}}}lr.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class Qt extends ce{constructor(){super(),this.decodeRowStringBuffer="",Qt.L_AND_G_PATTERNS=Qt.L_PATTERNS.map(t=>Int32Array.from(t));for(let t=10;t<20;t++){let e=Qt.L_PATTERNS[t-10],i=new Int32Array(e.length);for(let r=0;r<e.length;r++)i[r]=e[e.length-r-1];Qt.L_AND_G_PATTERNS[t]=i}}decodeRow(t,e,i){let r=Qt.findStartGuardPattern(e),o=i==null?null:i.get(Ut.NEED_RESULT_POINT_CALLBACK);if(o!=null){let X=new mt((r[0]+r[1])/2,t);o.foundPossibleResultPoint(X)}let a=this.decodeMiddle(e,r,this.decodeRowStringBuffer),l=a.rowOffset,u=a.resultString;if(o!=null){let X=new mt(l,t);o.foundPossibleResultPoint(X)}let f=this.decodeEnd(e,l);if(o!=null){let X=new mt((f[0]+f[1])/2,t);o.foundPossibleResultPoint(X)}let x=f[1],v=x+(x-f[0]);if(v>=e.getSize()||!e.isRange(x,v,!1))throw new Y;let S=u.toString();if(S.length<8)throw new tt;if(!Qt.checkChecksum(S))throw new $;let b=(r[1]+r[0])/2,N=(f[1]+f[0])/2,R=this.getBarcodeFormat(),F=[new mt(b,t),new mt(N,t)],V=new Zt(S,null,0,F,R,new Date().getTime()),J=0;try{let X=lr.decodeRow(t,e,f[1]);V.putMetadata(fe.UPC_EAN_EXTENSION,X.getText()),V.putAllMetadata(X.getResultMetadata()),V.addResultPoints(X.getResultPoints()),J=X.getText().length}catch{}let ot=i==null?null:i.get(Ut.ALLOWED_EAN_EXTENSIONS);if(ot!=null){let X=!1;for(let Pt in ot)if(J.toString()===Pt){X=!0;break}if(!X)throw new Y}return V}decodeEnd(t,e){return Qt.findGuardPattern(t,e,!1,Qt.START_END_PATTERN,new Int32Array(Qt.START_END_PATTERN.length).fill(0))}static checkChecksum(t){return Qt.checkStandardUPCEANChecksum(t)}static checkStandardUPCEANChecksum(t){let e=t.length;if(e===0)return!1;let i=parseInt(t.charAt(e-1),10);return Qt.getStandardUPCEANChecksum(t.substring(0,e-1))===i}static getStandardUPCEANChecksum(t){let e=t.length,i=0;for(let r=e-1;r>=0;r-=2){let o=t.charAt(r).charCodeAt(0)-48;if(o<0||o>9)throw new tt;i+=o}i*=3;for(let r=e-2;r>=0;r-=2){let o=t.charAt(r).charCodeAt(0)-48;if(o<0||o>9)throw new tt;i+=o}return(1e3-i)%10}}let Ci=(()=>{class p extends Qt{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(e,i,r){let o=this.decodeMiddleCounters;o[0]=0,o[1]=0,o[2]=0,o[3]=0;let a=e.getSize(),l=i[1],u=0;for(let x=0;x<6&&l<a;x++){let v=Qt.decodeDigit(e,o,l,Qt.L_AND_G_PATTERNS);r+=String.fromCharCode(48+v%10);for(let S of o)l+=S;v>=10&&(u|=1<<5-x)}r=p.determineFirstDigit(r,u),l=Qt.findGuardPattern(e,l,!0,Qt.MIDDLE_PATTERN,new Int32Array(Qt.MIDDLE_PATTERN.length).fill(0))[1];for(let x=0;x<6&&l<a;x++){let v=Qt.decodeDigit(e,o,l,Qt.L_PATTERNS);r+=String.fromCharCode(48+v);for(let S of o)l+=S}return{rowOffset:l,resultString:r}}getBarcodeFormat(){return it.EAN_13}static determineFirstDigit(e,i){for(let r=0;r<10;r++)if(i===this.FIRST_DIGIT_ENCODINGS[r])return e=String.fromCharCode(48+r)+e,e;throw new Y}}return p.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26],p})();class Nr extends Qt{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(t,e,i){let r=this.decodeMiddleCounters;r[0]=0,r[1]=0,r[2]=0,r[3]=0;let o=t.getSize(),a=e[1];for(let u=0;u<4&&a<o;u++){let f=Qt.decodeDigit(t,r,a,Qt.L_PATTERNS);i+=String.fromCharCode(48+f);for(let x of r)a+=x}a=Qt.findGuardPattern(t,a,!0,Qt.MIDDLE_PATTERN,new Int32Array(Qt.MIDDLE_PATTERN.length).fill(0))[1];for(let u=0;u<4&&a<o;u++){let f=Qt.decodeDigit(t,r,a,Qt.L_PATTERNS);i+=String.fromCharCode(48+f);for(let x of r)a+=x}return{rowOffset:a,resultString:i}}getBarcodeFormat(){return it.EAN_8}}class Or extends Qt{constructor(){super(...arguments),this.ean13Reader=new Ci}getBarcodeFormat(){return it.UPC_A}decode(t,e){return this.maybeReturnResult(this.ean13Reader.decode(t))}decodeRow(t,e,i){return this.maybeReturnResult(this.ean13Reader.decodeRow(t,e,i))}decodeMiddle(t,e,i){return this.ean13Reader.decodeMiddle(t,e,i)}maybeReturnResult(t){let e=t.getText();if(e.charAt(0)==="0"){let i=new Zt(e.substring(1),null,null,t.getResultPoints(),it.UPC_A);return t.getResultMetadata()!=null&&i.putAllMetadata(t.getResultMetadata()),i}else throw new Y}reset(){this.ean13Reader.reset()}}class ln extends Qt{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(t,e,i){let r=this.decodeMiddleCounters.map(f=>f);r[0]=0,r[1]=0,r[2]=0,r[3]=0;let o=t.getSize(),a=e[1],l=0;for(let f=0;f<6&&a<o;f++){let x=ln.decodeDigit(t,r,a,ln.L_AND_G_PATTERNS);i+=String.fromCharCode(48+x%10);for(let v of r)a+=v;x>=10&&(l|=1<<5-f)}let u=ln.determineNumSysAndCheckDigit(i,l);return{rowOffset:a,resultString:u}}decodeEnd(t,e){return ln.findGuardPatternWithoutCounters(t,e,!0,ln.MIDDLE_END_PATTERN)}checkChecksum(t){return Qt.checkChecksum(ln.convertUPCEtoUPCA(t))}static determineNumSysAndCheckDigit(t,e){for(let i=0;i<=1;i++)for(let r=0;r<10;r++)if(e===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[i][r]){let o=String.fromCharCode(48+i),a=String.fromCharCode(48+r);return o+t+a}throw Y.getNotFoundInstance()}getBarcodeFormat(){return it.UPC_E}static convertUPCEtoUPCA(t){let e=t.slice(1,7).split("").map(o=>o.charCodeAt(0)),i=new ne;i.append(t.charAt(0));let r=e[5];switch(r){case 0:case 1:case 2:i.appendChars(e,0,2),i.append(r),i.append("0000"),i.appendChars(e,2,3);break;case 3:i.appendChars(e,0,3),i.append("00000"),i.appendChars(e,3,2);break;case 4:i.appendChars(e,0,4),i.append("00000"),i.append(e[4]);break;default:i.appendChars(e,0,5),i.append("0000"),i.append(r);break}return t.length>=8&&i.append(t.charAt(7)),i.toString()}}ln.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),ln.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class cr extends Ee{constructor(t){super();let e=t==null?null:t.get(Ut.POSSIBLE_FORMATS),i=[];m(e)?(i.push(new Ci),i.push(new Or),i.push(new Nr),i.push(new ln)):(e.indexOf(it.EAN_13)>-1&&i.push(new Ci),e.indexOf(it.UPC_A)>-1&&i.push(new Or),e.indexOf(it.EAN_8)>-1&&i.push(new Nr),e.indexOf(it.UPC_E)>-1&&i.push(new ln)),this.readers=i}decodeRow(t,e,i){for(let r of this.readers)try{let o=r.decodeRow(t,e,i),a=o.getBarcodeFormat()===it.EAN_13&&o.getText().charAt(0)==="0",l=i==null?null:i.get(Ut.POSSIBLE_FORMATS),u=l==null||l.includes(it.UPC_A);if(a&&u){let f=o.getRawBytes(),x=new Zt(o.getText().substring(1),f,f?f.length:null,o.getResultPoints(),it.UPC_A);return x.putAllMetadata(o.getResultMetadata()),x}return o}catch{}throw new Y}reset(){for(let t of this.readers)t.reset()}}let Wn=(()=>{class p extends Ee{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(e,i){for(let r=0;r<i.length;r++)if(Ee.patternMatchVariance(e,i[r],p.MAX_INDIVIDUAL_VARIANCE)<p.MAX_AVG_VARIANCE)return r;throw new Y}static count(e){return Xt.sum(new Int32Array(e))}static increment(e,i){let r=0,o=i[0];for(let a=1;a<e.length;a++)i[a]>o&&(o=i[a],r=a);e[r]++}static decrement(e,i){let r=0,o=i[0];for(let a=1;a<e.length;a++)i[a]<o&&(o=i[a],r=a);e[r]--}static isFinderPattern(e){let i=e[0]+e[1],r=i+e[2]+e[3],o=i/r;if(o>=p.MIN_FINDER_PATTERN_RATIO&&o<=p.MAX_FINDER_PATTERN_RATIO){let a=Number.MAX_SAFE_INTEGER,l=Number.MIN_SAFE_INTEGER;for(let u of e)u>l&&(l=u),u<a&&(a=u);return l<10*a}return!1}}return p.MAX_AVG_VARIANCE=.2,p.MAX_INDIVIDUAL_VARIANCE=.45,p.MIN_FINDER_PATTERN_RATIO=9.5/12,p.MAX_FINDER_PATTERN_RATIO=12.5/14,p})();class ri{constructor(t,e){this.value=t,this.checksumPortion=e}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(t){if(!(t instanceof ri))return!1;let e=t;return this.value===e.value&&this.checksumPortion===e.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class oi{constructor(t,e,i,r,o){this.value=t,this.startEnd=e,this.value=t,this.startEnd=e,this.resultPoints=new Array,this.resultPoints.push(new mt(i,o)),this.resultPoints.push(new mt(r,o))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(t){if(!(t instanceof oi))return!1;let e=t;return this.value===e.value}hashCode(){return this.value}}class mn{constructor(){}static getRSSvalue(t,e,i){let r=0;for(let u of t)r+=u;let o=0,a=0,l=t.length;for(let u=0;u<l-1;u++){let f;for(f=1,a|=1<<u;f<t[u];f++,a&=~(1<<u)){let x=mn.combins(r-f-1,l-u-2);if(i&&a===0&&r-f-(l-u-1)>=l-u-1&&(x-=mn.combins(r-f-(l-u),l-u-2)),l-u-1>1){let v=0;for(let S=r-f-(l-u-2);S>e;S--)v+=mn.combins(r-f-S-1,l-u-3);x-=v*(l-1-u)}else r-f>e&&x--;o+=x}r-=f}return o}static combins(t,e){let i,r;t-e>e?(r=e,i=t-e):(r=t-e,i=e);let o=1,a=1;for(let l=t;l>i;l--)o*=l,a<=r&&(o/=a,a++);for(;a<=r;)o/=a,a++;return o}}class co{static buildBitArray(t){let e=t.length*2-1;t[t.length-1].getRightChar()==null&&(e-=1);let i=12*e,r=new Ft(i),o=0,l=t[0].getRightChar().getValue();for(let u=11;u>=0;--u)l&1<<u&&r.set(o),o++;for(let u=1;u<t.length;++u){let f=t[u],x=f.getLeftChar().getValue();for(let v=11;v>=0;--v)x&1<<v&&r.set(o),o++;if(f.getRightChar()!=null){let v=f.getRightChar().getValue();for(let S=11;S>=0;--S)v&1<<S&&r.set(o),o++}}return r}}class Gn{constructor(t,e){e?this.decodedInformation=null:(this.finished=t,this.decodedInformation=e)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class hr{constructor(t){this.newPosition=t}getNewPosition(){return this.newPosition}}let be=(()=>{class p extends hr{constructor(e,i){super(e),this.value=i}getValue(){return this.value}isFNC1(){return this.value===p.FNC1}}return p.FNC1="$",p})();class _t extends hr{constructor(t,e,i){super(t),i?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=e}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}let jn=(()=>{class p extends hr{constructor(e,i,r){if(super(e),i<0||i>10||r<0||r>10)throw new tt;this.firstDigit=i,this.secondDigit=r}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===p.FNC1}isSecondDigitFNC1(){return this.secondDigit===p.FNC1}isAnyFNC1(){return this.firstDigit===p.FNC1||this.secondDigit===p.FNC1}}return p.FNC1=10,p})();class ct{constructor(){}static parseFieldsInGeneralPurpose(t){if(!t)return null;if(t.length<2)throw new Y;let e=t.substring(0,2);for(let o of ct.TWO_DIGIT_DATA_LENGTH)if(o[0]===e)return o[1]===ct.VARIABLE_LENGTH?ct.processVariableAI(2,o[2],t):ct.processFixedAI(2,o[1],t);if(t.length<3)throw new Y;let i=t.substring(0,3);for(let o of ct.THREE_DIGIT_DATA_LENGTH)if(o[0]===i)return o[1]===ct.VARIABLE_LENGTH?ct.processVariableAI(3,o[2],t):ct.processFixedAI(3,o[1],t);for(let o of ct.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(o[0]===i)return o[1]===ct.VARIABLE_LENGTH?ct.processVariableAI(4,o[2],t):ct.processFixedAI(4,o[1],t);if(t.length<4)throw new Y;let r=t.substring(0,4);for(let o of ct.FOUR_DIGIT_DATA_LENGTH)if(o[0]===r)return o[1]===ct.VARIABLE_LENGTH?ct.processVariableAI(4,o[2],t):ct.processFixedAI(4,o[1],t);throw new Y}static processFixedAI(t,e,i){if(i.length<t)throw new Y;let r=i.substring(0,t);if(i.length<t+e)throw new Y;let o=i.substring(t,t+e),a=i.substring(t+e),l="("+r+")"+o,u=ct.parseFieldsInGeneralPurpose(a);return u==null?l:l+u}static processVariableAI(t,e,i){let r=i.substring(0,t),o;i.length<t+e?o=i.length:o=t+e;let a=i.substring(t,o),l=i.substring(o),u="("+r+")"+a,f=ct.parseFieldsInGeneralPurpose(l);return f==null?u:u+f}}ct.VARIABLE_LENGTH=[],ct.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",ct.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",ct.VARIABLE_LENGTH,20],["22",ct.VARIABLE_LENGTH,29],["30",ct.VARIABLE_LENGTH,8],["37",ct.VARIABLE_LENGTH,8],["90",ct.VARIABLE_LENGTH,30],["91",ct.VARIABLE_LENGTH,30],["92",ct.VARIABLE_LENGTH,30],["93",ct.VARIABLE_LENGTH,30],["94",ct.VARIABLE_LENGTH,30],["95",ct.VARIABLE_LENGTH,30],["96",ct.VARIABLE_LENGTH,30],["97",ct.VARIABLE_LENGTH,3],["98",ct.VARIABLE_LENGTH,30],["99",ct.VARIABLE_LENGTH,30]],ct.THREE_DIGIT_DATA_LENGTH=[["240",ct.VARIABLE_LENGTH,30],["241",ct.VARIABLE_LENGTH,30],["242",ct.VARIABLE_LENGTH,6],["250",ct.VARIABLE_LENGTH,30],["251",ct.VARIABLE_LENGTH,30],["253",ct.VARIABLE_LENGTH,17],["254",ct.VARIABLE_LENGTH,20],["400",ct.VARIABLE_LENGTH,30],["401",ct.VARIABLE_LENGTH,30],["402",17],["403",ct.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",ct.VARIABLE_LENGTH,20],["421",ct.VARIABLE_LENGTH,15],["422",3],["423",ct.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],ct.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",ct.VARIABLE_LENGTH,15],["391",ct.VARIABLE_LENGTH,18],["392",ct.VARIABLE_LENGTH,15],["393",ct.VARIABLE_LENGTH,18],["703",ct.VARIABLE_LENGTH,30]],ct.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",ct.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",ct.VARIABLE_LENGTH,20],["8003",ct.VARIABLE_LENGTH,30],["8004",ct.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",ct.VARIABLE_LENGTH,30],["8008",ct.VARIABLE_LENGTH,12],["8018",18],["8020",ct.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",ct.VARIABLE_LENGTH,70],["8200",ct.VARIABLE_LENGTH,70]];class Xn{constructor(t){this.buffer=new ne,this.information=t}decodeAllCodes(t,e){let i=e,r=null;do{let o=this.decodeGeneralPurposeField(i,r),a=ct.parseFieldsInGeneralPurpose(o.getNewString());if(a!=null&&t.append(a),o.isRemaining()?r=""+o.getRemainingValue():r=null,i===o.getNewPosition())break;i=o.getNewPosition()}while(!0);return t.toString()}isStillNumeric(t){if(t+7>this.information.getSize())return t+4<=this.information.getSize();for(let e=t;e<t+3;++e)if(this.information.get(e))return!0;return this.information.get(t+3)}decodeNumeric(t){if(t+7>this.information.getSize()){let o=this.extractNumericValueFromBitArray(t,4);return o===0?new jn(this.information.getSize(),jn.FNC1,jn.FNC1):new jn(this.information.getSize(),o-1,jn.FNC1)}let e=this.extractNumericValueFromBitArray(t,7),i=(e-8)/11,r=(e-8)%11;return new jn(t+7,i,r)}extractNumericValueFromBitArray(t,e){return Xn.extractNumericValueFromBitArray(this.information,t,e)}static extractNumericValueFromBitArray(t,e,i){let r=0;for(let o=0;o<i;++o)t.get(e+o)&&(r|=1<<i-o-1);return r}decodeGeneralPurposeField(t,e){this.buffer.setLengthToZero(),e!=null&&this.buffer.append(e),this.current.setPosition(t);let i=this.parseBlocks();return i!=null&&i.isRemaining()?new _t(this.current.getPosition(),this.buffer.toString(),i.getRemainingValue()):new _t(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let t,e;do{let i=this.current.getPosition();if(this.current.isAlpha()?(e=this.parseAlphaBlock(),t=e.isFinished()):this.current.isIsoIec646()?(e=this.parseIsoIec646Block(),t=e.isFinished()):(e=this.parseNumericBlock(),t=e.isFinished()),!(i!==this.current.getPosition())&&!t)break}while(!t);return e.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let t=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(t.getNewPosition()),t.isFirstDigitFNC1()){let e;return t.isSecondDigitFNC1()?e=new _t(this.current.getPosition(),this.buffer.toString()):e=new _t(this.current.getPosition(),this.buffer.toString(),t.getSecondDigit()),new Gn(!0,e)}if(this.buffer.append(t.getFirstDigit()),t.isSecondDigitFNC1()){let e=new _t(this.current.getPosition(),this.buffer.toString());return new Gn(!0,e)}this.buffer.append(t.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new Gn(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let t=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(t.getNewPosition()),t.isFNC1()){let e=new _t(this.current.getPosition(),this.buffer.toString());return new Gn(!0,e)}this.buffer.append(t.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new Gn(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let t=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(t.getNewPosition()),t.isFNC1()){let e=new _t(this.current.getPosition(),this.buffer.toString());return new Gn(!0,e)}this.buffer.append(t.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new Gn(!1)}isStillIsoIec646(t){if(t+5>this.information.getSize())return!1;let e=this.extractNumericValueFromBitArray(t,5);if(e>=5&&e<16)return!0;if(t+7>this.information.getSize())return!1;let i=this.extractNumericValueFromBitArray(t,7);if(i>=64&&i<116)return!0;if(t+8>this.information.getSize())return!1;let r=this.extractNumericValueFromBitArray(t,8);return r>=232&&r<253}decodeIsoIec646(t){let e=this.extractNumericValueFromBitArray(t,5);if(e===15)return new be(t+5,be.FNC1);if(e>=5&&e<15)return new be(t+5,"0"+(e-5));let i=this.extractNumericValueFromBitArray(t,7);if(i>=64&&i<90)return new be(t+7,""+(i+1));if(i>=90&&i<116)return new be(t+7,""+(i+7));let r=this.extractNumericValueFromBitArray(t,8),o;switch(r){case 232:o="!";break;case 233:o='"';break;case 234:o="%";break;case 235:o="&";break;case 236:o="'";break;case 237:o="(";break;case 238:o=")";break;case 239:o="*";break;case 240:o="+";break;case 241:o=",";break;case 242:o="-";break;case 243:o=".";break;case 244:o="/";break;case 245:o=":";break;case 246:o=";";break;case 247:o="<";break;case 248:o="=";break;case 249:o=">";break;case 250:o="?";break;case 251:o="_";break;case 252:o=" ";break;default:throw new tt}return new be(t+8,o)}isStillAlpha(t){if(t+5>this.information.getSize())return!1;let e=this.extractNumericValueFromBitArray(t,5);if(e>=5&&e<16)return!0;if(t+6>this.information.getSize())return!1;let i=this.extractNumericValueFromBitArray(t,6);return i>=16&&i<63}decodeAlphanumeric(t){let e=this.extractNumericValueFromBitArray(t,5);if(e===15)return new be(t+5,be.FNC1);if(e>=5&&e<15)return new be(t+5,"0"+(e-5));let i=this.extractNumericValueFromBitArray(t,6);if(i>=32&&i<58)return new be(t+6,""+(i+33));let r;switch(i){case 58:r="*";break;case 59:r=",";break;case 60:r="-";break;case 61:r=".";break;case 62:r="/";break;default:throw new gn("Decoding invalid alphanumeric value: "+i)}return new be(t+6,r)}isAlphaTo646ToAlphaLatch(t){if(t+1>this.information.getSize())return!1;for(let e=0;e<5&&e+t<this.information.getSize();++e)if(e===2){if(!this.information.get(t+2))return!1}else if(this.information.get(t+e))return!1;return!0}isAlphaOr646ToNumericLatch(t){if(t+3>this.information.getSize())return!1;for(let e=t;e<t+3;++e)if(this.information.get(e))return!1;return!0}isNumericToAlphaNumericLatch(t){if(t+1>this.information.getSize())return!1;for(let e=0;e<4&&e+t<this.information.getSize();++e)if(this.information.get(t+e))return!1;return!0}}class Bi{constructor(t){this.information=t,this.generalDecoder=new Xn(t)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}let qe=(()=>{class p extends Bi{constructor(e){super(e)}encodeCompressedGtin(e,i){e.append("(01)");let r=e.length();e.append("9"),this.encodeCompressedGtinWithoutAI(e,i,r)}encodeCompressedGtinWithoutAI(e,i,r){for(let o=0;o<4;++o){let a=this.getGeneralDecoder().extractNumericValueFromBitArray(i+10*o,10);a/100===0&&e.append("0"),a/10===0&&e.append("0"),e.append(a)}p.appendCheckDigit(e,r)}static appendCheckDigit(e,i){let r=0;for(let o=0;o<13;o++){let a=e.charAt(o+i).charCodeAt(0)-48;r+=o&1?a:3*a}r=10-r%10,r===10&&(r=0),e.append(r)}}return p.GTIN_SIZE=40,p})(),Lr=(()=>{class p extends qe{constructor(e){super(e)}parseInformation(){let e=new ne;e.append("(01)");let i=e.length(),r=this.getGeneralDecoder().extractNumericValueFromBitArray(p.HEADER_SIZE,4);return e.append(r),this.encodeCompressedGtinWithoutAI(e,p.HEADER_SIZE+4,i),this.getGeneralDecoder().decodeAllCodes(e,p.HEADER_SIZE+44)}}return p.HEADER_SIZE=4,p})(),si=(()=>{class p extends Bi{constructor(e){super(e)}parseInformation(){let e=new ne;return this.getGeneralDecoder().decodeAllCodes(e,p.HEADER_SIZE)}}return p.HEADER_SIZE=5,p})();class vi extends qe{constructor(t){super(t)}encodeCompressedWeight(t,e,i){let r=this.getGeneralDecoder().extractNumericValueFromBitArray(e,i);this.addWeightCode(t,r);let o=this.checkWeight(r),a=1e5;for(let l=0;l<5;++l)o/a===0&&t.append("0"),a/=10;t.append(o)}}let Dr=(()=>{class p extends vi{constructor(e){super(e)}parseInformation(){if(this.getInformation().getSize()!=p.HEADER_SIZE+vi.GTIN_SIZE+p.WEIGHT_SIZE)throw new Y;let e=new ne;return this.encodeCompressedGtin(e,p.HEADER_SIZE),this.encodeCompressedWeight(e,p.HEADER_SIZE+vi.GTIN_SIZE,p.WEIGHT_SIZE),e.toString()}}return p.HEADER_SIZE=5,p.WEIGHT_SIZE=15,p})();class ho extends Dr{constructor(t){super(t)}addWeightCode(t,e){t.append("(3103)")}checkWeight(t){return t}}class uo extends Dr{constructor(t){super(t)}addWeightCode(t,e){e<1e4?t.append("(3202)"):t.append("(3203)")}checkWeight(t){return t<1e4?t:t-1e4}}let fo=(()=>{class p extends qe{constructor(e){super(e)}parseInformation(){if(this.getInformation().getSize()<p.HEADER_SIZE+qe.GTIN_SIZE)throw new Y;let e=new ne;this.encodeCompressedGtin(e,p.HEADER_SIZE);let i=this.getGeneralDecoder().extractNumericValueFromBitArray(p.HEADER_SIZE+qe.GTIN_SIZE,p.LAST_DIGIT_SIZE);e.append("(392"),e.append(i),e.append(")");let r=this.getGeneralDecoder().decodeGeneralPurposeField(p.HEADER_SIZE+qe.GTIN_SIZE+p.LAST_DIGIT_SIZE,null);return e.append(r.getNewString()),e.toString()}}return p.HEADER_SIZE=8,p.LAST_DIGIT_SIZE=2,p})(),Rr=(()=>{class p extends qe{constructor(e){super(e)}parseInformation(){if(this.getInformation().getSize()<p.HEADER_SIZE+qe.GTIN_SIZE)throw new Y;let e=new ne;this.encodeCompressedGtin(e,p.HEADER_SIZE);let i=this.getGeneralDecoder().extractNumericValueFromBitArray(p.HEADER_SIZE+qe.GTIN_SIZE,p.LAST_DIGIT_SIZE);e.append("(393"),e.append(i),e.append(")");let r=this.getGeneralDecoder().extractNumericValueFromBitArray(p.HEADER_SIZE+qe.GTIN_SIZE+p.LAST_DIGIT_SIZE,p.FIRST_THREE_DIGITS_SIZE);r/100==0&&e.append("0"),r/10==0&&e.append("0"),e.append(r);let o=this.getGeneralDecoder().decodeGeneralPurposeField(p.HEADER_SIZE+qe.GTIN_SIZE+p.LAST_DIGIT_SIZE+p.FIRST_THREE_DIGITS_SIZE,null);return e.append(o.getNewString()),e.toString()}}return p.HEADER_SIZE=8,p.LAST_DIGIT_SIZE=2,p.FIRST_THREE_DIGITS_SIZE=10,p})(),Rn=(()=>{class p extends vi{constructor(e,i,r){super(e),this.dateCode=r,this.firstAIdigits=i}parseInformation(){if(this.getInformation().getSize()!=p.HEADER_SIZE+p.GTIN_SIZE+p.WEIGHT_SIZE+p.DATE_SIZE)throw new Y;let e=new ne;return this.encodeCompressedGtin(e,p.HEADER_SIZE),this.encodeCompressedWeight(e,p.HEADER_SIZE+p.GTIN_SIZE,p.WEIGHT_SIZE),this.encodeCompressedDate(e,p.HEADER_SIZE+p.GTIN_SIZE+p.WEIGHT_SIZE),e.toString()}encodeCompressedDate(e,i){let r=this.getGeneralDecoder().extractNumericValueFromBitArray(i,p.DATE_SIZE);if(r==38400)return;e.append("("),e.append(this.dateCode),e.append(")");let o=r%32;r/=32;let a=r%12+1;r/=12;let l=r;l/10==0&&e.append("0"),e.append(l),a/10==0&&e.append("0"),e.append(a),o/10==0&&e.append("0"),e.append(o)}addWeightCode(e,i){e.append("("),e.append(this.firstAIdigits),e.append(i/1e5),e.append(")")}checkWeight(e){return e%1e5}}return p.HEADER_SIZE=8,p.WEIGHT_SIZE=20,p.DATE_SIZE=16,p})();function Ei(p){try{if(p.get(1))return new Lr(p);if(!p.get(2))return new si(p);switch(Xn.extractNumericValueFromBitArray(p,1,4)){case 4:return new ho(p);case 5:return new uo(p)}switch(Xn.extractNumericValueFromBitArray(p,1,5)){case 12:return new fo(p);case 13:return new Rr(p)}switch(Xn.extractNumericValueFromBitArray(p,1,7)){case 56:return new Rn(p,"310","11");case 57:return new Rn(p,"320","11");case 58:return new Rn(p,"310","13");case 59:return new Rn(p,"320","13");case 60:return new Rn(p,"310","15");case 61:return new Rn(p,"320","15");case 62:return new Rn(p,"310","17");case 63:return new Rn(p,"320","17")}}catch(t){throw console.log(t),new gn("unknown decoder: "+p)}}class Pn{constructor(t,e,i,r){this.leftchar=t,this.rightchar=e,this.finderpattern=i,this.maybeLast=r}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(t,e){return t instanceof Pn?Pn.equalsOrNull(t.leftchar,e.leftchar)&&Pn.equalsOrNull(t.rightchar,e.rightchar)&&Pn.equalsOrNull(t.finderpattern,e.finderpattern):!1}static equalsOrNull(t,e){return t===null?e===null:Pn.equals(t,e)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class ur{constructor(t,e,i){this.pairs=t,this.rowNumber=e,this.wasReversed=i}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(t){return this.checkEqualitity(this,t)}toString(){return"{ "+this.pairs+" }"}equals(t,e){return t instanceof ur?this.checkEqualitity(t,e)&&t.wasReversed===e.wasReversed:!1}checkEqualitity(t,e){if(!t||!e)return;let i;return t.forEach((r,o)=>{e.forEach(a=>{r.getLeftChar().getValue()===a.getLeftChar().getValue()&&r.getRightChar().getValue()===a.getRightChar().getValue()&&r.getFinderPatter().getValue()===a.getFinderPatter().getValue()&&(i=!0)})}),i}}class q extends Wn{constructor(t){super(...arguments),this.pairs=new Array(q.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=t===!0}decodeRow(t,e,i){this.pairs.length=0,this.startFromEven=!1;try{return q.constructResult(this.decodeRow2pairs(t,e))}catch(r){this.verbose&&console.log(r)}return this.pairs.length=0,this.startFromEven=!0,q.constructResult(this.decodeRow2pairs(t,e))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(t,e){let i=!1;for(;!i;)try{this.pairs.push(this.retrieveNextPair(e,this.pairs,t))}catch(o){if(o instanceof Y){if(!this.pairs.length)throw new Y;i=!0}}if(this.checkChecksum())return this.pairs;let r;if(this.rows.length?r=!0:r=!1,this.storeRow(t,!1),r){let o=this.checkRowsBoolean(!1);if(o!=null||(o=this.checkRowsBoolean(!0),o!=null))return o}throw new Y}checkRowsBoolean(t){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,t&&(this.rows=this.rows.reverse());let e=null;try{e=this.checkRows(new Array,0)}catch(i){this.verbose&&console.log(i)}return t&&(this.rows=this.rows.reverse()),e}checkRows(t,e){for(let i=e;i<this.rows.length;i++){let r=this.rows[i];this.pairs.length=0;for(let a of t)this.pairs.push(a.getPairs());if(this.pairs.push(r.getPairs()),!q.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let o=new Array(t);o.push(r);try{return this.checkRows(o,i+1)}catch(a){this.verbose&&console.log(a)}}throw new Y}static isValidSequence(t){for(let e of q.FINDER_PATTERN_SEQUENCES){if(t.length>e.length)continue;let i=!0;for(let r=0;r<t.length;r++)if(t[r].getFinderPattern().getValue()!=e[r]){i=!1;break}if(i)return!0}return!1}storeRow(t,e){let i=0,r=!1,o=!1;for(;i<this.rows.length;){let a=this.rows[i];if(a.getRowNumber()>t){o=a.isEquivalent(this.pairs);break}r=a.isEquivalent(this.pairs),i++}o||r||q.isPartialRow(this.pairs,this.rows)||(this.rows.push(i,new ur(this.pairs,t,e)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(t,e){for(let i of e)if(i.getPairs().length!==t.length){for(let r of i.getPairs())for(let o of t)if(Pn.equals(r,o))break}}static isPartialRow(t,e){for(let i of e){let r=!0;for(let o of t){let a=!1;for(let l of i.getPairs())if(o.equals(l)){a=!0;break}if(!a){r=!1;break}}if(r)return!0}return!1}getRows(){return this.rows}static constructResult(t){let e=co.buildBitArray(t),r=Ei(e).parseInformation(),o=t[0].getFinderPattern().getResultPoints(),a=t[t.length-1].getFinderPattern().getResultPoints(),l=[o[0],o[1],a[0],a[1]];return new Zt(r,null,null,l,it.RSS_EXPANDED,null)}checkChecksum(){let t=this.pairs.get(0),e=t.getLeftChar(),i=t.getRightChar();if(i==null)return!1;let r=i.getChecksumPortion(),o=2;for(let l=1;l<this.pairs.size();++l){let u=this.pairs.get(l);r+=u.getLeftChar().getChecksumPortion(),o++;let f=u.getRightChar();f!=null&&(r+=f.getChecksumPortion(),o++)}return r%=211,211*(o-4)+r==e.getValue()}static getNextSecondBar(t,e){let i;return t.get(e)?(i=t.getNextUnset(e),i=t.getNextSet(i)):(i=t.getNextSet(e),i=t.getNextUnset(i)),i}retrieveNextPair(t,e,i){let r=e.length%2==0;this.startFromEven&&(r=!r);let o,a=!0,l=-1;do this.findNextPair(t,e,l),o=this.parseFoundFinderPattern(t,i,r),o==null?l=q.getNextSecondBar(t,this.startEnd[0]):a=!1;while(a);let u=this.decodeDataCharacter(t,o,r,!0);if(!this.isEmptyPair(e)&&e[e.length-1].mustBeLast())throw new Y;let f;try{f=this.decodeDataCharacter(t,o,r,!1)}catch(x){f=null,this.verbose&&console.log(x)}return new Pn(u,f,o,!0)}isEmptyPair(t){return t.length===0}findNextPair(t,e,i){let r=this.getDecodeFinderCounters();r[0]=0,r[1]=0,r[2]=0,r[3]=0;let o=t.getSize(),a;i>=0?a=i:this.isEmptyPair(e)?a=0:a=e[e.length-1].getFinderPattern().getStartEnd()[1];let l=e.length%2!=0;this.startFromEven&&(l=!l);let u=!1;for(;a<o&&(u=!t.get(a),!!u);)a++;let f=0,x=a;for(let v=a;v<o;v++)if(t.get(v)!=u)r[f]++;else{if(f==3){if(l&&q.reverseCounters(r),q.isFinderPattern(r)){this.startEnd[0]=x,this.startEnd[1]=v;return}l&&q.reverseCounters(r),x+=r[0]+r[1],r[0]=r[2],r[1]=r[3],r[2]=0,r[3]=0,f--}else f++;r[f]=1,u=!u}throw new Y}static reverseCounters(t){let e=t.length;for(let i=0;i<e/2;++i){let r=t[i];t[i]=t[e-i-1],t[e-i-1]=r}}parseFoundFinderPattern(t,e,i){let r,o,a;if(i){let f=this.startEnd[0]-1;for(;f>=0&&!t.get(f);)f--;f++,r=this.startEnd[0]-f,o=f,a=this.startEnd[1]}else o=this.startEnd[0],a=t.getNextUnset(this.startEnd[1]+1),r=a-this.startEnd[1];let l=this.getDecodeFinderCounters();st.arraycopy(l,0,l,1,l.length-1),l[0]=r;let u;try{u=this.parseFinderValue(l,q.FINDER_PATTERNS)}catch{return null}return new oi(u,[o,a],o,a,e)}decodeDataCharacter(t,e,i,r){let o=this.getDataCharacterCounters();for(let te=0;te<o.length;te++)o[te]=0;if(r)q.recordPatternInReverse(t,e.getStartEnd()[0],o);else{q.recordPattern(t,e.getStartEnd()[1],o);for(let te=0,Be=o.length-1;te<Be;te++,Be--){let Xe=o[te];o[te]=o[Be],o[Be]=Xe}}let a=17,l=Xt.sum(new Int32Array(o))/a,u=(e.getStartEnd()[1]-e.getStartEnd()[0])/15;if(Math.abs(l-u)/u>.3)throw new Y;let f=this.getOddCounts(),x=this.getEvenCounts(),v=this.getOddRoundingErrors(),S=this.getEvenRoundingErrors();for(let te=0;te<o.length;te++){let Be=1*o[te]/l,Xe=Be+.5;if(Xe<1){if(Be<.3)throw new Y;Xe=1}else if(Xe>8){if(Be>8.7)throw new Y;Xe=8}let fi=te/2;te&1?(x[fi]=Xe,S[fi]=Be-Xe):(f[fi]=Xe,v[fi]=Be-Xe)}this.adjustOddEvenCounts(a);let b=4*e.getValue()+(i?0:2)+(r?0:1)-1,N=0,R=0;for(let te=f.length-1;te>=0;te--){if(q.isNotA1left(e,i,r)){let Be=q.WEIGHTS[b][2*te];R+=f[te]*Be}N+=f[te]}let F=0;for(let te=x.length-1;te>=0;te--)if(q.isNotA1left(e,i,r)){let Be=q.WEIGHTS[b][2*te+1];F+=x[te]*Be}let V=R+F;if(N&1||N>13||N<4)throw new Y;let J=(13-N)/2,ot=q.SYMBOL_WIDEST[J],X=9-ot,Pt=mn.getRSSvalue(f,ot,!0),Ot=mn.getRSSvalue(x,X,!1),ye=q.EVEN_TOTAL_SUBSET[J],Ge=q.GSUM[J],je=Pt*ye+Ot+Ge;return new ri(je,V)}static isNotA1left(t,e,i){return!(t.getValue()==0&&e&&i)}adjustOddEvenCounts(t){let e=Xt.sum(new Int32Array(this.getOddCounts())),i=Xt.sum(new Int32Array(this.getEvenCounts())),r=!1,o=!1;e>13?o=!0:e<4&&(r=!0);let a=!1,l=!1;i>13?l=!0:i<4&&(a=!0);let u=e+i-t,f=(e&1)==1,x=(i&1)==0;if(u==1)if(f){if(x)throw new Y;o=!0}else{if(!x)throw new Y;l=!0}else if(u==-1)if(f){if(x)throw new Y;r=!0}else{if(!x)throw new Y;a=!0}else if(u==0){if(f){if(!x)throw new Y;e<i?(r=!0,l=!0):(o=!0,a=!0)}else if(x)throw new Y}else throw new Y;if(r){if(o)throw new Y;q.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(o&&q.decrement(this.getOddCounts(),this.getOddRoundingErrors()),a){if(l)throw new Y;q.increment(this.getEvenCounts(),this.getOddRoundingErrors())}l&&q.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}q.SYMBOL_WIDEST=[7,5,4,3,1],q.EVEN_TOTAL_SUBSET=[4,20,52,104,204],q.GSUM=[0,348,1388,2948,3988],q.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],q.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],q.FINDER_PAT_A=0,q.FINDER_PAT_B=1,q.FINDER_PAT_C=2,q.FINDER_PAT_D=3,q.FINDER_PAT_E=4,q.FINDER_PAT_F=5,q.FINDER_PATTERN_SEQUENCES=[[q.FINDER_PAT_A,q.FINDER_PAT_A],[q.FINDER_PAT_A,q.FINDER_PAT_B,q.FINDER_PAT_B],[q.FINDER_PAT_A,q.FINDER_PAT_C,q.FINDER_PAT_B,q.FINDER_PAT_D],[q.FINDER_PAT_A,q.FINDER_PAT_E,q.FINDER_PAT_B,q.FINDER_PAT_D,q.FINDER_PAT_C],[q.FINDER_PAT_A,q.FINDER_PAT_E,q.FINDER_PAT_B,q.FINDER_PAT_D,q.FINDER_PAT_D,q.FINDER_PAT_F],[q.FINDER_PAT_A,q.FINDER_PAT_E,q.FINDER_PAT_B,q.FINDER_PAT_D,q.FINDER_PAT_E,q.FINDER_PAT_F,q.FINDER_PAT_F],[q.FINDER_PAT_A,q.FINDER_PAT_A,q.FINDER_PAT_B,q.FINDER_PAT_B,q.FINDER_PAT_C,q.FINDER_PAT_C,q.FINDER_PAT_D,q.FINDER_PAT_D],[q.FINDER_PAT_A,q.FINDER_PAT_A,q.FINDER_PAT_B,q.FINDER_PAT_B,q.FINDER_PAT_C,q.FINDER_PAT_C,q.FINDER_PAT_D,q.FINDER_PAT_E,q.FINDER_PAT_E],[q.FINDER_PAT_A,q.FINDER_PAT_A,q.FINDER_PAT_B,q.FINDER_PAT_B,q.FINDER_PAT_C,q.FINDER_PAT_C,q.FINDER_PAT_D,q.FINDER_PAT_E,q.FINDER_PAT_F,q.FINDER_PAT_F],[q.FINDER_PAT_A,q.FINDER_PAT_A,q.FINDER_PAT_B,q.FINDER_PAT_B,q.FINDER_PAT_C,q.FINDER_PAT_D,q.FINDER_PAT_D,q.FINDER_PAT_E,q.FINDER_PAT_E,q.FINDER_PAT_F,q.FINDER_PAT_F]],q.MAX_PAIRS=11;class po extends ri{constructor(t,e,i){super(t,e),this.count=0,this.finderPattern=i}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class ve extends Wn{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(t,e,i){let r=this.decodePair(e,!1,t,i);ve.addOrTally(this.possibleLeftPairs,r),e.reverse();let o=this.decodePair(e,!0,t,i);ve.addOrTally(this.possibleRightPairs,o),e.reverse();for(let a of this.possibleLeftPairs)if(a.getCount()>1){for(let l of this.possibleRightPairs)if(l.getCount()>1&&ve.checkChecksum(a,l))return ve.constructResult(a,l)}throw new Y}static addOrTally(t,e){if(e==null)return;let i=!1;for(let r of t)if(r.getValue()===e.getValue()){r.incrementCount(),i=!0;break}i||t.push(e)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(t,e){let i=4537077*t.getValue()+e.getValue(),r=new String(i).toString(),o=new ne;for(let f=13-r.length;f>0;f--)o.append("0");o.append(r);let a=0;for(let f=0;f<13;f++){let x=o.charAt(f).charCodeAt(0)-48;a+=f&1?x:3*x}a=10-a%10,a===10&&(a=0),o.append(a.toString());let l=t.getFinderPattern().getResultPoints(),u=e.getFinderPattern().getResultPoints();return new Zt(o.toString(),null,0,[l[0],l[1],u[0],u[1]],it.RSS_14,new Date().getTime())}static checkChecksum(t,e){let i=(t.getChecksumPortion()+16*e.getChecksumPortion())%79,r=9*t.getFinderPattern().getValue()+e.getFinderPattern().getValue();return r>72&&r--,r>8&&r--,i===r}decodePair(t,e,i,r){try{let o=this.findFinderPattern(t,e),a=this.parseFoundFinderPattern(t,i,e,o),l=r==null?null:r.get(Ut.NEED_RESULT_POINT_CALLBACK);if(l!=null){let x=(o[0]+o[1])/2;e&&(x=t.getSize()-1-x),l.foundPossibleResultPoint(new mt(x,i))}let u=this.decodeDataCharacter(t,a,!0),f=this.decodeDataCharacter(t,a,!1);return new po(1597*u.getValue()+f.getValue(),u.getChecksumPortion()+4*f.getChecksumPortion(),a)}catch{return null}}decodeDataCharacter(t,e,i){let r=this.getDataCharacterCounters();for(let F=0;F<r.length;F++)r[F]=0;if(i)Ee.recordPatternInReverse(t,e.getStartEnd()[0],r);else{Ee.recordPattern(t,e.getStartEnd()[1]+1,r);for(let F=0,V=r.length-1;F<V;F++,V--){let J=r[F];r[F]=r[V],r[V]=J}}let o=i?16:15,a=Xt.sum(new Int32Array(r))/o,l=this.getOddCounts(),u=this.getEvenCounts(),f=this.getOddRoundingErrors(),x=this.getEvenRoundingErrors();for(let F=0;F<r.length;F++){let V=r[F]/a,J=Math.floor(V+.5);J<1?J=1:J>8&&(J=8);let ot=Math.floor(F/2);F&1?(u[ot]=J,x[ot]=V-J):(l[ot]=J,f[ot]=V-J)}this.adjustOddEvenCounts(i,o);let v=0,S=0;for(let F=l.length-1;F>=0;F--)S*=9,S+=l[F],v+=l[F];let b=0,N=0;for(let F=u.length-1;F>=0;F--)b*=9,b+=u[F],N+=u[F];let R=S+3*b;if(i){if(v&1||v>12||v<4)throw new Y;let F=(12-v)/2,V=ve.OUTSIDE_ODD_WIDEST[F],J=9-V,ot=mn.getRSSvalue(l,V,!1),X=mn.getRSSvalue(u,J,!0),Pt=ve.OUTSIDE_EVEN_TOTAL_SUBSET[F],Ot=ve.OUTSIDE_GSUM[F];return new ri(ot*Pt+X+Ot,R)}else{if(N&1||N>10||N<4)throw new Y;let F=(10-N)/2,V=ve.INSIDE_ODD_WIDEST[F],J=9-V,ot=mn.getRSSvalue(l,V,!0),X=mn.getRSSvalue(u,J,!1),Pt=ve.INSIDE_ODD_TOTAL_SUBSET[F],Ot=ve.INSIDE_GSUM[F];return new ri(X*Pt+ot+Ot,R)}}findFinderPattern(t,e){let i=this.getDecodeFinderCounters();i[0]=0,i[1]=0,i[2]=0,i[3]=0;let r=t.getSize(),o=!1,a=0;for(;a<r&&(o=!t.get(a),e!==o);)a++;let l=0,u=a;for(let f=a;f<r;f++)if(t.get(f)!==o)i[l]++;else{if(l===3){if(Wn.isFinderPattern(i))return[u,f];u+=i[0]+i[1],i[0]=i[2],i[1]=i[3],i[2]=0,i[3]=0,l--}else l++;i[l]=1,o=!o}throw new Y}parseFoundFinderPattern(t,e,i,r){let o=t.get(r[0]),a=r[0]-1;for(;a>=0&&o!==t.get(a);)a--;a++;let l=r[0]-a,u=this.getDecodeFinderCounters(),f=new Int32Array(u.length);st.arraycopy(u,0,f,1,u.length-1),f[0]=l;let x=this.parseFinderValue(f,ve.FINDER_PATTERNS),v=a,S=r[1];return i&&(v=t.getSize()-1-v,S=t.getSize()-1-S),new oi(x,[a,r[1]],v,S,e)}adjustOddEvenCounts(t,e){let i=Xt.sum(new Int32Array(this.getOddCounts())),r=Xt.sum(new Int32Array(this.getEvenCounts())),o=!1,a=!1,l=!1,u=!1;t?(i>12?a=!0:i<4&&(o=!0),r>12?u=!0:r<4&&(l=!0)):(i>11?a=!0:i<5&&(o=!0),r>10?u=!0:r<4&&(l=!0));let f=i+r-e,x=(i&1)===(t?1:0),v=(r&1)===1;if(f===1)if(x){if(v)throw new Y;a=!0}else{if(!v)throw new Y;u=!0}else if(f===-1)if(x){if(v)throw new Y;o=!0}else{if(!v)throw new Y;l=!0}else if(f===0){if(x){if(!v)throw new Y;i<r?(o=!0,u=!0):(a=!0,l=!0)}else if(v)throw new Y}else throw new Y;if(o){if(a)throw new Y;Wn.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(a&&Wn.decrement(this.getOddCounts(),this.getOddRoundingErrors()),l){if(u)throw new Y;Wn.increment(this.getEvenCounts(),this.getOddRoundingErrors())}u&&Wn.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}ve.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],ve.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],ve.OUTSIDE_GSUM=[0,161,961,2015,2715],ve.INSIDE_GSUM=[0,336,1036,1516],ve.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],ve.INSIDE_ODD_WIDEST=[2,4,6,8],ve.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class Bn extends Ee{constructor(t,e){super(),this.readers=[],this.verbose=e===!0;let i=t?t.get(Ut.POSSIBLE_FORMATS):null,r=t&&t.get(Ut.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;i?((i.includes(it.EAN_13)||i.includes(it.UPC_A)||i.includes(it.EAN_8)||i.includes(it.UPC_E))&&this.readers.push(new cr(t)),i.includes(it.CODE_39)&&this.readers.push(new Pi(r)),i.includes(it.CODE_128)&&this.readers.push(new rt),i.includes(it.ITF)&&this.readers.push(new se),i.includes(it.RSS_14)&&this.readers.push(new ve),i.includes(it.RSS_EXPANDED)&&this.readers.push(new q(this.verbose))):(this.readers.push(new cr(t)),this.readers.push(new Pi),this.readers.push(new cr(t)),this.readers.push(new rt),this.readers.push(new se),this.readers.push(new ve),this.readers.push(new q(this.verbose)))}decodeRow(t,e,i){for(let r=0;r<this.readers.length;r++)try{return this.readers[r].decodeRow(t,e,i)}catch{}throw new Y}reset(){this.readers.forEach(t=>t.reset())}}class Ai extends Ie{constructor(t=500,e){super(new Bn(e),t,e)}}class Jt{constructor(t,e,i){this.ecCodewords=t,this.ecBlocks=[e],i&&this.ecBlocks.push(i)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class qt{constructor(t,e){this.count=t,this.dataCodewords=e}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Rt{constructor(t,e,i,r,o,a){this.versionNumber=t,this.symbolSizeRows=e,this.symbolSizeColumns=i,this.dataRegionSizeRows=r,this.dataRegionSizeColumns=o,this.ecBlocks=a;let l=0,u=a.getECCodewords(),f=a.getECBlocks();for(let x of f)l+=x.getCount()*(x.getDataCodewords()+u);this.totalCodewords=l}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(t,e){if(t&1||e&1)throw new tt;for(let i of Rt.VERSIONS)if(i.symbolSizeRows===t&&i.symbolSizeColumns===e)return i;throw new tt}toString(){return""+this.versionNumber}static buildVersions(){return[new Rt(1,10,10,8,8,new Jt(5,new qt(1,3))),new Rt(2,12,12,10,10,new Jt(7,new qt(1,5))),new Rt(3,14,14,12,12,new Jt(10,new qt(1,8))),new Rt(4,16,16,14,14,new Jt(12,new qt(1,12))),new Rt(5,18,18,16,16,new Jt(14,new qt(1,18))),new Rt(6,20,20,18,18,new Jt(18,new qt(1,22))),new Rt(7,22,22,20,20,new Jt(20,new qt(1,30))),new Rt(8,24,24,22,22,new Jt(24,new qt(1,36))),new Rt(9,26,26,24,24,new Jt(28,new qt(1,44))),new Rt(10,32,32,14,14,new Jt(36,new qt(1,62))),new Rt(11,36,36,16,16,new Jt(42,new qt(1,86))),new Rt(12,40,40,18,18,new Jt(48,new qt(1,114))),new Rt(13,44,44,20,20,new Jt(56,new qt(1,144))),new Rt(14,48,48,22,22,new Jt(68,new qt(1,174))),new Rt(15,52,52,24,24,new Jt(42,new qt(2,102))),new Rt(16,64,64,14,14,new Jt(56,new qt(2,140))),new Rt(17,72,72,16,16,new Jt(36,new qt(4,92))),new Rt(18,80,80,18,18,new Jt(48,new qt(4,114))),new Rt(19,88,88,20,20,new Jt(56,new qt(4,144))),new Rt(20,96,96,22,22,new Jt(68,new qt(4,174))),new Rt(21,104,104,24,24,new Jt(56,new qt(6,136))),new Rt(22,120,120,18,18,new Jt(68,new qt(6,175))),new Rt(23,132,132,20,20,new Jt(62,new qt(8,163))),new Rt(24,144,144,22,22,new Jt(62,new qt(8,156),new qt(2,155))),new Rt(25,8,18,6,16,new Jt(7,new qt(1,5))),new Rt(26,8,32,6,14,new Jt(11,new qt(1,10))),new Rt(27,12,26,10,24,new Jt(14,new qt(1,16))),new Rt(28,12,36,10,16,new Jt(18,new qt(1,22))),new Rt(29,16,36,14,16,new Jt(24,new qt(1,32))),new Rt(30,16,48,14,22,new Jt(28,new qt(1,49)))]}}Rt.VERSIONS=Rt.buildVersions();class Wt{constructor(t){let e=t.getHeight();if(e<8||e>144||e&1)throw new tt;this.version=Wt.readVersion(t),this.mappingBitMatrix=this.extractDataRegion(t),this.readMappingMatrix=new le(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(t){let e=t.getHeight(),i=t.getWidth();return Rt.getVersionForDimensions(e,i)}readCodewords(){let t=new Int8Array(this.version.getTotalCodewords()),e=0,i=4,r=0,o=this.mappingBitMatrix.getHeight(),a=this.mappingBitMatrix.getWidth(),l=!1,u=!1,f=!1,x=!1;do if(i===o&&r===0&&!l)t[e++]=this.readCorner1(o,a)&255,i-=2,r+=2,l=!0;else if(i===o-2&&r===0&&a&3&&!u)t[e++]=this.readCorner2(o,a)&255,i-=2,r+=2,u=!0;else if(i===o+4&&r===2&&!(a&7)&&!f)t[e++]=this.readCorner3(o,a)&255,i-=2,r+=2,f=!0;else if(i===o-2&&r===0&&(a&7)===4&&!x)t[e++]=this.readCorner4(o,a)&255,i-=2,r+=2,x=!0;else{do i<o&&r>=0&&!this.readMappingMatrix.get(r,i)&&(t[e++]=this.readUtah(i,r,o,a)&255),i-=2,r+=2;while(i>=0&&r<a);i+=1,r+=3;do i>=0&&r<a&&!this.readMappingMatrix.get(r,i)&&(t[e++]=this.readUtah(i,r,o,a)&255),i+=2,r-=2;while(i<o&&r>=0);i+=3,r+=1}while(i<o||r<a);if(e!==this.version.getTotalCodewords())throw new tt;return t}readModule(t,e,i,r){return t<0&&(t+=i,e+=4-(i+4&7)),e<0&&(e+=r,t+=4-(r+4&7)),this.readMappingMatrix.set(e,t),this.mappingBitMatrix.get(e,t)}readUtah(t,e,i,r){let o=0;return this.readModule(t-2,e-2,i,r)&&(o|=1),o<<=1,this.readModule(t-2,e-1,i,r)&&(o|=1),o<<=1,this.readModule(t-1,e-2,i,r)&&(o|=1),o<<=1,this.readModule(t-1,e-1,i,r)&&(o|=1),o<<=1,this.readModule(t-1,e,i,r)&&(o|=1),o<<=1,this.readModule(t,e-2,i,r)&&(o|=1),o<<=1,this.readModule(t,e-1,i,r)&&(o|=1),o<<=1,this.readModule(t,e,i,r)&&(o|=1),o}readCorner1(t,e){let i=0;return this.readModule(t-1,0,t,e)&&(i|=1),i<<=1,this.readModule(t-1,1,t,e)&&(i|=1),i<<=1,this.readModule(t-1,2,t,e)&&(i|=1),i<<=1,this.readModule(0,e-2,t,e)&&(i|=1),i<<=1,this.readModule(0,e-1,t,e)&&(i|=1),i<<=1,this.readModule(1,e-1,t,e)&&(i|=1),i<<=1,this.readModule(2,e-1,t,e)&&(i|=1),i<<=1,this.readModule(3,e-1,t,e)&&(i|=1),i}readCorner2(t,e){let i=0;return this.readModule(t-3,0,t,e)&&(i|=1),i<<=1,this.readModule(t-2,0,t,e)&&(i|=1),i<<=1,this.readModule(t-1,0,t,e)&&(i|=1),i<<=1,this.readModule(0,e-4,t,e)&&(i|=1),i<<=1,this.readModule(0,e-3,t,e)&&(i|=1),i<<=1,this.readModule(0,e-2,t,e)&&(i|=1),i<<=1,this.readModule(0,e-1,t,e)&&(i|=1),i<<=1,this.readModule(1,e-1,t,e)&&(i|=1),i}readCorner3(t,e){let i=0;return this.readModule(t-1,0,t,e)&&(i|=1),i<<=1,this.readModule(t-1,e-1,t,e)&&(i|=1),i<<=1,this.readModule(0,e-3,t,e)&&(i|=1),i<<=1,this.readModule(0,e-2,t,e)&&(i|=1),i<<=1,this.readModule(0,e-1,t,e)&&(i|=1),i<<=1,this.readModule(1,e-3,t,e)&&(i|=1),i<<=1,this.readModule(1,e-2,t,e)&&(i|=1),i<<=1,this.readModule(1,e-1,t,e)&&(i|=1),i}readCorner4(t,e){let i=0;return this.readModule(t-3,0,t,e)&&(i|=1),i<<=1,this.readModule(t-2,0,t,e)&&(i|=1),i<<=1,this.readModule(t-1,0,t,e)&&(i|=1),i<<=1,this.readModule(0,e-2,t,e)&&(i|=1),i<<=1,this.readModule(0,e-1,t,e)&&(i|=1),i<<=1,this.readModule(1,e-1,t,e)&&(i|=1),i<<=1,this.readModule(2,e-1,t,e)&&(i|=1),i<<=1,this.readModule(3,e-1,t,e)&&(i|=1),i}extractDataRegion(t){let e=this.version.getSymbolSizeRows(),i=this.version.getSymbolSizeColumns();if(t.getHeight()!==e)throw new E("Dimension of bitMatrix must match the version size");let r=this.version.getDataRegionSizeRows(),o=this.version.getDataRegionSizeColumns(),a=e/r|0,l=i/o|0,u=a*r,f=l*o,x=new le(f,u);for(let v=0;v<a;++v){let S=v*r;for(let b=0;b<l;++b){let N=b*o;for(let R=0;R<r;++R){let F=v*(r+2)+1+R,V=S+R;for(let J=0;J<o;++J){let ot=b*(o+2)+1+J;if(t.get(ot,F)){let X=N+J;x.set(X,V)}}}}}return x}}class pe{constructor(t,e){this.numDataCodewords=t,this.codewords=e}static getDataBlocks(t,e){let i=e.getECBlocks(),r=0,o=i.getECBlocks();for(let R of o)r+=R.getCount();let a=new Array(r),l=0;for(let R of o)for(let F=0;F<R.getCount();F++){let V=R.getDataCodewords(),J=i.getECCodewords()+V;a[l++]=new pe(V,new Uint8Array(J))}let f=a[0].codewords.length-i.getECCodewords(),x=f-1,v=0;for(let R=0;R<x;R++)for(let F=0;F<l;F++)a[F].codewords[R]=t[v++];let S=e.getVersionNumber()===24,b=S?8:l;for(let R=0;R<b;R++)a[R].codewords[f-1]=t[v++];let N=a[0].codewords.length;for(let R=f;R<N;R++)for(let F=0;F<l;F++){let V=S?(F+8)%l:F,J=S&&V>7?R-1:R;a[V].codewords[J]=t[v++]}if(v!==t.length)throw new E;return a}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class ai{constructor(t){this.bytes=t,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(t){if(t<1||t>32||t>this.available())throw new E(""+t);let e=0,i=this.bitOffset,r=this.byteOffset,o=this.bytes;if(i>0){let a=8-i,l=t<a?t:a,u=a-l,f=255>>8-l<<u;e=(o[r]&f)>>u,t-=l,i+=l,i===8&&(i=0,r++)}if(t>0){for(;t>=8;)e=e<<8|o[r]&255,r++,t-=8;if(t>0){let a=8-t,l=255>>a<<a;e=e<<t|(o[r]&l)>>a,i+=t}}return this.bitOffset=i,this.byteOffset=r,e}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var xe=function(p){return p[p.PAD_ENCODE=0]="PAD_ENCODE",p[p.ASCII_ENCODE=1]="ASCII_ENCODE",p[p.C40_ENCODE=2]="C40_ENCODE",p[p.TEXT_ENCODE=3]="TEXT_ENCODE",p[p.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",p[p.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",p[p.BASE256_ENCODE=6]="BASE256_ENCODE",p}(xe||{});class Ke{static decode(t){let e=new ai(t),i=new ne,r=new ne,o=new Array,a=xe.ASCII_ENCODE;do if(a===xe.ASCII_ENCODE)a=this.decodeAsciiSegment(e,i,r);else{switch(a){case xe.C40_ENCODE:this.decodeC40Segment(e,i);break;case xe.TEXT_ENCODE:this.decodeTextSegment(e,i);break;case xe.ANSIX12_ENCODE:this.decodeAnsiX12Segment(e,i);break;case xe.EDIFACT_ENCODE:this.decodeEdifactSegment(e,i);break;case xe.BASE256_ENCODE:this.decodeBase256Segment(e,i,o);break;default:throw new tt}a=xe.ASCII_ENCODE}while(a!==xe.PAD_ENCODE&&e.available()>0);return r.length()>0&&i.append(r.toString()),new ei(t,i.toString(),o.length===0?null:o,null)}static decodeAsciiSegment(t,e,i){let r=!1;do{let o=t.readBits(8);if(o===0)throw new tt;if(o<=128)return r&&(o+=128),e.append(String.fromCharCode(o-1)),xe.ASCII_ENCODE;if(o===129)return xe.PAD_ENCODE;if(o<=229){let a=o-130;a<10&&e.append("0"),e.append(""+a)}else switch(o){case 230:return xe.C40_ENCODE;case 231:return xe.BASE256_ENCODE;case 232:e.append("");break;case 233:case 234:break;case 235:r=!0;break;case 236:e.append("[)>05"),i.insert(0,"");break;case 237:e.append("[)>06"),i.insert(0,"");break;case 238:return xe.ANSIX12_ENCODE;case 239:return xe.TEXT_ENCODE;case 240:return xe.EDIFACT_ENCODE;case 241:break;default:if(o!==254||t.available()!==0)throw new tt;break}}while(t.available()>0);return xe.ASCII_ENCODE}static decodeC40Segment(t,e){let i=!1,r=[],o=0;do{if(t.available()===8)return;let a=t.readBits(8);if(a===254)return;this.parseTwoBytes(a,t.readBits(8),r);for(let l=0;l<3;l++){let u=r[l];switch(o){case 0:if(u<3)o=u+1;else if(u<this.C40_BASIC_SET_CHARS.length){let f=this.C40_BASIC_SET_CHARS[u];i?(e.append(String.fromCharCode(f.charCodeAt(0)+128)),i=!1):e.append(f)}else throw new tt;break;case 1:i?(e.append(String.fromCharCode(u+128)),i=!1):e.append(String.fromCharCode(u)),o=0;break;case 2:if(u<this.C40_SHIFT2_SET_CHARS.length){let f=this.C40_SHIFT2_SET_CHARS[u];i?(e.append(String.fromCharCode(f.charCodeAt(0)+128)),i=!1):e.append(f)}else switch(u){case 27:e.append("");break;case 30:i=!0;break;default:throw new tt}o=0;break;case 3:i?(e.append(String.fromCharCode(u+224)),i=!1):e.append(String.fromCharCode(u+96)),o=0;break;default:throw new tt}}}while(t.available()>0)}static decodeTextSegment(t,e){let i=!1,r=[],o=0;do{if(t.available()===8)return;let a=t.readBits(8);if(a===254)return;this.parseTwoBytes(a,t.readBits(8),r);for(let l=0;l<3;l++){let u=r[l];switch(o){case 0:if(u<3)o=u+1;else if(u<this.TEXT_BASIC_SET_CHARS.length){let f=this.TEXT_BASIC_SET_CHARS[u];i?(e.append(String.fromCharCode(f.charCodeAt(0)+128)),i=!1):e.append(f)}else throw new tt;break;case 1:i?(e.append(String.fromCharCode(u+128)),i=!1):e.append(String.fromCharCode(u)),o=0;break;case 2:if(u<this.TEXT_SHIFT2_SET_CHARS.length){let f=this.TEXT_SHIFT2_SET_CHARS[u];i?(e.append(String.fromCharCode(f.charCodeAt(0)+128)),i=!1):e.append(f)}else switch(u){case 27:e.append("");break;case 30:i=!0;break;default:throw new tt}o=0;break;case 3:if(u<this.TEXT_SHIFT3_SET_CHARS.length){let f=this.TEXT_SHIFT3_SET_CHARS[u];i?(e.append(String.fromCharCode(f.charCodeAt(0)+128)),i=!1):e.append(f),o=0}else throw new tt;break;default:throw new tt}}}while(t.available()>0)}static decodeAnsiX12Segment(t,e){let i=[];do{if(t.available()===8)return;let r=t.readBits(8);if(r===254)return;this.parseTwoBytes(r,t.readBits(8),i);for(let o=0;o<3;o++){let a=i[o];switch(a){case 0:e.append("\r");break;case 1:e.append("*");break;case 2:e.append(">");break;case 3:e.append(" ");break;default:if(a<14)e.append(String.fromCharCode(a+44));else if(a<40)e.append(String.fromCharCode(a+51));else throw new tt;break}}}while(t.available()>0)}static parseTwoBytes(t,e,i){let r=(t<<8)+e-1,o=Math.floor(r/1600);i[0]=o,r-=o*1600,o=Math.floor(r/40),i[1]=o,i[2]=r-o*40}static decodeEdifactSegment(t,e){do{if(t.available()<=16)return;for(let i=0;i<4;i++){let r=t.readBits(6);if(r===31){let o=8-t.getBitOffset();o!==8&&t.readBits(o);return}r&32||(r|=64),e.append(String.fromCharCode(r))}}while(t.available()>0)}static decodeBase256Segment(t,e,i){let r=1+t.getByteOffset(),o=this.unrandomize255State(t.readBits(8),r++),a;if(o===0?a=t.available()/8|0:o<250?a=o:a=250*(o-249)+this.unrandomize255State(t.readBits(8),r++),a<0)throw new tt;let l=new Uint8Array(a);for(let u=0;u<a;u++){if(t.available()<8)throw new tt;l[u]=this.unrandomize255State(t.readBits(8),r++)}i.push(l);try{e.append(oe.decode(l,wt.ISO88591))}catch(u){throw new gn("Platform does not support required encoding: "+u.message)}}static unrandomize255State(t,e){let i=149*e%255+1,r=t-i;return r>=0?r:r+256}}Ke.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],Ke.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],Ke.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],Ke.TEXT_SHIFT2_SET_CHARS=Ke.C40_SHIFT2_SET_CHARS,Ke.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~","\x7F"];class dr{constructor(){this.rsDecoder=new ni(jt.DATA_MATRIX_FIELD_256)}decode(t){let e=new Wt(t),i=e.getVersion(),r=e.readCodewords(),o=pe.getDataBlocks(r,i),a=0;for(let f of o)a+=f.getNumDataCodewords();let l=new Uint8Array(a),u=o.length;for(let f=0;f<u;f++){let x=o[f],v=x.getCodewords(),S=x.getNumDataCodewords();this.correctErrors(v,S);for(let b=0;b<S;b++)l[b*u+f]=v[b]}return Ke.decode(l)}correctErrors(t,e){let i=new Int32Array(t);try{this.rsDecoder.decode(i,t.length-e)}catch{throw new $}for(let r=0;r<e;r++)t[r]=i[r]}}class xt{constructor(t){this.image=t,this.rectangleDetector=new Ri(this.image)}detect(){let t=this.rectangleDetector.detect(),e=this.detectSolid1(t);if(e=this.detectSolid2(e),e[3]=this.correctTopRight(e),!e[3])throw new Y;e=this.shiftToModuleCenter(e);let i=e[0],r=e[1],o=e[2],a=e[3],l=this.transitionsBetween(i,a)+1,u=this.transitionsBetween(o,a)+1;(l&1)===1&&(l+=1),(u&1)===1&&(u+=1),4*l<7*u&&4*u<7*l&&(l=u=Math.max(l,u));let f=xt.sampleGrid(this.image,i,r,o,a,l,u);return new xi(f,[i,r,o,a])}static shiftPoint(t,e,i){let r=(e.getX()-t.getX())/(i+1),o=(e.getY()-t.getY())/(i+1);return new mt(t.getX()+r,t.getY()+o)}static moveAway(t,e,i){let r=t.getX(),o=t.getY();return r<e?r-=1:r+=1,o<i?o-=1:o+=1,new mt(r,o)}detectSolid1(t){let e=t[0],i=t[1],r=t[3],o=t[2],a=this.transitionsBetween(e,i),l=this.transitionsBetween(i,r),u=this.transitionsBetween(r,o),f=this.transitionsBetween(o,e),x=a,v=[o,e,i,r];return x>l&&(x=l,v[0]=e,v[1]=i,v[2]=r,v[3]=o),x>u&&(x=u,v[0]=i,v[1]=r,v[2]=o,v[3]=e),x>f&&(v[0]=r,v[1]=o,v[2]=e,v[3]=i),v}detectSolid2(t){let e=t[0],i=t[1],r=t[2],o=t[3],a=this.transitionsBetween(e,o),l=xt.shiftPoint(i,r,(a+1)*4),u=xt.shiftPoint(r,i,(a+1)*4),f=this.transitionsBetween(l,e),x=this.transitionsBetween(u,o);return f<x?(t[0]=e,t[1]=i,t[2]=r,t[3]=o):(t[0]=i,t[1]=r,t[2]=o,t[3]=e),t}correctTopRight(t){let e=t[0],i=t[1],r=t[2],o=t[3],a=this.transitionsBetween(e,o),l=this.transitionsBetween(i,o),u=xt.shiftPoint(e,i,(l+1)*4),f=xt.shiftPoint(r,i,(a+1)*4);a=this.transitionsBetween(u,o),l=this.transitionsBetween(f,o);let x=new mt(o.getX()+(r.getX()-i.getX())/(a+1),o.getY()+(r.getY()-i.getY())/(a+1)),v=new mt(o.getX()+(e.getX()-i.getX())/(l+1),o.getY()+(e.getY()-i.getY())/(l+1));if(!this.isValid(x))return this.isValid(v)?v:null;if(!this.isValid(v))return x;let S=this.transitionsBetween(u,x)+this.transitionsBetween(f,x),b=this.transitionsBetween(u,v)+this.transitionsBetween(f,v);return S>b?x:v}shiftToModuleCenter(t){let e=t[0],i=t[1],r=t[2],o=t[3],a=this.transitionsBetween(e,o)+1,l=this.transitionsBetween(r,o)+1,u=xt.shiftPoint(e,i,l*4),f=xt.shiftPoint(r,i,a*4);a=this.transitionsBetween(u,o)+1,l=this.transitionsBetween(f,o)+1,(a&1)===1&&(a+=1),(l&1)===1&&(l+=1);let x=(e.getX()+i.getX()+r.getX()+o.getX())/4,v=(e.getY()+i.getY()+r.getY()+o.getY())/4;e=xt.moveAway(e,x,v),i=xt.moveAway(i,x,v),r=xt.moveAway(r,x,v),o=xt.moveAway(o,x,v);let S,b;return u=xt.shiftPoint(e,i,l*4),u=xt.shiftPoint(u,o,a*4),S=xt.shiftPoint(i,e,l*4),S=xt.shiftPoint(S,r,a*4),f=xt.shiftPoint(r,o,l*4),f=xt.shiftPoint(f,i,a*4),b=xt.shiftPoint(o,r,l*4),b=xt.shiftPoint(b,e,a*4),[u,S,f,b]}isValid(t){return t.getX()>=0&&t.getX()<this.image.getWidth()&&t.getY()>0&&t.getY()<this.image.getHeight()}static sampleGrid(t,e,i,r,o,a,l){return In.getInstance().sampleGrid(t,a,l,.5,.5,a-.5,.5,a-.5,l-.5,.5,l-.5,e.getX(),e.getY(),o.getX(),o.getY(),r.getX(),r.getY(),i.getX(),i.getY())}transitionsBetween(t,e){let i=Math.trunc(t.getX()),r=Math.trunc(t.getY()),o=Math.trunc(e.getX()),a=Math.trunc(e.getY()),l=Math.abs(a-r)>Math.abs(o-i);if(l){let R=i;i=r,r=R,R=o,o=a,a=R}let u=Math.abs(o-i),f=Math.abs(a-r),x=-u/2,v=r<a?1:-1,S=i<o?1:-1,b=0,N=this.image.get(l?r:i,l?i:r);for(let R=i,F=r;R!==o;R+=S){let V=this.image.get(l?F:R,l?R:F);if(V!==N&&(b++,N=V),x+=f,x>0){if(F===a)break;F+=v,x-=u}}return b}}let me=(()=>{class p{constructor(){this.decoder=new dr}decode(e,i=null){let r,o;if(i!=null&&i.has(Ut.PURE_BARCODE)){let x=p.extractPureBits(e.getBlackMatrix());r=this.decoder.decode(x),o=p.NO_POINTS}else{let x=new xt(e.getBlackMatrix()).detect();r=this.decoder.decode(x.getBits()),o=x.getPoints()}let a=r.getRawBytes(),l=new Zt(r.getText(),a,8*a.length,o,it.DATA_MATRIX,st.currentTimeMillis()),u=r.getByteSegments();u!=null&&l.putMetadata(fe.BYTE_SEGMENTS,u);let f=r.getECLevel();return f!=null&&l.putMetadata(fe.ERROR_CORRECTION_LEVEL,f),l}reset(){}static extractPureBits(e){let i=e.getTopLeftOnBit(),r=e.getBottomRightOnBit();if(i==null||r==null)throw new Y;let o=this.moduleSize(i,e),a=i[1],l=r[1],u=i[0],x=(r[0]-u+1)/o,v=(l-a+1)/o;if(x<=0||v<=0)throw new Y;let S=o/2;a+=S,u+=S;let b=new le(x,v);for(let N=0;N<v;N++){let R=a+N*o;for(let F=0;F<x;F++)e.get(u+F*o,R)&&b.set(F,N)}return b}static moduleSize(e,i){let r=i.getWidth(),o=e[0],a=e[1];for(;o<r&&i.get(o,a);)o++;if(o===r)throw new Y;let l=o-e[0];if(l===0)throw new Y;return l}}return p.NO_POINTS=[],p})();class fr extends Ie{constructor(t=500){super(new me,t)}}var kn=function(p){return p[p.L=0]="L",p[p.M=1]="M",p[p.Q=2]="Q",p[p.H=3]="H",p}(kn||{});class kt{constructor(t,e,i){this.value=t,this.stringValue=e,this.bits=i,kt.FOR_BITS.set(i,this),kt.FOR_VALUE.set(t,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(t){switch(t){case"L":return kt.L;case"M":return kt.M;case"Q":return kt.Q;case"H":return kt.H;default:throw new H(t+"not available")}}toString(){return this.stringValue}equals(t){if(!(t instanceof kt))return!1;let e=t;return this.value===e.value}static forBits(t){if(t<0||t>=kt.FOR_BITS.size)throw new E;return kt.FOR_BITS.get(t)}}kt.FOR_BITS=new Map,kt.FOR_VALUE=new Map,kt.L=new kt(kn.L,"L",1),kt.M=new kt(kn.M,"M",0),kt.Q=new kt(kn.Q,"Q",3),kt.H=new kt(kn.H,"H",2);class Fe{constructor(t){this.errorCorrectionLevel=kt.forBits(t>>3&3),this.dataMask=t&7}static numBitsDiffering(t,e){return gt.bitCount(t^e)}static decodeFormatInformation(t,e){let i=Fe.doDecodeFormatInformation(t,e);return i!==null?i:Fe.doDecodeFormatInformation(t^Fe.FORMAT_INFO_MASK_QR,e^Fe.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(t,e){let i=Number.MAX_SAFE_INTEGER,r=0;for(let o of Fe.FORMAT_INFO_DECODE_LOOKUP){let a=o[0];if(a===t||a===e)return new Fe(o[1]);let l=Fe.numBitsDiffering(t,a);l<i&&(r=o[1],i=l),t!==e&&(l=Fe.numBitsDiffering(e,a),l<i&&(r=o[1],i=l))}return i<=3?new Fe(r):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(t){if(!(t instanceof Fe))return!1;let e=t;return this.errorCorrectionLevel===e.errorCorrectionLevel&&this.dataMask===e.dataMask}}Fe.FORMAT_INFO_MASK_QR=21522,Fe.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class U{constructor(t,...e){this.ecCodewordsPerBlock=t,this.ecBlocks=e}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let t=0,e=this.ecBlocks;for(let i of e)t+=i.getCount();return t}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class I{constructor(t,e){this.count=t,this.dataCodewords=e}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class at{constructor(t,e,...i){this.versionNumber=t,this.alignmentPatternCenters=e,this.ecBlocks=i;let r=0,o=i[0].getECCodewordsPerBlock(),a=i[0].getECBlocks();for(let l of a)r+=l.getCount()*(l.getDataCodewords()+o);this.totalCodewords=r}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(t){return this.ecBlocks[t.getValue()]}static getProvisionalVersionForDimension(t){if(t%4!==1)throw new tt;try{return this.getVersionForNumber((t-17)/4)}catch{throw new tt}}static getVersionForNumber(t){if(t<1||t>40)throw new E;return at.VERSIONS[t-1]}static decodeVersionInformation(t){let e=Number.MAX_SAFE_INTEGER,i=0;for(let r=0;r<at.VERSION_DECODE_INFO.length;r++){let o=at.VERSION_DECODE_INFO[r];if(o===t)return at.getVersionForNumber(r+7);let a=Fe.numBitsDiffering(t,o);a<e&&(i=r+7,e=a)}return e<=3?at.getVersionForNumber(i):null}buildFunctionPattern(){let t=this.getDimensionForVersion(),e=new le(t);e.setRegion(0,0,9,9),e.setRegion(t-8,0,8,9),e.setRegion(0,t-8,9,8);let i=this.alignmentPatternCenters.length;for(let r=0;r<i;r++){let o=this.alignmentPatternCenters[r]-2;for(let a=0;a<i;a++)r===0&&(a===0||a===i-1)||r===i-1&&a===0||e.setRegion(this.alignmentPatternCenters[a]-2,o,5,5)}return e.setRegion(6,9,1,t-17),e.setRegion(9,6,t-17,1),this.versionNumber>6&&(e.setRegion(t-11,0,3,6),e.setRegion(0,t-11,6,3)),e}toString(){return""+this.versionNumber}}at.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),at.VERSIONS=[new at(1,new Int32Array(0),new U(7,new I(1,19)),new U(10,new I(1,16)),new U(13,new I(1,13)),new U(17,new I(1,9))),new at(2,Int32Array.from([6,18]),new U(10,new I(1,34)),new U(16,new I(1,28)),new U(22,new I(1,22)),new U(28,new I(1,16))),new at(3,Int32Array.from([6,22]),new U(15,new I(1,55)),new U(26,new I(1,44)),new U(18,new I(2,17)),new U(22,new I(2,13))),new at(4,Int32Array.from([6,26]),new U(20,new I(1,80)),new U(18,new I(2,32)),new U(26,new I(2,24)),new U(16,new I(4,9))),new at(5,Int32Array.from([6,30]),new U(26,new I(1,108)),new U(24,new I(2,43)),new U(18,new I(2,15),new I(2,16)),new U(22,new I(2,11),new I(2,12))),new at(6,Int32Array.from([6,34]),new U(18,new I(2,68)),new U(16,new I(4,27)),new U(24,new I(4,19)),new U(28,new I(4,15))),new at(7,Int32Array.from([6,22,38]),new U(20,new I(2,78)),new U(18,new I(4,31)),new U(18,new I(2,14),new I(4,15)),new U(26,new I(4,13),new I(1,14))),new at(8,Int32Array.from([6,24,42]),new U(24,new I(2,97)),new U(22,new I(2,38),new I(2,39)),new U(22,new I(4,18),new I(2,19)),new U(26,new I(4,14),new I(2,15))),new at(9,Int32Array.from([6,26,46]),new U(30,new I(2,116)),new U(22,new I(3,36),new I(2,37)),new U(20,new I(4,16),new I(4,17)),new U(24,new I(4,12),new I(4,13))),new at(10,Int32Array.from([6,28,50]),new U(18,new I(2,68),new I(2,69)),new U(26,new I(4,43),new I(1,44)),new U(24,new I(6,19),new I(2,20)),new U(28,new I(6,15),new I(2,16))),new at(11,Int32Array.from([6,30,54]),new U(20,new I(4,81)),new U(30,new I(1,50),new I(4,51)),new U(28,new I(4,22),new I(4,23)),new U(24,new I(3,12),new I(8,13))),new at(12,Int32Array.from([6,32,58]),new U(24,new I(2,92),new I(2,93)),new U(22,new I(6,36),new I(2,37)),new U(26,new I(4,20),new I(6,21)),new U(28,new I(7,14),new I(4,15))),new at(13,Int32Array.from([6,34,62]),new U(26,new I(4,107)),new U(22,new I(8,37),new I(1,38)),new U(24,new I(8,20),new I(4,21)),new U(22,new I(12,11),new I(4,12))),new at(14,Int32Array.from([6,26,46,66]),new U(30,new I(3,115),new I(1,116)),new U(24,new I(4,40),new I(5,41)),new U(20,new I(11,16),new I(5,17)),new U(24,new I(11,12),new I(5,13))),new at(15,Int32Array.from([6,26,48,70]),new U(22,new I(5,87),new I(1,88)),new U(24,new I(5,41),new I(5,42)),new U(30,new I(5,24),new I(7,25)),new U(24,new I(11,12),new I(7,13))),new at(16,Int32Array.from([6,26,50,74]),new U(24,new I(5,98),new I(1,99)),new U(28,new I(7,45),new I(3,46)),new U(24,new I(15,19),new I(2,20)),new U(30,new I(3,15),new I(13,16))),new at(17,Int32Array.from([6,30,54,78]),new U(28,new I(1,107),new I(5,108)),new U(28,new I(10,46),new I(1,47)),new U(28,new I(1,22),new I(15,23)),new U(28,new I(2,14),new I(17,15))),new at(18,Int32Array.from([6,30,56,82]),new U(30,new I(5,120),new I(1,121)),new U(26,new I(9,43),new I(4,44)),new U(28,new I(17,22),new I(1,23)),new U(28,new I(2,14),new I(19,15))),new at(19,Int32Array.from([6,30,58,86]),new U(28,new I(3,113),new I(4,114)),new U(26,new I(3,44),new I(11,45)),new U(26,new I(17,21),new I(4,22)),new U(26,new I(9,13),new I(16,14))),new at(20,Int32Array.from([6,34,62,90]),new U(28,new I(3,107),new I(5,108)),new U(26,new I(3,41),new I(13,42)),new U(30,new I(15,24),new I(5,25)),new U(28,new I(15,15),new I(10,16))),new at(21,Int32Array.from([6,28,50,72,94]),new U(28,new I(4,116),new I(4,117)),new U(26,new I(17,42)),new U(28,new I(17,22),new I(6,23)),new U(30,new I(19,16),new I(6,17))),new at(22,Int32Array.from([6,26,50,74,98]),new U(28,new I(2,111),new I(7,112)),new U(28,new I(17,46)),new U(30,new I(7,24),new I(16,25)),new U(24,new I(34,13))),new at(23,Int32Array.from([6,30,54,78,102]),new U(30,new I(4,121),new I(5,122)),new U(28,new I(4,47),new I(14,48)),new U(30,new I(11,24),new I(14,25)),new U(30,new I(16,15),new I(14,16))),new at(24,Int32Array.from([6,28,54,80,106]),new U(30,new I(6,117),new I(4,118)),new U(28,new I(6,45),new I(14,46)),new U(30,new I(11,24),new I(16,25)),new U(30,new I(30,16),new I(2,17))),new at(25,Int32Array.from([6,32,58,84,110]),new U(26,new I(8,106),new I(4,107)),new U(28,new I(8,47),new I(13,48)),new U(30,new I(7,24),new I(22,25)),new U(30,new I(22,15),new I(13,16))),new at(26,Int32Array.from([6,30,58,86,114]),new U(28,new I(10,114),new I(2,115)),new U(28,new I(19,46),new I(4,47)),new U(28,new I(28,22),new I(6,23)),new U(30,new I(33,16),new I(4,17))),new at(27,Int32Array.from([6,34,62,90,118]),new U(30,new I(8,122),new I(4,123)),new U(28,new I(22,45),new I(3,46)),new U(30,new I(8,23),new I(26,24)),new U(30,new I(12,15),new I(28,16))),new at(28,Int32Array.from([6,26,50,74,98,122]),new U(30,new I(3,117),new I(10,118)),new U(28,new I(3,45),new I(23,46)),new U(30,new I(4,24),new I(31,25)),new U(30,new I(11,15),new I(31,16))),new at(29,Int32Array.from([6,30,54,78,102,126]),new U(30,new I(7,116),new I(7,117)),new U(28,new I(21,45),new I(7,46)),new U(30,new I(1,23),new I(37,24)),new U(30,new I(19,15),new I(26,16))),new at(30,Int32Array.from([6,26,52,78,104,130]),new U(30,new I(5,115),new I(10,116)),new U(28,new I(19,47),new I(10,48)),new U(30,new I(15,24),new I(25,25)),new U(30,new I(23,15),new I(25,16))),new at(31,Int32Array.from([6,30,56,82,108,134]),new U(30,new I(13,115),new I(3,116)),new U(28,new I(2,46),new I(29,47)),new U(30,new I(42,24),new I(1,25)),new U(30,new I(23,15),new I(28,16))),new at(32,Int32Array.from([6,34,60,86,112,138]),new U(30,new I(17,115)),new U(28,new I(10,46),new I(23,47)),new U(30,new I(10,24),new I(35,25)),new U(30,new I(19,15),new I(35,16))),new at(33,Int32Array.from([6,30,58,86,114,142]),new U(30,new I(17,115),new I(1,116)),new U(28,new I(14,46),new I(21,47)),new U(30,new I(29,24),new I(19,25)),new U(30,new I(11,15),new I(46,16))),new at(34,Int32Array.from([6,34,62,90,118,146]),new U(30,new I(13,115),new I(6,116)),new U(28,new I(14,46),new I(23,47)),new U(30,new I(44,24),new I(7,25)),new U(30,new I(59,16),new I(1,17))),new at(35,Int32Array.from([6,30,54,78,102,126,150]),new U(30,new I(12,121),new I(7,122)),new U(28,new I(12,47),new I(26,48)),new U(30,new I(39,24),new I(14,25)),new U(30,new I(22,15),new I(41,16))),new at(36,Int32Array.from([6,24,50,76,102,128,154]),new U(30,new I(6,121),new I(14,122)),new U(28,new I(6,47),new I(34,48)),new U(30,new I(46,24),new I(10,25)),new U(30,new I(2,15),new I(64,16))),new at(37,Int32Array.from([6,28,54,80,106,132,158]),new U(30,new I(17,122),new I(4,123)),new U(28,new I(29,46),new I(14,47)),new U(30,new I(49,24),new I(10,25)),new U(30,new I(24,15),new I(46,16))),new at(38,Int32Array.from([6,32,58,84,110,136,162]),new U(30,new I(4,122),new I(18,123)),new U(28,new I(13,46),new I(32,47)),new U(30,new I(48,24),new I(14,25)),new U(30,new I(42,15),new I(32,16))),new at(39,Int32Array.from([6,26,54,82,110,138,166]),new U(30,new I(20,117),new I(4,118)),new U(28,new I(40,47),new I(7,48)),new U(30,new I(43,24),new I(22,25)),new U(30,new I(10,15),new I(67,16))),new at(40,Int32Array.from([6,30,58,86,114,142,170]),new U(30,new I(19,118),new I(6,119)),new U(28,new I(18,47),new I(31,48)),new U(30,new I(34,24),new I(34,25)),new U(30,new I(20,15),new I(61,16)))];var we=function(p){return p[p.DATA_MASK_000=0]="DATA_MASK_000",p[p.DATA_MASK_001=1]="DATA_MASK_001",p[p.DATA_MASK_010=2]="DATA_MASK_010",p[p.DATA_MASK_011=3]="DATA_MASK_011",p[p.DATA_MASK_100=4]="DATA_MASK_100",p[p.DATA_MASK_101=5]="DATA_MASK_101",p[p.DATA_MASK_110=6]="DATA_MASK_110",p[p.DATA_MASK_111=7]="DATA_MASK_111",p}(we||{});class Ue{constructor(t,e){this.value=t,this.isMasked=e}unmaskBitMatrix(t,e){for(let i=0;i<e;i++)for(let r=0;r<e;r++)this.isMasked(i,r)&&t.flip(r,i)}}Ue.values=new Map([[we.DATA_MASK_000,new Ue(we.DATA_MASK_000,(p,t)=>(p+t&1)===0)],[we.DATA_MASK_001,new Ue(we.DATA_MASK_001,(p,t)=>(p&1)===0)],[we.DATA_MASK_010,new Ue(we.DATA_MASK_010,(p,t)=>t%3===0)],[we.DATA_MASK_011,new Ue(we.DATA_MASK_011,(p,t)=>(p+t)%3===0)],[we.DATA_MASK_100,new Ue(we.DATA_MASK_100,(p,t)=>(Math.floor(p/2)+Math.floor(t/3)&1)===0)],[we.DATA_MASK_101,new Ue(we.DATA_MASK_101,(p,t)=>p*t%6===0)],[we.DATA_MASK_110,new Ue(we.DATA_MASK_110,(p,t)=>p*t%6<3)],[we.DATA_MASK_111,new Ue(we.DATA_MASK_111,(p,t)=>(p+t+p*t%3&1)===0)]]);class Si{constructor(t){let e=t.getHeight();if(e<21||(e&3)!==1)throw new tt;this.bitMatrix=t}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let t=0;for(let o=0;o<6;o++)t=this.copyBit(o,8,t);t=this.copyBit(7,8,t),t=this.copyBit(8,8,t),t=this.copyBit(8,7,t);for(let o=5;o>=0;o--)t=this.copyBit(8,o,t);let e=this.bitMatrix.getHeight(),i=0,r=e-7;for(let o=e-1;o>=r;o--)i=this.copyBit(8,o,i);for(let o=e-8;o<e;o++)i=this.copyBit(o,8,i);if(this.parsedFormatInfo=Fe.decodeFormatInformation(t,i),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new tt}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;let t=this.bitMatrix.getHeight(),e=Math.floor((t-17)/4);if(e<=6)return at.getVersionForNumber(e);let i=0,r=t-11;for(let a=5;a>=0;a--)for(let l=t-9;l>=r;l--)i=this.copyBit(l,a,i);let o=at.decodeVersionInformation(i);if(o!==null&&o.getDimensionForVersion()===t)return this.parsedVersion=o,o;i=0;for(let a=5;a>=0;a--)for(let l=t-9;l>=r;l--)i=this.copyBit(a,l,i);if(o=at.decodeVersionInformation(i),o!==null&&o.getDimensionForVersion()===t)return this.parsedVersion=o,o;throw new tt}copyBit(t,e,i){return(this.isMirror?this.bitMatrix.get(e,t):this.bitMatrix.get(t,e))?i<<1|1:i<<1}readCodewords(){let t=this.readFormatInformation(),e=this.readVersion(),i=Ue.values.get(t.getDataMask()),r=this.bitMatrix.getHeight();i.unmaskBitMatrix(this.bitMatrix,r);let o=e.buildFunctionPattern(),a=!0,l=new Uint8Array(e.getTotalCodewords()),u=0,f=0,x=0;for(let v=r-1;v>0;v-=2){v===6&&v--;for(let S=0;S<r;S++){let b=a?r-1-S:S;for(let N=0;N<2;N++)o.get(v-N,b)||(x++,f<<=1,this.bitMatrix.get(v-N,b)&&(f|=1),x===8&&(l[u++]=f,x=0,f=0))}a=!a}if(u!==e.getTotalCodewords())throw new tt;return l}remask(){if(this.parsedFormatInfo===null)return;let t=Ue.values[this.parsedFormatInfo.getDataMask()],e=this.bitMatrix.getHeight();t.unmaskBitMatrix(this.bitMatrix,e)}setMirror(t){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=t}mirror(){let t=this.bitMatrix;for(let e=0,i=t.getWidth();e<i;e++)for(let r=e+1,o=t.getHeight();r<o;r++)t.get(e,r)!==t.get(r,e)&&(t.flip(r,e),t.flip(e,r))}}class Ii{constructor(t,e){this.numDataCodewords=t,this.codewords=e}static getDataBlocks(t,e,i){if(t.length!==e.getTotalCodewords())throw new E;let r=e.getECBlocksForLevel(i),o=0,a=r.getECBlocks();for(let N of a)o+=N.getCount();let l=new Array(o),u=0;for(let N of a)for(let R=0;R<N.getCount();R++){let F=N.getDataCodewords(),V=r.getECCodewordsPerBlock()+F;l[u++]=new Ii(F,new Uint8Array(V))}let f=l[0].codewords.length,x=l.length-1;for(;x>=0&&l[x].codewords.length!==f;)x--;x++;let v=f-r.getECCodewordsPerBlock(),S=0;for(let N=0;N<v;N++)for(let R=0;R<u;R++)l[R].codewords[N]=t[S++];for(let N=x;N<u;N++)l[N].codewords[v]=t[S++];let b=l[0].codewords.length;for(let N=v;N<b;N++)for(let R=0;R<u;R++){let F=R<x?N:N+1;l[R].codewords[F]=t[S++]}return l}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var Ze=function(p){return p[p.TERMINATOR=0]="TERMINATOR",p[p.NUMERIC=1]="NUMERIC",p[p.ALPHANUMERIC=2]="ALPHANUMERIC",p[p.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",p[p.BYTE=4]="BYTE",p[p.ECI=5]="ECI",p[p.KANJI=6]="KANJI",p[p.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",p[p.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",p[p.HANZI=9]="HANZI",p}(Ze||{});class vt{constructor(t,e,i,r){this.value=t,this.stringValue=e,this.characterCountBitsForVersions=i,this.bits=r,vt.FOR_BITS.set(r,this),vt.FOR_VALUE.set(t,this)}static forBits(t){let e=vt.FOR_BITS.get(t);if(e===void 0)throw new E;return e}getCharacterCountBits(t){let e=t.getVersionNumber(),i;return e<=9?i=0:e<=26?i=1:i=2,this.characterCountBitsForVersions[i]}getValue(){return this.value}getBits(){return this.bits}equals(t){if(!(t instanceof vt))return!1;let e=t;return this.value===e.value}toString(){return this.stringValue}}vt.FOR_BITS=new Map,vt.FOR_VALUE=new Map,vt.TERMINATOR=new vt(Ze.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),vt.NUMERIC=new vt(Ze.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),vt.ALPHANUMERIC=new vt(Ze.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),vt.STRUCTURED_APPEND=new vt(Ze.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),vt.BYTE=new vt(Ze.BYTE,"BYTE",Int32Array.from([8,16,16]),4),vt.ECI=new vt(Ze.ECI,"ECI",Int32Array.from([0,0,0]),7),vt.KANJI=new vt(Ze.KANJI,"KANJI",Int32Array.from([8,10,12]),8),vt.FNC1_FIRST_POSITION=new vt(Ze.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),vt.FNC1_SECOND_POSITION=new vt(Ze.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),vt.HANZI=new vt(Ze.HANZI,"HANZI",Int32Array.from([8,10,12]),13);let ki=(()=>{class p{static decode(e,i,r,o){let a=new ai(e),l=new ne,u=new Array,f=-1,x=-1;try{let v=null,S=!1,b;do{if(a.available()<4)b=vt.TERMINATOR;else{let N=a.readBits(4);b=vt.forBits(N)}switch(b){case vt.TERMINATOR:break;case vt.FNC1_FIRST_POSITION:case vt.FNC1_SECOND_POSITION:S=!0;break;case vt.STRUCTURED_APPEND:if(a.available()<16)throw new tt;f=a.readBits(8),x=a.readBits(8);break;case vt.ECI:let N=p.parseECIValue(a);if(v=et.getCharacterSetECIByValue(N),v===null)throw new tt;break;case vt.HANZI:let R=a.readBits(4),F=a.readBits(b.getCharacterCountBits(i));R===p.GB2312_SUBSET&&p.decodeHanziSegment(a,l,F);break;default:let V=a.readBits(b.getCharacterCountBits(i));switch(b){case vt.NUMERIC:p.decodeNumericSegment(a,l,V);break;case vt.ALPHANUMERIC:p.decodeAlphanumericSegment(a,l,V,S);break;case vt.BYTE:p.decodeByteSegment(a,l,V,v,u,o);break;case vt.KANJI:p.decodeKanjiSegment(a,l,V);break;default:throw new tt}break}}while(b!==vt.TERMINATOR)}catch{throw new tt}return new ei(e,l.toString(),u.length===0?null:u,r===null?null:r.toString(),f,x)}static decodeHanziSegment(e,i,r){if(r*13>e.available())throw new tt;let o=new Uint8Array(2*r),a=0;for(;r>0;){let l=e.readBits(13),u=l/96<<8&4294967295|l%96;u<959?u+=41377:u+=42657,o[a]=u>>8&255,o[a+1]=u&255,a+=2,r--}try{i.append(oe.decode(o,wt.GB2312))}catch(l){throw new tt(l)}}static decodeKanjiSegment(e,i,r){if(r*13>e.available())throw new tt;let o=new Uint8Array(2*r),a=0;for(;r>0;){let l=e.readBits(13),u=l/192<<8&4294967295|l%192;u<7936?u+=33088:u+=49472,o[a]=u>>8,o[a+1]=u,a+=2,r--}try{i.append(oe.decode(o,wt.SHIFT_JIS))}catch(l){throw new tt(l)}}static decodeByteSegment(e,i,r,o,a,l){if(8*r>e.available())throw new tt;let u=new Uint8Array(r);for(let x=0;x<r;x++)u[x]=e.readBits(8);let f;o===null?f=wt.guessEncoding(u,l):f=o.getName();try{i.append(oe.decode(u,f))}catch(x){throw new tt(x)}a.push(u)}static toAlphaNumericChar(e){if(e>=p.ALPHANUMERIC_CHARS.length)throw new tt;return p.ALPHANUMERIC_CHARS[e]}static decodeAlphanumericSegment(e,i,r,o){let a=i.length();for(;r>1;){if(e.available()<11)throw new tt;let l=e.readBits(11);i.append(p.toAlphaNumericChar(Math.floor(l/45))),i.append(p.toAlphaNumericChar(l%45)),r-=2}if(r===1){if(e.available()<6)throw new tt;i.append(p.toAlphaNumericChar(e.readBits(6)))}if(o)for(let l=a;l<i.length();l++)i.charAt(l)==="%"&&(l<i.length()-1&&i.charAt(l+1)==="%"?i.deleteCharAt(l+1):i.setCharAt(l,""))}static decodeNumericSegment(e,i,r){for(;r>=3;){if(e.available()<10)throw new tt;let o=e.readBits(10);if(o>=1e3)throw new tt;i.append(p.toAlphaNumericChar(Math.floor(o/100))),i.append(p.toAlphaNumericChar(Math.floor(o/10)%10)),i.append(p.toAlphaNumericChar(o%10)),r-=3}if(r===2){if(e.available()<7)throw new tt;let o=e.readBits(7);if(o>=100)throw new tt;i.append(p.toAlphaNumericChar(Math.floor(o/10))),i.append(p.toAlphaNumericChar(o%10))}else if(r===1){if(e.available()<4)throw new tt;let o=e.readBits(4);if(o>=10)throw new tt;i.append(p.toAlphaNumericChar(o))}}static parseECIValue(e){let i=e.readBits(8);if(!(i&128))return i&127;if((i&192)===128){let r=e.readBits(8);return(i&63)<<8&4294967295|r}if((i&224)===192){let r=e.readBits(16);return(i&31)<<16&4294967295|r}throw new tt}}return p.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",p.GB2312_SUBSET=1,p})();class bi{constructor(t){this.mirrored=t}isMirrored(){return this.mirrored}applyMirroredCorrection(t){if(!this.mirrored||t===null||t.length<3)return;let e=t[0];t[0]=t[2],t[2]=e}}class pr{constructor(){this.rsDecoder=new ni(jt.QR_CODE_FIELD_256)}decodeBooleanArray(t,e){return this.decodeBitMatrix(le.parseFromBooleanArray(t),e)}decodeBitMatrix(t,e){let i=new Si(t),r=null;try{return this.decodeBitMatrixParser(i,e)}catch(o){r=o}try{i.remask(),i.setMirror(!0),i.readVersion(),i.readFormatInformation(),i.mirror();let o=this.decodeBitMatrixParser(i,e);return o.setOther(new bi(!0)),o}catch(o){throw r!==null?r:o}}decodeBitMatrixParser(t,e){let i=t.readVersion(),r=t.readFormatInformation().getErrorCorrectionLevel(),o=t.readCodewords(),a=Ii.getDataBlocks(o,i,r),l=0;for(let x of a)l+=x.getNumDataCodewords();let u=new Uint8Array(l),f=0;for(let x of a){let v=x.getCodewords(),S=x.getNumDataCodewords();this.correctErrors(v,S);for(let b=0;b<S;b++)u[f++]=v[b]}return ki.decode(u,i,r,e)}correctErrors(t,e){let i=new Int32Array(t);try{this.rsDecoder.decode(i,t.length-e)}catch{throw new $}for(let r=0;r<e;r++)t[r]=i[r]}}class Ti extends mt{constructor(t,e,i){super(t,e),this.estimatedModuleSize=i}aboutEquals(t,e,i){if(Math.abs(e-this.getY())<=t&&Math.abs(i-this.getX())<=t){let r=Math.abs(t-this.estimatedModuleSize);return r<=1||r<=this.estimatedModuleSize}return!1}combineEstimate(t,e,i){let r=(this.getX()+e)/2,o=(this.getY()+t)/2,a=(this.estimatedModuleSize+i)/2;return new Ti(r,o,a)}}class Yn{constructor(t,e,i,r,o,a,l){this.image=t,this.startX=e,this.startY=i,this.width=r,this.height=o,this.moduleSize=a,this.resultPointCallback=l,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){let t=this.startX,e=this.height,i=this.width,r=t+i,o=this.startY+e/2,a=new Int32Array(3),l=this.image;for(let u=0;u<e;u++){let f=o+(u&1?-Math.floor((u+1)/2):Math.floor((u+1)/2));a[0]=0,a[1]=0,a[2]=0;let x=t;for(;x<r&&!l.get(x,f);)x++;let v=0;for(;x<r;){if(l.get(x,f))if(v===1)a[1]++;else if(v===2){if(this.foundPatternCross(a)){let S=this.handlePossibleCenter(a,f,x);if(S!==null)return S}a[0]=a[2],a[1]=1,a[2]=0,v=1}else a[++v]++;else v===1&&v++,a[v]++;x++}if(this.foundPatternCross(a)){let S=this.handlePossibleCenter(a,f,r);if(S!==null)return S}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new Y}static centerFromEnd(t,e){return e-t[2]-t[1]/2}foundPatternCross(t){let e=this.moduleSize,i=e/2;for(let r=0;r<3;r++)if(Math.abs(e-t[r])>=i)return!1;return!0}crossCheckVertical(t,e,i,r){let o=this.image,a=o.getHeight(),l=this.crossCheckStateCount;l[0]=0,l[1]=0,l[2]=0;let u=t;for(;u>=0&&o.get(e,u)&&l[1]<=i;)l[1]++,u--;if(u<0||l[1]>i)return NaN;for(;u>=0&&!o.get(e,u)&&l[0]<=i;)l[0]++,u--;if(l[0]>i)return NaN;for(u=t+1;u<a&&o.get(e,u)&&l[1]<=i;)l[1]++,u++;if(u===a||l[1]>i)return NaN;for(;u<a&&!o.get(e,u)&&l[2]<=i;)l[2]++,u++;if(l[2]>i)return NaN;let f=l[0]+l[1]+l[2];return 5*Math.abs(f-r)>=2*r?NaN:this.foundPatternCross(l)?Yn.centerFromEnd(l,u):NaN}handlePossibleCenter(t,e,i){let r=t[0]+t[1]+t[2],o=Yn.centerFromEnd(t,i),a=this.crossCheckVertical(e,o,2*t[1],r);if(!isNaN(a)){let l=(t[0]+t[1]+t[2])/3;for(let f of this.possibleCenters)if(f.aboutEquals(l,a,o))return f.combineEstimate(a,o,l);let u=new Ti(o,a,l);this.possibleCenters.push(u),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(u)}return null}}class Fi extends mt{constructor(t,e,i,r){super(t,e),this.estimatedModuleSize=i,this.count=r,r===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(t,e,i){if(Math.abs(e-this.getY())<=t&&Math.abs(i-this.getX())<=t){let r=Math.abs(t-this.estimatedModuleSize);return r<=1||r<=this.estimatedModuleSize}return!1}combineEstimate(t,e,i){let r=this.count+1,o=(this.count*this.getX()+e)/r,a=(this.count*this.getY()+t)/r,l=(this.count*this.estimatedModuleSize+i)/r;return new Fi(o,a,l,r)}}class gr{constructor(t){this.bottomLeft=t[0],this.topLeft=t[1],this.topRight=t[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}let go=(()=>{class p{constructor(e,i){this.image=e,this.resultPointCallback=i,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=i}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(e){let i=e!=null&&e.get(Ut.TRY_HARDER)!==void 0,r=e!=null&&e.get(Ut.PURE_BARCODE)!==void 0,o=this.image,a=o.getHeight(),l=o.getWidth(),u=Math.floor(3*a/(4*p.MAX_MODULES));(u<p.MIN_SKIP||i)&&(u=p.MIN_SKIP);let f=!1,x=new Int32Array(5);for(let S=u-1;S<a&&!f;S+=u){x[0]=0,x[1]=0,x[2]=0,x[3]=0,x[4]=0;let b=0;for(let N=0;N<l;N++)if(o.get(N,S))(b&1)===1&&b++,x[b]++;else if(b&1)x[b]++;else if(b===4)if(p.foundPatternCross(x)){if(this.handlePossibleCenter(x,S,N,r)===!0)if(u=2,this.hasSkipped===!0)f=this.haveMultiplyConfirmedCenters();else{let F=this.findRowSkip();F>x[2]&&(S+=F-x[2]-u,N=l-1)}else{x[0]=x[2],x[1]=x[3],x[2]=x[4],x[3]=1,x[4]=0,b=3;continue}b=0,x[0]=0,x[1]=0,x[2]=0,x[3]=0,x[4]=0}else x[0]=x[2],x[1]=x[3],x[2]=x[4],x[3]=1,x[4]=0,b=3;else x[++b]++;p.foundPatternCross(x)&&this.handlePossibleCenter(x,S,l,r)===!0&&(u=x[0],this.hasSkipped&&(f=this.haveMultiplyConfirmedCenters()))}let v=this.selectBestPatterns();return mt.orderBestPatterns(v),new gr(v)}static centerFromEnd(e,i){return i-e[4]-e[3]-e[2]/2}static foundPatternCross(e){let i=0;for(let a=0;a<5;a++){let l=e[a];if(l===0)return!1;i+=l}if(i<7)return!1;let r=i/7,o=r/2;return Math.abs(r-e[0])<o&&Math.abs(r-e[1])<o&&Math.abs(3*r-e[2])<3*o&&Math.abs(r-e[3])<o&&Math.abs(r-e[4])<o}getCrossCheckStateCount(){let e=this.crossCheckStateCount;return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e}crossCheckDiagonal(e,i,r,o){let a=this.getCrossCheckStateCount(),l=0,u=this.image;for(;e>=l&&i>=l&&u.get(i-l,e-l);)a[2]++,l++;if(e<l||i<l)return!1;for(;e>=l&&i>=l&&!u.get(i-l,e-l)&&a[1]<=r;)a[1]++,l++;if(e<l||i<l||a[1]>r)return!1;for(;e>=l&&i>=l&&u.get(i-l,e-l)&&a[0]<=r;)a[0]++,l++;if(a[0]>r)return!1;let f=u.getHeight(),x=u.getWidth();for(l=1;e+l<f&&i+l<x&&u.get(i+l,e+l);)a[2]++,l++;if(e+l>=f||i+l>=x)return!1;for(;e+l<f&&i+l<x&&!u.get(i+l,e+l)&&a[3]<r;)a[3]++,l++;if(e+l>=f||i+l>=x||a[3]>=r)return!1;for(;e+l<f&&i+l<x&&u.get(i+l,e+l)&&a[4]<r;)a[4]++,l++;if(a[4]>=r)return!1;let v=a[0]+a[1]+a[2]+a[3]+a[4];return Math.abs(v-o)<2*o&&p.foundPatternCross(a)}crossCheckVertical(e,i,r,o){let a=this.image,l=a.getHeight(),u=this.getCrossCheckStateCount(),f=e;for(;f>=0&&a.get(i,f);)u[2]++,f--;if(f<0)return NaN;for(;f>=0&&!a.get(i,f)&&u[1]<=r;)u[1]++,f--;if(f<0||u[1]>r)return NaN;for(;f>=0&&a.get(i,f)&&u[0]<=r;)u[0]++,f--;if(u[0]>r)return NaN;for(f=e+1;f<l&&a.get(i,f);)u[2]++,f++;if(f===l)return NaN;for(;f<l&&!a.get(i,f)&&u[3]<r;)u[3]++,f++;if(f===l||u[3]>=r)return NaN;for(;f<l&&a.get(i,f)&&u[4]<r;)u[4]++,f++;if(u[4]>=r)return NaN;let x=u[0]+u[1]+u[2]+u[3]+u[4];return 5*Math.abs(x-o)>=2*o?NaN:p.foundPatternCross(u)?p.centerFromEnd(u,f):NaN}crossCheckHorizontal(e,i,r,o){let a=this.image,l=a.getWidth(),u=this.getCrossCheckStateCount(),f=e;for(;f>=0&&a.get(f,i);)u[2]++,f--;if(f<0)return NaN;for(;f>=0&&!a.get(f,i)&&u[1]<=r;)u[1]++,f--;if(f<0||u[1]>r)return NaN;for(;f>=0&&a.get(f,i)&&u[0]<=r;)u[0]++,f--;if(u[0]>r)return NaN;for(f=e+1;f<l&&a.get(f,i);)u[2]++,f++;if(f===l)return NaN;for(;f<l&&!a.get(f,i)&&u[3]<r;)u[3]++,f++;if(f===l||u[3]>=r)return NaN;for(;f<l&&a.get(f,i)&&u[4]<r;)u[4]++,f++;if(u[4]>=r)return NaN;let x=u[0]+u[1]+u[2]+u[3]+u[4];return 5*Math.abs(x-o)>=o?NaN:p.foundPatternCross(u)?p.centerFromEnd(u,f):NaN}handlePossibleCenter(e,i,r,o){let a=e[0]+e[1]+e[2]+e[3]+e[4],l=p.centerFromEnd(e,r),u=this.crossCheckVertical(i,Math.floor(l),e[2],a);if(!isNaN(u)&&(l=this.crossCheckHorizontal(Math.floor(l),Math.floor(u),e[2],a),!isNaN(l)&&(!o||this.crossCheckDiagonal(Math.floor(u),Math.floor(l),e[2],a)))){let f=a/7,x=!1,v=this.possibleCenters;for(let S=0,b=v.length;S<b;S++){let N=v[S];if(N.aboutEquals(f,u,l)){v[S]=N.combineEstimate(u,l,f),x=!0;break}}if(!x){let S=new Fi(l,u,f);v.push(S),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(S)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let i=null;for(let r of this.possibleCenters)if(r.getCount()>=p.CENTER_QUORUM)if(i==null)i=r;else return this.hasSkipped=!0,Math.floor((Math.abs(i.getX()-r.getX())-Math.abs(i.getY()-r.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let e=0,i=0,r=this.possibleCenters.length;for(let l of this.possibleCenters)l.getCount()>=p.CENTER_QUORUM&&(e++,i+=l.getEstimatedModuleSize());if(e<3)return!1;let o=i/r,a=0;for(let l of this.possibleCenters)a+=Math.abs(l.getEstimatedModuleSize()-o);return a<=.05*i}selectBestPatterns(){let e=this.possibleCenters.length;if(e<3)throw new Y;let i=this.possibleCenters,r;if(e>3){let o=0,a=0;for(let f of this.possibleCenters){let x=f.getEstimatedModuleSize();o+=x,a+=x*x}r=o/e;let l=Math.sqrt(a/e-r*r);i.sort((f,x)=>{let v=Math.abs(x.getEstimatedModuleSize()-r),S=Math.abs(f.getEstimatedModuleSize()-r);return v<S?-1:v>S?1:0});let u=Math.max(.2*r,l);for(let f=0;f<i.length&&i.length>3;f++){let x=i[f];Math.abs(x.getEstimatedModuleSize()-r)>u&&(i.splice(f,1),f--)}}if(i.length>3){let o=0;for(let a of i)o+=a.getEstimatedModuleSize();r=o/i.length,i.sort((a,l)=>{if(l.getCount()===a.getCount()){let u=Math.abs(l.getEstimatedModuleSize()-r),f=Math.abs(a.getEstimatedModuleSize()-r);return u<f?1:u>f?-1:0}else return l.getCount()-a.getCount()}),i.splice(3)}return[i[0],i[1],i[2]]}}return p.CENTER_QUORUM=2,p.MIN_SKIP=3,p.MAX_MODULES=57,p})();class Tt{constructor(t){this.image=t}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(t){this.resultPointCallback=t==null?null:t.get(Ut.NEED_RESULT_POINT_CALLBACK);let i=new go(this.image,this.resultPointCallback).find(t);return this.processFinderPatternInfo(i)}processFinderPatternInfo(t){let e=t.getTopLeft(),i=t.getTopRight(),r=t.getBottomLeft(),o=this.calculateModuleSize(e,i,r);if(o<1)throw new Y("No pattern found in proccess finder.");let a=Tt.computeDimension(e,i,r,o),l=at.getProvisionalVersionForDimension(a),u=l.getDimensionForVersion()-7,f=null;if(l.getAlignmentPatternCenters().length>0){let b=i.getX()-e.getX()+r.getX(),N=i.getY()-e.getY()+r.getY(),R=1-3/u,F=Math.floor(e.getX()+R*(b-e.getX())),V=Math.floor(e.getY()+R*(N-e.getY()));for(let J=4;J<=16;J<<=1)try{f=this.findAlignmentInRegion(o,F,V,J);break}catch(ot){if(!(ot instanceof Y))throw ot}}let x=Tt.createTransform(e,i,r,f,a),v=Tt.sampleGrid(this.image,x,a),S;return f===null?S=[r,e,i]:S=[r,e,i,f],new xi(v,S)}static createTransform(t,e,i,r,o){let a=o-3.5,l,u,f,x;return r!==null?(l=r.getX(),u=r.getY(),f=a-3,x=f):(l=e.getX()-t.getX()+i.getX(),u=e.getY()-t.getY()+i.getY(),f=a,x=a),Qe.quadrilateralToQuadrilateral(3.5,3.5,a,3.5,f,x,3.5,a,t.getX(),t.getY(),e.getX(),e.getY(),l,u,i.getX(),i.getY())}static sampleGrid(t,e,i){return In.getInstance().sampleGridWithTransform(t,i,i,e)}static computeDimension(t,e,i,r){let o=Xt.round(mt.distance(t,e)/r),a=Xt.round(mt.distance(t,i)/r),l=Math.floor((o+a)/2)+7;switch(l&3){case 0:l++;break;case 2:l--;break;case 3:throw new Y("Dimensions could be not found.")}return l}calculateModuleSize(t,e,i){return(this.calculateModuleSizeOneWay(t,e)+this.calculateModuleSizeOneWay(t,i))/2}calculateModuleSizeOneWay(t,e){let i=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(t.getX()),Math.floor(t.getY()),Math.floor(e.getX()),Math.floor(e.getY())),r=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(e.getX()),Math.floor(e.getY()),Math.floor(t.getX()),Math.floor(t.getY()));return isNaN(i)?r/7:isNaN(r)?i/7:(i+r)/14}sizeOfBlackWhiteBlackRunBothWays(t,e,i,r){let o=this.sizeOfBlackWhiteBlackRun(t,e,i,r),a=1,l=t-(i-t);l<0?(a=t/(t-l),l=0):l>=this.image.getWidth()&&(a=(this.image.getWidth()-1-t)/(l-t),l=this.image.getWidth()-1);let u=Math.floor(e-(r-e)*a);return a=1,u<0?(a=e/(e-u),u=0):u>=this.image.getHeight()&&(a=(this.image.getHeight()-1-e)/(u-e),u=this.image.getHeight()-1),l=Math.floor(t+(l-t)*a),o+=this.sizeOfBlackWhiteBlackRun(t,e,l,u),o-1}sizeOfBlackWhiteBlackRun(t,e,i,r){let o=Math.abs(r-e)>Math.abs(i-t);if(o){let b=t;t=e,e=b,b=i,i=r,r=b}let a=Math.abs(i-t),l=Math.abs(r-e),u=-a/2,f=t<i?1:-1,x=e<r?1:-1,v=0,S=i+f;for(let b=t,N=e;b!==S;b+=f){let R=o?N:b,F=o?b:N;if(v===1===this.image.get(R,F)){if(v===2)return Xt.distance(b,N,t,e);v++}if(u+=l,u>0){if(N===r)break;N+=x,u-=a}}return v===2?Xt.distance(i+f,r,t,e):NaN}findAlignmentInRegion(t,e,i,r){let o=Math.floor(r*t),a=Math.max(0,e-o),l=Math.min(this.image.getWidth()-1,e+o);if(l-a<t*3)throw new Y("Alignment top exceeds estimated module size.");let u=Math.max(0,i-o),f=Math.min(this.image.getHeight()-1,i+o);if(f-u<t*3)throw new Y("Alignment bottom exceeds estimated module size.");return new Yn(this.image,a,u,l-a,f-u,t,this.resultPointCallback).find()}}class De{constructor(){this.decoder=new pr}getDecoder(){return this.decoder}decode(t,e){let i,r;if(e!=null&&e.get(Ut.PURE_BARCODE)!==void 0){let u=De.extractPureBits(t.getBlackMatrix());i=this.decoder.decodeBitMatrix(u,e),r=De.NO_POINTS}else{let u=new Tt(t.getBlackMatrix()).detect(e);i=this.decoder.decodeBitMatrix(u.getBits(),e),r=u.getPoints()}i.getOther()instanceof bi&&i.getOther().applyMirroredCorrection(r);let o=new Zt(i.getText(),i.getRawBytes(),void 0,r,it.QR_CODE,void 0),a=i.getByteSegments();a!==null&&o.putMetadata(fe.BYTE_SEGMENTS,a);let l=i.getECLevel();return l!==null&&o.putMetadata(fe.ERROR_CORRECTION_LEVEL,l),i.hasStructuredAppend()&&(o.putMetadata(fe.STRUCTURED_APPEND_SEQUENCE,i.getStructuredAppendSequenceNumber()),o.putMetadata(fe.STRUCTURED_APPEND_PARITY,i.getStructuredAppendParity())),o}reset(){}static extractPureBits(t){let e=t.getTopLeftOnBit(),i=t.getBottomRightOnBit();if(e===null||i===null)throw new Y;let r=this.moduleSize(e,t),o=e[1],a=i[1],l=e[0],u=i[0];if(l>=u||o>=a)throw new Y;if(a-o!==u-l&&(u=l+(a-o),u>=t.getWidth()))throw new Y;let f=Math.round((u-l+1)/r),x=Math.round((a-o+1)/r);if(f<=0||x<=0)throw new Y;if(x!==f)throw new Y;let v=Math.floor(r/2);o+=v,l+=v;let S=l+Math.floor((f-1)*r)-u;if(S>0){if(S>v)throw new Y;l-=S}let b=o+Math.floor((x-1)*r)-a;if(b>0){if(b>v)throw new Y;o-=b}let N=new le(f,x);for(let R=0;R<x;R++){let F=o+Math.floor(R*r);for(let V=0;V<f;V++)t.get(l+Math.floor(V*r),F)&&N.set(V,R)}return N}static moduleSize(t,e){let i=e.getHeight(),r=e.getWidth(),o=t[0],a=t[1],l=!0,u=0;for(;o<r&&a<i;){if(l!==e.get(o,a)){if(++u===5)break;l=!l}o++,a++}if(o===r||a===i)throw new Y;return(o-t[0])/7}}De.NO_POINTS=new Array;class lt{PDF417Common(){}static getBitCountSum(t){return Xt.sum(t)}static toIntArray(t){if(t==null||!t.length)return lt.EMPTY_INT_ARRAY;let e=new Int32Array(t.length),i=0;for(let r of t)e[i++]=r;return e}static getCodeword(t){let e=Lt.binarySearch(lt.SYMBOL_TABLE,t&262143);return e<0?-1:(lt.CODEWORD_TABLE[e]-1)%lt.NUMBER_OF_CODEWORDS}}lt.NUMBER_OF_CODEWORDS=929,lt.MAX_CODEWORDS_IN_BARCODE=lt.NUMBER_OF_CODEWORDS-1,lt.MIN_ROWS_IN_BARCODE=3,lt.MAX_ROWS_IN_BARCODE=90,lt.MODULES_IN_CODEWORD=17,lt.MODULES_IN_STOP_PATTERN=18,lt.BARS_IN_MODULE=8,lt.EMPTY_INT_ARRAY=new Int32Array([]),lt.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),lt.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class Pr{constructor(t,e){this.bits=t,this.points=e}getBits(){return this.bits}getPoints(){return this.points}}class Nt{static detectMultiple(t,e,i){let r=t.getBlackMatrix(),o=Nt.detect(i,r);return o.length||(r=r.clone(),r.rotate180(),o=Nt.detect(i,r)),new Pr(r,o)}static detect(t,e){let i=new Array,r=0,o=0,a=!1;for(;r<e.getHeight();){let l=Nt.findVertices(e,r,o);if(l[0]==null&&l[3]==null){if(!a)break;a=!1,o=0;for(let u of i)u[1]!=null&&(r=Math.trunc(Math.max(r,u[1].getY()))),u[3]!=null&&(r=Math.max(r,Math.trunc(u[3].getY())));r+=Nt.ROW_STEP;continue}if(a=!0,i.push(l),!t)break;l[2]!=null?(o=Math.trunc(l[2].getX()),r=Math.trunc(l[2].getY())):(o=Math.trunc(l[4].getX()),r=Math.trunc(l[4].getY()))}return i}static findVertices(t,e,i){let r=t.getHeight(),o=t.getWidth(),a=new Array(8);return Nt.copyToResult(a,Nt.findRowsWithPattern(t,r,o,e,i,Nt.START_PATTERN),Nt.INDEXES_START_PATTERN),a[4]!=null&&(i=Math.trunc(a[4].getX()),e=Math.trunc(a[4].getY())),Nt.copyToResult(a,Nt.findRowsWithPattern(t,r,o,e,i,Nt.STOP_PATTERN),Nt.INDEXES_STOP_PATTERN),a}static copyToResult(t,e,i){for(let r=0;r<i.length;r++)t[i[r]]=e[r]}static findRowsWithPattern(t,e,i,r,o,a){let l=new Array(4),u=!1,f=new Int32Array(a.length);for(;r<e;r+=Nt.ROW_STEP){let v=Nt.findGuardPattern(t,o,r,i,!1,a,f);if(v!=null){for(;r>0;){let S=Nt.findGuardPattern(t,o,--r,i,!1,a,f);if(S!=null)v=S;else{r++;break}}l[0]=new mt(v[0],r),l[1]=new mt(v[1],r),u=!0;break}}let x=r+1;if(u){let v=0,S=Int32Array.from([Math.trunc(l[0].getX()),Math.trunc(l[1].getX())]);for(;x<e;x++){let b=Nt.findGuardPattern(t,S[0],x,i,!1,a,f);if(b!=null&&Math.abs(S[0]-b[0])<Nt.MAX_PATTERN_DRIFT&&Math.abs(S[1]-b[1])<Nt.MAX_PATTERN_DRIFT)S=b,v=0;else{if(v>Nt.SKIPPED_ROW_COUNT_MAX)break;v++}}x-=v+1,l[2]=new mt(S[0],x),l[3]=new mt(S[1],x)}return x-r<Nt.BARCODE_MIN_HEIGHT&&Lt.fill(l,null),l}static findGuardPattern(t,e,i,r,o,a,l){Lt.fillWithin(l,0,l.length,0);let u=e,f=0;for(;t.get(u,i)&&u>0&&f++<Nt.MAX_PIXEL_DRIFT;)u--;let x=u,v=0,S=a.length;for(let b=o;x<r;x++)if(t.get(x,i)!==b)l[v]++;else{if(v===S-1){if(Nt.patternMatchVariance(l,a,Nt.MAX_INDIVIDUAL_VARIANCE)<Nt.MAX_AVG_VARIANCE)return new Int32Array([u,x]);u+=l[0]+l[1],st.arraycopy(l,2,l,0,v-1),l[v-1]=0,l[v]=0,v--}else v++;l[v]=1,b=!b}return v===S-1&&Nt.patternMatchVariance(l,a,Nt.MAX_INDIVIDUAL_VARIANCE)<Nt.MAX_AVG_VARIANCE?new Int32Array([u,x-1]):null}static patternMatchVariance(t,e,i){let r=t.length,o=0,a=0;for(let f=0;f<r;f++)o+=t[f],a+=e[f];if(o<a)return 1/0;let l=o/a;i*=l;let u=0;for(let f=0;f<r;f++){let x=t[f],v=e[f]*l,S=x>v?x-v:v-x;if(S>i)return 1/0;u+=S}return u/o}}Nt.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),Nt.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),Nt.MAX_AVG_VARIANCE=.42,Nt.MAX_INDIVIDUAL_VARIANCE=.8,Nt.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),Nt.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),Nt.MAX_PIXEL_DRIFT=3,Nt.MAX_PATTERN_DRIFT=5,Nt.SKIPPED_ROW_COUNT_MAX=25,Nt.ROW_STEP=5,Nt.BARCODE_MIN_HEIGHT=10;class Me{constructor(t,e){if(e.length===0)throw new E;this.field=t;let i=e.length;if(i>1&&e[0]===0){let r=1;for(;r<i&&e[r]===0;)r++;r===i?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(i-r),st.arraycopy(e,r,this.coefficients,0,this.coefficients.length))}else this.coefficients=e}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(t){return this.coefficients[this.coefficients.length-1-t]}evaluateAt(t){if(t===0)return this.getCoefficient(0);if(t===1){let r=0;for(let o of this.coefficients)r=this.field.add(r,o);return r}let e=this.coefficients[0],i=this.coefficients.length;for(let r=1;r<i;r++)e=this.field.add(this.field.multiply(t,e),this.coefficients[r]);return e}add(t){if(!this.field.equals(t.field))throw new E("ModulusPolys do not have same ModulusGF field");if(this.isZero())return t;if(t.isZero())return this;let e=this.coefficients,i=t.coefficients;if(e.length>i.length){let a=e;e=i,i=a}let r=new Int32Array(i.length),o=i.length-e.length;st.arraycopy(i,0,r,0,o);for(let a=o;a<i.length;a++)r[a]=this.field.add(e[a-o],i[a]);return new Me(this.field,r)}subtract(t){if(!this.field.equals(t.field))throw new E("ModulusPolys do not have same ModulusGF field");return t.isZero()?this:this.add(t.negative())}multiply(t){return t instanceof Me?this.multiplyOther(t):this.multiplyScalar(t)}multiplyOther(t){if(!this.field.equals(t.field))throw new E("ModulusPolys do not have same ModulusGF field");if(this.isZero()||t.isZero())return new Me(this.field,new Int32Array([0]));let e=this.coefficients,i=e.length,r=t.coefficients,o=r.length,a=new Int32Array(i+o-1);for(let l=0;l<i;l++){let u=e[l];for(let f=0;f<o;f++)a[l+f]=this.field.add(a[l+f],this.field.multiply(u,r[f]))}return new Me(this.field,a)}negative(){let t=this.coefficients.length,e=new Int32Array(t);for(let i=0;i<t;i++)e[i]=this.field.subtract(0,this.coefficients[i]);return new Me(this.field,e)}multiplyScalar(t){if(t===0)return new Me(this.field,new Int32Array([0]));if(t===1)return this;let e=this.coefficients.length,i=new Int32Array(e);for(let r=0;r<e;r++)i[r]=this.field.multiply(this.coefficients[r],t);return new Me(this.field,i)}multiplyByMonomial(t,e){if(t<0)throw new E;if(e===0)return new Me(this.field,new Int32Array([0]));let i=this.coefficients.length,r=new Int32Array(i+t);for(let o=0;o<i;o++)r[o]=this.field.multiply(this.coefficients[o],e);return new Me(this.field,r)}toString(){let t=new ne;for(let e=this.getDegree();e>=0;e--){let i=this.getCoefficient(e);i!==0&&(i<0?(t.append(" - "),i=-i):t.length()>0&&t.append(" + "),(e===0||i!==1)&&t.append(i),e!==0&&(e===1?t.append("x"):(t.append("x^"),t.append(e))))}return t.toString()}}class mr{add(t,e){return(t+e)%this.modulus}subtract(t,e){return(this.modulus+t-e)%this.modulus}exp(t){return this.expTable[t]}log(t){if(t===0)throw new E;return this.logTable[t]}inverse(t){if(t===0)throw new Zn;return this.expTable[this.modulus-this.logTable[t]-1]}multiply(t,e){return t===0||e===0?0:this.expTable[(this.logTable[t]+this.logTable[e])%(this.modulus-1)]}getSize(){return this.modulus}equals(t){return t===this}}class bn extends mr{constructor(t,e){super(),this.modulus=t,this.expTable=new Int32Array(t),this.logTable=new Int32Array(t);let i=1;for(let r=0;r<t;r++)this.expTable[r]=i,i=i*e%t;for(let r=0;r<t-1;r++)this.logTable[this.expTable[r]]=r;this.zero=new Me(this,new Int32Array([0])),this.one=new Me(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(t,e){if(t<0)throw new E;if(e===0)return this.zero;let i=new Int32Array(t+1);return i[0]=e,new Me(this,i)}}bn.PDF417_GF=new bn(lt.NUMBER_OF_CODEWORDS,3);class Ui{constructor(){this.field=bn.PDF417_GF}decode(t,e,i){let r=new Me(this.field,t),o=new Int32Array(e),a=!1;for(let N=e;N>0;N--){let R=r.evaluateAt(this.field.exp(N));o[e-N]=R,R!==0&&(a=!0)}if(!a)return 0;let l=this.field.getOne();if(i!=null)for(let N of i){let R=this.field.exp(t.length-1-N),F=new Me(this.field,new Int32Array([this.field.subtract(0,R),1]));l=l.multiply(F)}let u=new Me(this.field,o),f=this.runEuclideanAlgorithm(this.field.buildMonomial(e,1),u,e),x=f[0],v=f[1],S=this.findErrorLocations(x),b=this.findErrorMagnitudes(v,x,S);for(let N=0;N<S.length;N++){let R=t.length-1-this.field.log(S[N]);if(R<0)throw $.getChecksumInstance();t[R]=this.field.subtract(t[R],b[N])}return S.length}runEuclideanAlgorithm(t,e,i){if(t.getDegree()<e.getDegree()){let S=t;t=e,e=S}let r=t,o=e,a=this.field.getZero(),l=this.field.getOne();for(;o.getDegree()>=Math.round(i/2);){let S=r,b=a;if(r=o,a=l,r.isZero())throw $.getChecksumInstance();o=S;let N=this.field.getZero(),R=r.getCoefficient(r.getDegree()),F=this.field.inverse(R);for(;o.getDegree()>=r.getDegree()&&!o.isZero();){let V=o.getDegree()-r.getDegree(),J=this.field.multiply(o.getCoefficient(o.getDegree()),F);N=N.add(this.field.buildMonomial(V,J)),o=o.subtract(r.multiplyByMonomial(V,J))}l=N.multiply(a).subtract(b).negative()}let u=l.getCoefficient(0);if(u===0)throw $.getChecksumInstance();let f=this.field.inverse(u),x=l.multiply(f),v=o.multiply(f);return[x,v]}findErrorLocations(t){let e=t.getDegree(),i=new Int32Array(e),r=0;for(let o=1;o<this.field.getSize()&&r<e;o++)t.evaluateAt(o)===0&&(i[r]=this.field.inverse(o),r++);if(r!==e)throw $.getChecksumInstance();return i}findErrorMagnitudes(t,e,i){let r=e.getDegree(),o=new Int32Array(r);for(let f=1;f<=r;f++)o[r-f]=this.field.multiply(f,e.getCoefficient(f));let a=new Me(this.field,o),l=i.length,u=new Int32Array(l);for(let f=0;f<l;f++){let x=this.field.inverse(i[f]),v=this.field.subtract(0,t.evaluateAt(x)),S=this.field.inverse(a.evaluateAt(x));u[f]=this.field.multiply(v,S)}return u}}class cn{constructor(t,e,i,r,o){t instanceof cn?this.constructor_2(t):this.constructor_1(t,e,i,r,o)}constructor_1(t,e,i,r,o){let a=e==null||i==null,l=r==null||o==null;if(a&&l)throw new Y;a?(e=new mt(0,r.getY()),i=new mt(0,o.getY())):l&&(r=new mt(t.getWidth()-1,e.getY()),o=new mt(t.getWidth()-1,i.getY())),this.image=t,this.topLeft=e,this.bottomLeft=i,this.topRight=r,this.bottomRight=o,this.minX=Math.trunc(Math.min(e.getX(),i.getX())),this.maxX=Math.trunc(Math.max(r.getX(),o.getX())),this.minY=Math.trunc(Math.min(e.getY(),r.getY())),this.maxY=Math.trunc(Math.max(i.getY(),o.getY()))}constructor_2(t){this.image=t.image,this.topLeft=t.getTopLeft(),this.bottomLeft=t.getBottomLeft(),this.topRight=t.getTopRight(),this.bottomRight=t.getBottomRight(),this.minX=t.getMinX(),this.maxX=t.getMaxX(),this.minY=t.getMinY(),this.maxY=t.getMaxY()}static merge(t,e){return t==null?e:e==null?t:new cn(t.image,t.topLeft,t.bottomLeft,e.topRight,e.bottomRight)}addMissingRows(t,e,i){let r=this.topLeft,o=this.bottomLeft,a=this.topRight,l=this.bottomRight;if(t>0){let u=i?this.topLeft:this.topRight,f=Math.trunc(u.getY()-t);f<0&&(f=0);let x=new mt(u.getX(),f);i?r=x:a=x}if(e>0){let u=i?this.bottomLeft:this.bottomRight,f=Math.trunc(u.getY()+e);f>=this.image.getHeight()&&(f=this.image.getHeight()-1);let x=new mt(u.getX(),f);i?o=x:l=x}return new cn(this.image,r,o,a,l)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class Re{constructor(t,e,i,r){this.columnCount=t,this.errorCorrectionLevel=r,this.rowCountUpperPart=e,this.rowCountLowerPart=i,this.rowCount=e+i}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class hn{constructor(){this.buffer=""}static form(t,e){let i=-1;function r(a,l,u,f,x,v){if(a==="%%")return"%";if(e[++i]===void 0)return;a=f?parseInt(f.substr(1)):void 0;let S=x?parseInt(x.substr(1)):void 0,b;switch(v){case"s":b=e[i];break;case"c":b=e[i][0];break;case"f":b=parseFloat(e[i]).toFixed(a);break;case"p":b=parseFloat(e[i]).toPrecision(a);break;case"e":b=parseFloat(e[i]).toExponential(a);break;case"x":b=parseInt(e[i]).toString(S||16);break;case"d":b=parseFloat(parseInt(e[i],S||10).toPrecision(a)).toFixed(0);break}b=typeof b=="object"?JSON.stringify(b):(+b).toString(S);let N=parseInt(u),R=u&&u[0]+""=="0"?"0":" ";for(;b.length<N;)b=l!==void 0?b+R:R+b;return b}let o=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return t.replace(o,r)}format(t,...e){this.buffer+=hn.form(t,e)}toString(){return this.buffer}}let _r=(()=>{class p{constructor(e){this.boundingBox=new cn(e),this.codewords=new Array(e.getMaxY()-e.getMinY()+1)}getCodewordNearby(e){let i=this.getCodeword(e);if(i!=null)return i;for(let r=1;r<p.MAX_NEARBY_DISTANCE;r++){let o=this.imageRowToCodewordIndex(e)-r;if(o>=0&&(i=this.codewords[o],i!=null)||(o=this.imageRowToCodewordIndex(e)+r,o<this.codewords.length&&(i=this.codewords[o],i!=null)))return i}return null}imageRowToCodewordIndex(e){return e-this.boundingBox.getMinY()}setCodeword(e,i){this.codewords[this.imageRowToCodewordIndex(e)]=i}getCodeword(e){return this.codewords[this.imageRowToCodewordIndex(e)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){let e=new hn,i=0;for(let r of this.codewords){if(r==null){e.format("%3d:    |   %n",i++);continue}e.format("%3d: %3d|%3d%n",i++,r.getRowNumber(),r.getValue())}return e.toString()}}return p.MAX_NEARBY_DISTANCE=5,p})();class li{constructor(){this.values=new Map}setValue(t){t=Math.trunc(t);let e=this.values.get(t);e==null&&(e=0),e++,this.values.set(t,e)}getValue(){let t=-1,e=new Array;for(let[i,r]of this.values.entries()){let o={getKey:()=>i,getValue:()=>r};o.getValue()>t?(t=o.getValue(),e=[],e.push(o.getKey())):o.getValue()===t&&e.push(o.getKey())}return lt.toIntArray(e)}getConfidence(t){return this.values.get(t)}}class Br extends _r{constructor(t,e){super(t),this._isLeft=e}setRowNumbers(){for(let t of this.getCodewords())t?.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(t){let e=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(e,t);let i=this.getBoundingBox(),r=this._isLeft?i.getTopLeft():i.getTopRight(),o=this._isLeft?i.getBottomLeft():i.getBottomRight(),a=this.imageRowToCodewordIndex(Math.trunc(r.getY())),l=this.imageRowToCodewordIndex(Math.trunc(o.getY())),u=-1,f=1,x=0;for(let v=a;v<l;v++){if(e[v]==null)continue;let S=e[v],b=S.getRowNumber()-u;if(b===0)x++;else if(b===1)f=Math.max(f,x),x=1,u=S.getRowNumber();else if(b<0||S.getRowNumber()>=t.getRowCount()||b>v)e[v]=null;else{let N;f>2?N=(f-2)*b:N=b;let R=N>=v;for(let F=1;F<=N&&!R;F++)R=e[v-F]!=null;R?e[v]=null:(u=S.getRowNumber(),x=1)}}}getRowHeights(){let t=this.getBarcodeMetadata();if(t==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(t);let e=new Int32Array(t.getRowCount());for(let i of this.getCodewords())if(i!=null){let r=i.getRowNumber();if(r>=e.length)continue;e[r]++}return e}adjustIncompleteIndicatorColumnRowNumbers(t){let e=this.getBoundingBox(),i=this._isLeft?e.getTopLeft():e.getTopRight(),r=this._isLeft?e.getBottomLeft():e.getBottomRight(),o=this.imageRowToCodewordIndex(Math.trunc(i.getY())),a=this.imageRowToCodewordIndex(Math.trunc(r.getY())),l=this.getCodewords(),u=-1;for(let f=o;f<a;f++){if(l[f]==null)continue;let x=l[f];x.setRowNumberAsRowIndicatorColumn();let v=x.getRowNumber()-u;v===0||(v===1?u=x.getRowNumber():x.getRowNumber()>=t.getRowCount()?l[f]=null:u=x.getRowNumber())}}getBarcodeMetadata(){let t=this.getCodewords(),e=new li,i=new li,r=new li,o=new li;for(let l of t){if(l==null)continue;l.setRowNumberAsRowIndicatorColumn();let u=l.getValue()%30,f=l.getRowNumber();switch(this._isLeft||(f+=2),f%3){case 0:i.setValue(u*3+1);break;case 1:o.setValue(u/3),r.setValue(u%3);break;case 2:e.setValue(u+1);break}}if(e.getValue().length===0||i.getValue().length===0||r.getValue().length===0||o.getValue().length===0||e.getValue()[0]<1||i.getValue()[0]+r.getValue()[0]<lt.MIN_ROWS_IN_BARCODE||i.getValue()[0]+r.getValue()[0]>lt.MAX_ROWS_IN_BARCODE)return null;let a=new Re(e.getValue()[0],i.getValue()[0],r.getValue()[0],o.getValue()[0]);return this.removeIncorrectCodewords(t,a),a}removeIncorrectCodewords(t,e){for(let i=0;i<t.length;i++){let r=t[i];if(t[i]==null)continue;let o=r.getValue()%30,a=r.getRowNumber();if(a>e.getRowCount()){t[i]=null;continue}switch(this._isLeft||(a+=2),a%3){case 0:o*3+1!==e.getRowCountUpperPart()&&(t[i]=null);break;case 1:(Math.trunc(o/3)!==e.getErrorCorrectionLevel()||o%3!==e.getRowCountLowerPart())&&(t[i]=null);break;case 2:o+1!==e.getColumnCount()&&(t[i]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class ci{constructor(t,e){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=t,this.barcodeColumnCount=t.getColumnCount(),this.boundingBox=e,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let t=lt.MAX_CODEWORDS_IN_BARCODE,e;do e=t,t=this.adjustRowNumbersAndGetCount();while(t>0&&t<e);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(t){t?.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let t=this.adjustRowNumbersByRow();if(t===0)return 0;for(let e=1;e<this.barcodeColumnCount+1;e++){let i=this.detectionResultColumns[e].getCodewords();for(let r=0;r<i.length;r++)i[r]!=null&&(i[r].hasValidRowNumber()||this.adjustRowNumbers(e,r,i))}return t}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let t=this.detectionResultColumns[0].getCodewords(),e=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let i=0;i<t.length;i++)if(t[i]!=null&&e[i]!=null&&t[i].getRowNumber()===e[i].getRowNumber())for(let r=1;r<=this.barcodeColumnCount;r++){let o=this.detectionResultColumns[r].getCodewords()[i];o!=null&&(o.setRowNumber(t[i].getRowNumber()),o.hasValidRowNumber()||(this.detectionResultColumns[r].getCodewords()[i]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let t=0,e=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let i=0;i<e.length;i++){if(e[i]==null)continue;let r=e[i].getRowNumber(),o=0;for(let a=this.barcodeColumnCount+1;a>0&&o<this.ADJUST_ROW_NUMBER_SKIP;a--){let l=this.detectionResultColumns[a].getCodewords()[i];l!=null&&(o=ci.adjustRowNumberIfValid(r,o,l),l.hasValidRowNumber()||t++)}}return t}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let t=0,e=this.detectionResultColumns[0].getCodewords();for(let i=0;i<e.length;i++){if(e[i]==null)continue;let r=e[i].getRowNumber(),o=0;for(let a=1;a<this.barcodeColumnCount+1&&o<this.ADJUST_ROW_NUMBER_SKIP;a++){let l=this.detectionResultColumns[a].getCodewords()[i];l!=null&&(o=ci.adjustRowNumberIfValid(r,o,l),l.hasValidRowNumber()||t++)}}return t}static adjustRowNumberIfValid(t,e,i){return i==null||i.hasValidRowNumber()||(i.isValidRowNumber(t)?(i.setRowNumber(t),e=0):++e),e}adjustRowNumbers(t,e,i){if(!this.detectionResultColumns[t-1])return;let r=i[e],o=this.detectionResultColumns[t-1].getCodewords(),a=o;this.detectionResultColumns[t+1]!=null&&(a=this.detectionResultColumns[t+1].getCodewords());let l=new Array(14);l[2]=o[e],l[3]=a[e],e>0&&(l[0]=i[e-1],l[4]=o[e-1],l[5]=a[e-1]),e>1&&(l[8]=i[e-2],l[10]=o[e-2],l[11]=a[e-2]),e<i.length-1&&(l[1]=i[e+1],l[6]=o[e+1],l[7]=a[e+1]),e<i.length-2&&(l[9]=i[e+2],l[12]=o[e+2],l[13]=a[e+2]);for(let u of l)if(ci.adjustRowNumber(r,u))return}static adjustRowNumber(t,e){return e==null?!1:e.hasValidRowNumber()&&e.getBucket()===t.getBucket()?(t.setRowNumber(e.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(t){this.boundingBox=t}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(t,e){this.detectionResultColumns[t]=e}getDetectionResultColumn(t){return this.detectionResultColumns[t]}toString(){let t=this.detectionResultColumns[0];t==null&&(t=this.detectionResultColumns[this.barcodeColumnCount+1]);let e=new hn;for(let i=0;i<t.getCodewords().length;i++){e.format("CW %3d:",i);for(let r=0;r<this.barcodeColumnCount+2;r++){if(this.detectionResultColumns[r]==null){e.format("    |   ");continue}let o=this.detectionResultColumns[r].getCodewords()[i];if(o==null){e.format("    |   ");continue}e.format(" %3d|%3d",o.getRowNumber(),o.getValue())}e.format("%n")}return e.toString()}}let xr=(()=>{class p{constructor(e,i,r,o){this.rowNumber=p.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(e),this.endX=Math.trunc(i),this.bucket=Math.trunc(r),this.value=Math.trunc(o)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(e){return e!==p.BARCODE_ROW_UNKNOWN&&this.bucket===e%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(e){this.rowNumber=e}toString(){return this.rowNumber+"|"+this.value}}return p.BARCODE_ROW_UNKNOWN=-1,p})();class We{static initialize(){for(let t=0;t<lt.SYMBOL_TABLE.length;t++){let e=lt.SYMBOL_TABLE[t],i=e&1;for(let r=0;r<lt.BARS_IN_MODULE;r++){let o=0;for(;(e&1)===i;)o+=1,e>>=1;i=e&1,We.RATIOS_TABLE[t]||(We.RATIOS_TABLE[t]=new Array(lt.BARS_IN_MODULE)),We.RATIOS_TABLE[t][lt.BARS_IN_MODULE-r-1]=Math.fround(o/lt.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(t){let e=We.getDecodedCodewordValue(We.sampleBitCounts(t));return e!==-1?e:We.getClosestDecodedValue(t)}static sampleBitCounts(t){let e=Xt.sum(t),i=new Int32Array(lt.BARS_IN_MODULE),r=0,o=0;for(let a=0;a<lt.MODULES_IN_CODEWORD;a++){let l=e/(2*lt.MODULES_IN_CODEWORD)+a*e/lt.MODULES_IN_CODEWORD;o+t[r]<=l&&(o+=t[r],r++),i[r]++}return i}static getDecodedCodewordValue(t){let e=We.getBitValue(t);return lt.getCodeword(e)===-1?-1:e}static getBitValue(t){let e=0;for(let i=0;i<t.length;i++)for(let r=0;r<t[i];r++)e=e<<1|(i%2===0?1:0);return Math.trunc(e)}static getClosestDecodedValue(t){let e=Xt.sum(t),i=new Array(lt.BARS_IN_MODULE);if(e>1)for(let a=0;a<i.length;a++)i[a]=Math.fround(t[a]/e);let r=_i.MAX_VALUE,o=-1;this.bSymbolTableReady||We.initialize();for(let a=0;a<We.RATIOS_TABLE.length;a++){let l=0,u=We.RATIOS_TABLE[a];for(let f=0;f<lt.BARS_IN_MODULE;f++){let x=Math.fround(u[f]-i[f]);if(l+=Math.fround(x*x),l>=r)break}l<r&&(r=l,o=lt.SYMBOL_TABLE[a])}return o}}We.bSymbolTableReady=!1,We.RATIOS_TABLE=new Array(lt.SYMBOL_TABLE.length).map(p=>p=new Array(lt.BARS_IN_MODULE));class wr{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(t){this.segmentIndex=t}getFileId(){return this.fileId}setFileId(t){this.fileId=t}getOptionalData(){return this.optionalData}setOptionalData(t){this.optionalData=t}isLastSegment(){return this.lastSegment}setLastSegment(t){this.lastSegment=t}getSegmentCount(){return this.segmentCount}setSegmentCount(t){this.segmentCount=t}getSender(){return this.sender||null}setSender(t){this.sender=t}getAddressee(){return this.addressee||null}setAddressee(t){this.addressee=t}getFileName(){return this.fileName}setFileName(t){this.fileName=t}getFileSize(){return this.fileSize}setFileSize(t){this.fileSize=t}getChecksum(){return this.checksum}setChecksum(t){this.checksum=t}getTimestamp(){return this.timestamp}setTimestamp(t){this.timestamp=t}}class Vt{static parseLong(t,e=void 0){return parseInt(t,e)}}let mo=(()=>{class p extends P{}return p.kind="NullPointerException",p})();class un{writeBytes(t){this.writeBytesOffset(t,0,t.length)}writeBytesOffset(t,e,i){if(t==null)throw new mo;if(e<0||e>t.length||i<0||e+i>t.length||e+i<0)throw new Te;if(i===0)return;for(let r=0;r<i;r++)this.write(t[e+r])}flush(){}close(){}}class Mi extends P{}class kr extends un{constructor(t=32){if(super(),this.count=0,t<0)throw new E("Negative initial size: "+t);this.buf=new Uint8Array(t)}ensureCapacity(t){t-this.buf.length>0&&this.grow(t)}grow(t){let i=this.buf.length<<1;if(i-t<0&&(i=t),i<0){if(t<0)throw new Mi;i=gt.MAX_VALUE}this.buf=Lt.copyOfUint8Array(this.buf,i)}write(t){this.ensureCapacity(this.count+1),this.buf[this.count]=t,this.count+=1}writeBytesOffset(t,e,i){if(e<0||e>t.length||i<0||e+i-t.length>0)throw new Te;this.ensureCapacity(this.count+i),st.arraycopy(t,e,this.buf,this.count,i),this.count+=i}writeTo(t){t.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return Lt.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(t){return t?typeof t=="string"?this.toString_string(t):this.toString_number(t):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(t){return new String(this.buf).toString()}toString_number(t){return new String(this.buf).toString()}close(){}}var ae=function(p){return p[p.ALPHA=0]="ALPHA",p[p.LOWER=1]="LOWER",p[p.MIXED=2]="MIXED",p[p.PUNCT=3]="PUNCT",p[p.ALPHA_SHIFT=4]="ALPHA_SHIFT",p[p.PUNCT_SHIFT=5]="PUNCT_SHIFT",p}(ae||{});function zi(){if(typeof window<"u")return window.BigInt||null;if(typeof global<"u")return global.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let Hi;function Tn(p){if(typeof Hi>"u"&&(Hi=zi()),Hi===null)throw new Error("BigInt is not supported!");return Hi(p)}function _o(){let p=[];p[0]=Tn(1);let t=Tn(900);p[1]=t;for(let e=2;e<16;e++)p[e]=p[e-1]*t;return p}class G{static decode(t,e){let i=new ne(""),r=et.ISO8859_1;i.enableDecoding(r);let o=1,a=t[o++],l=new wr;for(;o<t[0];){switch(a){case G.TEXT_COMPACTION_MODE_LATCH:o=G.textCompaction(t,o,i);break;case G.BYTE_COMPACTION_MODE_LATCH:case G.BYTE_COMPACTION_MODE_LATCH_6:o=G.byteCompaction(a,t,r,o,i);break;case G.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:i.append(t[o++]);break;case G.NUMERIC_COMPACTION_MODE_LATCH:o=G.numericCompaction(t,o,i);break;case G.ECI_CHARSET:let f=et.getCharacterSetECIByValue(t[o++]);break;case G.ECI_GENERAL_PURPOSE:o+=2;break;case G.ECI_USER_DEFINED:o++;break;case G.BEGIN_MACRO_PDF417_CONTROL_BLOCK:o=G.decodeMacroBlock(t,o,l);break;case G.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case G.MACRO_PDF417_TERMINATOR:throw new tt;default:o--,o=G.textCompaction(t,o,i);break}if(o<t.length)a=t[o++];else throw tt.getFormatInstance()}if(i.length()===0)throw tt.getFormatInstance();let u=new ei(null,i.toString(),null,e);return u.setOther(l),u}static decodeMacroBlock(t,e,i){if(e+G.NUMBER_OF_SEQUENCE_CODEWORDS>t[0])throw tt.getFormatInstance();let r=new Int32Array(G.NUMBER_OF_SEQUENCE_CODEWORDS);for(let l=0;l<G.NUMBER_OF_SEQUENCE_CODEWORDS;l++,e++)r[l]=t[e];i.setSegmentIndex(gt.parseInt(G.decodeBase900toBase10(r,G.NUMBER_OF_SEQUENCE_CODEWORDS)));let o=new ne;e=G.textCompaction(t,e,o),i.setFileId(o.toString());let a=-1;for(t[e]===G.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(a=e+1);e<t[0];)switch(t[e]){case G.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(e++,t[e]){case G.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let l=new ne;e=G.textCompaction(t,e+1,l),i.setFileName(l.toString());break;case G.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let u=new ne;e=G.textCompaction(t,e+1,u),i.setSender(u.toString());break;case G.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let f=new ne;e=G.textCompaction(t,e+1,f),i.setAddressee(f.toString());break;case G.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let x=new ne;e=G.numericCompaction(t,e+1,x),i.setSegmentCount(gt.parseInt(x.toString()));break;case G.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let v=new ne;e=G.numericCompaction(t,e+1,v),i.setTimestamp(Vt.parseLong(v.toString()));break;case G.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let S=new ne;e=G.numericCompaction(t,e+1,S),i.setChecksum(gt.parseInt(S.toString()));break;case G.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let b=new ne;e=G.numericCompaction(t,e+1,b),i.setFileSize(Vt.parseLong(b.toString()));break;default:throw tt.getFormatInstance()}break;case G.MACRO_PDF417_TERMINATOR:e++,i.setLastSegment(!0);break;default:throw tt.getFormatInstance()}if(a!==-1){let l=e-a;i.isLastSegment()&&l--,i.setOptionalData(Lt.copyOfRange(t,a,a+l))}return e}static textCompaction(t,e,i){let r=new Int32Array((t[0]-e)*2),o=new Int32Array((t[0]-e)*2),a=0,l=!1;for(;e<t[0]&&!l;){let u=t[e++];if(u<G.TEXT_COMPACTION_MODE_LATCH)r[a]=u/30,r[a+1]=u%30,a+=2;else switch(u){case G.TEXT_COMPACTION_MODE_LATCH:r[a++]=G.TEXT_COMPACTION_MODE_LATCH;break;case G.BYTE_COMPACTION_MODE_LATCH:case G.BYTE_COMPACTION_MODE_LATCH_6:case G.NUMERIC_COMPACTION_MODE_LATCH:case G.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case G.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case G.MACRO_PDF417_TERMINATOR:e--,l=!0;break;case G.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r[a]=G.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,u=t[e++],o[a]=u,a++;break}}return G.decodeTextCompaction(r,o,a,i),e}static decodeTextCompaction(t,e,i,r){let o=ae.ALPHA,a=ae.ALPHA,l=0;for(;l<i;){let u=t[l],f="";switch(o){case ae.ALPHA:if(u<26)f=String.fromCharCode(65+u);else switch(u){case 26:f=" ";break;case G.LL:o=ae.LOWER;break;case G.ML:o=ae.MIXED;break;case G.PS:a=o,o=ae.PUNCT_SHIFT;break;case G.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(e[l]);break;case G.TEXT_COMPACTION_MODE_LATCH:o=ae.ALPHA;break}break;case ae.LOWER:if(u<26)f=String.fromCharCode(97+u);else switch(u){case 26:f=" ";break;case G.AS:a=o,o=ae.ALPHA_SHIFT;break;case G.ML:o=ae.MIXED;break;case G.PS:a=o,o=ae.PUNCT_SHIFT;break;case G.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(e[l]);break;case G.TEXT_COMPACTION_MODE_LATCH:o=ae.ALPHA;break}break;case ae.MIXED:if(u<G.PL)f=G.MIXED_CHARS[u];else switch(u){case G.PL:o=ae.PUNCT;break;case 26:f=" ";break;case G.LL:o=ae.LOWER;break;case G.AL:o=ae.ALPHA;break;case G.PS:a=o,o=ae.PUNCT_SHIFT;break;case G.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(e[l]);break;case G.TEXT_COMPACTION_MODE_LATCH:o=ae.ALPHA;break}break;case ae.PUNCT:if(u<G.PAL)f=G.PUNCT_CHARS[u];else switch(u){case G.PAL:o=ae.ALPHA;break;case G.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(e[l]);break;case G.TEXT_COMPACTION_MODE_LATCH:o=ae.ALPHA;break}break;case ae.ALPHA_SHIFT:if(o=a,u<26)f=String.fromCharCode(65+u);else switch(u){case 26:f=" ";break;case G.TEXT_COMPACTION_MODE_LATCH:o=ae.ALPHA;break}break;case ae.PUNCT_SHIFT:if(o=a,u<G.PAL)f=G.PUNCT_CHARS[u];else switch(u){case G.PAL:o=ae.ALPHA;break;case G.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(e[l]);break;case G.TEXT_COMPACTION_MODE_LATCH:o=ae.ALPHA;break}break}f!==""&&r.append(f),l++}}static byteCompaction(t,e,i,r,o){let a=new kr,l=0,u=0,f=!1;switch(t){case G.BYTE_COMPACTION_MODE_LATCH:let x=new Int32Array(6),v=e[r++];for(;r<e[0]&&!f;)switch(x[l++]=v,u=900*u+v,v=e[r++],v){case G.TEXT_COMPACTION_MODE_LATCH:case G.BYTE_COMPACTION_MODE_LATCH:case G.NUMERIC_COMPACTION_MODE_LATCH:case G.BYTE_COMPACTION_MODE_LATCH_6:case G.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case G.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case G.MACRO_PDF417_TERMINATOR:r--,f=!0;break;default:if(l%5===0&&l>0){for(let S=0;S<6;++S)a.write(Number(Tn(u)>>Tn(8*(5-S))));u=0,l=0}break}r===e[0]&&v<G.TEXT_COMPACTION_MODE_LATCH&&(x[l++]=v);for(let S=0;S<l;S++)a.write(x[S]);break;case G.BYTE_COMPACTION_MODE_LATCH_6:for(;r<e[0]&&!f;){let S=e[r++];if(S<G.TEXT_COMPACTION_MODE_LATCH)l++,u=900*u+S;else switch(S){case G.TEXT_COMPACTION_MODE_LATCH:case G.BYTE_COMPACTION_MODE_LATCH:case G.NUMERIC_COMPACTION_MODE_LATCH:case G.BYTE_COMPACTION_MODE_LATCH_6:case G.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case G.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case G.MACRO_PDF417_TERMINATOR:r--,f=!0;break}if(l%5===0&&l>0){for(let b=0;b<6;++b)a.write(Number(Tn(u)>>Tn(8*(5-b))));u=0,l=0}}break}return o.append(oe.decode(a.toByteArray(),i)),r}static numericCompaction(t,e,i){let r=0,o=!1,a=new Int32Array(G.MAX_NUMERIC_CODEWORDS);for(;e<t[0]&&!o;){let l=t[e++];if(e===t[0]&&(o=!0),l<G.TEXT_COMPACTION_MODE_LATCH)a[r]=l,r++;else switch(l){case G.TEXT_COMPACTION_MODE_LATCH:case G.BYTE_COMPACTION_MODE_LATCH:case G.BYTE_COMPACTION_MODE_LATCH_6:case G.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case G.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case G.MACRO_PDF417_TERMINATOR:e--,o=!0;break}(r%G.MAX_NUMERIC_CODEWORDS===0||l===G.NUMERIC_COMPACTION_MODE_LATCH||o)&&r>0&&(i.append(G.decodeBase900toBase10(a,r)),r=0)}return e}static decodeBase900toBase10(t,e){let i=Tn(0);for(let o=0;o<e;o++)i+=G.EXP900[e-o-1]*Tn(t[o]);let r=i.toString();if(r.charAt(0)!=="1")throw new tt;return r.substring(1)}}G.TEXT_COMPACTION_MODE_LATCH=900,G.BYTE_COMPACTION_MODE_LATCH=901,G.NUMERIC_COMPACTION_MODE_LATCH=902,G.BYTE_COMPACTION_MODE_LATCH_6=924,G.ECI_USER_DEFINED=925,G.ECI_GENERAL_PURPOSE=926,G.ECI_CHARSET=927,G.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,G.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,G.MACRO_PDF417_TERMINATOR=922,G.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,G.MAX_NUMERIC_CODEWORDS=15,G.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,G.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,G.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,G.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,G.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,G.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,G.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,G.PL=25,G.LL=27,G.AS=27,G.ML=28,G.AL=28,G.PS=29,G.PAL=29,G.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,G.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",G.EXP900=zi()?_o():[],G.NUMBER_OF_SEQUENCE_CODEWORDS=2;class Dt{constructor(){}static decode(t,e,i,r,o,a,l){let u=new cn(t,e,i,r,o),f=null,x=null,v;for(let N=!0;;N=!1){if(e!=null&&(f=Dt.getRowIndicatorColumn(t,u,e,!0,a,l)),r!=null&&(x=Dt.getRowIndicatorColumn(t,u,r,!1,a,l)),v=Dt.merge(f,x),v==null)throw Y.getNotFoundInstance();let R=v.getBoundingBox();if(N&&R!=null&&(R.getMinY()<u.getMinY()||R.getMaxY()>u.getMaxY()))u=R;else break}v.setBoundingBox(u);let S=v.getBarcodeColumnCount()+1;v.setDetectionResultColumn(0,f),v.setDetectionResultColumn(S,x);let b=f!=null;for(let N=1;N<=S;N++){let R=b?N:S-N;if(v.getDetectionResultColumn(R)!==void 0)continue;let F;R===0||R===S?F=new Br(u,R===0):F=new _r(u),v.setDetectionResultColumn(R,F);let V=-1,J=V;for(let ot=u.getMinY();ot<=u.getMaxY();ot++){if(V=Dt.getStartColumn(v,R,ot,b),V<0||V>u.getMaxX()){if(J===-1)continue;V=J}let X=Dt.detectCodeword(t,u.getMinX(),u.getMaxX(),b,V,ot,a,l);X!=null&&(F.setCodeword(ot,X),J=V,a=Math.min(a,X.getWidth()),l=Math.max(l,X.getWidth()))}}return Dt.createDecoderResult(v)}static merge(t,e){if(t==null&&e==null)return null;let i=Dt.getBarcodeMetadata(t,e);if(i==null)return null;let r=cn.merge(Dt.adjustBoundingBox(t),Dt.adjustBoundingBox(e));return new ci(i,r)}static adjustBoundingBox(t){if(t==null)return null;let e=t.getRowHeights();if(e==null)return null;let i=Dt.getMax(e),r=0;for(let l of e)if(r+=i-l,l>0)break;let o=t.getCodewords();for(let l=0;r>0&&o[l]==null;l++)r--;let a=0;for(let l=e.length-1;l>=0&&(a+=i-e[l],!(e[l]>0));l--);for(let l=o.length-1;a>0&&o[l]==null;l--)a--;return t.getBoundingBox().addMissingRows(r,a,t.isLeft())}static getMax(t){let e=-1;for(let i of t)e=Math.max(e,i);return e}static getBarcodeMetadata(t,e){let i;if(t==null||(i=t.getBarcodeMetadata())==null)return e==null?null:e.getBarcodeMetadata();let r;return e==null||(r=e.getBarcodeMetadata())==null?i:i.getColumnCount()!==r.getColumnCount()&&i.getErrorCorrectionLevel()!==r.getErrorCorrectionLevel()&&i.getRowCount()!==r.getRowCount()?null:i}static getRowIndicatorColumn(t,e,i,r,o,a){let l=new Br(e,r);for(let u=0;u<2;u++){let f=u===0?1:-1,x=Math.trunc(Math.trunc(i.getX()));for(let v=Math.trunc(Math.trunc(i.getY()));v<=e.getMaxY()&&v>=e.getMinY();v+=f){let S=Dt.detectCodeword(t,0,t.getWidth(),r,x,v,o,a);S!=null&&(l.setCodeword(v,S),r?x=S.getStartX():x=S.getEndX())}}return l}static adjustCodewordCount(t,e){let i=e[0][1],r=i.getValue(),o=t.getBarcodeColumnCount()*t.getBarcodeRowCount()-Dt.getNumberOfECCodeWords(t.getBarcodeECLevel());if(r.length===0){if(o<1||o>lt.MAX_CODEWORDS_IN_BARCODE)throw Y.getNotFoundInstance();i.setValue(o)}else r[0]!==o&&i.setValue(o)}static createDecoderResult(t){let e=Dt.createBarcodeMatrix(t);Dt.adjustCodewordCount(t,e);let i=new Array,r=new Int32Array(t.getBarcodeRowCount()*t.getBarcodeColumnCount()),o=[],a=new Array;for(let u=0;u<t.getBarcodeRowCount();u++)for(let f=0;f<t.getBarcodeColumnCount();f++){let x=e[u][f+1].getValue(),v=u*t.getBarcodeColumnCount()+f;x.length===0?i.push(v):x.length===1?r[v]=x[0]:(a.push(v),o.push(x))}let l=new Array(o.length);for(let u=0;u<l.length;u++)l[u]=o[u];return Dt.createDecoderResultFromAmbiguousValues(t.getBarcodeECLevel(),r,lt.toIntArray(i),lt.toIntArray(a),l)}static createDecoderResultFromAmbiguousValues(t,e,i,r,o){let a=new Int32Array(r.length),l=100;for(;l-- >0;){for(let u=0;u<a.length;u++)e[r[u]]=o[u][a[u]];try{return Dt.decodeCodewords(e,t,i)}catch(u){if(!(u instanceof $))throw u}if(a.length===0)throw $.getChecksumInstance();for(let u=0;u<a.length;u++)if(a[u]<o[u].length-1){a[u]++;break}else if(a[u]=0,u===a.length-1)throw $.getChecksumInstance()}throw $.getChecksumInstance()}static createBarcodeMatrix(t){let e=Array.from({length:t.getBarcodeRowCount()},()=>new Array(t.getBarcodeColumnCount()+2));for(let r=0;r<e.length;r++)for(let o=0;o<e[r].length;o++)e[r][o]=new li;let i=0;for(let r of t.getDetectionResultColumns()){if(r!=null){for(let o of r.getCodewords())if(o!=null){let a=o.getRowNumber();if(a>=0){if(a>=e.length)continue;e[a][i].setValue(o.getValue())}}}i++}return e}static isValidBarcodeColumn(t,e){return e>=0&&e<=t.getBarcodeColumnCount()+1}static getStartColumn(t,e,i,r){let o=r?1:-1,a=null;if(Dt.isValidBarcodeColumn(t,e-o)&&(a=t.getDetectionResultColumn(e-o).getCodeword(i)),a!=null)return r?a.getEndX():a.getStartX();if(a=t.getDetectionResultColumn(e).getCodewordNearby(i),a!=null)return r?a.getStartX():a.getEndX();if(Dt.isValidBarcodeColumn(t,e-o)&&(a=t.getDetectionResultColumn(e-o).getCodewordNearby(i)),a!=null)return r?a.getEndX():a.getStartX();let l=0;for(;Dt.isValidBarcodeColumn(t,e-o);){e-=o;for(let u of t.getDetectionResultColumn(e).getCodewords())if(u!=null)return(r?u.getEndX():u.getStartX())+o*l*(u.getEndX()-u.getStartX());l++}return r?t.getBoundingBox().getMinX():t.getBoundingBox().getMaxX()}static detectCodeword(t,e,i,r,o,a,l,u){o=Dt.adjustCodewordStartColumn(t,e,i,r,o,a);let f=Dt.getModuleBitCount(t,e,i,r,o,a);if(f==null)return null;let x,v=Xt.sum(f);if(r)x=o+v;else{for(let N=0;N<f.length/2;N++){let R=f[N];f[N]=f[f.length-1-N],f[f.length-1-N]=R}x=o,o=x-v}if(!Dt.checkCodewordSkew(v,l,u))return null;let S=We.getDecodedValue(f),b=lt.getCodeword(S);return b===-1?null:new xr(o,x,Dt.getCodewordBucketNumber(S),b)}static getModuleBitCount(t,e,i,r,o,a){let l=o,u=new Int32Array(8),f=0,x=r?1:-1,v=r;for(;(r?l<i:l>=e)&&f<u.length;)t.get(l,a)===v?(u[f]++,l+=x):(f++,v=!v);return f===u.length||l===(r?i:e)&&f===u.length-1?u:null}static getNumberOfECCodeWords(t){return 2<<t}static adjustCodewordStartColumn(t,e,i,r,o,a){let l=o,u=r?-1:1;for(let f=0;f<2;f++){for(;(r?l>=e:l<i)&&r===t.get(l,a);){if(Math.abs(o-l)>Dt.CODEWORD_SKEW_SIZE)return o;l+=u}u=-u,r=!r}return l}static checkCodewordSkew(t,e,i){return e-Dt.CODEWORD_SKEW_SIZE<=t&&t<=i+Dt.CODEWORD_SKEW_SIZE}static decodeCodewords(t,e,i){if(t.length===0)throw tt.getFormatInstance();let r=1<<e+1,o=Dt.correctErrors(t,i,r);Dt.verifyCodewordCount(t,r);let a=G.decode(t,""+e);return a.setErrorsCorrected(o),a.setErasures(i.length),a}static correctErrors(t,e,i){if(e!=null&&e.length>i/2+Dt.MAX_ERRORS||i<0||i>Dt.MAX_EC_CODEWORDS)throw $.getChecksumInstance();return Dt.errorCorrection.decode(t,i,e)}static verifyCodewordCount(t,e){if(t.length<4)throw tt.getFormatInstance();let i=t[0];if(i>t.length)throw tt.getFormatInstance();if(i===0)if(e<t.length)t[0]=t.length-e;else throw tt.getFormatInstance()}static getBitCountForCodeword(t){let e=new Int32Array(8),i=0,r=e.length-1;for(;!((t&1)!==i&&(i=t&1,r--,r<0));)e[r]++,t>>=1;return e}static getCodewordBucketNumber(t){return t instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(t):this.getCodewordBucketNumber_number(t)}static getCodewordBucketNumber_number(t){return Dt.getCodewordBucketNumber(Dt.getBitCountForCodeword(t))}static getCodewordBucketNumber_Int32Array(t){return(t[0]-t[2]+t[4]-t[6]+9)%9}static toString(t){let e=new hn;for(let i=0;i<t.length;i++){e.format("Row %2d: ",i);for(let r=0;r<t[i].length;r++){let o=t[i][r];o.getValue().length===0?e.format("        ",null):e.format("%4d(%2d)",o.getValue()[0],o.getConfidence(o.getValue()[0]))}e.format("%n")}return e.toString()}}Dt.CODEWORD_SKEW_SIZE=2,Dt.MAX_ERRORS=3,Dt.MAX_EC_CODEWORDS=512,Dt.errorCorrection=new Ui;class Pe{decode(t,e=null){let i=Pe.decode(t,e,!1);if(i==null||i.length===0||i[0]==null)throw Y.getNotFoundInstance();return i[0]}decodeMultiple(t,e=null){try{return Pe.decode(t,e,!0)}catch(i){throw i instanceof tt||i instanceof $?Y.getNotFoundInstance():i}}static decode(t,e,i){let r=new Array,o=Nt.detectMultiple(t,e,i);for(let a of o.getPoints()){let l=Dt.decode(o.getBits(),a[4],a[5],a[6],a[7],Pe.getMinCodewordWidth(a),Pe.getMaxCodewordWidth(a)),u=new Zt(l.getText(),l.getRawBytes(),void 0,a,it.PDF_417);u.putMetadata(fe.ERROR_CORRECTION_LEVEL,l.getECLevel());let f=l.getOther();f!=null&&u.putMetadata(fe.PDF417_EXTRA_METADATA,f),r.push(u)}return r.map(a=>a)}static getMaxWidth(t,e){return t==null||e==null?0:Math.trunc(Math.abs(t.getX()-e.getX()))}static getMinWidth(t,e){return t==null||e==null?gt.MAX_VALUE:Math.trunc(Math.abs(t.getX()-e.getX()))}static getMaxCodewordWidth(t){return Math.floor(Math.max(Math.max(Pe.getMaxWidth(t[0],t[4]),Pe.getMaxWidth(t[6],t[2])*lt.MODULES_IN_CODEWORD/lt.MODULES_IN_STOP_PATTERN),Math.max(Pe.getMaxWidth(t[1],t[5]),Pe.getMaxWidth(t[7],t[3])*lt.MODULES_IN_CODEWORD/lt.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(t){return Math.floor(Math.min(Math.min(Pe.getMinWidth(t[0],t[4]),Pe.getMinWidth(t[6],t[2])*lt.MODULES_IN_CODEWORD/lt.MODULES_IN_STOP_PATTERN),Math.min(Pe.getMinWidth(t[1],t[5]),Pe.getMinWidth(t[7],t[3])*lt.MODULES_IN_CODEWORD/lt.MODULES_IN_STOP_PATTERN)))}reset(){}}let nn=(()=>{class p extends P{}return p.kind="ReaderException",p})();class Fr{constructor(t,e){this.verbose=t===!0,e&&this.setHints(e)}decode(t,e){return e&&this.setHints(e),this.decodeInternal(t)}decodeWithState(t){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(t)}setHints(t){this.hints=t;let e=!m(t)&&t.get(Ut.TRY_HARDER)===!0,i=m(t)?null:t.get(Ut.POSSIBLE_FORMATS),r=new Array;if(!m(i)){let o=i.some(a=>a===it.UPC_A||a===it.UPC_E||a===it.EAN_13||a===it.EAN_8||a===it.CODABAR||a===it.CODE_39||a===it.CODE_93||a===it.CODE_128||a===it.ITF||a===it.RSS_14||a===it.RSS_EXPANDED);o&&!e&&r.push(new Bn(t,this.verbose)),i.includes(it.QR_CODE)&&r.push(new De),i.includes(it.DATA_MATRIX)&&r.push(new me),i.includes(it.AZTEC)&&r.push(new wi),i.includes(it.PDF_417)&&r.push(new Pe),o&&e&&r.push(new Bn(t,this.verbose))}r.length===0&&(e||r.push(new Bn(t,this.verbose)),r.push(new De),r.push(new me),r.push(new wi),r.push(new Pe),e&&r.push(new Bn(t,this.verbose))),this.readers=r}reset(){if(this.readers!==null)for(let t of this.readers)t.reset()}decodeInternal(t){if(this.readers===null)throw new nn("No readers where selected, nothing can be read.");for(let e of this.readers)try{return e.decode(t,this.hints)}catch(i){if(i instanceof nn)continue}throw new Y("No MultiFormat Readers were able to detect the code.")}}class Ur extends Ie{constructor(t=null,e=500){let i=new Fr;i.setHints(t),super(i,e)}decodeBitmap(t){return this.reader.decodeWithState(t)}}class Fn extends Ie{constructor(t=500){super(new Pe,t)}}class zr extends Ie{constructor(t=500){super(new De,t)}}var yr=function(p){return p[p.ERROR_CORRECTION=0]="ERROR_CORRECTION",p[p.CHARACTER_SET=1]="CHARACTER_SET",p[p.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",p[p.MIN_SIZE=3]="MIN_SIZE",p[p.MAX_SIZE=4]="MAX_SIZE",p[p.MARGIN=5]="MARGIN",p[p.PDF417_COMPACT=6]="PDF417_COMPACT",p[p.PDF417_COMPACTION=7]="PDF417_COMPACTION",p[p.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",p[p.AZTEC_LAYERS=9]="AZTEC_LAYERS",p[p.QR_VERSION=10]="QR_VERSION",p}(yr||{}),Ae=yr;class Cr{constructor(t){this.field=t,this.cachedGenerators=[],this.cachedGenerators.push(new ke(t,Int32Array.from([1])))}buildGenerator(t){let e=this.cachedGenerators;if(t>=e.length){let i=e[e.length-1],r=this.field;for(let o=e.length;o<=t;o++){let a=i.multiply(new ke(r,Int32Array.from([1,r.exp(o-1+r.getGeneratorBase())])));e.push(a),i=a}}return e[t]}encode(t,e){if(e===0)throw new E("No error correction bytes");let i=t.length-e;if(i<=0)throw new E("No data bytes provided");let r=this.buildGenerator(e),o=new Int32Array(i);st.arraycopy(t,0,o,0,i);let a=new ke(this.field,o);a=a.multiplyByMonomial(e,1);let u=a.divide(r)[1].getCoefficients(),f=e-u.length;for(let x=0;x<f;x++)t[i+x]=0;st.arraycopy(u,0,t,i+f,u.length)}}let Qn=(()=>{class p{constructor(){}static applyMaskPenaltyRule1(e){return p.applyMaskPenaltyRule1Internal(e,!0)+p.applyMaskPenaltyRule1Internal(e,!1)}static applyMaskPenaltyRule2(e){let i=0,r=e.getArray(),o=e.getWidth(),a=e.getHeight();for(let l=0;l<a-1;l++){let u=r[l];for(let f=0;f<o-1;f++){let x=u[f];x===u[f+1]&&x===r[l+1][f]&&x===r[l+1][f+1]&&i++}}return p.N2*i}static applyMaskPenaltyRule3(e){let i=0,r=e.getArray(),o=e.getWidth(),a=e.getHeight();for(let l=0;l<a;l++)for(let u=0;u<o;u++){let f=r[l];u+6<o&&f[u]===1&&f[u+1]===0&&f[u+2]===1&&f[u+3]===1&&f[u+4]===1&&f[u+5]===0&&f[u+6]===1&&(p.isWhiteHorizontal(f,u-4,u)||p.isWhiteHorizontal(f,u+7,u+11))&&i++,l+6<a&&r[l][u]===1&&r[l+1][u]===0&&r[l+2][u]===1&&r[l+3][u]===1&&r[l+4][u]===1&&r[l+5][u]===0&&r[l+6][u]===1&&(p.isWhiteVertical(r,u,l-4,l)||p.isWhiteVertical(r,u,l+7,l+11))&&i++}return i*p.N3}static isWhiteHorizontal(e,i,r){i=Math.max(i,0),r=Math.min(r,e.length);for(let o=i;o<r;o++)if(e[o]===1)return!1;return!0}static isWhiteVertical(e,i,r,o){r=Math.max(r,0),o=Math.min(o,e.length);for(let a=r;a<o;a++)if(e[a][i]===1)return!1;return!0}static applyMaskPenaltyRule4(e){let i=0,r=e.getArray(),o=e.getWidth(),a=e.getHeight();for(let f=0;f<a;f++){let x=r[f];for(let v=0;v<o;v++)x[v]===1&&i++}let l=e.getHeight()*e.getWidth();return Math.floor(Math.abs(i*2-l)*10/l)*p.N4}static getDataMaskBit(e,i,r){let o,a;switch(e){case 0:o=r+i&1;break;case 1:o=r&1;break;case 2:o=i%3;break;case 3:o=(r+i)%3;break;case 4:o=Math.floor(r/2)+Math.floor(i/3)&1;break;case 5:a=r*i,o=(a&1)+a%3;break;case 6:a=r*i,o=(a&1)+a%3&1;break;case 7:a=r*i,o=a%3+(r+i&1)&1;break;default:throw new E("Invalid mask pattern: "+e)}return o===0}static applyMaskPenaltyRule1Internal(e,i){let r=0,o=i?e.getHeight():e.getWidth(),a=i?e.getWidth():e.getHeight(),l=e.getArray();for(let u=0;u<o;u++){let f=0,x=-1;for(let v=0;v<a;v++){let S=i?l[u][v]:l[v][u];S===x?f++:(f>=5&&(r+=p.N1+(f-5)),f=1,x=S)}f>=5&&(r+=p.N1+(f-5))}return r}}return p.N1=3,p.N2=3,p.N3=40,p.N4=10,p})();class Ni{constructor(t,e){this.width=t,this.height=e;let i=new Array(e);for(let r=0;r!==e;r++)i[r]=new Uint8Array(t);this.bytes=i}getHeight(){return this.height}getWidth(){return this.width}get(t,e){return this.bytes[e][t]}getArray(){return this.bytes}setNumber(t,e,i){this.bytes[e][t]=i}setBoolean(t,e,i){this.bytes[e][t]=i?1:0}clear(t){for(let e of this.bytes)Lt.fill(e,t)}equals(t){if(!(t instanceof Ni))return!1;let e=t;if(this.width!==e.width||this.height!==e.height)return!1;for(let i=0,r=this.height;i<r;++i){let o=this.bytes[i],a=e.bytes[i];for(let l=0,u=this.width;l<u;++l)if(o[l]!==a[l])return!1}return!0}toString(){let t=new ne;for(let e=0,i=this.height;e<i;++e){let r=this.bytes[e];for(let o=0,a=this.width;o<a;++o)switch(r[o]){case 0:t.append(" 0");break;case 1:t.append(" 1");break;default:t.append("  ");break}t.append(`
`)}return t.toString()}}let Vi=(()=>{class p{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){let e=new ne;return e.append(`<<
`),e.append(" mode: "),e.append(this.mode?this.mode.toString():"null"),e.append(`
 ecLevel: `),e.append(this.ecLevel?this.ecLevel.toString():"null"),e.append(`
 version: `),e.append(this.version?this.version.toString():"null"),e.append(`
 maskPattern: `),e.append(this.maskPattern.toString()),this.matrix?(e.append(`
 matrix:
`),e.append(this.matrix.toString())):e.append(`
 matrix: null
`),e.append(`>>
`),e.toString()}setMode(e){this.mode=e}setECLevel(e){this.ecLevel=e}setVersion(e){this.version=e}setMaskPattern(e){this.maskPattern=e}setMatrix(e){this.matrix=e}static isValidMaskPattern(e){return e>=0&&e<p.NUM_MASK_PATTERNS}}return p.NUM_MASK_PATTERNS=8,p})(),he=(()=>{class p extends P{}return p.kind="WriterException",p})();class Et{constructor(){}static clearMatrix(t){t.clear(255)}static buildMatrix(t,e,i,r,o){Et.clearMatrix(o),Et.embedBasicPatterns(i,o),Et.embedTypeInfo(e,r,o),Et.maybeEmbedVersionInfo(i,o),Et.embedDataBits(t,r,o)}static embedBasicPatterns(t,e){Et.embedPositionDetectionPatternsAndSeparators(e),Et.embedDarkDotAtLeftBottomCorner(e),Et.maybeEmbedPositionAdjustmentPatterns(t,e),Et.embedTimingPatterns(e)}static embedTypeInfo(t,e,i){let r=new Ft;Et.makeTypeInfoBits(t,e,r);for(let o=0,a=r.getSize();o<a;++o){let l=r.get(r.getSize()-1-o),u=Et.TYPE_INFO_COORDINATES[o],f=u[0],x=u[1];if(i.setBoolean(f,x,l),o<8){let v=i.getWidth()-o-1;i.setBoolean(v,8,l)}else{let S=i.getHeight()-7+(o-8);i.setBoolean(8,S,l)}}}static maybeEmbedVersionInfo(t,e){if(t.getVersionNumber()<7)return;let i=new Ft;Et.makeVersionInfoBits(t,i);let r=6*3-1;for(let o=0;o<6;++o)for(let a=0;a<3;++a){let l=i.get(r);r--,e.setBoolean(o,e.getHeight()-11+a,l),e.setBoolean(e.getHeight()-11+a,o,l)}}static embedDataBits(t,e,i){let r=0,o=-1,a=i.getWidth()-1,l=i.getHeight()-1;for(;a>0;){for(a===6&&(a-=1);l>=0&&l<i.getHeight();){for(let u=0;u<2;++u){let f=a-u;if(!Et.isEmpty(i.get(f,l)))continue;let x;r<t.getSize()?(x=t.get(r),++r):x=!1,e!==255&&Qn.getDataMaskBit(e,f,l)&&(x=!x),i.setBoolean(f,l,x)}l+=o}o=-o,l+=o,a-=2}if(r!==t.getSize())throw new he("Not all bits consumed: "+r+"/"+t.getSize())}static findMSBSet(t){return 32-gt.numberOfLeadingZeros(t)}static calculateBCHCode(t,e){if(e===0)throw new E("0 polynomial");let i=Et.findMSBSet(e);for(t<<=i-1;Et.findMSBSet(t)>=i;)t^=e<<Et.findMSBSet(t)-i;return t}static makeTypeInfoBits(t,e,i){if(!Vi.isValidMaskPattern(e))throw new he("Invalid mask pattern");let r=t.getBits()<<3|e;i.appendBits(r,5);let o=Et.calculateBCHCode(r,Et.TYPE_INFO_POLY);i.appendBits(o,10);let a=new Ft;if(a.appendBits(Et.TYPE_INFO_MASK_PATTERN,15),i.xor(a),i.getSize()!==15)throw new he("should not happen but we got: "+i.getSize())}static makeVersionInfoBits(t,e){e.appendBits(t.getVersionNumber(),6);let i=Et.calculateBCHCode(t.getVersionNumber(),Et.VERSION_INFO_POLY);if(e.appendBits(i,12),e.getSize()!==18)throw new he("should not happen but we got: "+e.getSize())}static isEmpty(t){return t===255}static embedTimingPatterns(t){for(let e=8;e<t.getWidth()-8;++e){let i=(e+1)%2;Et.isEmpty(t.get(e,6))&&t.setNumber(e,6,i),Et.isEmpty(t.get(6,e))&&t.setNumber(6,e,i)}}static embedDarkDotAtLeftBottomCorner(t){if(t.get(8,t.getHeight()-8)===0)throw new he;t.setNumber(8,t.getHeight()-8,1)}static embedHorizontalSeparationPattern(t,e,i){for(let r=0;r<8;++r){if(!Et.isEmpty(i.get(t+r,e)))throw new he;i.setNumber(t+r,e,0)}}static embedVerticalSeparationPattern(t,e,i){for(let r=0;r<7;++r){if(!Et.isEmpty(i.get(t,e+r)))throw new he;i.setNumber(t,e+r,0)}}static embedPositionAdjustmentPattern(t,e,i){for(let r=0;r<5;++r){let o=Et.POSITION_ADJUSTMENT_PATTERN[r];for(let a=0;a<5;++a)i.setNumber(t+a,e+r,o[a])}}static embedPositionDetectionPattern(t,e,i){for(let r=0;r<7;++r){let o=Et.POSITION_DETECTION_PATTERN[r];for(let a=0;a<7;++a)i.setNumber(t+a,e+r,o[a])}}static embedPositionDetectionPatternsAndSeparators(t){let e=Et.POSITION_DETECTION_PATTERN[0].length;Et.embedPositionDetectionPattern(0,0,t),Et.embedPositionDetectionPattern(t.getWidth()-e,0,t),Et.embedPositionDetectionPattern(0,t.getWidth()-e,t);let i=8;Et.embedHorizontalSeparationPattern(0,i-1,t),Et.embedHorizontalSeparationPattern(t.getWidth()-i,i-1,t),Et.embedHorizontalSeparationPattern(0,t.getWidth()-i,t);let r=7;Et.embedVerticalSeparationPattern(r,0,t),Et.embedVerticalSeparationPattern(t.getHeight()-r-1,0,t),Et.embedVerticalSeparationPattern(r,t.getHeight()-r,t)}static maybeEmbedPositionAdjustmentPatterns(t,e){if(t.getVersionNumber()<2)return;let i=t.getVersionNumber()-1,r=Et.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[i];for(let o=0,a=r.length;o!==a;o++){let l=r[o];if(l>=0)for(let u=0;u!==a;u++){let f=r[u];f>=0&&Et.isEmpty(e.get(f,l))&&Et.embedPositionAdjustmentPattern(f-2,l-2,e)}}}}Et.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),Et.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),Et.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),Et.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),Et.VERSION_INFO_POLY=7973,Et.TYPE_INFO_POLY=1335,Et.TYPE_INFO_MASK_PATTERN=21522;class xo{constructor(t,e){this.dataBytes=t,this.errorCorrectionBytes=e}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class ue{constructor(){}static calculateMaskPenalty(t){return Qn.applyMaskPenaltyRule1(t)+Qn.applyMaskPenaltyRule2(t)+Qn.applyMaskPenaltyRule3(t)+Qn.applyMaskPenaltyRule4(t)}static encode(t,e,i=null){let r=ue.DEFAULT_BYTE_MODE_ENCODING,o=i!==null&&i.get(Ae.CHARACTER_SET)!==void 0;o&&(r=i.get(Ae.CHARACTER_SET).toString());let a=this.chooseMode(t,r),l=new Ft;if(a===vt.BYTE&&(o||ue.DEFAULT_BYTE_MODE_ENCODING!==r)){let ot=et.getCharacterSetECIByName(r);ot!==void 0&&this.appendECI(ot,l)}this.appendModeInfo(a,l);let u=new Ft;this.appendBytes(t,a,u,r);let f;if(i!==null&&i.get(Ae.QR_VERSION)!==void 0){let ot=Number.parseInt(i.get(Ae.QR_VERSION).toString(),10);f=at.getVersionForNumber(ot);let X=this.calculateBitsNeeded(a,l,u,f);if(!this.willFit(X,f,e))throw new he("Data too big for requested version")}else f=this.recommendVersion(e,a,l,u);let x=new Ft;x.appendBitArray(l);let v=a===vt.BYTE?u.getSizeInBytes():t.length;this.appendLengthInfo(v,f,a,x),x.appendBitArray(u);let S=f.getECBlocksForLevel(e),b=f.getTotalCodewords()-S.getTotalECCodewords();this.terminateBits(b,x);let N=this.interleaveWithECBytes(x,f.getTotalCodewords(),b,S.getNumBlocks()),R=new Vi;R.setECLevel(e),R.setMode(a),R.setVersion(f);let F=f.getDimensionForVersion(),V=new Ni(F,F),J=this.chooseMaskPattern(N,e,f,V);return R.setMaskPattern(J),Et.buildMatrix(N,e,f,J,V),R.setMatrix(V),R}static recommendVersion(t,e,i,r){let o=this.calculateBitsNeeded(e,i,r,at.getVersionForNumber(1)),a=this.chooseVersion(o,t),l=this.calculateBitsNeeded(e,i,r,a);return this.chooseVersion(l,t)}static calculateBitsNeeded(t,e,i,r){return e.getSize()+t.getCharacterCountBits(r)+i.getSize()}static getAlphanumericCode(t){return t<ue.ALPHANUMERIC_TABLE.length?ue.ALPHANUMERIC_TABLE[t]:-1}static chooseMode(t,e=null){if(et.SJIS.getName()===e&&this.isOnlyDoubleByteKanji(t))return vt.KANJI;let i=!1,r=!1;for(let o=0,a=t.length;o<a;++o){let l=t.charAt(o);if(ue.isDigit(l))i=!0;else if(this.getAlphanumericCode(l.charCodeAt(0))!==-1)r=!0;else return vt.BYTE}return r?vt.ALPHANUMERIC:i?vt.NUMERIC:vt.BYTE}static isOnlyDoubleByteKanji(t){let e;try{e=oe.encode(t,et.SJIS)}catch{return!1}let i=e.length;if(i%2!==0)return!1;for(let r=0;r<i;r+=2){let o=e[r]&255;if((o<129||o>159)&&(o<224||o>235))return!1}return!0}static chooseMaskPattern(t,e,i,r){let o=Number.MAX_SAFE_INTEGER,a=-1;for(let l=0;l<Vi.NUM_MASK_PATTERNS;l++){Et.buildMatrix(t,e,i,l,r);let u=this.calculateMaskPenalty(r);u<o&&(o=u,a=l)}return a}static chooseVersion(t,e){for(let i=1;i<=40;i++){let r=at.getVersionForNumber(i);if(ue.willFit(t,r,e))return r}throw new he("Data too big")}static willFit(t,e,i){let r=e.getTotalCodewords(),a=e.getECBlocksForLevel(i).getTotalECCodewords(),l=r-a,u=(t+7)/8;return l>=u}static terminateBits(t,e){let i=t*8;if(e.getSize()>i)throw new he("data bits cannot fit in the QR Code"+e.getSize()+" > "+i);for(let a=0;a<4&&e.getSize()<i;++a)e.appendBit(!1);let r=e.getSize()&7;if(r>0)for(let a=r;a<8;a++)e.appendBit(!1);let o=t-e.getSizeInBytes();for(let a=0;a<o;++a)e.appendBits(a&1?17:236,8);if(e.getSize()!==i)throw new he("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(t,e,i,r,o,a){if(r>=i)throw new he("Block ID too large");let l=t%i,u=i-l,f=Math.floor(t/i),x=f+1,v=Math.floor(e/i),S=v+1,b=f-v,N=x-S;if(b!==N)throw new he("EC bytes mismatch");if(i!==u+l)throw new he("RS blocks mismatch");if(t!==(v+b)*u+(S+N)*l)throw new he("Total bytes mismatch");r<u?(o[0]=v,a[0]=b):(o[0]=S,a[0]=N)}static interleaveWithECBytes(t,e,i,r){if(t.getSizeInBytes()!==i)throw new he("Number of bits and data bytes does not match");let o=0,a=0,l=0,u=new Array;for(let x=0;x<r;++x){let v=new Int32Array(1),S=new Int32Array(1);ue.getNumDataBytesAndNumECBytesForBlockID(e,i,r,x,v,S);let b=v[0],N=new Uint8Array(b);t.toBytes(8*o,N,0,b);let R=ue.generateECBytes(N,S[0]);u.push(new xo(N,R)),a=Math.max(a,b),l=Math.max(l,R.length),o+=v[0]}if(i!==o)throw new he("Data bytes does not match offset");let f=new Ft;for(let x=0;x<a;++x)for(let v of u){let S=v.getDataBytes();x<S.length&&f.appendBits(S[x],8)}for(let x=0;x<l;++x)for(let v of u){let S=v.getErrorCorrectionBytes();x<S.length&&f.appendBits(S[x],8)}if(e!==f.getSizeInBytes())throw new he("Interleaving error: "+e+" and "+f.getSizeInBytes()+" differ.");return f}static generateECBytes(t,e){let i=t.length,r=new Int32Array(i+e);for(let a=0;a<i;a++)r[a]=t[a]&255;new Cr(jt.QR_CODE_FIELD_256).encode(r,e);let o=new Uint8Array(e);for(let a=0;a<e;a++)o[a]=r[i+a];return o}static appendModeInfo(t,e){e.appendBits(t.getBits(),4)}static appendLengthInfo(t,e,i,r){let o=i.getCharacterCountBits(e);if(t>=1<<o)throw new he(t+" is bigger than "+((1<<o)-1));r.appendBits(t,o)}static appendBytes(t,e,i,r){switch(e){case vt.NUMERIC:ue.appendNumericBytes(t,i);break;case vt.ALPHANUMERIC:ue.appendAlphanumericBytes(t,i);break;case vt.BYTE:ue.append8BitBytes(t,i,r);break;case vt.KANJI:ue.appendKanjiBytes(t,i);break;default:throw new he("Invalid mode: "+e)}}static getDigit(t){return t.charCodeAt(0)-48}static isDigit(t){let e=ue.getDigit(t);return e>=0&&e<=9}static appendNumericBytes(t,e){let i=t.length,r=0;for(;r<i;){let o=ue.getDigit(t.charAt(r));if(r+2<i){let a=ue.getDigit(t.charAt(r+1)),l=ue.getDigit(t.charAt(r+2));e.appendBits(o*100+a*10+l,10),r+=3}else if(r+1<i){let a=ue.getDigit(t.charAt(r+1));e.appendBits(o*10+a,7),r+=2}else e.appendBits(o,4),r++}}static appendAlphanumericBytes(t,e){let i=t.length,r=0;for(;r<i;){let o=ue.getAlphanumericCode(t.charCodeAt(r));if(o===-1)throw new he;if(r+1<i){let a=ue.getAlphanumericCode(t.charCodeAt(r+1));if(a===-1)throw new he;e.appendBits(o*45+a,11),r+=2}else e.appendBits(o,6),r++}}static append8BitBytes(t,e,i){let r;try{r=oe.encode(t,i)}catch(o){throw new he(o)}for(let o=0,a=r.length;o!==a;o++){let l=r[o];e.appendBits(l,8)}}static appendKanjiBytes(t,e){let i;try{i=oe.encode(t,et.SJIS)}catch(o){throw new he(o)}let r=i.length;for(let o=0;o<r;o+=2){let a=i[o]&255,l=i[o+1]&255,u=a<<8&4294967295|l,f=-1;if(u>=33088&&u<=40956?f=u-33088:u>=57408&&u<=60351&&(f=u-49472),f===-1)throw new he("Invalid byte sequence");let x=(f>>8)*192+(f&255);e.appendBits(x,13)}}static appendECI(t,e){e.appendBits(vt.ECI.getBits(),4),e.appendBits(t.getValue(),8)}}ue.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),ue.DEFAULT_BYTE_MODE_ENCODING=et.UTF8.getName();let Hr=(()=>{class p{write(e,i,r,o=null){if(e.length===0)throw new E("Found empty contents");if(i<0||r<0)throw new E("Requested dimensions are too small: "+i+"x"+r);let a=kt.L,l=p.QUIET_ZONE_SIZE;o!==null&&(o.get(Ae.ERROR_CORRECTION)!==void 0&&(a=kt.fromString(o.get(Ae.ERROR_CORRECTION).toString())),o.get(Ae.MARGIN)!==void 0&&(l=Number.parseInt(o.get(Ae.MARGIN).toString(),10)));let u=ue.encode(e,a,o);return this.renderResult(u,i,r,l)}writeToDom(e,i,r,o,a=null){typeof e=="string"&&(e=document.querySelector(e));let l=this.write(i,r,o,a);e&&e.appendChild(l)}renderResult(e,i,r,o){let a=e.getMatrix();if(a===null)throw new gn;let l=a.getWidth(),u=a.getHeight(),f=l+o*2,x=u+o*2,v=Math.max(i,f),S=Math.max(r,x),b=Math.min(Math.floor(v/f),Math.floor(S/x)),N=Math.floor((v-l*b)/2),R=Math.floor((S-u*b)/2),F=this.createSVGElement(v,S);for(let V=0,J=R;V<u;V++,J+=b)for(let ot=0,X=N;ot<l;ot++,X+=b)if(a.get(ot,V)===1){let Pt=this.createSvgRectElement(X,J,b,b);F.appendChild(Pt)}return F}createSVGElement(e,i){let r=document.createElementNS(p.SVG_NS,"svg");return r.setAttributeNS(null,"height",e.toString()),r.setAttributeNS(null,"width",i.toString()),r}createSvgRectElement(e,i,r,o){let a=document.createElementNS(p.SVG_NS,"rect");return a.setAttributeNS(null,"x",e.toString()),a.setAttributeNS(null,"y",i.toString()),a.setAttributeNS(null,"height",r.toString()),a.setAttributeNS(null,"width",o.toString()),a.setAttributeNS(null,"fill","#000000"),a}}return p.QUIET_ZONE_SIZE=4,p.SVG_NS="http://www.w3.org/2000/svg",p})(),Oi=(()=>{class p{encode(e,i,r,o,a){if(e.length===0)throw new E("Found empty contents");if(i!==it.QR_CODE)throw new E("Can only encode QR_CODE, but got "+i);if(r<0||o<0)throw new E(`Requested dimensions are too small: ${r}x${o}`);let l=kt.L,u=p.QUIET_ZONE_SIZE;a!==null&&(a.get(Ae.ERROR_CORRECTION)!==void 0&&(l=kt.fromString(a.get(Ae.ERROR_CORRECTION).toString())),a.get(Ae.MARGIN)!==void 0&&(u=Number.parseInt(a.get(Ae.MARGIN).toString(),10)));let f=ue.encode(e,l,a);return p.renderResult(f,r,o,u)}static renderResult(e,i,r,o){let a=e.getMatrix();if(a===null)throw new gn;let l=a.getWidth(),u=a.getHeight(),f=l+o*2,x=u+o*2,v=Math.max(i,f),S=Math.max(r,x),b=Math.min(Math.floor(v/f),Math.floor(S/x)),N=Math.floor((v-l*b)/2),R=Math.floor((S-u*b)/2),F=new le(v,S);for(let V=0,J=R;V<u;V++,J+=b)for(let ot=0,X=N;ot<l;ot++,X+=b)a.get(ot,V)===1&&F.setRegion(X,J,b,b);return F}}return p.QUIET_ZONE_SIZE=4,p})();class qn{encode(t,e,i,r,o){let a;switch(e){case it.QR_CODE:a=new Oi;break;default:throw new E("No encoder available for format "+e)}return a.encode(t,e,i,r,o)}}let wo=(()=>{class p extends bt{constructor(e,i,r,o,a,l,u,f){if(super(l,u),this.yuvData=e,this.dataWidth=i,this.dataHeight=r,this.left=o,this.top=a,o+l>i||a+u>r)throw new E("Crop rectangle does not fit within image data.");f&&this.reverseHorizontal(l,u)}getRow(e,i){if(e<0||e>=this.getHeight())throw new E("Requested row is outside the image: "+e);let r=this.getWidth();(i==null||i.length<r)&&(i=new Uint8ClampedArray(r));let o=(e+this.top)*this.dataWidth+this.left;return st.arraycopy(this.yuvData,o,i,0,r),i}getMatrix(){let e=this.getWidth(),i=this.getHeight();if(e===this.dataWidth&&i===this.dataHeight)return this.yuvData;let r=e*i,o=new Uint8ClampedArray(r),a=this.top*this.dataWidth+this.left;if(e===this.dataWidth)return st.arraycopy(this.yuvData,a,o,0,r),o;for(let l=0;l<i;l++){let u=l*e;st.arraycopy(this.yuvData,a,o,u,e),a+=this.dataWidth}return o}isCropSupported(){return!0}crop(e,i,r,o){return new p(this.yuvData,this.dataWidth,this.dataHeight,this.left+e,this.top+i,r,o,!1)}renderThumbnail(){let e=this.getWidth()/p.THUMBNAIL_SCALE_FACTOR,i=this.getHeight()/p.THUMBNAIL_SCALE_FACTOR,r=new Int32Array(e*i),o=this.yuvData,a=this.top*this.dataWidth+this.left;for(let l=0;l<i;l++){let u=l*e;for(let f=0;f<e;f++){let x=o[a+f*p.THUMBNAIL_SCALE_FACTOR]&255;r[u+f]=4278190080|x*65793}a+=this.dataWidth*p.THUMBNAIL_SCALE_FACTOR}return r}getThumbnailWidth(){return this.getWidth()/p.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/p.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(e,i){let r=this.yuvData;for(let o=0,a=this.top*this.dataWidth+this.left;o<i;o++,a+=this.dataWidth){let l=a+e/2;for(let u=a,f=a+e-1;u<l;u++,f--){let x=r[u];r[u]=r[f],r[f]=x}}}invert(){return new Sn(this)}}return p.THUMBNAIL_SCALE_FACTOR=2,p})();class Kn extends bt{constructor(t,e,i,r,o,a,l){if(super(e,i),this.dataWidth=r,this.dataHeight=o,this.left=a,this.top=l,t.BYTES_PER_ELEMENT===4){let u=e*i,f=new Uint8ClampedArray(u);for(let x=0;x<u;x++){let v=t[x],S=v>>16&255,b=v>>7&510,N=v&255;f[x]=(S+b+N)/4&255}this.luminances=f}else this.luminances=t;if(r===void 0&&(this.dataWidth=e),o===void 0&&(this.dataHeight=i),a===void 0&&(this.left=0),l===void 0&&(this.top=0),this.left+e>this.dataWidth||this.top+i>this.dataHeight)throw new E("Crop rectangle does not fit within image data.")}getRow(t,e){if(t<0||t>=this.getHeight())throw new E("Requested row is outside the image: "+t);let i=this.getWidth();(e==null||e.length<i)&&(e=new Uint8ClampedArray(i));let r=(t+this.top)*this.dataWidth+this.left;return st.arraycopy(this.luminances,r,e,0,i),e}getMatrix(){let t=this.getWidth(),e=this.getHeight();if(t===this.dataWidth&&e===this.dataHeight)return this.luminances;let i=t*e,r=new Uint8ClampedArray(i),o=this.top*this.dataWidth+this.left;if(t===this.dataWidth)return st.arraycopy(this.luminances,o,r,0,i),r;for(let a=0;a<e;a++){let l=a*t;st.arraycopy(this.luminances,o,r,l,t),o+=this.dataWidth}return r}isCropSupported(){return!0}crop(t,e,i,r){return new Kn(this.luminances,i,r,this.dataWidth,this.dataHeight,this.left+t,this.top+e)}invert(){return new Sn(this)}}class Je extends et{static forName(t){return this.getCharacterSetECIByName(t)}}class Zi{}Zi.ISO_8859_1=et.ISO8859_1;class vr{isCompact(){return this.compact}setCompact(t){this.compact=t}getSize(){return this.size}setSize(t){this.size=t}getLayers(){return this.layers}setLayers(t){this.layers=t}getCodeWords(){return this.codeWords}setCodeWords(t){this.codeWords=t}getMatrix(){return this.matrix}setMatrix(t){this.matrix=t}}class Vr{static singletonList(t){return[t]}static min(t,e){return t.sort(e)[0]}}class Er{constructor(t){this.previous=t}getPrevious(){return this.previous}}class Un extends Er{constructor(t,e,i){super(t),this.value=e,this.bitCount=i}appendTo(t,e){t.appendBits(this.value,this.bitCount)}add(t,e){return new Un(this,t,e)}addBinaryShift(t,e){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new Un(this,t,e)}toString(){let t=this.value&(1<<this.bitCount)-1;return t|=1<<this.bitCount,"<"+gt.toBinaryString(t|1<<this.bitCount).substring(1)+">"}}class Ar extends Un{constructor(t,e,i){super(t,0,0),this.binaryShiftStart=e,this.binaryShiftByteCount=i}appendTo(t,e){for(let i=0;i<this.binaryShiftByteCount;i++)(i===0||i===31&&this.binaryShiftByteCount<=62)&&(t.appendBits(31,5),this.binaryShiftByteCount>62?t.appendBits(this.binaryShiftByteCount-31,16):i===0?t.appendBits(Math.min(this.binaryShiftByteCount,31),5):t.appendBits(this.binaryShiftByteCount-31,5)),t.appendBits(e[this.binaryShiftStart+i],8)}addBinaryShift(t,e){return new Ar(this,t,e)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function yo(p,t,e){return new Ar(p,t,e)}function hi(p,t,e){return new Un(p,t,e)}let Co=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],Oe=0,Mn=1,rn=2,_n=3,xn=4,ui=new Un(null,0,0),Sr=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])];function Li(p){for(let t of p)Lt.fill(t,-1);return p[Oe][xn]=0,p[Mn][xn]=0,p[Mn][Oe]=28,p[_n][xn]=0,p[rn][xn]=0,p[rn][Oe]=15,p}let Ir=Li(Lt.createInt32Array(6,6));class $e{constructor(t,e,i,r){this.token=t,this.mode=e,this.binaryShiftByteCount=i,this.bitCount=r}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(t,e){let i=this.bitCount,r=this.token;if(t!==this.mode){let a=Sr[this.mode][t];r=hi(r,a&65535,a>>16),i+=a>>16}let o=t===rn?4:5;return r=hi(r,e,o),new $e(r,t,0,i+o)}shiftAndAppend(t,e){let i=this.token,r=this.mode===rn?4:5;return i=hi(i,Ir[this.mode][t],r),i=hi(i,e,5),new $e(i,this.mode,0,this.bitCount+r+5)}addBinaryShiftChar(t){let e=this.token,i=this.mode,r=this.bitCount;if(this.mode===xn||this.mode===rn){let l=Sr[i][Oe];e=hi(e,l&65535,l>>16),r+=l>>16,i=Oe}let o=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,a=new $e(e,i,this.binaryShiftByteCount+1,r+o);return a.binaryShiftByteCount===2078&&(a=a.endBinaryShift(t+1)),a}endBinaryShift(t){if(this.binaryShiftByteCount===0)return this;let e=this.token;return e=yo(e,t-this.binaryShiftByteCount,this.binaryShiftByteCount),new $e(e,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(t){let e=this.bitCount+(Sr[this.mode][t.mode]>>16);return this.binaryShiftByteCount<t.binaryShiftByteCount?e+=$e.calculateBinaryShiftCost(t)-$e.calculateBinaryShiftCost(this):this.binaryShiftByteCount>t.binaryShiftByteCount&&t.binaryShiftByteCount>0&&(e+=10),e<=t.bitCount}toBitArray(t){let e=[];for(let r=this.endBinaryShift(t.length).token;r!==null;r=r.getPrevious())e.unshift(r);let i=new Ft;for(let r of e)r.appendTo(i,t);return i}toString(){return wt.format("%s bits=%d bytes=%d",Co[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(t){return t.binaryShiftByteCount>62?21:t.binaryShiftByteCount>31?20:t.binaryShiftByteCount>0?10:0}}$e.INITIAL_STATE=new $e(ui,Oe,0,0);function vo(p){let t=wt.getCharCode(" "),e=wt.getCharCode("."),i=wt.getCharCode(",");p[Oe][t]=1;let r=wt.getCharCode("Z"),o=wt.getCharCode("A");for(let S=o;S<=r;S++)p[Oe][S]=S-o+2;p[Mn][t]=1;let a=wt.getCharCode("z"),l=wt.getCharCode("a");for(let S=l;S<=a;S++)p[Mn][S]=S-l+2;p[rn][t]=1;let u=wt.getCharCode("9"),f=wt.getCharCode("0");for(let S=f;S<=u;S++)p[rn][S]=S-f+2;p[rn][i]=12,p[rn][e]=13;let x=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~","\x7F"];for(let S=0;S<x.length;S++)p[_n][wt.getCharCode(x[S])]=S;let v=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let S=0;S<v.length;S++)wt.getCharCode(v[S])>0&&(p[xn][wt.getCharCode(v[S])]=S);return p}let wn=vo(Lt.createInt32Array(5,256));class zn{constructor(t){this.text=t}encode(){let t=wt.getCharCode(" "),e=wt.getCharCode(`
`),i=Vr.singletonList($e.INITIAL_STATE);for(let o=0;o<this.text.length;o++){let a,l=o+1<this.text.length?this.text[o+1]:0;switch(this.text[o]){case wt.getCharCode("\r"):a=l===e?2:0;break;case wt.getCharCode("."):a=l===t?3:0;break;case wt.getCharCode(","):a=l===t?4:0;break;case wt.getCharCode(":"):a=l===t?5:0;break;default:a=0}a>0?(i=zn.updateStateListForPair(i,o,a),o++):i=this.updateStateListForChar(i,o)}return Vr.min(i,(o,a)=>o.getBitCount()-a.getBitCount()).toBitArray(this.text)}updateStateListForChar(t,e){let i=[];for(let r of t)this.updateStateForChar(r,e,i);return zn.simplifyStates(i)}updateStateForChar(t,e,i){let r=this.text[e]&255,o=wn[t.getMode()][r]>0,a=null;for(let l=0;l<=xn;l++){let u=wn[l][r];if(u>0){if(a==null&&(a=t.endBinaryShift(e)),!o||l===t.getMode()||l===rn){let f=a.latchAndAppend(l,u);i.push(f)}if(!o&&Ir[t.getMode()][l]>=0){let f=a.shiftAndAppend(l,u);i.push(f)}}}if(t.getBinaryShiftByteCount()>0||wn[t.getMode()][r]===0){let l=t.addBinaryShiftChar(e);i.push(l)}}static updateStateListForPair(t,e,i){let r=[];for(let o of t)this.updateStateForPair(o,e,i,r);return this.simplifyStates(r)}static updateStateForPair(t,e,i,r){let o=t.endBinaryShift(e);if(r.push(o.latchAndAppend(xn,i)),t.getMode()!==xn&&r.push(o.shiftAndAppend(xn,i)),i===3||i===4){let a=o.latchAndAppend(rn,16-i).latchAndAppend(rn,1);r.push(a)}if(t.getBinaryShiftByteCount()>0){let a=t.addBinaryShiftChar(e).addBinaryShiftChar(e+1);r.push(a)}}static simplifyStates(t){let e=[];for(let i of t){let r=!0;for(let o of e){if(o.isBetterThanOrEqualTo(i)){r=!1;break}i.isBetterThanOrEqualTo(o)&&(e=e.filter(a=>a!==o))}r&&e.push(i)}return e}}class Yt{constructor(){}static encodeBytes(t){return Yt.encode(t,Yt.DEFAULT_EC_PERCENT,Yt.DEFAULT_AZTEC_LAYERS)}static encode(t,e,i){let r=new zn(t).encode(),o=gt.truncDivision(r.getSize()*e,100)+11,a=r.getSize()+o,l,u,f,x,v;if(i!==Yt.DEFAULT_AZTEC_LAYERS){if(l=i<0,u=Math.abs(i),u>(l?Yt.MAX_NB_BITS_COMPACT:Yt.MAX_NB_BITS))throw new E(wt.format("Illegal value %s for layers",i));f=Yt.totalBitsInLayer(u,l),x=Yt.WORD_SIZE[u];let X=f-f%x;if(v=Yt.stuffBits(r,x),v.getSize()+o>X)throw new E("Data to large for user specified layer");if(l&&v.getSize()>x*64)throw new E("Data to large for user specified layer")}else{x=0,v=null;for(let X=0;;X++){if(X>Yt.MAX_NB_BITS)throw new E("Data too large for an Aztec code");if(l=X<=3,u=l?X+1:X,f=Yt.totalBitsInLayer(u,l),a>f)continue;(v==null||x!==Yt.WORD_SIZE[u])&&(x=Yt.WORD_SIZE[u],v=Yt.stuffBits(r,x));let Pt=f-f%x;if(!(l&&v.getSize()>x*64)&&v.getSize()+o<=Pt)break}}let S=Yt.generateCheckWords(v,f,x),b=v.getSize()/x,N=Yt.generateModeMessage(l,u,b),R=(l?11:14)+u*4,F=new Int32Array(R),V;if(l){V=R;for(let X=0;X<F.length;X++)F[X]=X}else{V=R+1+2*gt.truncDivision(gt.truncDivision(R,2)-1,15);let X=gt.truncDivision(R,2),Pt=gt.truncDivision(V,2);for(let Ot=0;Ot<X;Ot++){let ye=Ot+gt.truncDivision(Ot,15);F[X-Ot-1]=Pt-ye-1,F[X+Ot]=Pt+ye+1}}let J=new le(V);for(let X=0,Pt=0;X<u;X++){let Ot=(u-X)*4+(l?9:12);for(let ye=0;ye<Ot;ye++){let Ge=ye*2;for(let je=0;je<2;je++)S.get(Pt+Ge+je)&&J.set(F[X*2+je],F[X*2+ye]),S.get(Pt+Ot*2+Ge+je)&&J.set(F[X*2+ye],F[R-1-X*2-je]),S.get(Pt+Ot*4+Ge+je)&&J.set(F[R-1-X*2-je],F[R-1-X*2-ye]),S.get(Pt+Ot*6+Ge+je)&&J.set(F[R-1-X*2-ye],F[X*2+je])}Pt+=Ot*8}if(Yt.drawModeMessage(J,l,V,N),l)Yt.drawBullsEye(J,gt.truncDivision(V,2),5);else{Yt.drawBullsEye(J,gt.truncDivision(V,2),7);for(let X=0,Pt=0;X<gt.truncDivision(R,2)-1;X+=15,Pt+=16)for(let Ot=gt.truncDivision(V,2)&1;Ot<V;Ot+=2)J.set(gt.truncDivision(V,2)-Pt,Ot),J.set(gt.truncDivision(V,2)+Pt,Ot),J.set(Ot,gt.truncDivision(V,2)-Pt),J.set(Ot,gt.truncDivision(V,2)+Pt)}let ot=new vr;return ot.setCompact(l),ot.setSize(V),ot.setLayers(u),ot.setCodeWords(b),ot.setMatrix(J),ot}static drawBullsEye(t,e,i){for(let r=0;r<i;r+=2)for(let o=e-r;o<=e+r;o++)t.set(o,e-r),t.set(o,e+r),t.set(e-r,o),t.set(e+r,o);t.set(e-i,e-i),t.set(e-i+1,e-i),t.set(e-i,e-i+1),t.set(e+i,e-i),t.set(e+i,e-i+1),t.set(e+i,e+i-1)}static generateModeMessage(t,e,i){let r=new Ft;return t?(r.appendBits(e-1,2),r.appendBits(i-1,6),r=Yt.generateCheckWords(r,28,4)):(r.appendBits(e-1,5),r.appendBits(i-1,11),r=Yt.generateCheckWords(r,40,4)),r}static drawModeMessage(t,e,i,r){let o=gt.truncDivision(i,2);if(e)for(let a=0;a<7;a++){let l=o-3+a;r.get(a)&&t.set(l,o-5),r.get(a+7)&&t.set(o+5,l),r.get(20-a)&&t.set(l,o+5),r.get(27-a)&&t.set(o-5,l)}else for(let a=0;a<10;a++){let l=o-5+a+gt.truncDivision(a,5);r.get(a)&&t.set(l,o-7),r.get(a+10)&&t.set(o+7,l),r.get(29-a)&&t.set(l,o+7),r.get(39-a)&&t.set(o-7,l)}}static generateCheckWords(t,e,i){let r=t.getSize()/i,o=new Cr(Yt.getGF(i)),a=gt.truncDivision(e,i),l=Yt.bitsToWords(t,i,a);o.encode(l,a-r);let u=e%i,f=new Ft;f.appendBits(0,u);for(let x of Array.from(l))f.appendBits(x,i);return f}static bitsToWords(t,e,i){let r=new Int32Array(i),o,a;for(o=0,a=t.getSize()/e;o<a;o++){let l=0;for(let u=0;u<e;u++)l|=t.get(o*e+u)?1<<e-u-1:0;r[o]=l}return r}static getGF(t){switch(t){case 4:return jt.AZTEC_PARAM;case 6:return jt.AZTEC_DATA_6;case 8:return jt.AZTEC_DATA_8;case 10:return jt.AZTEC_DATA_10;case 12:return jt.AZTEC_DATA_12;default:throw new E("Unsupported word size "+t)}}static stuffBits(t,e){let i=new Ft,r=t.getSize(),o=(1<<e)-2;for(let a=0;a<r;a+=e){let l=0;for(let u=0;u<e;u++)(a+u>=r||t.get(a+u))&&(l|=1<<e-1-u);(l&o)===o?(i.appendBits(l&o,e),a--):l&o?i.appendBits(l,e):(i.appendBits(l|1,e),a--)}return i}static totalBitsInLayer(t,e){return((e?88:112)+16*t)*t}}Yt.DEFAULT_EC_PERCENT=33,Yt.DEFAULT_AZTEC_LAYERS=0,Yt.MAX_NB_BITS=32,Yt.MAX_NB_BITS_COMPACT=4,Yt.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class di{encode(t,e,i,r){return this.encodeWithHints(t,e,i,r,null)}encodeWithHints(t,e,i,r,o){let a=Zi.ISO_8859_1,l=Yt.DEFAULT_EC_PERCENT,u=Yt.DEFAULT_AZTEC_LAYERS;return o!=null&&(o.has(Ae.CHARACTER_SET)&&(a=Je.forName(o.get(Ae.CHARACTER_SET).toString())),o.has(Ae.ERROR_CORRECTION)&&(l=gt.parseInt(o.get(Ae.ERROR_CORRECTION).toString())),o.has(Ae.AZTEC_LAYERS)&&(u=gt.parseInt(o.get(Ae.AZTEC_LAYERS).toString()))),di.encodeLayers(t,e,i,r,a,l,u)}static encodeLayers(t,e,i,r,o,a,l){if(e!==it.AZTEC)throw new E("Can only encode AZTEC, but got "+e);let u=Yt.encode(wt.getBytes(t,o),a,l);return di.renderResult(u,i,r)}static renderResult(t,e,i){let r=t.getMatrix();if(r==null)throw new gn;let o=r.getWidth(),a=r.getHeight(),l=Math.max(e,o),u=Math.max(i,a),f=Math.min(l/o,u/a),x=(l-o*f)/2,v=(u-a*f)/2,S=new le(l,u);for(let b=0,N=v;b<a;b++,N+=f)for(let R=0,F=x;R<o;R++,F+=f)r.get(R,b)&&S.setRegion(F,N,f,f);return S}}d.AbstractExpandedDecoder=Bi,d.ArgumentException=H,d.ArithmeticException=Zn,d.AztecCode=vr,d.AztecCodeReader=wi,d.AztecCodeWriter=di,d.AztecDecoder=ii,d.AztecDetector=sr,d.AztecDetectorResult=ir,d.AztecEncoder=Yt,d.AztecHighLevelEncoder=zn,d.AztecPoint=Ve,d.BarcodeFormat=it,d.Binarizer=Bt,d.BinaryBitmap=Z,d.BitArray=Ft,d.BitMatrix=le,d.BitSource=ai,d.BrowserAztecCodeReader=lo,d.BrowserBarcodeReader=Ai,d.BrowserCodeReader=Ie,d.BrowserDatamatrixCodeReader=fr,d.BrowserMultiFormatReader=Ur,d.BrowserPDF417Reader=Fn,d.BrowserQRCodeReader=zr,d.BrowserQRCodeSvgWriter=Hr,d.CharacterSetECI=et,d.ChecksumException=$,d.Code128Reader=rt,d.Code39Reader=Pi,d.DataMatrixDecodedBitStreamParser=Ke,d.DataMatrixReader=me,d.DecodeHintType=Ut,d.DecoderResult=ei,d.DefaultGridSampler=or,d.DetectorResult=xi,d.EAN13Reader=Ci,d.EncodeHintType=Ae,d.Exception=P,d.FormatException=tt,d.GenericGF=jt,d.GenericGFPoly=ke,d.GlobalHistogramBinarizer=$t,d.GridSampler=rr,d.GridSamplerInstance=In,d.HTMLCanvasElementLuminanceSource=At,d.HybridBinarizer=Mt,d.ITFReader=se,d.IllegalArgumentException=E,d.IllegalStateException=gn,d.InvertedLuminanceSource=Sn,d.LuminanceSource=bt,d.MathUtils=Xt,d.MultiFormatOneDReader=Bn,d.MultiFormatReader=Fr,d.MultiFormatWriter=qn,d.NotFoundException=Y,d.OneDReader=Ee,d.PDF417DecodedBitStreamParser=G,d.PDF417DecoderErrorCorrection=Ui,d.PDF417Reader=Pe,d.PDF417ResultMetadata=wr,d.PerspectiveTransform=Qe,d.PlanarYUVLuminanceSource=wo,d.QRCodeByteMatrix=Ni,d.QRCodeDataMask=Ue,d.QRCodeDecodedBitStreamParser=ki,d.QRCodeDecoderErrorCorrectionLevel=kt,d.QRCodeDecoderFormatInformation=Fe,d.QRCodeEncoder=ue,d.QRCodeEncoderQRCode=Vi,d.QRCodeMaskUtil=Qn,d.QRCodeMatrixUtil=Et,d.QRCodeMode=vt,d.QRCodeReader=De,d.QRCodeVersion=at,d.QRCodeWriter=Oi,d.RGBLuminanceSource=Kn,d.RSS14Reader=ve,d.RSSExpandedReader=q,d.ReaderException=nn,d.ReedSolomonDecoder=ni,d.ReedSolomonEncoder=Cr,d.ReedSolomonException=mi,d.Result=Zt,d.ResultMetadataType=fe,d.ResultPoint=mt,d.StringUtils=wt,d.UnsupportedOperationException=ti,d.VideoInputDevice=ge,d.WhiteRectangleDetector=Ri,d.WriterException=he,d.ZXingArrays=Lt,d.ZXingCharset=Je,d.ZXingInteger=gt,d.ZXingStandardCharsets=Zi,d.ZXingStringBuilder=ne,d.ZXingStringEncoding=oe,d.ZXingSystem=st,d.createAbstractExpandedDecoder=Ei,Object.defineProperty(d,"__esModule",{value:!0})})});var en=as(Ns());var ut=function(d){return d[d.QR_CODE=0]="QR_CODE",d[d.AZTEC=1]="AZTEC",d[d.CODABAR=2]="CODABAR",d[d.CODE_39=3]="CODE_39",d[d.CODE_93=4]="CODE_93",d[d.CODE_128=5]="CODE_128",d[d.DATA_MATRIX=6]="DATA_MATRIX",d[d.MAXICODE=7]="MAXICODE",d[d.ITF=8]="ITF",d[d.EAN_13=9]="EAN_13",d[d.EAN_8=10]="EAN_8",d[d.PDF_417=11]="PDF_417",d[d.RSS_14=12]="RSS_14",d[d.RSS_EXPANDED=13]="RSS_EXPANDED",d[d.UPC_A=14]="UPC_A",d[d.UPC_E=15]="UPC_E",d[d.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION",d}(ut||{}),Os=new Map([[ut.QR_CODE,"QR_CODE"],[ut.AZTEC,"AZTEC"],[ut.CODABAR,"CODABAR"],[ut.CODE_39,"CODE_39"],[ut.CODE_93,"CODE_93"],[ut.CODE_128,"CODE_128"],[ut.DATA_MATRIX,"DATA_MATRIX"],[ut.MAXICODE,"MAXICODE"],[ut.ITF,"ITF"],[ut.EAN_13,"EAN_13"],[ut.EAN_8,"EAN_8"],[ut.PDF_417,"PDF_417"],[ut.RSS_14,"RSS_14"],[ut.RSS_EXPANDED,"RSS_EXPANDED"],[ut.UPC_A,"UPC_A"],[ut.UPC_E,"UPC_E"],[ut.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]);function Ls(d){return Object.values(ut).includes(d)}var Hn=function(d){return d[d.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",d[d.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE",d}(Hn||{}),sn=function(){function d(){}return d.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",d.SCAN_DEFAULT_FPS=2,d.DEFAULT_DISABLE_FLIP=!1,d.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,d.DEFAULT_SUPPORTED_SCAN_TYPE=[Hn.SCAN_TYPE_CAMERA,Hn.SCAN_TYPE_FILE],d}();var no=function(){function d(m,c){this.format=m,this.formatName=c}return d.prototype.toString=function(){return this.formatName},d.create=function(m){if(!Os.has(m))throw"".concat(m," not in html5QrcodeSupportedFormatsTextMap");return new d(m,Os.get(m))},d}();var Lo=function(){function d(){}return d.createFromText=function(m){var c={text:m};return{decodedText:m,result:c}},d.createFromQrcodeResult=function(m){return{decodedText:m.text,result:m}},d}();var Ds=function(d){return d[d.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",d[d.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",d[d.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR",d}(Ds||{}),io=function(){function d(){}return d.createFrom=function(m){return{errorMessage:m,type:Ds.UNKWOWN_ERROR}},d}();var ro=function(){function d(m){this.verbose=m}return d.prototype.log=function(m){this.verbose&&console.log(m)},d.prototype.warn=function(m){this.verbose&&console.warn(m)},d.prototype.logError=function(m,c){(this.verbose||c===!0)&&console.error(m)},d.prototype.logErrors=function(m){if(m.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(m)},d}();function En(d){return typeof d>"u"||d===null}function Rs(d,m,c){return d>c?c:d<m?m:d}var gi=function(){function d(){}return d.codeParseError=function(m){return"QR code parse error, error = ".concat(m)},d.errorGettingUserMedia=function(m){return"Error getting userMedia, error = ".concat(m)},d.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},d.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},d.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},d.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},d.scannerPaused=function(){return"Scanner paused"},d}();var Kt=function(){function d(){}return d.scanningStatus=function(){return"Scanning"},d.idleStatus=function(){return"Idle"},d.errorStatus=function(){return"Error"},d.permissionStatus=function(){return"Permission"},d.noCameraFoundErrorStatus=function(){return"No Cameras"},d.lastMatch=function(m){return"Last Match: ".concat(m)},d.codeScannerTitle=function(){return"Code Scanner"},d.cameraPermissionTitle=function(){return"Request Camera Permissions"},d.cameraPermissionRequesting=function(){return"Requesting camera permissions..."},d.noCameraFound=function(){return"No camera found"},d.scanButtonStopScanningText=function(){return"Stop Scanning"},d.scanButtonStartScanningText=function(){return"Start Scanning"},d.torchOnButton=function(){return"Switch On Torch"},d.torchOffButton=function(){return"Switch Off Torch"},d.torchOnFailedMessage=function(){return"Failed to turn on torch"},d.torchOffFailedMessage=function(){return"Failed to turn off torch"},d.scanButtonScanningStarting=function(){return"Launching Camera..."},d.textIfCameraScanSelected=function(){return"Scan an Image File"},d.textIfFileScanSelected=function(){return"Scan using camera directly"},d.selectCamera=function(){return"Select Camera"},d.fileSelectionChooseImage=function(){return"Choose Image"},d.fileSelectionChooseAnother=function(){return"Choose Another"},d.fileSelectionNoImageSelected=function(){return"No image choosen"},d.anonymousCameraPrefix=function(){return"Anonymous Camera"},d.dragAndDropMessage=function(){return"Or drop an image to scan"},d.dragAndDropMessageOnlyImages=function(){return"Or drop an image to scan (other files not supported)"},d.zoom=function(){return"zoom"},d.loadingImage=function(){return"Loading image..."},d.cameraScanAltText=function(){return"Camera based scan"},d.fileScanAltText=function(){return"Fule based scan"},d}();var Do=function(){function d(){}return d.poweredBy=function(){return"Powered by "},d.reportIssues=function(){return"Report issues"},d}();var Ro=function(){function d(){}return d.isMediaStreamConstraintsValid=function(m,c){if(typeof m!="object"){var w=typeof m;return c.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(w,"."),!0),!1}for(var _=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],C=new Set(_),M=Object.keys(m),P=0,H=M;P<H.length;P++){var E=H[P];if(C.has(E))return c.logError("".concat(E," is not supported videoConstaints."),!0),!1}return!0},d}();var re=as(Bs());var Po=function(){function d(m,c,w){if(this.formatMap=new Map([[ut.QR_CODE,re.BarcodeFormat.QR_CODE],[ut.AZTEC,re.BarcodeFormat.AZTEC],[ut.CODABAR,re.BarcodeFormat.CODABAR],[ut.CODE_39,re.BarcodeFormat.CODE_39],[ut.CODE_93,re.BarcodeFormat.CODE_93],[ut.CODE_128,re.BarcodeFormat.CODE_128],[ut.DATA_MATRIX,re.BarcodeFormat.DATA_MATRIX],[ut.MAXICODE,re.BarcodeFormat.MAXICODE],[ut.ITF,re.BarcodeFormat.ITF],[ut.EAN_13,re.BarcodeFormat.EAN_13],[ut.EAN_8,re.BarcodeFormat.EAN_8],[ut.PDF_417,re.BarcodeFormat.PDF_417],[ut.RSS_14,re.BarcodeFormat.RSS_14],[ut.RSS_EXPANDED,re.BarcodeFormat.RSS_EXPANDED],[ut.UPC_A,re.BarcodeFormat.UPC_A],[ut.UPC_E,re.BarcodeFormat.UPC_E],[ut.UPC_EAN_EXTENSION,re.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!re)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=c,this.logger=w;var _=this.createZXingFormats(m),C=new Map;C.set(re.DecodeHintType.POSSIBLE_FORMATS,_),C.set(re.DecodeHintType.TRY_HARDER,!1),this.hints=C}return d.prototype.decodeAsync=function(m){var c=this;return new Promise(function(w,_){try{w(c.decode(m))}catch(C){_(C)}})},d.prototype.decode=function(m){var c=new re.MultiFormatReader(this.verbose,this.hints),w=new re.HTMLCanvasElementLuminanceSource(m),_=new re.BinaryBitmap(new re.HybridBinarizer(w)),C=c.decode(_);return{text:C.text,format:no.create(this.toHtml5QrcodeSupportedFormats(C.format)),debugData:this.createDebugData()}},d.prototype.createReverseFormatMap=function(){var m=new Map;return this.formatMap.forEach(function(c,w,_){m.set(c,w)}),m},d.prototype.toHtml5QrcodeSupportedFormats=function(m){if(!this.reverseFormatMap.has(m))throw"reverseFormatMap doesn't have ".concat(m);return this.reverseFormatMap.get(m)},d.prototype.createZXingFormats=function(m){for(var c=[],w=0,_=m;w<_.length;w++){var C=_[w];this.formatMap.has(C)?c.push(this.formatMap.get(C)):this.logger.logError("".concat(C," is not supported by")+"ZXingHtml5QrcodeShim")}return c},d.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},d}();var Aa=function(d,m,c,w){function _(C){return C instanceof c?C:new c(function(M){M(C)})}return new(c||(c=Promise))(function(C,M){function P(Z){try{E(w.next(Z))}catch($){M($)}}function H(Z){try{E(w.throw(Z))}catch($){M($)}}function E(Z){Z.done?C(Z.value):_(Z.value).then(P,H)}E((w=w.apply(d,m||[])).next())})},Sa=function(d,m){var c={label:0,sent:function(){if(C[0]&1)throw C[1];return C[1]},trys:[],ops:[]},w,_,C,M;return M={next:P(0),throw:P(1),return:P(2)},typeof Symbol=="function"&&(M[Symbol.iterator]=function(){return this}),M;function P(E){return function(Z){return H([E,Z])}}function H(E){if(w)throw new TypeError("Generator is already executing.");for(;M&&(M=0,E[0]&&(c=0)),c;)try{if(w=1,_&&(C=E[0]&2?_.return:E[0]?_.throw||((C=_.return)&&C.call(_),0):_.next)&&!(C=C.call(_,E[1])).done)return C;switch(_=0,C&&(E=[E[0]&2,C.value]),E[0]){case 0:case 1:C=E;break;case 4:return c.label++,{value:E[1],done:!1};case 5:c.label++,_=E[1],E=[0];continue;case 7:E=c.ops.pop(),c.trys.pop();continue;default:if(C=c.trys,!(C=C.length>0&&C[C.length-1])&&(E[0]===6||E[0]===2)){c=0;continue}if(E[0]===3&&(!C||E[1]>C[0]&&E[1]<C[3])){c.label=E[1];break}if(E[0]===6&&c.label<C[1]){c.label=C[1],C=E;break}if(C&&c.label<C[2]){c.label=C[2],c.ops.push(E);break}C[2]&&c.ops.pop(),c.trys.pop();continue}E=m.call(d,c)}catch(Z){E=[6,Z],_=0}finally{w=C=0}if(E[0]&5)throw E[1];return{value:E[0]?E[1]:void 0,done:!0}}},Bo=function(){function d(m,c,w){if(this.formatMap=new Map([[ut.QR_CODE,"qr_code"],[ut.AZTEC,"aztec"],[ut.CODABAR,"codabar"],[ut.CODE_39,"code_39"],[ut.CODE_93,"code_93"],[ut.CODE_128,"code_128"],[ut.DATA_MATRIX,"data_matrix"],[ut.ITF,"itf"],[ut.EAN_13,"ean_13"],[ut.EAN_8,"ean_8"],[ut.PDF_417,"pdf417"],[ut.UPC_A,"upc_a"],[ut.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!d.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=c,this.logger=w;var _=this.createBarcodeDetectorFormats(m);if(this.detector=new BarcodeDetector(_),!this.detector)throw"BarcodeDetector detector not supported"}return d.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var m=new BarcodeDetector({formats:["qr_code"]});return typeof m<"u"},d.prototype.decodeAsync=function(m){return Aa(this,void 0,void 0,function(){var c,w;return Sa(this,function(_){switch(_.label){case 0:return[4,this.detector.detect(m)];case 1:if(c=_.sent(),!c||c.length===0)throw"No barcode or QR code detected.";return w=this.selectLargestBarcode(c),[2,{text:w.rawValue,format:no.create(this.toHtml5QrcodeSupportedFormats(w.format)),debugData:this.createDebugData()}]}})})},d.prototype.selectLargestBarcode=function(m){for(var c=null,w=0,_=0,C=m;_<C.length;_++){var M=C[_],P=M.boundingBox.width*M.boundingBox.height;P>w&&(w=P,c=M)}if(!c)throw"No largest barcode found";return c},d.prototype.createBarcodeDetectorFormats=function(m){for(var c=[],w=0,_=m;w<_.length;w++){var C=_[w];this.formatMap.has(C)?c.push(this.formatMap.get(C)):this.logger.warn("".concat(C," is not supported by")+"BarcodeDetectorDelegate")}return{formats:c}},d.prototype.toHtml5QrcodeSupportedFormats=function(m){if(!this.reverseFormatMap.has(m))throw"reverseFormatMap doesn't have ".concat(m);return this.reverseFormatMap.get(m)},d.prototype.createReverseFormatMap=function(){var m=new Map;return this.formatMap.forEach(function(c,w,_){m.set(c,w)}),m},d.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},d}();var ks=function(d,m,c,w){function _(C){return C instanceof c?C:new c(function(M){M(C)})}return new(c||(c=Promise))(function(C,M){function P(Z){try{E(w.next(Z))}catch($){M($)}}function H(Z){try{E(w.throw(Z))}catch($){M($)}}function E(Z){Z.done?C(Z.value):_(Z.value).then(P,H)}E((w=w.apply(d,m||[])).next())})},Fs=function(d,m){var c={label:0,sent:function(){if(C[0]&1)throw C[1];return C[1]},trys:[],ops:[]},w,_,C,M;return M={next:P(0),throw:P(1),return:P(2)},typeof Symbol=="function"&&(M[Symbol.iterator]=function(){return this}),M;function P(E){return function(Z){return H([E,Z])}}function H(E){if(w)throw new TypeError("Generator is already executing.");for(;M&&(M=0,E[0]&&(c=0)),c;)try{if(w=1,_&&(C=E[0]&2?_.return:E[0]?_.throw||((C=_.return)&&C.call(_),0):_.next)&&!(C=C.call(_,E[1])).done)return C;switch(_=0,C&&(E=[E[0]&2,C.value]),E[0]){case 0:case 1:C=E;break;case 4:return c.label++,{value:E[1],done:!1};case 5:c.label++,_=E[1],E=[0];continue;case 7:E=c.ops.pop(),c.trys.pop();continue;default:if(C=c.trys,!(C=C.length>0&&C[C.length-1])&&(E[0]===6||E[0]===2)){c=0;continue}if(E[0]===3&&(!C||E[1]>C[0]&&E[1]<C[3])){c.label=E[1];break}if(E[0]===6&&c.label<C[1]){c.label=C[1],C=E;break}if(C&&c.label<C[2]){c.label=C[2],c.ops.push(E);break}C[2]&&c.ops.pop(),c.trys.pop();continue}E=m.call(d,c)}catch(Z){E=[6,Z],_=0}finally{w=C=0}if(E[0]&5)throw E[1];return{value:E[0]?E[1]:void 0,done:!0}}},Us=function(){function d(m,c,w,_){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=w,c&&Bo.isSupported()?(this.primaryDecoder=new Bo(m,w,_),this.secondaryDecoder=new Po(m,w,_)):this.primaryDecoder=new Po(m,w,_)}return d.prototype.decodeAsync=function(m){return ks(this,void 0,void 0,function(){var c;return Fs(this,function(w){switch(w.label){case 0:c=performance.now(),w.label=1;case 1:return w.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(m)];case 2:return[2,w.sent()];case 3:return this.possiblyLogPerformance(c),[7];case 4:return[2]}})})},d.prototype.decodeRobustlyAsync=function(m){return ks(this,void 0,void 0,function(){var c,w;return Fs(this,function(_){switch(_.label){case 0:c=performance.now(),_.label=1;case 1:return _.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(m)];case 2:return[2,_.sent()];case 3:if(w=_.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(m)];throw w;case 4:return this.possiblyLogPerformance(c),[7];case 5:return[2]}})})},d.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},d.prototype.possiblyLogPerformance=function(m){if(this.verbose){var c=performance.now()-m;this.executionResults.push(c),this.executions++,this.possiblyFlushPerformanceReport()}},d.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var m=0,c=0,w=this.executionResults;c<w.length;c++){var _=w[c];m+=_}var C=m/this.executionResults.length;console.log("".concat(C," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},d}();var ko=function(){var d=function(m,c){return d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(w,_){w.__proto__=_}||function(w,_){for(var C in _)Object.prototype.hasOwnProperty.call(_,C)&&(w[C]=_[C])},d(m,c)};return function(m,c){if(typeof c!="function"&&c!==null)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");d(m,c);function w(){this.constructor=m}m.prototype=c===null?Object.create(c):(w.prototype=c.prototype,new w)}}(),so=function(d,m,c,w){function _(C){return C instanceof c?C:new c(function(M){M(C)})}return new(c||(c=Promise))(function(C,M){function P(Z){try{E(w.next(Z))}catch($){M($)}}function H(Z){try{E(w.throw(Z))}catch($){M($)}}function E(Z){Z.done?C(Z.value):_(Z.value).then(P,H)}E((w=w.apply(d,m||[])).next())})},ao=function(d,m){var c={label:0,sent:function(){if(C[0]&1)throw C[1];return C[1]},trys:[],ops:[]},w,_,C,M;return M={next:P(0),throw:P(1),return:P(2)},typeof Symbol=="function"&&(M[Symbol.iterator]=function(){return this}),M;function P(E){return function(Z){return H([E,Z])}}function H(E){if(w)throw new TypeError("Generator is already executing.");for(;M&&(M=0,E[0]&&(c=0)),c;)try{if(w=1,_&&(C=E[0]&2?_.return:E[0]?_.throw||((C=_.return)&&C.call(_),0):_.next)&&!(C=C.call(_,E[1])).done)return C;switch(_=0,C&&(E=[E[0]&2,C.value]),E[0]){case 0:case 1:C=E;break;case 4:return c.label++,{value:E[1],done:!1};case 5:c.label++,_=E[1],E=[0];continue;case 7:E=c.ops.pop(),c.trys.pop();continue;default:if(C=c.trys,!(C=C.length>0&&C[C.length-1])&&(E[0]===6||E[0]===2)){c=0;continue}if(E[0]===3&&(!C||E[1]>C[0]&&E[1]<C[3])){c.label=E[1];break}if(E[0]===6&&c.label<C[1]){c.label=C[1],C=E;break}if(C&&c.label<C[2]){c.label=C[2],c.ops.push(E);break}C[2]&&c.ops.pop(),c.trys.pop();continue}E=m.call(d,c)}catch(Z){E=[6,Z],_=0}finally{w=C=0}if(E[0]&5)throw E[1];return{value:E[0]?E[1]:void 0,done:!0}}},zs=function(){function d(m,c){this.name=m,this.track=c}return d.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},d.prototype.apply=function(m){var c={};c[this.name]=m;var w={advanced:[c]};return this.track.applyConstraints(w)},d.prototype.value=function(){var m=this.track.getSettings();if(this.name in m){var c=m[this.name];return c}return null},d}(),Ia=function(d){ko(m,d);function m(c,w){return d.call(this,c,w)||this}return m.prototype.min=function(){return this.getCapabilities().min},m.prototype.max=function(){return this.getCapabilities().max},m.prototype.step=function(){return this.getCapabilities().step},m.prototype.apply=function(c){var w={};w[this.name]=c;var _={advanced:[w]};return this.track.applyConstraints(_)},m.prototype.getCapabilities=function(){this.failIfNotSupported();var c=this.track.getCapabilities(),w=c[this.name];return{min:w.min,max:w.max,step:w.step}},m.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},m}(zs),ba=function(d){ko(m,d);function m(c){return d.call(this,"zoom",c)||this}return m}(Ia),Ta=function(d){ko(m,d);function m(c){return d.call(this,"torch",c)||this}return m}(zs),Ma=function(){function d(m){this.track=m}return d.prototype.zoomFeature=function(){return new ba(this.track)},d.prototype.torchFeature=function(){return new Ta(this.track)},d}(),Na=function(){function d(m,c,w){this.isClosed=!1,this.parentElement=m,this.mediaStream=c,this.callbacks=w,this.surface=this.createVideoElement(this.parentElement.clientWidth),m.append(this.surface)}return d.prototype.createVideoElement=function(m){var c=document.createElement("video");return c.style.width="".concat(m,"px"),c.style.display="block",c.muted=!0,c.setAttribute("muted","true"),c.playsInline=!0,c},d.prototype.setupSurface=function(){var m=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var c=function(){var w=m.surface.clientWidth,_=m.surface.clientHeight;m.callbacks.onRenderSurfaceReady(w,_),m.surface.removeEventListener("playing",c)};this.surface.addEventListener("playing",c),this.surface.srcObject=this.mediaStream,this.surface.play()},d.create=function(m,c,w,_){return so(this,void 0,void 0,function(){var C,M;return ao(this,function(P){switch(P.label){case 0:return C=new d(m,c,_),w.aspectRatio?(M={aspectRatio:w.aspectRatio},[4,C.getFirstTrackOrFail().applyConstraints(M)]):[3,2];case 1:P.sent(),P.label=2;case 2:return C.setupSurface(),[2,C]}})})},d.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},d.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},d.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},d.prototype.resume=function(m){this.failIfClosed();var c=this,w=function(){setTimeout(m,200),c.surface.removeEventListener("playing",w)};this.surface.addEventListener("playing",w),this.surface.play()},d.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},d.prototype.getSurface=function(){return this.failIfClosed(),this.surface},d.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},d.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},d.prototype.applyVideoConstraints=function(m){return so(this,void 0,void 0,function(){return ao(this,function(c){if("aspectRatio"in m)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(m)]})})},d.prototype.close=function(){if(this.isClosed)return Promise.resolve();var m=this;return new Promise(function(c,w){var _=m.mediaStream.getVideoTracks(),C=_.length,M=0;m.mediaStream.getVideoTracks().forEach(function(P){m.mediaStream.removeTrack(P),P.stop(),++M,M>=C&&(m.isClosed=!0,m.parentElement.removeChild(m.surface),c())})})},d.prototype.getCapabilities=function(){return new Ma(this.getFirstTrackOrFail())},d}(),Hs=function(){function d(m){this.mediaStream=m}return d.prototype.render=function(m,c,w){return so(this,void 0,void 0,function(){return ao(this,function(_){return[2,Na.create(m,this.mediaStream,c,w)]})})},d.create=function(m){return so(this,void 0,void 0,function(){var c,w;return ao(this,function(_){switch(_.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return c={audio:!1,video:m},[4,navigator.mediaDevices.getUserMedia(c)];case 1:return w=_.sent(),[2,new d(w)]}})})},d}();var Vs=function(d,m,c,w){function _(C){return C instanceof c?C:new c(function(M){M(C)})}return new(c||(c=Promise))(function(C,M){function P(Z){try{E(w.next(Z))}catch($){M($)}}function H(Z){try{E(w.throw(Z))}catch($){M($)}}function E(Z){Z.done?C(Z.value):_(Z.value).then(P,H)}E((w=w.apply(d,m||[])).next())})},Zs=function(d,m){var c={label:0,sent:function(){if(C[0]&1)throw C[1];return C[1]},trys:[],ops:[]},w,_,C,M;return M={next:P(0),throw:P(1),return:P(2)},typeof Symbol=="function"&&(M[Symbol.iterator]=function(){return this}),M;function P(E){return function(Z){return H([E,Z])}}function H(E){if(w)throw new TypeError("Generator is already executing.");for(;M&&(M=0,E[0]&&(c=0)),c;)try{if(w=1,_&&(C=E[0]&2?_.return:E[0]?_.throw||((C=_.return)&&C.call(_),0):_.next)&&!(C=C.call(_,E[1])).done)return C;switch(_=0,C&&(E=[E[0]&2,C.value]),E[0]){case 0:case 1:C=E;break;case 4:return c.label++,{value:E[1],done:!1};case 5:c.label++,_=E[1],E=[0];continue;case 7:E=c.ops.pop(),c.trys.pop();continue;default:if(C=c.trys,!(C=C.length>0&&C[C.length-1])&&(E[0]===6||E[0]===2)){c=0;continue}if(E[0]===3&&(!C||E[1]>C[0]&&E[1]<C[3])){c.label=E[1];break}if(E[0]===6&&c.label<C[1]){c.label=C[1],C=E;break}if(C&&c.label<C[2]){c.label=C[2],c.ops.push(E);break}C[2]&&c.ops.pop(),c.trys.pop();continue}E=m.call(d,c)}catch(Z){E=[6,Z],_=0}finally{w=C=0}if(E[0]&5)throw E[1];return{value:E[0]?E[1]:void 0,done:!0}}},Ws=function(){function d(){}return d.failIfNotSupported=function(){return Vs(this,void 0,void 0,function(){return Zs(this,function(m){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new d]})})},d.prototype.create=function(m){return Vs(this,void 0,void 0,function(){return Zs(this,function(c){return[2,Hs.create(m)]})})},d}();var Oa=function(d,m,c,w){function _(C){return C instanceof c?C:new c(function(M){M(C)})}return new(c||(c=Promise))(function(C,M){function P(Z){try{E(w.next(Z))}catch($){M($)}}function H(Z){try{E(w.throw(Z))}catch($){M($)}}function E(Z){Z.done?C(Z.value):_(Z.value).then(P,H)}E((w=w.apply(d,m||[])).next())})},La=function(d,m){var c={label:0,sent:function(){if(C[0]&1)throw C[1];return C[1]},trys:[],ops:[]},w,_,C,M;return M={next:P(0),throw:P(1),return:P(2)},typeof Symbol=="function"&&(M[Symbol.iterator]=function(){return this}),M;function P(E){return function(Z){return H([E,Z])}}function H(E){if(w)throw new TypeError("Generator is already executing.");for(;M&&(M=0,E[0]&&(c=0)),c;)try{if(w=1,_&&(C=E[0]&2?_.return:E[0]?_.throw||((C=_.return)&&C.call(_),0):_.next)&&!(C=C.call(_,E[1])).done)return C;switch(_=0,C&&(E=[E[0]&2,C.value]),E[0]){case 0:case 1:C=E;break;case 4:return c.label++,{value:E[1],done:!1};case 5:c.label++,_=E[1],E=[0];continue;case 7:E=c.ops.pop(),c.trys.pop();continue;default:if(C=c.trys,!(C=C.length>0&&C[C.length-1])&&(E[0]===6||E[0]===2)){c=0;continue}if(E[0]===3&&(!C||E[1]>C[0]&&E[1]<C[3])){c.label=E[1];break}if(E[0]===6&&c.label<C[1]){c.label=C[1],C=E;break}if(C&&c.label<C[2]){c.label=C[2],c.ops.push(E);break}C[2]&&c.ops.pop(),c.trys.pop();continue}E=m.call(d,c)}catch(Z){E=[6,Z],_=0}finally{w=C=0}if(E[0]&5)throw E[1];return{value:E[0]?E[1]:void 0,done:!0}}},Gs=function(){function d(){}return d.retrieve=function(){if(navigator.mediaDevices)return d.getCamerasFromMediaDevices();var m=MediaStreamTrack;return MediaStreamTrack&&m.getSources?d.getCamerasFromMediaStreamTrack():d.rejectWithError()},d.rejectWithError=function(){var m=gi.unableToQuerySupportedDevices();return d.isHttpsOrLocalhost()||(m=gi.insecureContextCameraQueryError()),Promise.reject(m)},d.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var m=location.host.split(":")[0];return m==="127.0.0.1"||m==="localhost"},d.getCamerasFromMediaDevices=function(){return Oa(this,void 0,void 0,function(){var m,c,w,_,C,M,P;return La(this,function(H){switch(H.label){case 0:return m=function(E){for(var Z=E.getVideoTracks(),$=0,Bt=Z;$<Bt.length;$++){var st=Bt[$];st.enabled=!1,st.stop(),E.removeTrack(st)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return c=H.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(w=H.sent(),_=[],C=0,M=w;C<M.length;C++)P=M[C],P.kind==="videoinput"&&_.push({id:P.deviceId,label:P.label});return m(c),[2,_]}})})},d.getCamerasFromMediaStreamTrack=function(){return new Promise(function(m,c){var w=function(C){for(var M=[],P=0,H=C;P<H.length;P++){var E=H[P];E.kind==="video"&&M.push({id:E.id,label:E.label})}m(M)},_=MediaStreamTrack;_.getSources(w)})},d}();var Ce=function(d){return d[d.UNKNOWN=0]="UNKNOWN",d[d.NOT_STARTED=1]="NOT_STARTED",d[d.SCANNING=2]="SCANNING",d[d.PAUSED=3]="PAUSED",d}(Ce||{}),Da=function(){function d(){this.state=Ce.NOT_STARTED,this.onGoingTransactionNewState=Ce.UNKNOWN}return d.prototype.directTransition=function(m){this.failIfTransitionOngoing(),this.validateTransition(m),this.state=m},d.prototype.startTransition=function(m){return this.failIfTransitionOngoing(),this.validateTransition(m),this.onGoingTransactionNewState=m,this},d.prototype.execute=function(){if(this.onGoingTransactionNewState===Ce.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var m=this.onGoingTransactionNewState;this.onGoingTransactionNewState=Ce.UNKNOWN,this.directTransition(m)},d.prototype.cancel=function(){if(this.onGoingTransactionNewState===Ce.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=Ce.UNKNOWN},d.prototype.getState=function(){return this.state},d.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==Ce.UNKNOWN)throw"Cannot transition to a new state, already under transition"},d.prototype.validateTransition=function(m){switch(this.state){case Ce.UNKNOWN:throw"Transition from unknown is not allowed";case Ce.NOT_STARTED:this.failIfNewStateIs(m,[Ce.PAUSED]);break;case Ce.SCANNING:break;case Ce.PAUSED:break}},d.prototype.failIfNewStateIs=function(m,c){for(var w=0,_=c;w<_.length;w++){var C=_[w];if(m===C)throw"Cannot transition from ".concat(this.state," to ").concat(m)}},d}(),Ra=function(){function d(m){this.stateManager=m}return d.prototype.startTransition=function(m){return this.stateManager.startTransition(m)},d.prototype.directTransition=function(m){this.stateManager.directTransition(m)},d.prototype.getState=function(){return this.stateManager.getState()},d.prototype.canScanFile=function(){return this.stateManager.getState()===Ce.NOT_STARTED},d.prototype.isScanning=function(){return this.stateManager.getState()!==Ce.NOT_STARTED},d.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===Ce.SCANNING},d.prototype.isPaused=function(){return this.stateManager.getState()===Ce.PAUSED},d}();var js=function(){function d(){}return d.create=function(){return new Ra(new Da)},d}();var Pa=function(){var d=function(m,c){return d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(w,_){w.__proto__=_}||function(w,_){for(var C in _)Object.prototype.hasOwnProperty.call(_,C)&&(w[C]=_[C])},d(m,c)};return function(m,c){if(typeof c!="function"&&c!==null)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");d(m,c);function w(){this.constructor=m}m.prototype=c===null?Object.create(c):(w.prototype=c.prototype,new w)}}(),fn=function(d){Pa(m,d);function m(){return d!==null&&d.apply(this,arguments)||this}return m.DEFAULT_WIDTH=300,m.DEFAULT_WIDTH_OFFSET=2,m.FILE_SCAN_MIN_HEIGHT=300,m.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,m.MIN_QR_BOX_SIZE=50,m.SHADED_LEFT=1,m.SHADED_RIGHT=2,m.SHADED_TOP=3,m.SHADED_BOTTOM=4,m.SHADED_REGION_ELEMENT_ID="qr-shaded-region",m.VERBOSE=!1,m.BORDER_SHADER_DEFAULT_COLOR="#ffffff",m.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",m}(sn),Ba=function(){function d(m,c){this.logger=c,this.fps=fn.SCAN_DEFAULT_FPS,m?(m.fps&&(this.fps=m.fps),this.disableFlip=m.disableFlip===!0,this.qrbox=m.qrbox,this.aspectRatio=m.aspectRatio,this.videoConstraints=m.videoConstraints):this.disableFlip=fn.DEFAULT_DISABLE_FLIP}return d.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?Ro.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},d.prototype.isShadedBoxEnabled=function(){return!En(this.qrbox)},d.create=function(m,c){return new d(m,c)},d}(),nr=function(){function d(m,c){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(m))throw"HTML Element with id=".concat(m," not found");this.elementId=m,this.verbose=!1;var w,_;typeof c=="boolean"?this.verbose=c===!0:c&&(_=c,this.verbose=_.verbose===!0,w=_.experimentalFeatures),this.logger=new ro(this.verbose),this.qrcode=new Us(this.getSupportedFormats(c),this.getUseBarCodeDetectorIfSupported(_),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=js.create()}return d.prototype.start=function(m,c,w,_){var C=this;if(!m)throw"cameraIdOrConfig is required";if(!w||typeof w!="function")throw"qrCodeSuccessCallback is required and should be a function.";var M;_?M=_:M=this.verbose?this.logger.log:function(){};var P=Ba.create(c,this.logger);this.clearElement();var H=!1;P.videoConstraints&&(P.isMediaStreamConstraintsValid()?H=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var E=H,Z=document.getElementById(this.elementId),$=Z.clientWidth?Z.clientWidth:fn.DEFAULT_WIDTH;Z.style.position="relative",this.shouldScan=!0,this.element=Z;var Bt=this,st=this.stateManagerProxy.startTransition(Ce.SCANNING);return new Promise(function(Te,_e){var Lt=E?P.videoConstraints:Bt.createVideoConstraints(m);if(!Lt){st.cancel(),_e("videoConstraints should be defined");return}var gt={};(!E||P.aspectRatio)&&(gt.aspectRatio=P.aspectRatio);var Ft={onRenderSurfaceReady:function(Ye,Ut){Bt.setupUi(Ye,Ut,P),Bt.isScanning=!0,Bt.foreverScan(P,w,M)}};Ws.failIfNotSupported().then(function(Ye){Ye.create(Lt).then(function(Ut){return Ut.render(C.element,gt,Ft).then(function(tt){Bt.renderedCamera=tt,st.execute(),Te(null)}).catch(function(tt){st.cancel(),_e(tt)})}).catch(function(Ut){st.cancel(),_e(gi.errorGettingUserMedia(Ut))})}).catch(function(Ye){st.cancel(),_e(gi.cameraStreamingNotSupported())})})},d.prototype.pause=function(m){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(Ce.PAUSED),this.showPausedState(),(En(m)||m!==!0)&&(m=!1),m&&this.renderedCamera&&this.renderedCamera.pause()},d.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var m=this,c=function(){m.stateManagerProxy.directTransition(Ce.SCANNING),m.hidePausedState()};if(!this.renderedCamera.isPaused()){c();return}this.renderedCamera.resume(function(){c()})},d.prototype.getState=function(){return this.stateManagerProxy.getState()},d.prototype.stop=function(){var m=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var c=this.stateManagerProxy.startTransition(Ce.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var w=function(){if(m.element){var C=document.getElementById(fn.SHADED_REGION_ELEMENT_ID);C&&m.element.removeChild(C)}},_=this;return this.renderedCamera.close().then(function(){return _.renderedCamera=null,_.element&&(_.element.removeChild(_.canvasElement),_.canvasElement=null),w(),_.qrRegion&&(_.qrRegion=null),_.context&&(_.context=null),c.execute(),_.hidePausedState(),_.isScanning=!1,Promise.resolve()})},d.prototype.scanFile=function(m,c){return this.scanFileV2(m,c).then(function(w){return w.decodedText})},d.prototype.scanFileV2=function(m,c){var w=this;if(!m||!(m instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(En(c)&&(c=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(_,C){w.possiblyCloseLastScanImageFile(),w.clearElement(),w.lastScanImageFile=URL.createObjectURL(m);var M=new Image;M.onload=function(){var P=M.width,H=M.height,E=document.getElementById(w.elementId),Z=E.clientWidth?E.clientWidth:fn.DEFAULT_WIDTH,$=Math.max(E.clientHeight?E.clientHeight:H,fn.FILE_SCAN_MIN_HEIGHT),Bt=w.computeCanvasDrawConfig(P,H,Z,$);if(c){var st=w.createCanvasElement(Z,$,"qr-canvas-visible");st.style.display="inline-block",E.appendChild(st);var Te=st.getContext("2d");if(!Te)throw"Unable to get 2d context from canvas";Te.canvas.width=Z,Te.canvas.height=$,Te.drawImage(M,0,0,P,H,Bt.x,Bt.y,Bt.width,Bt.height)}var _e=fn.FILE_SCAN_HIDDEN_CANVAS_PADDING,Lt=Math.max(M.width,Bt.width),gt=Math.max(M.height,Bt.height),Ft=Lt+2*_e,Ye=gt+2*_e,Ut=w.createCanvasElement(Ft,Ye);E.appendChild(Ut);var tt=Ut.getContext("2d");if(!tt)throw"Unable to get 2d context from canvas";tt.canvas.width=Ft,tt.canvas.height=Ye,tt.drawImage(M,0,0,P,H,_e,_e,Lt,gt);try{w.qrcode.decodeRobustlyAsync(Ut).then(function(Gt){_(Lo.createFromQrcodeResult(Gt))}).catch(C)}catch(Gt){C("QR code parse error, error = ".concat(Gt))}},M.onerror=C,M.onabort=C,M.onstalled=C,M.onsuspend=C,M.src=URL.createObjectURL(m)})},d.prototype.clear=function(){this.clearElement()},d.getCameras=function(){return Gs.retrieve()},d.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},d.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},d.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},d.prototype.applyVideoConstraints=function(m){if(m){if(!Ro.isMediaStreamConstraintsValid(m,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(m)},d.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},d.prototype.getSupportedFormats=function(m){var c=[ut.QR_CODE,ut.AZTEC,ut.CODABAR,ut.CODE_39,ut.CODE_93,ut.CODE_128,ut.DATA_MATRIX,ut.MAXICODE,ut.ITF,ut.EAN_13,ut.EAN_8,ut.PDF_417,ut.RSS_14,ut.RSS_EXPANDED,ut.UPC_A,ut.UPC_E,ut.UPC_EAN_EXTENSION];if(!m||typeof m=="boolean"||!m.formatsToSupport)return c;if(!Array.isArray(m.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(m.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var w=[],_=0,C=m.formatsToSupport;_<C.length;_++){var M=C[_];Ls(M)?w.push(M):this.logger.warn("Invalid format: ".concat(M," passed in config, ignoring."))}if(w.length===0)throw"None of formatsToSupport match supported values.";return w},d.prototype.getUseBarCodeDetectorIfSupported=function(m){if(En(m))return!0;if(!En(m.useBarCodeDetectorIfSupported))return m.useBarCodeDetectorIfSupported!==!1;if(En(m.experimentalFeatures))return!0;var c=m.experimentalFeatures;return En(c.useBarCodeDetectorIfSupported)?!0:c.useBarCodeDetectorIfSupported!==!1},d.prototype.validateQrboxSize=function(m,c,w){var _=this,C=w.qrbox;this.validateQrboxConfig(C);var M=this.toQrdimensions(m,c,C),P=function(E){if(E<fn.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(fn.MIN_QR_BOX_SIZE,"px.")},H=function(E){return E>m&&(_.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),E=m),E};P(M.width),P(M.height),M.width=H(M.width)},d.prototype.validateQrboxConfig=function(m){if(typeof m!="number"&&typeof m!="function"&&(m.width===void 0||m.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},d.prototype.toQrdimensions=function(m,c,w){if(typeof w=="number")return{width:w,height:w};if(typeof w=="function")try{return w(m,c)}catch(_){throw new Error("qrbox config was passed as a function but it failed with unknown error"+_)}return w},d.prototype.setupUi=function(m,c,w){w.isShadedBoxEnabled()&&this.validateQrboxSize(m,c,w);var _=En(w.qrbox)?{width:m,height:c}:w.qrbox;this.validateQrboxConfig(_);var C=this.toQrdimensions(m,c,_);C.height>c&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var M=w.isShadedBoxEnabled()&&C.height<=c,P={x:0,y:0,width:m,height:c},H=M?this.getShadedRegionBounds(m,c,C):P,E=this.createCanvasElement(H.width,H.height),Z={willReadFrequently:!0},$=E.getContext("2d",Z);$.canvas.width=H.width,$.canvas.height=H.height,this.element.append(E),M&&this.possiblyInsertShadingElement(this.element,m,c,C),this.createScannerPausedUiElement(this.element),this.qrRegion=H,this.context=$,this.canvasElement=E},d.prototype.createScannerPausedUiElement=function(m){var c=document.createElement("div");c.innerText=gi.scannerPaused(),c.style.display="none",c.style.position="absolute",c.style.top="0px",c.style.zIndex="1",c.style.background="rgba(9, 9, 9, 0.46)",c.style.color="#FFECEC",c.style.textAlign="center",c.style.width="100%",m.appendChild(c),this.scannerPausedUiElement=c},d.prototype.scanContext=function(m,c){var w=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(_){return m(_.text,Lo.createFromQrcodeResult(_)),w.possiblyUpdateShaders(!0),!0}).catch(function(_){w.possiblyUpdateShaders(!1);var C=gi.codeParseError(_);return c(C,io.createFrom(C)),!1})},d.prototype.foreverScan=function(m,c,w){var _=this;if(this.shouldScan&&this.renderedCamera){var C=this.renderedCamera.getSurface(),M=C.videoWidth/C.clientWidth,P=C.videoHeight/C.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var H=this.qrRegion.width*M,E=this.qrRegion.height*P,Z=this.qrRegion.x*M,$=this.qrRegion.y*P;this.context.drawImage(C,Z,$,H,E,0,0,this.qrRegion.width,this.qrRegion.height);var Bt=function(){_.foreverScanTimeout=setTimeout(function(){_.foreverScan(m,c,w)},_.getTimeoutFps(m.fps))};this.scanContext(c,w).then(function(st){!st&&m.disableFlip!==!0?(_.context.translate(_.context.canvas.width,0),_.context.scale(-1,1),_.scanContext(c,w).finally(function(){Bt()})):Bt()}).catch(function(st){_.logger.logError("Error happend while scanning context",st),Bt()})}},d.prototype.createVideoConstraints=function(m){if(typeof m=="string")return{deviceId:{exact:m}};if(typeof m=="object"){var c="facingMode",w="deviceId",_={user:!0,environment:!0},C="exact",M=function(Te){if(Te in _)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(Te,"'")},P=Object.keys(m);if(P.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(P.length," keys");var H=Object.keys(m)[0];if(H!==c&&H!==w)throw"Only '".concat(c,"' and '").concat(w,"' ")+" are supported for 'cameraIdOrConfig'";if(H===c){var E=m.facingMode;if(typeof E=="string"){if(M(E))return{facingMode:E}}else if(typeof E=="object")if(C in E){if(M(E["".concat(C)]))return{facingMode:{exact:E["".concat(C)]}}}else throw"'facingMode' should be string or object with"+" ".concat(C," as key.");else{var Z=typeof E;throw"Invalid type of 'facingMode' = ".concat(Z)}}else{var $=m.deviceId;if(typeof $=="string")return{deviceId:$};if(typeof $=="object"){if(C in $)return{deviceId:{exact:$["".concat(C)]}};throw"'deviceId' should be string or object with"+" ".concat(C," as key.")}else{var Bt=typeof $;throw"Invalid type of 'deviceId' = ".concat(Bt)}}}var st=typeof m;throw"Invalid type of 'cameraIdOrConfig' = ".concat(st)},d.prototype.computeCanvasDrawConfig=function(m,c,w,_){if(m<=w&&c<=_){var C=(w-m)/2,M=(_-c)/2;return{x:C,y:M,width:m,height:c}}else{var P=m,H=c;return m>w&&(c=w/m*c,m=w),c>_&&(m=_/c*m,c=_),this.logger.log("Image downsampled from "+"".concat(P,"X").concat(H)+" to ".concat(m,"X").concat(c,".")),this.computeCanvasDrawConfig(m,c,w,_)}},d.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var m=document.getElementById(this.elementId);m&&(m.innerHTML="")},d.prototype.possiblyUpdateShaders=function(m){this.qrMatch!==m&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(c){c.style.backgroundColor=m?fn.BORDER_SHADER_MATCH_COLOR:fn.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=m)},d.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},d.prototype.createCanvasElement=function(m,c,w){var _=m,C=c,M=document.createElement("canvas");return M.style.width="".concat(_,"px"),M.style.height="".concat(C,"px"),M.style.display="none",M.id=En(w)?"qr-canvas":w,M},d.prototype.getShadedRegionBounds=function(m,c,w){if(w.width>m||w.height>c)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(m-w.width)/2,y:(c-w.height)/2,width:w.width,height:w.height}},d.prototype.possiblyInsertShadingElement=function(m,c,w,_){if(!(c-_.width<1||w-_.height<1)){var C=document.createElement("div");C.style.position="absolute";var M=(c-_.width)/2,P=(w-_.height)/2;if(C.style.borderLeft="".concat(M,"px solid rgba(0, 0, 0, 0.48)"),C.style.borderRight="".concat(M,"px solid rgba(0, 0, 0, 0.48)"),C.style.borderTop="".concat(P,"px solid rgba(0, 0, 0, 0.48)"),C.style.borderBottom="".concat(P,"px solid rgba(0, 0, 0, 0.48)"),C.style.boxSizing="border-box",C.style.top="0px",C.style.bottom="0px",C.style.left="0px",C.style.right="0px",C.id="".concat(fn.SHADED_REGION_ELEMENT_ID),c-_.width<11||w-_.height<11)this.hasBorderShaders=!1;else{var H=5,E=40;this.insertShaderBorders(C,E,H,-H,null,0,!0),this.insertShaderBorders(C,E,H,-H,null,0,!1),this.insertShaderBorders(C,E,H,null,-H,0,!0),this.insertShaderBorders(C,E,H,null,-H,0,!1),this.insertShaderBorders(C,H,E+H,-H,null,-H,!0),this.insertShaderBorders(C,H,E+H,null,-H,-H,!0),this.insertShaderBorders(C,H,E+H,-H,null,-H,!1),this.insertShaderBorders(C,H,E+H,null,-H,-H,!1),this.hasBorderShaders=!0}m.append(C)}},d.prototype.insertShaderBorders=function(m,c,w,_,C,M,P){var H=document.createElement("div");H.style.position="absolute",H.style.backgroundColor=fn.BORDER_SHADER_DEFAULT_COLOR,H.style.width="".concat(c,"px"),H.style.height="".concat(w,"px"),_!==null&&(H.style.top="".concat(_,"px")),C!==null&&(H.style.bottom="".concat(C,"px")),P?H.style.left="".concat(M,"px"):H.style.right="".concat(M,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(H),m.appendChild(H)},d.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},d.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},d.prototype.getTimeoutFps=function(m){return 1e3/m},d}();var Fo="data:image/svg+xml;base64,",Xs=Fo+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNzEuNjQzIDM3MS42NDMiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDM3MS42NDMgMzcxLjY0MyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PHBhdGggZD0iTTEwNS4wODQgMzguMjcxaDE2My43Njh2MjBIMTA1LjA4NHoiLz48cGF0aCBkPSJNMzExLjU5NiAxOTAuMTg5Yy03LjQ0MS05LjM0Ny0xOC40MDMtMTYuMjA2LTMyLjc0My0yMC41MjJWMzBjMC0xNi41NDItMTMuNDU4LTMwLTMwLTMwSDEyNS4wODRjLTE2LjU0MiAwLTMwIDEzLjQ1OC0zMCAzMHYxMjAuMTQzaC04LjI5NmMtMTYuNTQyIDAtMzAgMTMuNDU4LTMwIDMwdjEuMzMzYTI5LjgwNCAyOS44MDQgMCAwIDAgNC42MDMgMTUuOTM5Yy03LjM0IDUuNDc0LTEyLjEwMyAxNC4yMjEtMTIuMTAzIDI0LjA2MXYxLjMzM2MwIDkuODQgNC43NjMgMTguNTg3IDEyLjEwMyAyNC4wNjJhMjkuODEgMjkuODEgMCAwIDAtNC42MDMgMTUuOTM4djEuMzMzYzAgMTYuNTQyIDEzLjQ1OCAzMCAzMCAzMGg4LjMyNGMuNDI3IDExLjYzMSA3LjUwMyAyMS41ODcgMTcuNTM0IDI2LjE3Ny45MzEgMTAuNTAzIDQuMDg0IDMwLjE4NyAxNC43NjggNDUuNTM3YTkuOTg4IDkuOTg4IDAgMCAwIDguMjE2IDQuMjg4IDkuOTU4IDkuOTU4IDAgMCAwIDUuNzA0LTEuNzkzYzQuNTMzLTMuMTU1IDUuNjUtOS4zODggMi40OTUtMTMuOTIxLTYuNzk4LTkuNzY3LTkuNjAyLTIyLjYwOC0xMC43Ni0zMS40aDgyLjY4NWMuMjcyLjQxNC41NDUuODE4LjgxNSAxLjIxIDMuMTQyIDQuNTQxIDkuMzcyIDUuNjc5IDEzLjkxMyAyLjUzNCA0LjU0Mi0zLjE0MiA1LjY3Ny05LjM3MSAyLjUzNS0xMy45MTMtMTEuOTE5LTE3LjIyOS04Ljc4Ny0zNS44ODQgOS41ODEtNTcuMDEyIDMuMDY3LTIuNjUyIDEyLjMwNy0xMS43MzIgMTEuMjE3LTI0LjAzMy0uODI4LTkuMzQzLTcuMTA5LTE3LjE5NC0xOC42NjktMjMuMzM3YTkuODU3IDkuODU3IDAgMCAwLTEuMDYxLS40ODZjLS40NjYtLjE4Mi0xMS40MDMtNC41NzktOS43NDEtMTUuNzA2IDEuMDA3LTYuNzM3IDE0Ljc2OC04LjI3MyAyMy43NjYtNy42NjYgMjMuMTU2IDEuNTY5IDM5LjY5OCA3LjgwMyA0Ny44MzYgMTguMDI2IDUuNzUyIDcuMjI1IDcuNjA3IDE2LjYyMyA1LjY3MyAyOC43MzMtLjQxMyAyLjU4NS0uODI0IDUuMjQxLTEuMjQ1IDcuOTU5LTUuNzU2IDM3LjE5NC0xMi45MTkgODMuNDgzLTQ5Ljg3IDExNC42NjEtNC4yMjEgMy41NjEtNC43NTYgOS44Ny0xLjE5NCAxNC4wOTJhOS45OCA5Ljk4IDAgMCAwIDcuNjQ4IDMuNTUxIDkuOTU1IDkuOTU1IDAgMCAwIDYuNDQ0LTIuMzU4YzQyLjY3Mi0zNi4wMDUgNTAuODAyLTg4LjUzMyA1Ni43MzctMTI2Ljg4OC40MTUtMi42ODQuODIxLTUuMzA5IDEuMjI5LTcuODYzIDIuODM0LTE3LjcyMS0uNDU1LTMyLjY0MS05Ljc3Mi00NC4zNDV6bS0yMzIuMzA4IDQyLjYyYy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi0xLjMzM2MwLTUuNTE0IDQuNDg2LTEwIDEwLTEwaDE1djIxLjMzM2gtMTV6bS0yLjUtNTIuNjY2YzAtNS41MTQgNC40ODYtMTAgMTAtMTBoNy41djIxLjMzM2gtNy41Yy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi0xLjMzM3ptMTcuNSA5My45OTloLTcuNWMtNS41MTQgMC0xMC00LjQ4Ni0xMC0xMHYtMS4zMzNjMC01LjUxNCA0LjQ4Ni0xMCAxMC0xMGg3LjV2MjEuMzMzem0zMC43OTYgMjguODg3Yy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi04LjI3MWg5MS40NTdjLS44NTEgNi42NjgtLjQzNyAxMi43ODcuNzMxIDE4LjI3MWgtODIuMTg4em03OS40ODItMTEzLjY5OGMtMy4xMjQgMjAuOTA2IDEyLjQyNyAzMy4xODQgMjEuNjI1IDM3LjA0IDUuNDQxIDIuOTY4IDcuNTUxIDUuNjQ3IDcuNzAxIDcuMTg4LjIxIDIuMTUtMi41NTMgNS42ODQtNC40NzcgNy4yNTEtLjQ4Mi4zNzgtLjkyOS44LTEuMzM1IDEuMjYxLTYuOTg3IDcuOTM2LTExLjk4MiAxNS41Mi0xNS40MzIgMjIuNjg4aC05Ny41NjRWMzBjMC01LjUxNCA0LjQ4Ni0xMCAxMC0xMGgxMjMuNzY5YzUuNTE0IDAgMTAgNC40ODYgMTAgMTB2MTM1LjU3OWMtMy4wMzItLjM4MS02LjE1LS42OTQtOS4zODktLjkxNC0yNS4xNTktMS42OTQtNDIuMzcgNy43NDgtNDQuODk4IDI0LjY2NnoiLz48cGF0aCBkPSJNMTc5LjEyOSA4My4xNjdoLTI0LjA2YTUgNSAwIDAgMC01IDV2MjQuMDYxYTUgNSAwIDAgMCA1IDVoMjQuMDZhNSA1IDAgMCAwIDUtNVY4OC4xNjdhNSA1IDAgMCAwLTUtNXpNMTcyLjYyOSAxNDIuODZoLTEyLjU2VjEzMC44YTUgNSAwIDEgMC0xMCAwdjE3LjA2MWE1IDUgMCAwIDAgNSA1aDE3LjU2YTUgNSAwIDEgMCAwLTEwLjAwMXpNMjE2LjU2OCA4My4xNjdoLTI0LjA2YTUgNSAwIDAgMC01IDV2MjQuMDYxYTUgNSAwIDAgMCA1IDVoMjQuMDZhNSA1IDAgMCAwIDUtNVY4OC4xNjdhNSA1IDAgMCAwLTUtNXptLTUgMjQuMDYxaC0xNC4wNlY5My4xNjdoMTQuMDZ2MTQuMDYxek0yMTEuNjY5IDEyNS45MzZIMTk3LjQxYTUgNSAwIDAgMC01IDV2MTQuMjU3YTUgNSAwIDAgMCA1IDVoMTQuMjU5YTUgNSAwIDAgMCA1LTV2LTE0LjI1N2E1IDUgMCAwIDAtNS01eiIvPjwvc3ZnPg==",Ys=Fo+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1OS4wMTggNTkuMDE4IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA1OS4wMTggNTkuMDE4IiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBkPSJtNTguNzQxIDU0LjgwOS01Ljk2OS02LjI0NGExMC43NCAxMC43NCAwIDAgMCAyLjgyLTcuMjVjMC01Ljk1My00Ljg0My0xMC43OTYtMTAuNzk2LTEwLjc5NlMzNCAzNS4zNjEgMzQgNDEuMzE0IDM4Ljg0MyA1Mi4xMSA0NC43OTYgNTIuMTFjMi40NDEgMCA0LjY4OC0uODI0IDYuNDk5LTIuMTk2bDYuMDAxIDYuMjc3YS45OTguOTk4IDAgMCAwIDEuNDE0LjAzMiAxIDEgMCAwIDAgLjAzMS0xLjQxNHpNMzYgNDEuMzE0YzAtNC44NSAzLjk0Ni04Ljc5NiA4Ljc5Ni04Ljc5NnM4Ljc5NiAzLjk0NiA4Ljc5NiA4Ljc5Ni0zLjk0NiA4Ljc5Ni04Ljc5NiA4Ljc5NlMzNiA0Ni4xNjQgMzYgNDEuMzE0ek0xMC40MzEgMTYuMDg4YzAgMy4wNyAyLjQ5OCA1LjU2OCA1LjU2OSA1LjU2OHM1LjU2OS0yLjQ5OCA1LjU2OS01LjU2OGMwLTMuMDcxLTIuNDk4LTUuNTY5LTUuNTY5LTUuNTY5cy01LjU2OSAyLjQ5OC01LjU2OSA1LjU2OXptOS4xMzggMGMwIDEuOTY4LTEuNjAyIDMuNTY4LTMuNTY5IDMuNTY4cy0zLjU2OS0xLjYwMS0zLjU2OS0zLjU2OCAxLjYwMi0zLjU2OSAzLjU2OS0zLjU2OSAzLjU2OSAxLjYwMSAzLjU2OSAzLjU2OXoiLz48cGF0aCBkPSJtMzAuODgyIDI4Ljk4NyA5LjE4LTEwLjA1NCAxMS4yNjIgMTAuMzIzYTEgMSAwIDAgMCAxLjM1MS0xLjQ3NWwtMTItMTFhMSAxIDAgMCAwLTEuNDE0LjA2M2wtOS43OTQgMTAuNzI3LTQuNzQzLTQuNzQzYTEuMDAzIDEuMDAzIDAgMCAwLTEuMzY4LS4wNDRMNi4zMzkgMzcuNzY4YTEgMSAwIDEgMCAxLjMyMiAxLjUwMWwxNi4zMTMtMTQuMzYyIDcuMzE5IDcuMzE4YS45OTkuOTk5IDAgMSAwIDEuNDE0LTEuNDE0bC0xLjgyNS0xLjgyNHoiLz48cGF0aCBkPSJNMzAgNDYuNTE4SDJ2LTQyaDU0djI4YTEgMSAwIDEgMCAyIDB2LTI5YTEgMSAwIDAgMC0xLTFIMWExIDEgMCAwIDAtMSAxdjQ0YTEgMSAwIDAgMCAxIDFoMjlhMSAxIDAgMSAwIDAtMnoiLz48L3N2Zz4=",Uo=Fo+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0NjAgNDYwIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA0NjAgNDYwIiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBkPSJNMjMwIDBDMTAyLjk3NSAwIDAgMTAyLjk3NSAwIDIzMHMxMDIuOTc1IDIzMCAyMzAgMjMwIDIzMC0xMDIuOTc0IDIzMC0yMzBTMzU3LjAyNSAwIDIzMCAwem0zOC4zMzMgMzc3LjM2YzAgOC42NzYtNy4wMzQgMTUuNzEtMTUuNzEgMTUuNzFoLTQzLjEwMWMtOC42NzYgMC0xNS43MS03LjAzNC0xNS43MS0xNS43MVYyMDIuNDc3YzAtOC42NzYgNy4wMzMtMTUuNzEgMTUuNzEtMTUuNzFoNDMuMTAxYzguNjc2IDAgMTUuNzEgNy4wMzMgMTUuNzEgMTUuNzFWMzc3LjM2ek0yMzAgMTU3Yy0yMS41MzkgMC0zOS0xNy40NjEtMzktMzlzMTcuNDYxLTM5IDM5LTM5IDM5IDE3LjQ2MSAzOSAzOS0xNy40NjEgMzktMzkgMzl6Ii8+PC9zdmc+",Qs="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAQgAAAEIBarqQRAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAE1SURBVDiNfdI7S0NBEAXgLya1otFgpbYSbISAgpXYi6CmiH9KCAiChaVga6OiWPgfRDQ+0itaGVNosXtluWwcuMzePfM4M3sq8lbHBubwg1dc4m1E/J/N4ghDPOIsfk/4xiEao5KX0McFljN4C9d4QTPXuY99jP3DsIoDPGM6BY5i5yI5R7O4q+ImFkJY2DCh3cAH2klyB+9J1xUMMAG7eCh1a+Mr+k48b5diXrFVwwLuS+BJ9MfR7+G0FHOHhTHhnXNWS87VDF4pcnfQK4Ep7XScNLmPTZgURNKKYENYWDpzW1BhscS1WHS8CDgURFJQrWcoF3c13KKbgg1BYQfy8xZWEzTTw1QZbAoKu8FqJnktdu5hcVSHmchiILzzuaDQvjBzV2m8yohCE1jHfPx/xhU+y4G/D75ELlRJsSYAAAAASUVORK5CYII=";var qs=function(){function d(){}return d.createDefault=function(){return{hasPermission:!1,lastUsedCameraId:null}},d}(),Ks=function(){function d(){this.data=qs.createDefault();var m=localStorage.getItem(d.LOCAL_STORAGE_KEY);m?this.data=JSON.parse(m):this.reset()}return d.prototype.hasCameraPermissions=function(){return this.data.hasPermission},d.prototype.getLastUsedCameraId=function(){return this.data.lastUsedCameraId},d.prototype.setHasPermission=function(m){this.data.hasPermission=m,this.flush()},d.prototype.setLastUsedCameraId=function(m){this.data.lastUsedCameraId=m,this.flush()},d.prototype.resetLastUsedCameraId=function(){this.data.lastUsedCameraId=null,this.flush()},d.prototype.reset=function(){this.data=qs.createDefault(),this.flush()},d.prototype.flush=function(){localStorage.setItem(d.LOCAL_STORAGE_KEY,JSON.stringify(this.data))},d.LOCAL_STORAGE_KEY="HTML5_QRCODE_DATA",d}();var ka=function(){function d(){this.infoDiv=document.createElement("div")}return d.prototype.renderInto=function(m){this.infoDiv.style.position="absolute",this.infoDiv.style.top="10px",this.infoDiv.style.right="10px",this.infoDiv.style.zIndex="2",this.infoDiv.style.display="none",this.infoDiv.style.padding="5pt",this.infoDiv.style.border="1px solid #171717",this.infoDiv.style.fontSize="10pt",this.infoDiv.style.background="rgb(0 0 0 / 69%)",this.infoDiv.style.borderRadius="5px",this.infoDiv.style.textAlign="center",this.infoDiv.style.fontWeight="400",this.infoDiv.style.color="white",this.infoDiv.innerText=Do.poweredBy();var c=document.createElement("a");c.innerText="ScanApp",c.href="https://scanapp.org",c.target="new",c.style.color="white",this.infoDiv.appendChild(c);var w=document.createElement("br"),_=document.createElement("br");this.infoDiv.appendChild(w),this.infoDiv.appendChild(_);var C=document.createElement("a");C.innerText=Do.reportIssues(),C.href="https://github.com/mebjas/html5-qrcode/issues",C.target="new",C.style.color="white",this.infoDiv.appendChild(C),m.appendChild(this.infoDiv)},d.prototype.show=function(){this.infoDiv.style.display="block"},d.prototype.hide=function(){this.infoDiv.style.display="none"},d}(),Fa=function(){function d(m,c){this.isShowingInfoIcon=!0,this.onTapIn=m,this.onTapOut=c,this.infoIcon=document.createElement("img")}return d.prototype.renderInto=function(m){var c=this;this.infoIcon.alt="Info icon",this.infoIcon.src=Uo,this.infoIcon.style.position="absolute",this.infoIcon.style.top="4px",this.infoIcon.style.right="4px",this.infoIcon.style.opacity="0.6",this.infoIcon.style.cursor="pointer",this.infoIcon.style.zIndex="2",this.infoIcon.style.width="16px",this.infoIcon.style.height="16px",this.infoIcon.onmouseover=function(w){return c.onHoverIn()},this.infoIcon.onmouseout=function(w){return c.onHoverOut()},this.infoIcon.onclick=function(w){return c.onClick()},m.appendChild(this.infoIcon)},d.prototype.onHoverIn=function(){this.isShowingInfoIcon&&(this.infoIcon.style.opacity="1")},d.prototype.onHoverOut=function(){this.isShowingInfoIcon&&(this.infoIcon.style.opacity="0.6")},d.prototype.onClick=function(){this.isShowingInfoIcon?(this.isShowingInfoIcon=!1,this.onTapIn(),this.infoIcon.src=Qs,this.infoIcon.style.opacity="1"):(this.isShowingInfoIcon=!0,this.onTapOut(),this.infoIcon.src=Uo,this.infoIcon.style.opacity="0.6")},d}(),Js=function(){function d(){var m=this;this.infoDiv=new ka,this.infoIcon=new Fa(function(){m.infoDiv.show()},function(){m.infoDiv.hide()})}return d.prototype.renderInto=function(m){this.infoDiv.renderInto(m),this.infoIcon.renderInto(m)},d}();var Ua=function(d,m,c,w){function _(C){return C instanceof c?C:new c(function(M){M(C)})}return new(c||(c=Promise))(function(C,M){function P(Z){try{E(w.next(Z))}catch($){M($)}}function H(Z){try{E(w.throw(Z))}catch($){M($)}}function E(Z){Z.done?C(Z.value):_(Z.value).then(P,H)}E((w=w.apply(d,m||[])).next())})},za=function(d,m){var c={label:0,sent:function(){if(C[0]&1)throw C[1];return C[1]},trys:[],ops:[]},w,_,C,M;return M={next:P(0),throw:P(1),return:P(2)},typeof Symbol=="function"&&(M[Symbol.iterator]=function(){return this}),M;function P(E){return function(Z){return H([E,Z])}}function H(E){if(w)throw new TypeError("Generator is already executing.");for(;M&&(M=0,E[0]&&(c=0)),c;)try{if(w=1,_&&(C=E[0]&2?_.return:E[0]?_.throw||((C=_.return)&&C.call(_),0):_.next)&&!(C=C.call(_,E[1])).done)return C;switch(_=0,C&&(E=[E[0]&2,C.value]),E[0]){case 0:case 1:C=E;break;case 4:return c.label++,{value:E[1],done:!1};case 5:c.label++,_=E[1],E=[0];continue;case 7:E=c.ops.pop(),c.trys.pop();continue;default:if(C=c.trys,!(C=C.length>0&&C[C.length-1])&&(E[0]===6||E[0]===2)){c=0;continue}if(E[0]===3&&(!C||E[1]>C[0]&&E[1]<C[3])){c.label=E[1];break}if(E[0]===6&&c.label<C[1]){c.label=C[1],C=E;break}if(C&&c.label<C[2]){c.label=C[2],c.ops.push(E);break}C[2]&&c.ops.pop(),c.trys.pop();continue}E=m.call(d,c)}catch(Z){E=[6,Z],_=0}finally{w=C=0}if(E[0]&5)throw E[1];return{value:E[0]?E[1]:void 0,done:!0}}},zo=function(){function d(){}return d.hasPermissions=function(){return Ua(this,void 0,void 0,function(){var m,c,w,_;return za(this,function(C){switch(C.label){case 0:return[4,navigator.mediaDevices.enumerateDevices()];case 1:for(m=C.sent(),c=0,w=m;c<w.length;c++)if(_=w[c],_.kind==="videoinput"&&_.label)return[2,!0];return[2,!1]}})})},d}();var $n=function(){function d(m){this.supportedScanTypes=this.validateAndReturnScanTypes(m)}return d.prototype.getDefaultScanType=function(){return this.supportedScanTypes[0]},d.prototype.hasMoreThanOneScanType=function(){return this.supportedScanTypes.length>1},d.prototype.isCameraScanRequired=function(){for(var m=0,c=this.supportedScanTypes;m<c.length;m++){var w=c[m];if(d.isCameraScanType(w))return!0}return!1},d.isCameraScanType=function(m){return m===Hn.SCAN_TYPE_CAMERA},d.isFileScanType=function(m){return m===Hn.SCAN_TYPE_FILE},d.prototype.validateAndReturnScanTypes=function(m){if(!m||m.length===0)return sn.DEFAULT_SUPPORTED_SCAN_TYPE;var c=sn.DEFAULT_SUPPORTED_SCAN_TYPE.length;if(m.length>c)throw"Max ".concat(c," values expected for ")+"supportedScanTypes";for(var w=0,_=m;w<_.length;w++){var C=_[w];if(!sn.DEFAULT_SUPPORTED_SCAN_TYPE.includes(C))throw"Unsupported scan type ".concat(C)}return m},d}();var He=function(){function d(){}return d.ALL_ELEMENT_CLASS="html5-qrcode-element",d.CAMERA_PERMISSION_BUTTON_ID="html5-qrcode-button-camera-permission",d.CAMERA_START_BUTTON_ID="html5-qrcode-button-camera-start",d.CAMERA_STOP_BUTTON_ID="html5-qrcode-button-camera-stop",d.TORCH_BUTTON_ID="html5-qrcode-button-torch",d.CAMERA_SELECTION_SELECT_ID="html5-qrcode-select-camera",d.FILE_SELECTION_BUTTON_ID="html5-qrcode-button-file-selection",d.ZOOM_SLIDER_ID="html5-qrcode-input-range-zoom",d.SCAN_TYPE_CHANGE_ANCHOR_ID="html5-qrcode-anchor-scan-type-change",d.TORCH_BUTTON_CLASS_TORCH_ON="html5-qrcode-button-torch-on",d.TORCH_BUTTON_CLASS_TORCH_OFF="html5-qrcode-button-torch-off",d}();var an=function(){function d(){}return d.createElement=function(m,c){var w=document.createElement(m);return w.id=c,w.classList.add(He.ALL_ELEMENT_CLASS),m==="button"&&w.setAttribute("type","button"),w},d}();var ta=function(d,m,c,w){function _(C){return C instanceof c?C:new c(function(M){M(C)})}return new(c||(c=Promise))(function(C,M){function P(Z){try{E(w.next(Z))}catch($){M($)}}function H(Z){try{E(w.throw(Z))}catch($){M($)}}function E(Z){Z.done?C(Z.value):_(Z.value).then(P,H)}E((w=w.apply(d,m||[])).next())})},ea=function(d,m){var c={label:0,sent:function(){if(C[0]&1)throw C[1];return C[1]},trys:[],ops:[]},w,_,C,M;return M={next:P(0),throw:P(1),return:P(2)},typeof Symbol=="function"&&(M[Symbol.iterator]=function(){return this}),M;function P(E){return function(Z){return H([E,Z])}}function H(E){if(w)throw new TypeError("Generator is already executing.");for(;M&&(M=0,E[0]&&(c=0)),c;)try{if(w=1,_&&(C=E[0]&2?_.return:E[0]?_.throw||((C=_.return)&&C.call(_),0):_.next)&&!(C=C.call(_,E[1])).done)return C;switch(_=0,C&&(E=[E[0]&2,C.value]),E[0]){case 0:case 1:C=E;break;case 4:return c.label++,{value:E[1],done:!1};case 5:c.label++,_=E[1],E=[0];continue;case 7:E=c.ops.pop(),c.trys.pop();continue;default:if(C=c.trys,!(C=C.length>0&&C[C.length-1])&&(E[0]===6||E[0]===2)){c=0;continue}if(E[0]===3&&(!C||E[1]>C[0]&&E[1]<C[3])){c.label=E[1];break}if(E[0]===6&&c.label<C[1]){c.label=C[1],C=E;break}if(C&&c.label<C[2]){c.label=C[2],c.ops.push(E);break}C[2]&&c.ops.pop(),c.trys.pop();continue}E=m.call(d,c)}catch(Z){E=[6,Z],_=0}finally{w=C=0}if(E[0]&5)throw E[1];return{value:E[0]?E[1]:void 0,done:!0}}},$s=function(){function d(m,c,w){this.isTorchOn=!1,this.torchCapability=m,this.buttonController=c,this.onTorchActionFailureCallback=w}return d.prototype.isTorchEnabled=function(){return this.isTorchOn},d.prototype.flipState=function(){return ta(this,void 0,void 0,function(){var m,c;return ea(this,function(w){switch(w.label){case 0:this.buttonController.disable(),m=!this.isTorchOn,w.label=1;case 1:return w.trys.push([1,3,,4]),[4,this.torchCapability.apply(m)];case 2:return w.sent(),this.updateUiBasedOnLatestSettings(this.torchCapability.value(),m),[3,4];case 3:return c=w.sent(),this.propagateFailure(m,c),this.buttonController.enable(),[3,4];case 4:return[2]}})})},d.prototype.updateUiBasedOnLatestSettings=function(m,c){m===c?(this.buttonController.setText(c?Kt.torchOffButton():Kt.torchOnButton()),this.isTorchOn=c):this.propagateFailure(c),this.buttonController.enable()},d.prototype.propagateFailure=function(m,c){var w=m?Kt.torchOnFailedMessage():Kt.torchOffFailedMessage();c&&(w+="; Error = "+c),this.onTorchActionFailureCallback(w)},d.prototype.reset=function(){this.isTorchOn=!1},d}(),na=function(){function d(m,c){this.onTorchActionFailureCallback=c,this.torchButton=an.createElement("button",He.TORCH_BUTTON_ID),this.torchController=new $s(m,this,c)}return d.prototype.render=function(m,c){var w=this;this.torchButton.innerText=Kt.torchOnButton(),this.torchButton.style.display=c.display,this.torchButton.style.marginLeft=c.marginLeft;var _=this;this.torchButton.addEventListener("click",function(C){return ta(w,void 0,void 0,function(){return ea(this,function(M){switch(M.label){case 0:return[4,_.torchController.flipState()];case 1:return M.sent(),_.torchController.isTorchEnabled()?(_.torchButton.classList.remove(He.TORCH_BUTTON_CLASS_TORCH_OFF),_.torchButton.classList.add(He.TORCH_BUTTON_CLASS_TORCH_ON)):(_.torchButton.classList.remove(He.TORCH_BUTTON_CLASS_TORCH_ON),_.torchButton.classList.add(He.TORCH_BUTTON_CLASS_TORCH_OFF)),[2]}})})}),m.appendChild(this.torchButton)},d.prototype.updateTorchCapability=function(m){this.torchController=new $s(m,this,this.onTorchActionFailureCallback)},d.prototype.getTorchButton=function(){return this.torchButton},d.prototype.hide=function(){this.torchButton.style.display="none"},d.prototype.show=function(){this.torchButton.style.display="inline-block"},d.prototype.disable=function(){this.torchButton.disabled=!0},d.prototype.enable=function(){this.torchButton.disabled=!1},d.prototype.setText=function(m){this.torchButton.innerText=m},d.prototype.reset=function(){this.torchButton.innerText=Kt.torchOnButton(),this.torchController.reset()},d.create=function(m,c,w,_){var C=new d(c,_);return C.render(m,w),C},d}();var ia=function(){function d(m,c,w){this.fileBasedScanRegion=this.createFileBasedScanRegion(),this.fileBasedScanRegion.style.display=c?"block":"none",m.appendChild(this.fileBasedScanRegion);var _=document.createElement("label");_.setAttribute("for",this.getFileScanInputId()),_.style.display="inline-block",this.fileBasedScanRegion.appendChild(_),this.fileSelectionButton=an.createElement("button",He.FILE_SELECTION_BUTTON_ID),this.setInitialValueToButton(),this.fileSelectionButton.addEventListener("click",function(P){_.click()}),_.append(this.fileSelectionButton),this.fileScanInput=an.createElement("input",this.getFileScanInputId()),this.fileScanInput.type="file",this.fileScanInput.accept="image/*",this.fileScanInput.style.display="none",_.appendChild(this.fileScanInput);var C=this;this.fileScanInput.addEventListener("change",function(P){if(!(P==null||P.target==null)){var H=P.target;if(!(H.files&&H.files.length===0)){var E=H.files,Z=E[0],$=Z.name;C.setImageNameToButton($),w(Z)}}});var M=this.createDragAndDropMessage();this.fileBasedScanRegion.appendChild(M),this.fileBasedScanRegion.addEventListener("dragenter",function(P){C.fileBasedScanRegion.style.border=C.fileBasedScanRegionActiveBorder(),P.stopPropagation(),P.preventDefault()}),this.fileBasedScanRegion.addEventListener("dragleave",function(P){C.fileBasedScanRegion.style.border=C.fileBasedScanRegionDefaultBorder(),P.stopPropagation(),P.preventDefault()}),this.fileBasedScanRegion.addEventListener("dragover",function(P){C.fileBasedScanRegion.style.border=C.fileBasedScanRegionActiveBorder(),P.stopPropagation(),P.preventDefault()}),this.fileBasedScanRegion.addEventListener("drop",function(P){P.stopPropagation(),P.preventDefault(),C.fileBasedScanRegion.style.border=C.fileBasedScanRegionDefaultBorder();var H=P.dataTransfer;if(H){var E=H.files;if(!E||E.length===0)return;for(var Z=!1,$=0;$<E.length;++$){var Bt=E.item($);if(Bt){var st=/image.*/;if(Bt.type.match(st)){Z=!0;var Te=Bt.name;C.setImageNameToButton(Te),w(Bt),M.innerText=Kt.dragAndDropMessage();break}}}Z||(M.innerText=Kt.dragAndDropMessageOnlyImages())}})}return d.prototype.hide=function(){this.fileBasedScanRegion.style.display="none",this.fileScanInput.disabled=!0},d.prototype.show=function(){this.fileBasedScanRegion.style.display="block",this.fileScanInput.disabled=!1},d.prototype.isShowing=function(){return this.fileBasedScanRegion.style.display==="block"},d.prototype.resetValue=function(){this.fileScanInput.value="",this.setInitialValueToButton()},d.prototype.createFileBasedScanRegion=function(){var m=document.createElement("div");return m.style.textAlign="center",m.style.margin="auto",m.style.width="80%",m.style.maxWidth="600px",m.style.border=this.fileBasedScanRegionDefaultBorder(),m.style.padding="10px",m.style.marginBottom="10px",m},d.prototype.fileBasedScanRegionDefaultBorder=function(){return"6px dashed #ebebeb"},d.prototype.fileBasedScanRegionActiveBorder=function(){return"6px dashed rgb(153 151 151)"},d.prototype.createDragAndDropMessage=function(){var m=document.createElement("div");return m.innerText=Kt.dragAndDropMessage(),m.style.fontWeight="400",m},d.prototype.setImageNameToButton=function(m){var c=20;if(m.length>c){var w=m.substring(0,8),_=m.length,C=m.substring(_-8,_);m="".concat(w,"....").concat(C)}var M=Kt.fileSelectionChooseAnother()+" - "+m;this.fileSelectionButton.innerText=M},d.prototype.setInitialValueToButton=function(){var m=Kt.fileSelectionChooseImage()+" - "+Kt.fileSelectionNoImageSelected();this.fileSelectionButton.innerText=m},d.prototype.getFileScanInputId=function(){return"html5-qrcode-private-filescan-input"},d.create=function(m,c,w){var _=new d(m,c,w);return _},d}();var ra=function(){function d(m){this.selectElement=an.createElement("select",He.CAMERA_SELECTION_SELECT_ID),this.cameras=m,this.options=[]}return d.prototype.render=function(m){var c=document.createElement("span");c.style.marginRight="10px";var w=this.cameras.length;if(w===0)throw new Error("No cameras found");if(w===1)c.style.display="none";else{var _=Kt.selectCamera();c.innerText="".concat(_," (").concat(this.cameras.length,")  ")}for(var C=1,M=0,P=this.cameras;M<P.length;M++){var H=P[M],E=H.id,Z=H.label==null?E:H.label;(!Z||Z==="")&&(Z=[Kt.anonymousCameraPrefix(),C++].join(" "));var $=document.createElement("option");$.value=E,$.innerText=Z,this.options.push($),this.selectElement.appendChild($)}c.appendChild(this.selectElement),m.appendChild(c)},d.prototype.disable=function(){this.selectElement.disabled=!0},d.prototype.isDisabled=function(){return this.selectElement.disabled===!0},d.prototype.enable=function(){this.selectElement.disabled=!1},d.prototype.getValue=function(){return this.selectElement.value},d.prototype.hasValue=function(m){for(var c=0,w=this.options;c<w.length;c++){var _=w[c];if(_.value===m)return!0}return!1},d.prototype.setValue=function(m){if(!this.hasValue(m))throw new Error("".concat(m," is not present in the camera list."));this.selectElement.value=m},d.prototype.hasSingleItem=function(){return this.cameras.length===1},d.prototype.numCameras=function(){return this.cameras.length},d.create=function(m,c){var w=new d(c);return w.render(m),w},d}();var oa=function(){function d(){this.onChangeCallback=null,this.zoomElementContainer=document.createElement("div"),this.rangeInput=an.createElement("input",He.ZOOM_SLIDER_ID),this.rangeInput.type="range",this.rangeText=document.createElement("span"),this.rangeInput.min="1",this.rangeInput.max="5",this.rangeInput.value="1",this.rangeInput.step="0.1"}return d.prototype.render=function(m,c){this.zoomElementContainer.style.display=c?"block":"none",this.zoomElementContainer.style.padding="5px 10px",this.zoomElementContainer.style.textAlign="center",m.appendChild(this.zoomElementContainer),this.rangeInput.style.display="inline-block",this.rangeInput.style.width="50%",this.rangeInput.style.height="5px",this.rangeInput.style.background="#d3d3d3",this.rangeInput.style.outline="none",this.rangeInput.style.opacity="0.7";var w=Kt.zoom();this.rangeText.innerText="".concat(this.rangeInput.value,"x ").concat(w),this.rangeText.style.marginRight="10px";var _=this;this.rangeInput.addEventListener("input",function(){return _.onValueChange()}),this.rangeInput.addEventListener("change",function(){return _.onValueChange()}),this.zoomElementContainer.appendChild(this.rangeInput),this.zoomElementContainer.appendChild(this.rangeText)},d.prototype.onValueChange=function(){var m=Kt.zoom();this.rangeText.innerText="".concat(this.rangeInput.value,"x ").concat(m),this.onChangeCallback&&this.onChangeCallback(parseFloat(this.rangeInput.value))},d.prototype.setValues=function(m,c,w,_){this.rangeInput.min=m.toString(),this.rangeInput.max=c.toString(),this.rangeInput.step=_.toString(),this.rangeInput.value=w.toString(),this.onValueChange()},d.prototype.show=function(){this.zoomElementContainer.style.display="block"},d.prototype.hide=function(){this.zoomElementContainer.style.display="none"},d.prototype.setOnCameraZoomValueChangeCallback=function(m){this.onChangeCallback=m},d.prototype.removeOnCameraZoomValueChangeCallback=function(){this.onChangeCallback=null},d.create=function(m,c){var w=new d;return w.render(m,c),w},d}();var An=function(d){return d[d.STATUS_DEFAULT=0]="STATUS_DEFAULT",d[d.STATUS_SUCCESS=1]="STATUS_SUCCESS",d[d.STATUS_WARNING=2]="STATUS_WARNING",d[d.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION",d}(An||{});function Ha(d){return{fps:d.fps,qrbox:d.qrbox,aspectRatio:d.aspectRatio,disableFlip:d.disableFlip,videoConstraints:d.videoConstraints}}function Va(d,m){return{formatsToSupport:d.formatsToSupport,useBarCodeDetectorIfSupported:d.useBarCodeDetectorIfSupported,experimentalFeatures:d.experimentalFeatures,verbose:m}}var Za=function(){function d(m,c,w){if(this.lastMatchFound=null,this.cameraScanImage=null,this.fileScanImage=null,this.fileSelectionUi=null,this.elementId=m,this.config=this.createConfig(c),this.verbose=w===!0,!document.getElementById(m))throw"HTML Element with id=".concat(m," not found");this.scanTypeSelector=new $n(this.config.supportedScanTypes),this.currentScanType=this.scanTypeSelector.getDefaultScanType(),this.sectionSwapAllowed=!0,this.logger=new ro(this.verbose),this.persistedDataManager=new Ks,c.rememberLastUsedCamera!==!0&&this.persistedDataManager.reset()}return d.prototype.render=function(m,c){var w=this;this.lastMatchFound=null,this.qrCodeSuccessCallback=function(C,M){if(m)m(C,M);else{if(w.lastMatchFound===C)return;w.lastMatchFound=C,w.setHeaderMessage(Kt.lastMatch(C),An.STATUS_SUCCESS)}},this.qrCodeErrorCallback=function(C,M){c&&c(C,M)};var _=document.getElementById(this.elementId);if(!_)throw"HTML Element with id=".concat(this.elementId," not found");_.innerHTML="",this.createBasicLayout(_),this.html5Qrcode=new nr(this.getScanRegionId(),Va(this.config,this.verbose))},d.prototype.pause=function(m){(En(m)||m!==!0)&&(m=!1),this.getHtml5QrcodeOrFail().pause(m)},d.prototype.resume=function(){this.getHtml5QrcodeOrFail().resume()},d.prototype.getState=function(){return this.getHtml5QrcodeOrFail().getState()},d.prototype.clear=function(){var m=this,c=function(){var w=document.getElementById(m.elementId);w&&(w.innerHTML="",m.resetBasicLayout(w))};return this.html5Qrcode?new Promise(function(w,_){if(!m.html5Qrcode){w();return}m.html5Qrcode.isScanning?m.html5Qrcode.stop().then(function(C){if(!m.html5Qrcode){w();return}m.html5Qrcode.clear(),c(),w()}).catch(function(C){m.verbose&&m.logger.logError("Unable to stop qrcode scanner",C),_(C)}):(m.html5Qrcode.clear(),c(),w())}):Promise.resolve()},d.prototype.getRunningTrackCapabilities=function(){return this.getHtml5QrcodeOrFail().getRunningTrackCapabilities()},d.prototype.getRunningTrackSettings=function(){return this.getHtml5QrcodeOrFail().getRunningTrackSettings()},d.prototype.applyVideoConstraints=function(m){return this.getHtml5QrcodeOrFail().applyVideoConstraints(m)},d.prototype.getHtml5QrcodeOrFail=function(){if(!this.html5Qrcode)throw"Code scanner not initialized.";return this.html5Qrcode},d.prototype.createConfig=function(m){return m?(m.fps||(m.fps=sn.SCAN_DEFAULT_FPS),m.rememberLastUsedCamera!==!sn.DEFAULT_REMEMBER_LAST_CAMERA_USED&&(m.rememberLastUsedCamera=sn.DEFAULT_REMEMBER_LAST_CAMERA_USED),m.supportedScanTypes||(m.supportedScanTypes=sn.DEFAULT_SUPPORTED_SCAN_TYPE),m):{fps:sn.SCAN_DEFAULT_FPS,rememberLastUsedCamera:sn.DEFAULT_REMEMBER_LAST_CAMERA_USED,supportedScanTypes:sn.DEFAULT_SUPPORTED_SCAN_TYPE}},d.prototype.createBasicLayout=function(m){m.style.position="relative",m.style.padding="0px",m.style.border="1px solid silver",this.createHeader(m);var c=document.createElement("div"),w=this.getScanRegionId();c.id=w,c.style.width="100%",c.style.minHeight="100px",c.style.textAlign="center",m.appendChild(c),$n.isCameraScanType(this.currentScanType)?this.insertCameraScanImageToScanRegion():this.insertFileScanImageToScanRegion();var _=document.createElement("div"),C=this.getDashboardId();_.id=C,_.style.width="100%",m.appendChild(_),this.setupInitialDashboard(_)},d.prototype.resetBasicLayout=function(m){m.style.border="none"},d.prototype.setupInitialDashboard=function(m){this.createSection(m),this.createSectionControlPanel(),this.scanTypeSelector.hasMoreThanOneScanType()&&this.createSectionSwap()},d.prototype.createHeader=function(m){var c=document.createElement("div");c.style.textAlign="left",c.style.margin="0px",m.appendChild(c);var w=new Js;w.renderInto(c);var _=document.createElement("div");_.id=this.getHeaderMessageContainerId(),_.style.display="none",_.style.textAlign="center",_.style.fontSize="14px",_.style.padding="2px 10px",_.style.margin="4px",_.style.borderTop="1px solid #f6f6f6",c.appendChild(_)},d.prototype.createSection=function(m){var c=document.createElement("div");c.id=this.getDashboardSectionId(),c.style.width="100%",c.style.padding="10px 0px 10px 0px",c.style.textAlign="left",m.appendChild(c)},d.prototype.createCameraListUi=function(m,c,w){var _=this;_.showHideScanTypeSwapLink(!1),_.setHeaderMessage(Kt.cameraPermissionRequesting());var C=function(){w||_.createPermissionButton(m,c)};nr.getCameras().then(function(M){_.persistedDataManager.setHasPermission(!0),_.showHideScanTypeSwapLink(!0),_.resetHeaderMessage(),M&&M.length>0?(m.removeChild(c),_.renderCameraSelection(M)):(_.setHeaderMessage(Kt.noCameraFound(),An.STATUS_WARNING),C())}).catch(function(M){_.persistedDataManager.setHasPermission(!1),w?w.disabled=!1:C(),_.setHeaderMessage(M,An.STATUS_WARNING),_.showHideScanTypeSwapLink(!0)})},d.prototype.createPermissionButton=function(m,c){var w=this,_=an.createElement("button",this.getCameraPermissionButtonId());_.innerText=Kt.cameraPermissionTitle(),_.addEventListener("click",function(){_.disabled=!0,w.createCameraListUi(m,c,_)}),c.appendChild(_)},d.prototype.createPermissionsUi=function(m,c){var w=this;if($n.isCameraScanType(this.currentScanType)&&this.persistedDataManager.hasCameraPermissions()){zo.hasPermissions().then(function(_){_?w.createCameraListUi(m,c):(w.persistedDataManager.setHasPermission(!1),w.createPermissionButton(m,c))}).catch(function(_){w.persistedDataManager.setHasPermission(!1),w.createPermissionButton(m,c)});return}this.createPermissionButton(m,c)},d.prototype.createSectionControlPanel=function(){var m=document.getElementById(this.getDashboardSectionId()),c=document.createElement("div");m.appendChild(c);var w=document.createElement("div");w.id=this.getDashboardSectionCameraScanRegionId(),w.style.display=$n.isCameraScanType(this.currentScanType)?"block":"none",c.appendChild(w);var _=document.createElement("div");_.style.textAlign="center",w.appendChild(_),this.scanTypeSelector.isCameraScanRequired()&&this.createPermissionsUi(w,_),this.renderFileScanUi(c)},d.prototype.renderFileScanUi=function(m){var c=$n.isFileScanType(this.currentScanType),w=this,_=function(C){if(!w.html5Qrcode)throw"html5Qrcode not defined";$n.isFileScanType(w.currentScanType)&&(w.setHeaderMessage(Kt.loadingImage()),w.html5Qrcode.scanFileV2(C,!0).then(function(M){w.resetHeaderMessage(),w.qrCodeSuccessCallback(M.decodedText,M)}).catch(function(M){w.setHeaderMessage(M,An.STATUS_WARNING),w.qrCodeErrorCallback(M,io.createFrom(M))}))};this.fileSelectionUi=ia.create(m,c,_)},d.prototype.renderCameraSelection=function(m){var c=this,w=this,_=document.getElementById(this.getDashboardSectionCameraScanRegionId());_.style.textAlign="center";var C=oa.create(_,!1),M=function(_e){var Lt=_e.zoomFeature();if(Lt.isSupported()){C.setOnCameraZoomValueChangeCallback(function(Ft){Lt.apply(Ft)});var gt=1;c.config.defaultZoomValueIfSupported&&(gt=c.config.defaultZoomValueIfSupported),gt=Rs(gt,Lt.min(),Lt.max()),C.setValues(Lt.min(),Lt.max(),gt,Lt.step()),C.show()}},P=ra.create(_,m),H=document.createElement("span"),E=an.createElement("button",He.CAMERA_START_BUTTON_ID);E.innerText=Kt.scanButtonStartScanningText(),H.appendChild(E);var Z=an.createElement("button",He.CAMERA_STOP_BUTTON_ID);Z.innerText=Kt.scanButtonStopScanningText(),Z.style.display="none",Z.disabled=!0,H.appendChild(Z);var $,Bt=function(_e){if(!_e.torchFeature().isSupported()){$&&$.hide();return}$?$.updateTorchCapability(_e.torchFeature()):$=na.create(H,_e.torchFeature(),{display:"none",marginLeft:"5px"},function(Lt){w.setHeaderMessage(Lt,An.STATUS_WARNING)}),$.show()};_.appendChild(H);var st=function(_e){_e||(E.style.display="none"),E.innerText=Kt.scanButtonStartScanningText(),E.style.opacity="1",E.disabled=!1,_e&&(E.style.display="inline-block")};if(E.addEventListener("click",function(_e){E.innerText=Kt.scanButtonScanningStarting(),P.disable(),E.disabled=!0,E.style.opacity="0.5",c.scanTypeSelector.hasMoreThanOneScanType()&&w.showHideScanTypeSwapLink(!1),w.resetHeaderMessage();var Lt=P.getValue();w.persistedDataManager.setLastUsedCameraId(Lt),w.html5Qrcode.start(Lt,Ha(w.config),w.qrCodeSuccessCallback,w.qrCodeErrorCallback).then(function(gt){Z.disabled=!1,Z.style.display="inline-block",st(!1);var Ft=w.html5Qrcode.getRunningTrackCameraCapabilities();c.config.showTorchButtonIfSupported===!0&&Bt(Ft),c.config.showZoomSliderIfSupported===!0&&M(Ft)}).catch(function(gt){w.showHideScanTypeSwapLink(!0),P.enable(),st(!0),w.setHeaderMessage(gt,An.STATUS_WARNING)})}),P.hasSingleItem()&&E.click(),Z.addEventListener("click",function(_e){if(!w.html5Qrcode)throw"html5Qrcode not defined";Z.disabled=!0,w.html5Qrcode.stop().then(function(Lt){c.scanTypeSelector.hasMoreThanOneScanType()&&w.showHideScanTypeSwapLink(!0),P.enable(),E.disabled=!1,Z.style.display="none",E.style.display="inline-block",$&&($.reset(),$.hide()),C.removeOnCameraZoomValueChangeCallback(),C.hide(),w.insertCameraScanImageToScanRegion()}).catch(function(Lt){Z.disabled=!1,w.setHeaderMessage(Lt,An.STATUS_WARNING)})}),w.persistedDataManager.getLastUsedCameraId()){var Te=w.persistedDataManager.getLastUsedCameraId();P.hasValue(Te)?(P.setValue(Te),E.click()):w.persistedDataManager.resetLastUsedCameraId()}},d.prototype.createSectionSwap=function(){var m=this,c=Kt.textIfCameraScanSelected(),w=Kt.textIfFileScanSelected(),_=document.getElementById(this.getDashboardSectionId()),C=document.createElement("div");C.style.textAlign="center";var M=an.createElement("span",this.getDashboardSectionSwapLinkId());M.style.textDecoration="underline",M.style.cursor="pointer",M.innerText=$n.isCameraScanType(this.currentScanType)?c:w,M.addEventListener("click",function(){if(!m.sectionSwapAllowed){m.verbose&&m.logger.logError("Section swap called when not allowed");return}m.resetHeaderMessage(),m.fileSelectionUi.resetValue(),m.sectionSwapAllowed=!1,$n.isCameraScanType(m.currentScanType)?(m.clearScanRegion(),m.getCameraScanRegion().style.display="none",m.fileSelectionUi.show(),M.innerText=w,m.currentScanType=Hn.SCAN_TYPE_FILE,m.insertFileScanImageToScanRegion()):(m.clearScanRegion(),m.getCameraScanRegion().style.display="block",m.fileSelectionUi.hide(),M.innerText=c,m.currentScanType=Hn.SCAN_TYPE_CAMERA,m.insertCameraScanImageToScanRegion(),m.startCameraScanIfPermissionExistsOnSwap()),m.sectionSwapAllowed=!0}),C.appendChild(M),_.appendChild(C)},d.prototype.startCameraScanIfPermissionExistsOnSwap=function(){var m=this,c=this;if(this.persistedDataManager.hasCameraPermissions()){zo.hasPermissions().then(function(w){if(w){var _=document.getElementById(c.getCameraPermissionButtonId());if(!_)throw m.logger.logError("Permission button not found, fail;"),"Permission button not found";_.click()}else c.persistedDataManager.setHasPermission(!1)}).catch(function(w){c.persistedDataManager.setHasPermission(!1)});return}},d.prototype.resetHeaderMessage=function(){var m=document.getElementById(this.getHeaderMessageContainerId());m.style.display="none"},d.prototype.setHeaderMessage=function(m,c){c||(c=An.STATUS_DEFAULT);var w=this.getHeaderMessageDiv();switch(w.innerText=m,w.style.display="block",c){case An.STATUS_SUCCESS:w.style.background="rgba(106, 175, 80, 0.26)",w.style.color="#477735";break;case An.STATUS_WARNING:w.style.background="rgba(203, 36, 49, 0.14)",w.style.color="#cb2431";break;case An.STATUS_DEFAULT:default:w.style.background="rgba(0, 0, 0, 0)",w.style.color="rgb(17, 17, 17)";break}},d.prototype.showHideScanTypeSwapLink=function(m){this.scanTypeSelector.hasMoreThanOneScanType()&&(m!==!0&&(m=!1),this.sectionSwapAllowed=m,this.getDashboardSectionSwapLink().style.display=m?"inline-block":"none")},d.prototype.insertCameraScanImageToScanRegion=function(){var m=this,c=document.getElementById(this.getScanRegionId());if(this.cameraScanImage){c.innerHTML="<br>",c.appendChild(this.cameraScanImage);return}this.cameraScanImage=new Image,this.cameraScanImage.onload=function(w){c.innerHTML="<br>",c.appendChild(m.cameraScanImage)},this.cameraScanImage.width=64,this.cameraScanImage.style.opacity="0.8",this.cameraScanImage.src=Xs,this.cameraScanImage.alt=Kt.cameraScanAltText()},d.prototype.insertFileScanImageToScanRegion=function(){var m=this,c=document.getElementById(this.getScanRegionId());if(this.fileScanImage){c.innerHTML="<br>",c.appendChild(this.fileScanImage);return}this.fileScanImage=new Image,this.fileScanImage.onload=function(w){c.innerHTML="<br>",c.appendChild(m.fileScanImage)},this.fileScanImage.width=64,this.fileScanImage.style.opacity="0.8",this.fileScanImage.src=Ys,this.fileScanImage.alt=Kt.fileScanAltText()},d.prototype.clearScanRegion=function(){var m=document.getElementById(this.getScanRegionId());m.innerHTML=""},d.prototype.getDashboardSectionId=function(){return"".concat(this.elementId,"__dashboard_section")},d.prototype.getDashboardSectionCameraScanRegionId=function(){return"".concat(this.elementId,"__dashboard_section_csr")},d.prototype.getDashboardSectionSwapLinkId=function(){return He.SCAN_TYPE_CHANGE_ANCHOR_ID},d.prototype.getScanRegionId=function(){return"".concat(this.elementId,"__scan_region")},d.prototype.getDashboardId=function(){return"".concat(this.elementId,"__dashboard")},d.prototype.getHeaderMessageContainerId=function(){return"".concat(this.elementId,"__header_message")},d.prototype.getCameraPermissionButtonId=function(){return He.CAMERA_PERMISSION_BUTTON_ID},d.prototype.getCameraScanRegion=function(){return document.getElementById(this.getDashboardSectionCameraScanRegionId())},d.prototype.getDashboardSectionSwapLink=function(){return document.getElementById(this.getDashboardSectionSwapLinkId())},d.prototype.getHeaderMessageDiv=function(){return document.getElementById(this.getHeaderMessageContainerId())},d}();function Ga(d,m){if(d&1&&(T(0,"div",11),k(1),O()),d&2){let c=Q();B(),de(" ",c.scanError," ")}}function ja(d,m){d&1&&nt(0,"div",12)}function Xa(d,m){if(d&1){let c=Se();T(0,"button",13),St("click",function(){yt(c);let _=Q();return Ct(_.toggleManualEntry())}),nt(1,"span",2),dt(2,"safeHtml"),k(3," Enter Code Manually "),O()}if(d&2){let c=Q();B(),W("innerHTML",pt(2,1,c.getIcon("keyboard")),ft)}}function Ya(d,m){if(d&1){let c=Se();T(0,"div",14)(1,"h4"),k(2,"Enter QR Code"),O(),T(3,"p",15),k(4,"If scanning doesn't work, ask the affected user for their QR code and enter it here:"),O(),T(5,"input",16),Ln("ngModelChange",function(_){yt(c);let C=Q();return On(C.manualCode,_)||(C.manualCode=_),Ct(_)}),O(),T(6,"div",17)(7,"button",18),St("click",function(){yt(c);let _=Q();return Ct(_.submitManualCode())}),k(8," \u2713 Submit Code "),O(),T(9,"button",13),St("click",function(){yt(c);let _=Q();return Ct(_.toggleManualEntry())}),k(10," \u2190 Back to Scanner "),O()()()}if(d&2){let c=Q();B(5),Nn("ngModel",c.manualCode),B(2),W("disabled",!c.manualCode.trim())}}var la=(()=>{class d{ngOnInit(){this.startScanner()}ngOnDestroy(){this.stopScanner()}startScanner(){return Gi(this,null,function*(){try{this.html5QrCode=new nr("qr-reader"),yield this.html5QrCode.start({facingMode:"environment"},{fps:10,qrbox:{width:250,height:250}},c=>{this.onScanSuccess(c)},c=>{}),this.isScanning=!0}catch(c){console.error("Error starting scanner:",c),this.scanError="Failed to start camera. Please ensure camera permissions are granted or use manual entry.",this.showManualEntry=!0}})}stopScanner(){return Gi(this,null,function*(){if(this.html5QrCode&&this.isScanning){try{this.html5QrCode.getState()===Ce.SCANNING&&(yield this.html5QrCode.stop()),this.html5QrCode.clear()}catch(c){console.error("Error stopping scanner:",c)}this.isScanning=!1}})}onScanSuccess(c){this.stopScanner(),this.scanned.emit(c)}toggleManualEntry(){this.showManualEntry=!this.showManualEntry}submitManualCode(){this.manualCode.trim()&&this.scanned.emit(this.manualCode.trim())}closeScanner(){this.stopScanner(),this.closed.emit()}constructor(c){this.iconService=c,this.scanned=new Xi,this.closed=new Xi,this.isScanning=!1,this.scanError="",this.manualCode="",this.showManualEntry=!1}getIcon(c,w="md"){return this.iconService.getIcon(c,w)}static{this.\u0275fac=function(w){return new(w||d)(vn($i))}}static{this.\u0275cmp=ji({type:d,selectors:[["app-qr-scanner"]],outputs:{scanned:"scanned",closed:"closed"},standalone:!0,features:[Yi],decls:25,vars:7,consts:[[1,"scanner-container"],[1,"scanner-header"],[3,"innerHTML"],[1,"close-button",3,"click"],[1,"scanner-body"],["class","alert alert-error",4,"ngIf"],[1,"scanner-instructions"],["id","qr-reader",4,"ngIf"],[1,"manual-entry-section"],["class","btn btn-secondary",3,"click",4,"ngIf"],["class","manual-entry-form",4,"ngIf"],[1,"alert","alert-error"],["id","qr-reader"],[1,"btn","btn-secondary",3,"click"],[1,"manual-entry-form"],[1,"help-text"],["type","text","placeholder","LOC-XXXXXXXXXXXX",1,"form-control",3,"ngModelChange","ngModel"],[1,"manual-entry-actions"],[1,"btn","btn-primary",3,"click","disabled"]],template:function(w,_){w&1&&(T(0,"div",0)(1,"div",1)(2,"h3"),nt(3,"span",2),dt(4,"safeHtml"),k(5," Scan QR Code"),O(),T(6,"button",3),St("click",function(){return _.closeScanner()}),k(7,"\xD7"),O()(),T(8,"div",4),Ht(9,Ga,2,1,"div",5),T(10,"div",6)(11,"p")(12,"strong"),k(13,"Instructions:"),O()(),T(14,"ul")(15,"li"),k(16,"Point your camera at the affected user's QR code"),O(),T(17,"li"),k(18,"Hold steady until the code is recognized"),O(),T(19,"li"),k(20,"The scan will complete automatically"),O()()(),Ht(21,ja,1,0,"div",7),T(22,"div",8),Ht(23,Xa,4,3,"button",9)(24,Ya,11,2,"div",10),O()()()),w&2&&(B(3),W("innerHTML",pt(4,5,_.getIcon("qr-code")),ft),B(6),W("ngIf",_.scanError),B(12),W("ngIf",!_.showManualEntry),B(2),W("ngIf",!_.showManualEntry),B(),W("ngIf",_.showManualEntry))},dependencies:[qi,Qi,to,tr,er,Kr,Ki],styles:[".scanner-container[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:0;max-width:600px;margin:0 auto}.scanner-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:20px 24px;border-bottom:2px solid #e5e7eb}.scanner-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:#1f2937;font-size:1.3rem}.close-button[_ngcontent-%COMP%]{background:none;border:none;font-size:2rem;color:#6b7280;cursor:pointer;padding:0;width:32px;height:32px;display:flex;align-items:center;justify-content:center;transition:all .2s}.close-button[_ngcontent-%COMP%]:hover{color:#1f2937;transform:scale(1.1)}.scanner-body[_ngcontent-%COMP%]{padding:24px}.scanner-instructions[_ngcontent-%COMP%]{background:#eff6ff;border:2px solid #3b82f6;border-radius:8px;padding:16px;margin-bottom:20px}.scanner-instructions[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 12px;color:#1e40af;font-weight:600}.scanner-instructions[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin:0;padding-left:20px;color:#1e40af}.scanner-instructions[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin:6px 0;line-height:1.5}#qr-reader[_ngcontent-%COMP%]{width:100%;border:3px solid #3b82f6;border-radius:12px;overflow:hidden;margin-bottom:20px}.manual-entry-section[_ngcontent-%COMP%]{margin-top:20px;text-align:center}.manual-entry-form[_ngcontent-%COMP%]{background:#f9fafb;border:2px solid #e5e7eb;border-radius:8px;padding:20px;margin-top:16px}.manual-entry-form[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 12px;color:#1f2937}.help-text[_ngcontent-%COMP%]{color:#6b7280;font-size:.9rem;margin-bottom:16px}.form-control[_ngcontent-%COMP%]{width:100%;padding:12px;border:2px solid #d1d5db;border-radius:8px;font-size:1rem;font-family:monospace;text-transform:uppercase;transition:all .2s;box-sizing:border-box}.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}.manual-entry-actions[_ngcontent-%COMP%]{display:flex;gap:12px;justify-content:center;margin-top:16px}.btn[_ngcontent-%COMP%]{padding:10px 20px;border:none;border-radius:8px;font-size:.95rem;font-weight:600;cursor:pointer;transition:all .2s}.btn-primary[_ngcontent-%COMP%]{background-color:#3b82f6;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#2563eb}.btn-primary[_ngcontent-%COMP%]:disabled{background-color:#9ca3af;cursor:not-allowed}.btn-secondary[_ngcontent-%COMP%]{background-color:#6b7280;color:#fff}.btn-secondary[_ngcontent-%COMP%]:hover{background-color:#4b5563}.alert[_ngcontent-%COMP%]{padding:12px 16px;border-radius:8px;margin-bottom:16px;font-size:.9rem}.alert-error[_ngcontent-%COMP%]{background-color:#fee2e2;border:2px solid #ef4444;color:#991b1b}"]})}}return d})();var Qa=()=>[1,2,3,4,5];function qa(d,m){if(d&1&&(T(0,"span",36),k(1),O()),d&2){let c=Q(2);B(),de("Expected: ",c.getSupplyExpected("water"),"")}}function Ka(d,m){if(d&1&&(T(0,"span",36),k(1),O()),d&2){let c=Q(2);B(),de("Expected: ",c.getSupplyExpected("food"),"")}}function Ja(d,m){if(d&1&&(T(0,"span",36),k(1),O()),d&2){let c=Q(2);B(),de("Expected: ",c.getSupplyExpected("medical_supplies"),"")}}function $a(d,m){if(d&1&&(T(0,"span",36),k(1),O()),d&2){let c=Q(2);B(),de("Expected: ",c.getSupplyExpected("clothing"),"")}}function tl(d,m){if(d&1&&(T(0,"span",36),k(1),O()),d&2){let c=Q(2);B(),de("Expected: ",c.getSupplyExpected("shelter_materials"),"")}}function el(d,m){if(d&1&&(T(0,"span",36),k(1),O()),d&2){let c=Q(2);B(),de("Expected: ",c.getSupplyExpected("other"),"")}}function nl(d,m){if(d&1){let c=Se();T(0,"span",37),St("click",function(){let _=yt(c).$implicit,C=Q(2);return Ct(C.setRating(_))}),k(1," \u2605 "),O()}if(d&2){let c=m.$implicit,w=Q(2);hs(w.getStarClass(c))}}function il(d,m){if(d&1){let c=Se();T(0,"div",1),St("click",function(){yt(c);let _=Q();return Ct(_.onClose())}),T(1,"div",2),St("click",function(_){return yt(c),Ct(_.stopPropagation())}),T(2,"div",3)(3,"h2",4),nt(4,"span",5),dt(5,"safeHtml"),k(6," Donation Received! "),O(),T(7,"button",6),St("click",function(){yt(c);let _=Q();return Ct(_.onClose())}),k(8,"\xD7"),O()(),T(9,"div",7)(10,"div",8)(11,"div",9)(12,"h3"),k(13),O(),T(14,"p",10),k(15),O(),T(16,"p",11),k(17),dt(18,"date"),O()(),T(19,"div",12)(20,"p")(21,"strong"),k(22,"Great news!"),O(),k(23," A generous donator has scanned your QR code and provided relief supplies. Please confirm what you received and rate your experience. "),O()()(),T(24,"div",13)(25,"h4"),k(26,"\u{1F4E6} Supply Confirmation"),O(),T(27,"p",14),k(28,"Please confirm the supplies you received:"),O(),T(29,"div",15)(30,"button",16),St("click",function(){yt(c);let _=Q();return Ct(_.fillExpectedSupplies())}),k(31," \u2713 Received Expected Supply "),O(),T(32,"span",17),k(33,"Click to automatically fill with expected amounts"),O()(),T(34,"div",18)(35,"div",19)(36,"label"),k(37,"\u{1F4A7} Water Supplies:"),O(),T(38,"div",20),Ht(39,qa,2,1,"span",21),T(40,"input",22),Ln("ngModelChange",function(_){yt(c);let C=Q();return On(C.suppliesConfirmed.water_received,_)||(C.suppliesConfirmed.water_received=_),Ct(_)}),O(),T(41,"span",23),k(42,"bottles/liters received"),O()()(),T(43,"div",19)(44,"label"),k(45,"\u{1F35E} Food Packages:"),O(),T(46,"div",20),Ht(47,Ka,2,1,"span",21),T(48,"input",22),Ln("ngModelChange",function(_){yt(c);let C=Q();return On(C.suppliesConfirmed.food_received,_)||(C.suppliesConfirmed.food_received=_),Ct(_)}),O(),T(49,"span",23),k(50,"packages received"),O()()(),T(51,"div",19)(52,"label"),k(53,"\u{1F3E5} Medical Supplies:"),O(),T(54,"div",20),Ht(55,Ja,2,1,"span",21),T(56,"input",22),Ln("ngModelChange",function(_){yt(c);let C=Q();return On(C.suppliesConfirmed.medical_supplies_received,_)||(C.suppliesConfirmed.medical_supplies_received=_),Ct(_)}),O(),T(57,"span",23),k(58,"items received"),O()()(),T(59,"div",19)(60,"label"),k(61,"\u{1F455} Clothing Items:"),O(),T(62,"div",20),Ht(63,$a,2,1,"span",21),T(64,"input",22),Ln("ngModelChange",function(_){yt(c);let C=Q();return On(C.suppliesConfirmed.clothing_received,_)||(C.suppliesConfirmed.clothing_received=_),Ct(_)}),O(),T(65,"span",23),k(66,"pieces received"),O()()(),T(67,"div",19)(68,"label"),k(69,"\u{1F3E0} Shelter Materials:"),O(),T(70,"div",20),Ht(71,tl,2,1,"span",21),T(72,"input",22),Ln("ngModelChange",function(_){yt(c);let C=Q();return On(C.suppliesConfirmed.shelter_materials_received,_)||(C.suppliesConfirmed.shelter_materials_received=_),Ct(_)}),O(),T(73,"span",23),k(74,"items received"),O()()(),T(75,"div",19)(76,"label"),k(77,"\u{1F4CB} Other Items:"),O(),T(78,"div",20),Ht(79,el,2,1,"span",21),T(80,"textarea",24),Ln("ngModelChange",function(_){yt(c);let C=Q();return On(C.suppliesConfirmed.other_items,_)||(C.suppliesConfirmed.other_items=_),Ct(_)}),O()()()(),T(81,"div",25)(82,"label",26)(83,"input",27),Ln("ngModelChange",function(_){yt(c);let C=Q();return On(C.suppliesConfirmed.all_supplies_received,_)||(C.suppliesConfirmed.all_supplies_received=_),Ct(_)}),O(),nt(84,"span",28),k(85," I confirm that I received all the supplies as promised "),O()()(),T(86,"div",29)(87,"h4"),nt(88,"span",5),dt(89,"safeHtml"),k(90," Rate Your Experience"),O(),T(91,"p",14),k(92,"How satisfied are you with this donation?"),O(),T(93,"div",30),Ht(94,nl,2,2,"span",31),O(),T(95,"textarea",32),Ln("ngModelChange",function(_){yt(c);let C=Q();return On(C.comment,_)||(C.comment=_),Ct(_)}),O()()(),T(96,"div",33)(97,"button",34),St("click",function(){yt(c);let _=Q();return Ct(_.onClose())}),k(98,"Cancel"),O(),T(99,"button",35),St("click",function(){yt(c);let _=Q();return Ct(_.onSubmit())}),k(100,"Submit Rating"),O()()()()}if(d&2){let c=Q();B(4),W("innerHTML",pt(5,20,c.getIcon("celebration","md")),ft),B(9),dn(c.donationData==null?null:c.donationData.donator_name),B(2),dn(c.donationData==null?null:c.donationData.donator_email),B(2),de("Donated ",jr(18,22,c.donationData==null?null:c.donationData.donated_at,"short"),""),B(22),W("ngIf",c.getSupplyExpected("water")>0),B(),Nn("ngModel",c.suppliesConfirmed.water_received),B(7),W("ngIf",c.getSupplyExpected("food")>0),B(),Nn("ngModel",c.suppliesConfirmed.food_received),B(7),W("ngIf",c.getSupplyExpected("medical_supplies")>0),B(),Nn("ngModel",c.suppliesConfirmed.medical_supplies_received),B(7),W("ngIf",c.getSupplyExpected("clothing")>0),B(),Nn("ngModel",c.suppliesConfirmed.clothing_received),B(7),W("ngIf",c.getSupplyExpected("shelter_materials")>0),B(),Nn("ngModel",c.suppliesConfirmed.shelter_materials_received),B(7),W("ngIf",c.getSupplyExpected("other")),B(),Nn("ngModel",c.suppliesConfirmed.other_items),B(3),Nn("ngModel",c.suppliesConfirmed.all_supplies_received),B(5),W("innerHTML",pt(89,25,c.getIcon("star")),ft),B(6),W("ngForOf",us(27,Qa)),B(),Nn("ngModel",c.comment)}}var ca=(()=>{class d{constructor(){this.show=!1,this.donationData=null,this.closeModal=new Xi,this.submitRating=new Xi,this.router=Gr(qr),this.authService=Gr(Ji),this.iconService=Gr($i),this.rating=0,this.comment="",this.suppliesConfirmed={water_received:0,food_received:0,medical_supplies_received:0,clothing_received:0,shelter_materials_received:0,other_items:"",all_supplies_received:!1}}ngOnInit(){if(this.donationData?.supply_needs_fulfilled){let c=this.donationData.supply_needs_fulfilled;this.suppliesConfirmed={water_received:c.water||0,food_received:c.food||0,medical_supplies_received:c.medical_supplies||0,clothing_received:c.clothing||0,shelter_materials_received:c.shelter_materials||0,other_items:c.other||"",all_supplies_received:!0}}}setRating(c){this.rating=c}onClose(){this.closeModal.emit()}onSubmit(){if(this.rating===0){alert("Please provide a rating before submitting.");return}this.submitRating.emit({rating:this.rating,comment:this.comment,supplies_confirmed:this.suppliesConfirmed}),setTimeout(()=>{this.authService.logout(),this.router.navigate(["/register"])},1e3)}getSupplyExpected(c){return this.donationData?.supply_needs_fulfilled&&this.donationData.supply_needs_fulfilled[c]||0}getStarClass(c){return c<=this.rating?"star filled":"star"}fillExpectedSupplies(){if(this.donationData?.supply_needs_fulfilled){let c=this.donationData.supply_needs_fulfilled;this.suppliesConfirmed={water_received:c.water||0,food_received:c.food||0,medical_supplies_received:c.medical_supplies||0,clothing_received:c.clothing||0,shelter_materials_received:c.shelter_materials||0,other_items:c.other||"",all_supplies_received:!0}}}getIcon(c,w="md"){return this.iconService.getIcon(c,w)}static{this.\u0275fac=function(w){return new(w||d)}}static{this.\u0275cmp=ji({type:d,selectors:[["app-donation-confirmation-modal"]],inputs:{show:"show",donationData:"donationData"},outputs:{closeModal:"closeModal",submitRating:"submitRating"},standalone:!0,features:[Yi],decls:1,vars:1,consts:[["class","modal-overlay",3,"click",4,"ngIf"],[1,"modal-overlay",3,"click"],[1,"modal-container",3,"click"],[1,"modal-header"],[1,"modal-title"],[3,"innerHTML"],[1,"close-btn",3,"click"],[1,"modal-content"],[1,"donation-info"],[1,"donator-info"],[1,"donator-email"],[1,"donation-time"],[1,"success-message"],[1,"supplies-section"],[1,"section-subtitle"],[1,"auto-fill-section"],["type","button",1,"btn","btn-auto-fill",3,"click"],[1,"auto-fill-hint"],[1,"supply-items"],[1,"supply-item"],[1,"supply-input"],["class","expected",4,"ngIf"],["type","number","min","0","placeholder","0",1,"supply-count",3,"ngModelChange","ngModel"],[1,"received-label"],["placeholder","Describe other items received (cash, etc.)...","rows","2",1,"other-items-input",3,"ngModelChange","ngModel"],[1,"all-received-checkbox"],[1,"checkbox-label"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"checkmark"],[1,"rating-section"],[1,"star-rating"],[3,"class","click",4,"ngFor","ngForOf"],["placeholder","Share your feedback (optional)...","rows","3",1,"comment-input",3,"ngModelChange","ngModel"],[1,"modal-footer"],[1,"btn","btn-secondary",3,"click"],[1,"btn","btn-primary",3,"click"],[1,"expected"],[3,"click"]],template:function(w,_){w&1&&Ht(0,il,101,28,"div",0),w&2&&W("ngIf",_.show)},dependencies:[qi,Xr,Qi,Yr,to,tr,Jr,_s,er,$r,Kr,Ki],styles:[".modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100vw;height:100vh;background:#000000b3;display:flex;justify-content:center;align-items:center;z-index:1000;-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px)}.modal-container[_ngcontent-%COMP%]{background:#fff;border-radius:15px;max-width:600px;width:90%;max-height:90vh;overflow-y:auto;box-shadow:0 20px 60px #0000004d;animation:_ngcontent-%COMP%_modalSlideIn .3s ease-out}@keyframes _ngcontent-%COMP%_modalSlideIn{0%{opacity:0;transform:translateY(-50px) scale(.9)}to{opacity:1;transform:translateY(0) scale(1)}}.modal-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4caf50,#45a049);color:#fff;padding:1.5rem;border-radius:15px 15px 0 0;display:flex;justify-content:space-between;align-items:center}.modal-title[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;margin:0}.close-btn[_ngcontent-%COMP%]{background:none;border:none;color:#fff;font-size:2rem;cursor:pointer;padding:0;width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;transition:background-color .3s ease}.close-btn[_ngcontent-%COMP%]:hover{background:#fff3}.modal-content[_ngcontent-%COMP%]{padding:2rem}.donation-info[_ngcontent-%COMP%]{margin-bottom:2rem}.donator-info[_ngcontent-%COMP%]{background:#f8f9fa;padding:1rem;border-radius:10px;border-left:4px solid #4CAF50;margin-bottom:1rem}.donator-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 .5rem;color:#333;font-size:1.2rem}.donator-email[_ngcontent-%COMP%]{color:#666;margin:0 0 .25rem;font-size:.9rem}.donation-time[_ngcontent-%COMP%]{color:#666;margin:0;font-size:.9rem;font-style:italic}.success-message[_ngcontent-%COMP%]{background:linear-gradient(135deg,#e8f5e8,#f0f8f0);padding:1rem;border-radius:10px;border-left:4px solid #4CAF50}.success-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#2d5a2d;line-height:1.5}.supplies-section[_ngcontent-%COMP%], .rating-section[_ngcontent-%COMP%]{margin-bottom:2rem}.supplies-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], .rating-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:600;color:#333;margin:0 0 .5rem}.section-subtitle[_ngcontent-%COMP%]{color:#666;font-size:.9rem;margin:0 0 1rem}.supply-items[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;margin-bottom:1.5rem}.supply-item[_ngcontent-%COMP%]{background:#f8f9fa;padding:1rem;border-radius:8px;border:1px solid #e9ecef}.supply-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-weight:600;color:#333;margin-bottom:.5rem}.supply-input[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;flex-wrap:wrap}.expected[_ngcontent-%COMP%]{background:#e3f2fd;color:#1976d2;padding:.25rem .5rem;border-radius:4px;font-size:.85rem;font-weight:500}.supply-count[_ngcontent-%COMP%]{width:80px;padding:.5rem;border:1px solid #ddd;border-radius:4px;font-size:1rem;text-align:center}.received-label[_ngcontent-%COMP%]{color:#666;font-size:.9rem}.other-items-input[_ngcontent-%COMP%]{width:100%;padding:.5rem;border:1px solid #ddd;border-radius:4px;font-family:inherit;resize:vertical;margin-top:.5rem}.all-received-checkbox[_ngcontent-%COMP%]{background:#e8f5e8;padding:1rem;border-radius:8px;border:1px solid #c8e6c9}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;cursor:pointer;font-weight:500;color:#2d5a2d}.checkbox-label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin-right:.5rem;transform:scale(1.2)}.star-rating[_ngcontent-%COMP%]{display:flex;gap:.25rem;margin-bottom:1rem;justify-content:center}.star[_ngcontent-%COMP%]{font-size:2rem;color:#ddd;cursor:pointer;transition:color .2s ease;-webkit-user-select:none;user-select:none}.star[_ngcontent-%COMP%]:hover, .star.filled[_ngcontent-%COMP%]{color:gold}.comment-input[_ngcontent-%COMP%]{width:100%;padding:.75rem;border:1px solid #ddd;border-radius:8px;font-family:inherit;resize:vertical}.modal-footer[_ngcontent-%COMP%]{background:#f8f9fa;padding:1.5rem;border-radius:0 0 15px 15px;display:flex;justify-content:flex-end;gap:1rem;border-top:1px solid #e9ecef}.btn[_ngcontent-%COMP%]{padding:.75rem 1.5rem;border:none;border-radius:8px;font-size:1rem;font-weight:500;cursor:pointer;transition:all .3s ease}.btn-secondary[_ngcontent-%COMP%]{background:#6c757d;color:#fff}.btn-secondary[_ngcontent-%COMP%]:hover{background:#5a6268}.btn-primary[_ngcontent-%COMP%]{background:#4caf50;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover{background:#45a049;transform:translateY(-2px)}.btn-auto-fill[_ngcontent-%COMP%]{background:linear-gradient(135deg,#2196f3,#1976d2);color:#fff;padding:.6rem 1.2rem;border:none;border-radius:6px;font-size:.9rem;font-weight:500;cursor:pointer;transition:all .3s ease;display:inline-flex;align-items:center;gap:.5rem}.btn-auto-fill[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#1976d2,#1565c0);transform:translateY(-1px);box-shadow:0 4px 12px #2196f34d}.auto-fill-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;margin-bottom:1.5rem;padding:1rem;background:linear-gradient(135deg,#e3f2fd,#f3e5f5);border-radius:8px;border-left:4px solid #2196F3}.auto-fill-hint[_ngcontent-%COMP%]{font-size:.85rem;color:#666;font-style:italic}@media (max-width: 768px){.modal-container[_ngcontent-%COMP%]{width:95%;margin:1rem}.modal-content[_ngcontent-%COMP%]{padding:1.5rem}.supply-input[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.supply-count[_ngcontent-%COMP%]{width:100%}.star-rating[_ngcontent-%COMP%]{justify-content:flex-start}.modal-footer[_ngcontent-%COMP%]{flex-direction:column}.btn[_ngcontent-%COMP%]{width:100%}}"],changeDetection:0})}}return d})();var ha=(()=>{class d{constructor(c,w){this.http=c,this.authService=w,this.trackingSubject=new ls({isTracking:!1}),this.watchId=null,this.updateInterval=null,this.currentLocationId=null}get trackingStatus$(){return this.trackingSubject.asObservable()}startTracking(c){return new Promise((w,_)=>{if(!navigator.geolocation){let P="Geolocation is not supported by this browser";this.trackingSubject.next({isTracking:!1,error:P}),_(new Error(P));return}let C=this.authService.getCurrentUserValue();if(!C){let P="User must be logged in to start tracking";this.trackingSubject.next({isTracking:!1,error:P}),_(new Error(P));return}this.currentLocationId=c;let M={enableHighAccuracy:!1,timeout:3e4,maximumAge:6e4};navigator.geolocation.getCurrentPosition(P=>{this.startWatchingPosition(C,c,M,w,_)},P=>{console.error("Initial geolocation error:",P);let H={enableHighAccuracy:!1,timeout:6e4,maximumAge:3e5};console.log("Trying fallback geolocation options..."),navigator.geolocation.getCurrentPosition(E=>{console.log("Fallback location success, starting tracking..."),this.startWatchingPosition(C,c,H,w,_)},E=>{console.error("Fallback geolocation also failed:",E);let Z="Location access denied or unavailable";switch(E.code){case E.PERMISSION_DENIED:Z="Location access denied. Please enable location permissions in your browser settings.";break;case E.POSITION_UNAVAILABLE:Z="Location information is unavailable. Please ensure GPS/location services are enabled.";break;case E.TIMEOUT:Z="Location request timed out. Please try again or check your internet connection.";break}this.trackingSubject.next({isTracking:!1,error:Z}),_(new Error(Z))},H)},M),this.updateInterval=Mr(1e4).subscribe(()=>{this.watchId!==null&&console.log("Location tracking active...")})})}startWatchingPosition(c,w,_,C,M){this.watchId=navigator.geolocation.watchPosition(P=>{let H={latitude:P.coords.latitude,longitude:P.coords.longitude,accuracy:P.coords.accuracy,timestamp:new Date,donatorId:c.id,donatorUsername:c.email.split("@")[0],locationId:w};this.sendLocationUpdate(H),this.trackingSubject.next({isTracking:!0,donatorInfo:{id:c.id,username:c.email.split("@")[0],firstName:c.first_name||"",lastName:c.last_name||""},lastUpdate:H}),C()},P=>{console.error("Watch position error:",P);let H="Location tracking failed";switch(P.code){case P.PERMISSION_DENIED:H="Location access denied. Please enable location permissions.";break;case P.POSITION_UNAVAILABLE:H="Location information is unavailable.";break;case P.TIMEOUT:H="Location request timed out during tracking.";break}this.trackingSubject.next({isTracking:!1,error:H}),M(new Error(H))},_)}stopTracking(){this.watchId!==null&&(navigator.geolocation.clearWatch(this.watchId),this.watchId=null),this.updateInterval&&(this.updateInterval.unsubscribe(),this.updateInterval=null),this.currentLocationId&&this.stopLocationTracking(this.currentLocationId).subscribe({next:()=>console.log("Tracking stopped successfully"),error:c=>console.error("Error stopping tracking:",c)}),this.currentLocationId=null,this.trackingSubject.next({isTracking:!1})}sendLocationUpdate(c){let w=new To({Authorization:`Bearer ${this.authService.getAccessToken()}`,"Content-Type":"application/json"});this.http.post(`${Oo.apiUrl}/location-updates/`,c,{headers:w}).subscribe({next:_=>{console.log("Location update sent successfully:",_)},error:_=>{console.error("Error sending location update:",_)}})}stopLocationTracking(c){let w=new To({Authorization:`Bearer ${this.authService.getAccessToken()}`,"Content-Type":"application/json"});return this.http.post(`${Oo.apiUrl}/stop-tracking/`,{locationId:c},{headers:w})}getCurrentTrackingStatus(){return this.trackingSubject.value}isCurrentlyTracking(){return this.trackingSubject.value.isTracking}static{this.\u0275fac=function(w){return new(w||d)(So(ps),So(Ji))}}static{this.\u0275prov=cs({token:d,factory:d.\u0275fac,providedIn:"root"})}}return d})();function sl(d,m){d&1&&(T(0,"span"),k(1,"System Online"),O())}function al(d,m){d&1&&(T(0,"span"),k(1,"Connection Lost - Updates will sync when reconnected"),O())}function ll(d,m){if(d&1&&(T(0,"div",24),k(1),O()),d&2){let c=Q();B(),de(" ",c.error," ")}}function cl(d,m){if(d&1){let c=Se();T(0,"button",25),St("click",function(){yt(c);let _=Q();return Ct(_.openShareLocationModal())}),nt(1,"span",7),dt(2,"safeHtml"),k(3," Request Emergency Assistance "),O()}if(d&2){let c=Q();B(),W("innerHTML",pt(2,1,c.getIcon("emergency")),ft)}}function hl(d,m){if(d&1){let c=Se();T(0,"button",26),St("click",function(){yt(c);let _=Q();return Ct(_.stopSharingLocation())}),nt(1,"span",7),dt(2,"safeHtml"),k(3," Stop Location Sharing "),O()}if(d&2){let c=Q();B(),W("innerHTML",pt(2,1,c.getIcon("stop")),ft)}}function ul(d,m){if(d&1){let c=Se();T(0,"button",27),St("click",function(){yt(c);let _=Q();return Ct(_.openQRModal())}),nt(1,"span",7),dt(2,"safeHtml"),k(3," Show QR Code "),O()}if(d&2){let c=Q();B(),W("innerHTML",pt(2,1,c.getIcon("qr-code")),ft)}}function dl(d,m){if(d&1){let c=Se();T(0,"button",27),St("click",function(){yt(c);let _=Q();return Ct(_.openScanner())}),nt(1,"span",7),dt(2,"safeHtml"),k(3," Scan Response QR "),O()}if(d&2){let c=Q();B(),W("innerHTML",pt(2,1,c.getIcon("qr-code")),ft)}}function fl(d,m){d&1&&(T(0,"div",28)(1,"div",29)(2,"h4",30),k(3,"Map Reference"),O(),T(4,"div",31),k(5,"Interactive marker identification"),O()()())}function pl(d,m){if(d&1&&(T(0,"div",44)(1,"div",45),nt(2,"span",7),dt(3,"safeHtml"),T(4,"small"),k(5),nt(6,"br"),k(7),O()(),T(8,"div",45),nt(9,"span",7),dt(10,"safeHtml"),T(11,"small"),k(12),nt(13,"br"),k(14," Estimated contact time: Calculating... "),O()()()),d&2){let c=Q(3);B(2),W("innerHTML",pt(3,6,c.getIcon("clock")),ft),B(3),de(" Last updated: ",c.formatTrackingTime(c.trackingStatus.lastUpdate.timestamp)," "),B(2),de(" Location accuracy: \xB1",c.trackingStatus.lastUpdate.accuracy.toFixed(0),"m "),B(2),W("innerHTML",pt(10,8,c.getIcon("user")),ft),B(3),bo(" Responder: ",c.trackingStatus.donatorInfo==null?null:c.trackingStatus.donatorInfo.firstName," ",c.trackingStatus.donatorInfo==null?null:c.trackingStatus.donatorInfo.lastName," ")}}function gl(d,m){if(d&1&&(T(0,"div",36)(1,"div",37),nt(2,"span",38),dt(3,"safeHtml"),T(4,"div",39)(5,"strong"),k(6,"Response Team En Route"),O(),T(7,"p",40),k(8),O()(),T(9,"div",41),nt(10,"span",42),T(11,"small"),k(12,"Live Tracking Active"),O()()(),Ht(13,pl,15,10,"div",43),O()),d&2){let c=Q(2);W("@slideIn",void 0),B(2),W("innerHTML",pt(3,5,c.getIcon("truck")),ft),B(6),bo("",c.trackingStatus.donatorInfo==null?null:c.trackingStatus.donatorInfo.firstName," ",c.trackingStatus.donatorInfo==null?null:c.trackingStatus.donatorInfo.lastName," is responding to your location"),B(5),W("ngIf",c.trackingStatus.lastUpdate)}}function ml(d,m){if(d&1){let c=Se();T(0,"div",44)(1,"div",45),nt(2,"span",7),dt(3,"safeHtml"),T(4,"small"),k(5),nt(6,"br"),k(7),O()(),T(8,"div",47)(9,"button",48),St("click",function(){yt(c);let _=Q(3);return Ct(_.turnOffLocationSharing())}),nt(10,"span",7),dt(11,"safeHtml"),k(12," End Mission "),O(),T(13,"button",49),St("click",function(){yt(c);let _=Q(3);return Ct(_.openCurrentLocationInGoogleMaps())}),nt(14,"span",7),dt(15,"safeHtml"),k(16," Open in Maps "),O()()()}if(d&2){let c=Q(3);B(2),W("innerHTML",pt(3,5,c.getIcon("clock")),ft),B(3),de(" Last updated: ",c.formatTrackingTime(c.trackingStatus.lastUpdate.timestamp)," "),B(2),de(" GPS accuracy: \xB1",c.trackingStatus.lastUpdate.accuracy.toFixed(0),"m "),B(3),W("innerHTML",pt(11,7,c.getIcon("stop")),ft),B(4),W("innerHTML",pt(15,9,c.getIcon("external-link")),ft)}}function _l(d,m){if(d&1&&(T(0,"div",46)(1,"div",37),nt(2,"span",38),dt(3,"safeHtml"),T(4,"div",39)(5,"strong"),k(6,"Response Mission Active"),O(),T(7,"p",40),k(8,"Your location is being shared with the affected user"),O()(),T(9,"div",41),nt(10,"span",42),T(11,"small"),k(12,"Live Tracking"),O()()(),Ht(13,ml,17,11,"div",43),O()),d&2){let c=Q(2);W("@slideIn",void 0),B(2),W("innerHTML",pt(3,3,c.getIcon("location-marker")),ft),B(11),W("ngIf",c.trackingStatus.lastUpdate)}}function xl(d,m){if(d&1&&(T(0,"div",50),nt(1,"span",7),dt(2,"safeHtml"),T(3,"span"),k(4),O()()),d&2){let c=Q(2);B(),W("innerHTML",pt(2,2,c.getIcon("warning")),ft),B(3),de("",c.offlineQueue.length," location update(s) pending synchronization")}}function wl(d,m){if(d&1&&(T(0,"div",32),Ht(1,gl,14,7,"div",33)(2,_l,14,5,"div",34)(3,xl,5,4,"div",35),O()),d&2){let c=Q();B(),W("ngIf",c.trackingStatus.isTracking&&c.isAffectedUser),B(),W("ngIf",c.trackingStatus.isTracking&&!c.isAffectedUser),B(),W("ngIf",c.offlineQueue.length>0)}}function yl(d,m){d&1&&nt(0,"div",51)}function Cl(d,m){if(d&1&&(T(0,"div",64),nt(1,"span",65),dt(2,"safeHtml"),T(3,"div",66)(4,"span",67),k(5,"Facebook:"),O(),T(6,"span",68),k(7),O()()()),d&2){let c=Q(2);B(),W("innerHTML",pt(2,2,c.getIcon("facebook")),ft),B(6),dn(c.selectedLocation.facebook)}}function vl(d,m){if(d&1&&(T(0,"div",64),nt(1,"span",65),dt(2,"safeHtml"),T(3,"div",66)(4,"span",67),k(5,"Email:"),O(),T(6,"span",68),k(7),O()()()),d&2){let c=Q(2);B(),W("innerHTML",pt(2,2,c.getIcon("mail")),ft),B(6),dn(c.selectedLocation.email)}}function El(d,m){if(d&1){let c=Se();T(0,"div",62)(1,"h4"),nt(2,"span",7),dt(3,"safeHtml"),k(4," Situation Verification "),O(),T(5,"div",74)(6,"img",75),St("error",function(_){yt(c);let C=Q(2);return Ct(C.onImageError(_))}),O(),T(7,"div",76),nt(8,"span",7),dt(9,"safeHtml"),k(10," Verified emergency situation photo "),O()()()}if(d&2){let c=Q(2);B(2),W("innerHTML",pt(3,3,c.getIcon("camera")),ft),B(4),W("src",c.selectedLocation.photo,Io),B(2),W("innerHTML",pt(9,5,c.getIcon("info")),ft)}}function Al(d,m){if(d&1&&(T(0,"div",80),nt(1,"span",81),dt(2,"safeHtml"),T(3,"div",82)(4,"span",83),k(5,"Affected People:"),O(),T(6,"span",84),k(7),O()()()),d&2){let c=Q(3);B(),W("innerHTML",pt(2,2,c.getIcon("users")),ft),B(6),dn(c.selectedLocation.supply_needs.people_count)}}function Sl(d,m){if(d&1&&(T(0,"div",80),nt(1,"span",81),dt(2,"safeHtml"),T(3,"div",82)(4,"span",83),k(5,"Water:"),O(),T(6,"span",84),k(7),O()()()),d&2){let c=Q(3);B(),W("innerHTML",pt(2,2,c.getIcon("water")),ft),B(6),de("",c.selectedLocation.supply_needs.water," bottles")}}function Il(d,m){if(d&1&&(T(0,"div",80),nt(1,"span",81),dt(2,"safeHtml"),T(3,"div",82)(4,"span",83),k(5,"Food Packs:"),O(),T(6,"span",84),k(7),O()()()),d&2){let c=Q(3);B(),W("innerHTML",pt(2,2,c.getIcon("food")),ft),B(6),de("",c.selectedLocation.supply_needs.food," packs")}}function bl(d,m){if(d&1&&(T(0,"div",80),nt(1,"span",81),dt(2,"safeHtml"),T(3,"div",82)(4,"span",83),k(5,"Medical Supplies:"),O(),T(6,"span",84),k(7),O()()()),d&2){let c=Q(3);B(),W("innerHTML",pt(2,2,c.getIcon("medical")),ft),B(6),dn(c.selectedLocation.supply_needs.medical_supplies)}}function Tl(d,m){if(d&1&&(T(0,"div",80),nt(1,"span",81),dt(2,"safeHtml"),T(3,"div",82)(4,"span",83),k(5,"Clothing:"),O(),T(6,"span",84),k(7),O()()()),d&2){let c=Q(3);B(),W("innerHTML",pt(2,2,c.getIcon("clothing")),ft),B(6),de("",c.selectedLocation.supply_needs.clothing," sets")}}function Ml(d,m){if(d&1&&(T(0,"div",80),nt(1,"span",81),dt(2,"safeHtml"),T(3,"div",82)(4,"span",83),k(5,"Shelter Materials:"),O(),T(6,"span",84),k(7),O()()()),d&2){let c=Q(3);B(),W("innerHTML",pt(2,2,c.getIcon("shelter")),ft),B(6),dn(c.selectedLocation.supply_needs.shelter_materials)}}function Nl(d,m){if(d&1&&(T(0,"div",85)(1,"h5"),k(2,"Additional Requirements:"),O(),T(3,"p"),k(4),O()()),d&2){let c=Q(3);B(4),dn(c.selectedLocation.supply_needs.other)}}function Ol(d,m){if(d&1&&(T(0,"div",62)(1,"h4"),nt(2,"span",7),dt(3,"safeHtml"),k(4," Required Supplies "),O(),T(5,"div",77),Ht(6,Al,8,4,"div",78)(7,Sl,8,4,"div",78)(8,Il,8,4,"div",78)(9,bl,8,4,"div",78)(10,Tl,8,4,"div",78)(11,Ml,8,4,"div",78),O(),Ht(12,Nl,5,1,"div",79),O()),d&2){let c=Q(2);B(2),W("innerHTML",pt(3,8,c.getIcon("food")),ft),B(4),W("ngIf",c.selectedLocation.supply_needs.people_count),B(),W("ngIf",c.selectedLocation.supply_needs.water),B(),W("ngIf",c.selectedLocation.supply_needs.food),B(),W("ngIf",c.selectedLocation.supply_needs.medical_supplies),B(),W("ngIf",c.selectedLocation.supply_needs.clothing),B(),W("ngIf",c.selectedLocation.supply_needs.shelter_materials),B(),W("ngIf",c.selectedLocation.supply_needs.other)}}function Ll(d,m){if(d&1&&(T(0,"div",62)(1,"h4"),k(2,"\u{1F4DD} Additional Notes"),O(),T(3,"p",86),k(4),O()()),d&2){let c=Q(2);B(4),dn(c.selectedLocation.notes)}}function Dl(d,m){if(d&1&&(T(0,"div",97),nt(1,"span",7),dt(2,"safeHtml"),k(3," Arrived "),O()),d&2){let c=Q(4);B(),W("innerHTML",pt(2,1,c.getIcon("check")),ft)}}function Rl(d,m){if(d&1&&(T(0,"div",44)(1,"small"),k(2),O()()),d&2){let c=Q(6);B(2),de("Last update: ",c.formatTrackingTime(c.trackingStatus.lastUpdate.timestamp),"")}}function Pl(d,m){if(d&1&&(T(0,"div",100)(1,"span",101),nt(2,"span",7),dt(3,"safeHtml"),k(4," LIVE"),O(),T(5,"small"),k(6),O(),Ht(7,Rl,3,1,"div",43),O()),d&2){let c=Q(5);B(2),W("innerHTML",pt(3,3,c.getIcon("emergency","sm")),ft),B(4),de("",c.trackingStatus.donatorInfo==null?null:c.trackingStatus.donatorInfo.username," is on the way for supplies"),B(),W("ngIf",c.trackingStatus.lastUpdate)}}function Bl(d,m){if(d&1&&(T(0,"div",98),Ht(1,Pl,8,5,"div",99),O()),d&2){let c=Q().$implicit,w=Q(3);B(),W("ngIf",w.trackingStatus.isTracking&&(w.trackingStatus.donatorInfo==null?null:w.trackingStatus.donatorInfo.username)===c.donator_name)}}function kl(d,m){if(d&1&&(T(0,"div",90)(1,"div",91),nt(2,"span",7),dt(3,"safeHtml"),O(),T(4,"div",92)(5,"div",93),k(6),O(),T(7,"div",94),k(8),dt(9,"date"),O(),Ht(10,Dl,4,3,"div",95)(11,Bl,2,1,"div",96),O()()),d&2){let c=m.$implicit,w=Q(3);B(2),W("innerHTML",pt(3,5,w.getIcon("user")),ft),B(4),dn(c.donator_name),B(2),de(" Marked at: ",jr(9,7,c.marked_at,"short")," "),B(2),W("ngIf",c.arrived),B(),W("ngIf",!c.arrived)}}function Fl(d,m){if(d&1&&(T(0,"div",62)(1,"h4"),nt(2,"span",7),dt(3,"safeHtml"),k(4," Donators On The Way"),O(),T(5,"div",87),Ht(6,kl,12,10,"div",88),O(),T(7,"p",89),k(8),O()()),d&2){let c=Q(2);B(2),W("innerHTML",pt(3,3,c.getIcon("truck")),ft),B(4),W("ngForOf",c.selectedLocation.donators_on_the_way),B(2),de("",c.selectedLocation.donators_on_the_way.length," donator(s) heading to this location")}}function Ul(d,m){if(d&1&&(T(0,"div",39)(1,"div",106)(2,"span",107),k(3,"\u23F0"),O(),T(4,"span"),k(5),O()(),T(6,"div",106),nt(7,"span",108),dt(8,"safeHtml"),T(9,"span"),k(10),O()()()),d&2){let c=Q(3);B(5),de("Last update: ",c.formatTrackingTime(c.trackingStatus.lastUpdate.timestamp),""),B(2),W("innerHTML",pt(8,3,c.getIcon("location-marker")),ft),B(3),de("Accuracy: \xB1",c.trackingStatus.lastUpdate.accuracy.toFixed(0),"m")}}function zl(d,m){if(d&1&&(T(0,"div",102)(1,"h4"),nt(2,"span",7),dt(3,"safeHtml"),k(4," Real-Time Tracking"),O(),T(5,"div",103)(6,"div",37)(7,"span",104),nt(8,"span",7),dt(9,"safeHtml"),O(),T(10,"strong"),k(11),O()(),T(12,"div",40),k(13," Please standby for contact "),O(),Ht(14,Ul,11,5,"div",105),O()()),d&2){let c=Q(2);B(2),W("innerHTML",pt(3,4,c.getIcon("location-marker")),ft),B(6),W("innerHTML",pt(9,6,c.getIcon("emergency","sm")),ft),B(3),de("",c.trackingStatus.donatorInfo==null?null:c.trackingStatus.donatorInfo.username," is on the way"),B(3),W("ngIf",c.trackingStatus.lastUpdate)}}function Hl(d,m){if(d&1){let c=Se();T(0,"button",109),St("click",function(){yt(c);let _=Q(2);return Ct(_.markAsOnTheWay(_.selectedLocation))}),nt(1,"span",7),dt(2,"safeHtml"),k(3," Start Response Mission "),O()}if(d&2){let c=Q(2);B(),W("innerHTML",pt(2,1,c.getIcon("truck")),ft)}}function Vl(d,m){if(d&1){let c=Se();T(0,"div",52),St("click",function(){yt(c);let _=Q();return Ct(_.closeLocationCard())}),T(1,"div",53),St("click",function(_){return yt(c),Ct(_.stopPropagation())}),T(2,"div",54)(3,"div",55)(4,"div",56),nt(5,"span",7),dt(6,"safeHtml"),O(),T(7,"div",57)(8,"h2",58),k(9,"Emergency Request"),O(),T(10,"p",59),k(11,"Response coordination details"),O()()(),T(12,"button",60),St("click",function(){yt(c);let _=Q();return Ct(_.closeLocationCard())}),nt(13,"span",7),dt(14,"safeHtml"),O()(),T(15,"div",61)(16,"div",62)(17,"h4"),nt(18,"span",7),dt(19,"safeHtml"),k(20," Contact Information "),O(),T(21,"div",63)(22,"div",64),nt(23,"span",65),dt(24,"safeHtml"),T(25,"div",66)(26,"span",67),k(27,"Phone:"),O(),T(28,"span",68),k(29),O()()(),Ht(30,Cl,8,4,"div",69)(31,vl,8,4,"div",69),O()(),Ht(32,El,11,7,"div",70)(33,Ol,13,10,"div",70)(34,Ll,5,1,"div",70)(35,Fl,9,5,"div",70)(36,zl,15,8,"div",71),O(),T(37,"div",72)(38,"button",14),St("click",function(){yt(c);let _=Q();return Ct(_.copyCoordinates(_.selectedLocation))}),nt(39,"span",7),dt(40,"safeHtml"),k(41," Copy Coordinates "),O(),T(42,"button",27),St("click",function(){yt(c);let _=Q();return Ct(_.openInMaps(_.selectedLocation))}),nt(43,"span",7),dt(44,"safeHtml"),k(45," Open in Maps "),O(),Ht(46,Hl,4,3,"button",73),O()()()}if(d&2){let c=Q();W("@slideIn",void 0),B(5),W("innerHTML",pt(6,16,c.getIcon("emergency")),ft),B(8),W("innerHTML",pt(14,18,c.getIcon("close")),ft),B(5),W("innerHTML",pt(19,20,c.getIcon("phone")),ft),B(5),W("innerHTML",pt(24,22,c.getIcon("phone")),ft),B(6),dn(c.selectedLocation.phone),B(),W("ngIf",c.selectedLocation.facebook),B(),W("ngIf",c.selectedLocation.email),B(),W("ngIf",c.selectedLocation.photo),B(),W("ngIf",c.selectedLocation.supply_needs),B(),W("ngIf",c.selectedLocation.notes),B(),W("ngIf",c.selectedLocation.donators_on_the_way&&c.selectedLocation.donators_on_the_way.length>0),B(),W("ngIf",c.trackingStatus.isTracking&&c.selectedLocation),B(3),W("innerHTML",pt(40,24,c.getIcon("copy")),ft),B(4),W("innerHTML",pt(44,26,c.getIcon("external-link")),ft),B(3),W("ngIf",!c.isAffectedUser)}}function Zl(d,m){d&1&&(T(0,"div",141),k(1," Please enter a valid PH mobile number "),O())}function Wl(d,m){if(d&1&&(T(0,"div",126)(1,"div",127),nt(2,"span",128),dt(3,"safeHtml"),T(4,"p",129),k(5," Provide your contact information so emergency responders can coordinate with you "),O()(),T(6,"div",130)(7,"label",131),k(8," Phone Number "),T(9,"span",132),k(10,"*"),O(),T(11,"small"),k(12,"(e.g., 09123456789 or +639123456789)"),O()(),nt(13,"input",133),Ht(14,Zl,2,0,"div",134),O(),T(15,"div",130)(16,"label",135),k(17," Facebook Profile "),T(18,"small"),k(19,"(optional)"),O()(),nt(20,"input",136),O(),T(21,"div",130)(22,"label",137),k(23," Email Address "),T(24,"small"),k(25,"(optional)"),O()(),nt(26,"input",138),O(),T(27,"div",130)(28,"label",139),k(29," Additional Notes "),T(30,"small"),k(31,"(optional - describe your situation)"),O()(),nt(32,"textarea",140),O()()),d&2){let c,w,_,C=Q(2);B(2),W("innerHTML",pt(3,6,C.getIcon("phone")),ft),B(11),Di("error",((c=C.shareLocationForm.get("phone"))==null?null:c.invalid)&&((c=C.shareLocationForm.get("phone"))==null?null:c.touched)),B(),W("ngIf",((w=C.shareLocationForm.get("phone"))==null?null:w.invalid)&&((w=C.shareLocationForm.get("phone"))==null?null:w.touched)),B(12),Di("error",((_=C.shareLocationForm.get("email"))==null?null:_.invalid)&&((_=C.shareLocationForm.get("email"))==null?null:_.touched))}}function Gl(d,m){if(d&1){let c=Se();T(0,"div",145),nt(1,"img",146),T(2,"button",147),St("click",function(){yt(c);let _=Q(3);return Ct(_.removePhoto())}),nt(3,"span",7),dt(4,"safeHtml"),k(5," Remove Photo "),O()()}if(d&2){let c=Q(3);B(),W("src",c.photoPreview,Io),B(2),W("innerHTML",pt(4,2,c.getIcon("close")),ft)}}function jl(d,m){if(d&1){let c=Se();T(0,"div",148)(1,"label",149),nt(2,"span",7),dt(3,"safeHtml"),k(4," Capture Verification Photo "),O(),T(5,"input",150),St("change",function(_){yt(c);let C=Q(3);return Ct(C.onPhotoSelected(_))}),O(),T(6,"div",151),nt(7,"span",7),dt(8,"safeHtml"),T(9,"span"),k(10,"Photo verification helps responders assess the situation and locate you accurately"),O()()()}if(d&2){let c=Q(3);B(2),W("innerHTML",pt(3,2,c.getIcon("camera")),ft),B(5),W("innerHTML",pt(8,4,c.getIcon("info")),ft)}}function Xl(d,m){if(d&1&&(T(0,"div",126)(1,"div",127),nt(2,"span",128),dt(3,"safeHtml"),T(4,"p",129),k(5," Capture a photo to verify your location and situation (required for response coordination) "),O()(),T(6,"div",142),Ht(7,Gl,6,4,"div",143)(8,jl,11,6,"div",144),O()()),d&2){let c=Q(2);B(2),W("innerHTML",pt(3,3,c.getIcon("camera")),ft),B(5),W("ngIf",c.photoPreview),B(),W("ngIf",!c.photoPreview)}}function Yl(d,m){d&1&&(T(0,"div",141),k(1," Please specify how many people need assistance "),O())}function Ql(d,m){if(d&1&&(T(0,"div",152)(1,"div",127),nt(2,"span",128),dt(3,"safeHtml"),T(4,"p",129),k(5," Specify your immediate supply requirements to help responders prepare "),O()(),T(6,"div",130)(7,"label",153),k(8," Number of People "),T(9,"span",132),k(10,"*"),O()(),nt(11,"input",154),Ht(12,Yl,2,0,"div",134),O(),T(13,"div",77)(14,"div",130)(15,"label",155),nt(16,"span",7),dt(17,"safeHtml"),k(18," Water (liters)"),O(),nt(19,"input",156),O(),T(20,"div",130)(21,"label",157),k(22,"\u{1F35A} Food (packs)"),O(),nt(23,"input",158),O(),T(24,"div",130)(25,"label",159),k(26,"\u{1F48A} Medical"),O(),nt(27,"input",160),O(),T(28,"div",130)(29,"label",161),nt(30,"span",7),dt(31,"safeHtml"),k(32," Clothing (sets)"),O(),nt(33,"input",162),O(),T(34,"div",130)(35,"label",163),k(36,"\u26FA Shelter"),O(),nt(37,"input",164),O()(),T(38,"div",130)(39,"label",165),k(40,"Other Needs"),O(),nt(41,"textarea",166),O()()),d&2){let c,w,_=Q(2);B(2),W("innerHTML",pt(3,6,_.getIcon("food")),ft),B(9),Di("error",((c=_.shareLocationForm.get("supply_needs.people_count"))==null?null:c.invalid)&&((c=_.shareLocationForm.get("supply_needs.people_count"))==null?null:c.touched)),B(),W("ngIf",((w=_.shareLocationForm.get("supply_needs.people_count"))==null?null:w.invalid)&&((w=_.shareLocationForm.get("supply_needs.people_count"))==null?null:w.touched)),B(4),W("innerHTML",pt(17,8,_.getIcon("water")),ft),B(14),W("innerHTML",pt(31,10,_.getIcon("clothing")),ft)}}function ql(d,m){if(d&1){let c=Se();T(0,"button",167),St("click",function(){yt(c);let _=Q(2);return Ct(_.previousStep())}),k(1," \u2190 Previous "),O()}if(d&2){let c=Q(2);W("disabled",c.submitting)}}function Kl(d,m){if(d&1){let c=Se();T(0,"button",168),St("click",function(){yt(c);let _=Q(2);return Ct(_.nextStep())}),k(1," Next \u2192 "),O()}if(d&2){let c=Q(2);W("disabled",!c.canProceedToNextStep()||c.submitting)}}function Jl(d,m){if(d&1&&(T(0,"span"),nt(1,"span",7),dt(2,"safeHtml"),k(3," Share Location"),O()),d&2){let c=Q(3);B(),W("innerHTML",pt(2,1,c.getIcon("location-marker")),ft)}}function $l(d,m){d&1&&(T(0,"span"),k(1,"Sharing..."),O())}function tc(d,m){if(d&1&&(T(0,"button",169),Ht(1,Jl,4,3,"span",8)(2,$l,2,0,"span",8),O()),d&2){let c=Q(2);W("disabled",!c.shareLocationForm.valid||c.submitting),B(),W("ngIf",!c.submitting),B(),W("ngIf",c.submitting)}}function ec(d,m){if(d&1){let c=Se();T(0,"div",110),St("click",function(){yt(c);let _=Q();return Ct(_.closeShareModal())}),T(1,"div",111),St("click",function(_){return yt(c),Ct(_.stopPropagation())}),T(2,"div",112)(3,"div",113),nt(4,"span",114),dt(5,"safeHtml"),T(6,"h3"),k(7,"Request Emergency Assistance"),O()(),T(8,"button",115),St("click",function(){yt(c);let _=Q();return Ct(_.closeShareModal())}),nt(9,"span",7),dt(10,"safeHtml"),O()(),T(11,"div",116)(12,"div",117)(13,"span",118),k(14,"1"),O(),T(15,"span",119),k(16,"Contact Info"),O()(),T(17,"div",117)(18,"span",118),k(19,"2"),O(),T(20,"span",119),k(21,"Verify Photo"),O()(),T(22,"div",117)(23,"span",118),k(24,"3"),O(),T(25,"span",119),k(26,"Supply Needs"),O()()(),T(27,"form",120),St("ngSubmit",function(){yt(c);let _=Q();return Ct(_.submitShareLocation())}),Ht(28,Wl,33,8,"div",121)(29,Xl,9,5,"div",121)(30,Ql,42,12,"div",122),T(31,"div",72),Ht(32,ql,2,1,"button",123)(33,Kl,2,1,"button",124)(34,tc,3,3,"button",125),O()()()()}if(d&2){let c=Q();B(),W("@slideIn",void 0),B(3),W("innerHTML",pt(5,20,c.getIcon("emergency")),ft),B(5),W("innerHTML",pt(10,22,c.getIcon("close")),ft),B(3),Di("active",c.currentStep===1)("completed",c.currentStep>1),B(5),Di("active",c.currentStep===2)("completed",c.currentStep>2),B(5),Di("active",c.currentStep===3),B(5),W("formGroup",c.shareLocationForm),B(),W("ngIf",c.currentStep===1),B(),W("ngIf",c.currentStep===2),B(),W("ngIf",c.currentStep===3),B(2),W("ngIf",c.currentStep>1),B(),W("ngIf",c.currentStep<3),B(),W("ngIf",c.currentStep===3)}}function nc(d,m){if(d&1){let c=Se();T(0,"div",170),St("click",function(){yt(c);let _=Q();return Ct(_.closeQRModal())}),T(1,"div",111),St("click",function(_){return yt(c),Ct(_.stopPropagation())}),T(2,"div",112)(3,"h3"),nt(4,"span",7),dt(5,"safeHtml"),k(6," Your Donation QR Code"),O(),T(7,"button",171),St("click",function(){yt(c);let _=Q();return Ct(_.closeQRModal())}),k(8,"\xD7"),O()(),T(9,"div",126)(10,"div",172)(11,"p",173)(12,"strong"),k(13,"Show this QR code to donators when they arrive to deliver donations."),O()(),T(14,"div",174),nt(15,"qrcode",175),O(),T(16,"div",176)(17,"strong"),k(18,"Code:"),O(),k(19),O(),T(20,"div",177)(21,"h5"),nt(22,"span",7),dt(23,"safeHtml"),k(24," How It Works:"),O(),T(25,"ul")(26,"li"),k(27,"\u2713 Your location is visible to donators on the map"),O(),T(28,"li"),k(29,"\u2713 When a donator arrives, show them this QR code"),O(),T(30,"li"),k(31,"\u2713 They will scan it to confirm the donation delivery"),O(),T(32,"li"),k(33,"\u2713 After scanning, you cannot request help again for 3 hours"),O(),T(34,"li"),k(35,"\u2713 Keep this code safe and only show it to real donators"),O()()(),T(36,"div",178)(37,"button",179),St("click",function(){yt(c);let _=Q();return Ct(_.downloadQRCode())}),nt(38,"span",7),dt(39,"safeHtml"),k(40," Download QR Code "),O(),T(41,"button",147),St("click",function(){yt(c);let _=Q();return Ct(_.closeQRModal())}),k(42," Close "),O()()()()()()}if(d&2){let c=Q();B(4),W("innerHTML",pt(5,8,c.getIcon("qr-code")),ft),B(11),W("qrdata",c.userQRCode)("width",256)("errorCorrectionLevel","M")("elementType","canvas"),B(4),de(" ",c.userQRCode," "),B(3),W("innerHTML",pt(23,10,c.getIcon("clipboard")),ft),B(16),W("innerHTML",pt(39,12,c.getIcon("download")),ft)}}function ic(d,m){if(d&1){let c=Se();T(0,"div",180),St("click",function(){yt(c);let _=Q();return Ct(_.closeOnTheWayModal())}),T(1,"div",111),St("click",function(_){return yt(c),Ct(_.stopPropagation())}),T(2,"div",112)(3,"h3"),nt(4,"span",7),dt(5,"safeHtml"),k(6," Mark as On The Way"),O(),T(7,"button",171),St("click",function(){yt(c);let _=Q();return Ct(_.closeOnTheWayModal())}),k(8,"\xD7"),O()(),T(9,"div",126)(10,"div",181)(11,"h4"),nt(12,"span",7),dt(13,"safeHtml"),k(14," Important Instructions"),O(),T(15,"div",182)(16,"p")(17,"strong"),k(18,"Before marking yourself as on the way:"),O()(),T(19,"ul")(20,"li"),nt(21,"span",7),dt(22,"safeHtml"),T(23,"strong"),k(24,"Contact the affected user first"),O(),k(25," using the phone number or Facebook provided"),O(),T(26,"li"),nt(27,"span",7),dt(28,"safeHtml"),k(29," Verify their location and confirm they still need help"),O(),T(30,"li"),nt(31,"span",7),dt(32,"safeHtml"),T(33,"strong"),k(34,'Use "Get Directions" button below'),O(),k(35," to plan your route via Google Maps"),O(),T(36,"li"),nt(37,"span",7),dt(38,"safeHtml"),k(39," Confirm what supplies you're bringing"),O()()(),T(40,"div",183)(41,"p")(42,"strong"),k(43,"After marking as on the way:"),O()(),T(44,"ul")(45,"li"),k(46,"\u2713 The affected user will see your name and time"),O(),T(47,"li"),k(48,"\u2713 You commit to delivering the donation"),O(),T(49,"li"),k(50,"\u2713 Upon arrival, scan their QR code to confirm delivery"),O()()(),T(51,"div",184)(52,"p")(53,"strong"),k(54,"Have you contacted the affected user and confirmed their location?"),O()()()(),T(55,"div",185)(56,"button",26),St("click",function(){yt(c);let _=Q();return Ct(_.closeOnTheWayModal())}),k(57," Cancel "),O(),T(58,"button",186),St("click",function(){yt(c);let _=Q();return Ct(_.openGoogleMapsDirections(_.selectedLocationForDonation))}),nt(59,"span",7),dt(60,"safeHtml"),k(61," Get Directions (Google Maps) "),O(),T(62,"button",187),St("click",function(){yt(c);let _=Q();return Ct(_.confirmOnTheWay())}),k(63," Yes, I'm On The Way "),O()()()()()}if(d&2){let c=Q();B(4),W("innerHTML",pt(5,7,c.getIcon("truck")),ft),B(8),W("innerHTML",pt(13,9,c.getIcon("alert")),ft),B(9),W("innerHTML",pt(22,11,c.getIcon("phone")),ft),B(6),W("innerHTML",pt(28,13,c.getIcon("check")),ft),B(4),W("innerHTML",pt(32,15,c.getIcon("map")),ft),B(6),W("innerHTML",pt(38,17,c.getIcon("package")),ft),B(22),W("innerHTML",pt(60,19,c.getIcon("map")),ft)}}function rc(d,m){if(d&1){let c=Se();T(0,"div",52),St("click",function(){yt(c);let _=Q();return Ct(_.closeScannerModal())}),T(1,"div",188),St("click",function(_){return yt(c),Ct(_.stopPropagation())}),T(2,"app-qr-scanner",189),St("scanned",function(_){yt(c);let C=Q();return Ct(C.onQRScanned(_))})("closed",function(){yt(c);let _=Q();return Ct(_.closeScannerModal())}),O()()()}}var $h=(()=>{class d{constructor(c,w,_,C,M,P,H,E,Z){this.locationService=c,this.donationService=w,this.authService=_,this.locationTrackingService=C,this.iconService=M,this.fb=P,this.cdr=H,this.route=E,this.router=Z,this.markers=[],this.locations=[],this.selectedLocation=null,this.isAffectedUser=!1,this.isLocationSharing=!1,this.offlineQueue=[],this.loading=!0,this.error="",this.isOnline=navigator.onLine,this.showShareModal=!1,this.submitting=!1,this.sharedUserData=null,this.currentStep=1,this.photoFile=null,this.photoPreview=null,this.showQRModal=!1,this.userQRCode="",this.showOnTheWayModal=!1,this.selectedLocationForDonation=null,this.showScannerModal=!1,this.showDonationConfirmationModal=!1,this.donationNotificationData=null,this.trackingStatus={isTracking:!1},this.defaultBarangayMarkers=[],this.barangayLocations=[{name:"Anonang Norte Barangay Hall",lat:11.0507,lng:124.0047,city:"Bogo City",address:"Anonang Norte, Bogo City"},{name:"Anonang Sur Barangay Hall",lat:11.0474,lng:124.0041,city:"Bogo City",address:"Anonang Sur, Bogo City"},{name:"Banban Barangay Hall",lat:11.0635,lng:124.0092,city:"Bogo City",address:"Banban, Bogo City"},{name:"Binabag Barangay Hall",lat:11.0551,lng:124.0069,city:"Bogo City",address:"Binabag, Bogo City"},{name:"Bungtod Barangay Hall",lat:11.0441,lng:124.0125,city:"Bogo City",address:"Bungtod, Bogo City"},{name:"Carbon Barangay Hall",lat:11.0584,lng:124.0036,city:"Bogo City",address:"Carbon, Bogo City"},{name:"Cayang Barangay Hall",lat:11.0407,lng:124.0158,city:"Bogo City",address:"Cayang, Bogo City"},{name:"Cogon Barangay Hall",lat:11.0518,lng:124.008,city:"Bogo City",address:"Cogon, Bogo City"},{name:"Dakit Barangay Hall",lat:11.0462,lng:124.0147,city:"Bogo City",address:"Dakit, Bogo City"},{name:"Don Pedro Rodriguez Barangay Hall",lat:11.0529,lng:124.0025,city:"Bogo City",address:"Don Pedro Rodriguez, Bogo City"},{name:"Gairan Barangay Hall",lat:11.0495,lng:124.01,city:"Bogo City",address:"Gairan, Bogo City"},{name:"Guadalupe Barangay Hall",lat:11.0451,lng:124.0136,city:"Bogo City",address:"Guadalupe, Bogo City"},{name:"La Paz Barangay Hall",lat:11.054,lng:124.0014,city:"Bogo City",address:"La Paz, Bogo City"},{name:"Libertad Barangay Hall",lat:11.0484,lng:124.0089,city:"Bogo City",address:"Libertad, Bogo City"},{name:"Lourdes Barangay Hall",lat:11.0507,lng:124.0058,city:"Bogo City",address:"Lourdes, Bogo City"},{name:"Malingin Barangay Hall",lat:11.0418,lng:124.0169,city:"Bogo City",address:"Malingin, Bogo City"},{name:"Marangog Barangay Hall",lat:11.0562,lng:124.0003,city:"Bogo City",address:"Marangog, Bogo City"},{name:"Nailon Barangay Hall",lat:11.0473,lng:124.0114,city:"Bogo City",address:"Nailon, Bogo City"},{name:"Odlot Barangay Hall",lat:11.0429,lng:124.018,city:"Bogo City",address:"Odlot, Bogo City"},{name:"Pandan Barangay Hall",lat:11.0551,lng:124.0047,city:"Bogo City",address:"Pandan, Bogo City"},{name:"Polambato Barangay Hall",lat:11.0415,lng:124.0191,city:"Bogo City",address:"Polambato, Bogo City"},{name:"Sambag Barangay Hall",lat:11.0495,lng:124.0069,city:"Bogo City",address:"Sambag, Bogo City"},{name:"San Vicente Barangay Hall",lat:11.0462,lng:124.0125,city:"Bogo City",address:"San Vicente, Bogo City"},{name:"Santo Ni\xF1o Barangay Hall",lat:11.0529,lng:124.0036,city:"Bogo City",address:"Santo Ni\xF1o, Bogo City"},{name:"Santo Rosario Barangay Hall",lat:11.044,lng:124.0147,city:"Bogo City",address:"Santo Rosario, Bogo City"},{name:"Siocon Barangay Hall",lat:11.0406,lng:124.02,city:"Bogo City",address:"Siocon, Bogo City"},{name:"Sudlonon Barangay Hall",lat:11.0484,lng:124.0091,city:"Bogo City",address:"Sudlonon, Bogo City"},{name:"Taytayan Barangay Hall",lat:11.0518,lng:124.008,city:"Bogo City",address:"Taytayan, Bogo City"}],window.addEventListener("online",()=>this.handleOnline()),window.addEventListener("offline",()=>this.handleOffline()),this.shareLocationForm=this.fb.group({phone:["",[Dn.required,Dn.pattern(/^(09|\+639)\d{9}$/)]],facebook:[""],email:["",[Dn.email]],notes:[""],supply_needs:this.fb.group({people_count:["",[Dn.required,Dn.min(1)]],water:[0,[Dn.min(0)]],food:[0,[Dn.min(0)]],medical_supplies:[0,[Dn.min(0)]],clothing:[0,[Dn.min(0)]],shelter_materials:[0,[Dn.min(0)]],other:[""]})})}ngOnInit(){this.authService.currentUser$.subscribe(P=>{this.isAffectedUser=P?.role==="affected",console.log("User updated - isAffectedUser:",this.isAffectedUser,"user:",P)});let c=localStorage.getItem("user");if(c)try{let P=JSON.parse(c);this.isAffectedUser=P.role==="affected",console.log("Map component initialized from localStorage - isAffectedUser:",this.isAffectedUser)}catch(P){console.error("Error parsing user from localStorage",P)}this.trackingSubscription=this.locationTrackingService.trackingStatus$.subscribe(P=>{this.trackingStatus=P,this.cdr.detectChanges(),console.log("Tracking status updated:",P)});let w=localStorage.getItem("anonymous_session_id"),_=localStorage.getItem("anonymous_location_id"),C=localStorage.getItem("location_sharing_enabled");this.isLocationSharing=!!(w&&_&&C==="true"),console.log("Location sharing status:",this.isLocationSharing,"sessionId:",w,"locationId:",_),w&&this.isAffectedUser&&(this.currentSessionId=w,this.initializeWebSocket(),Notification.permission==="default"&&Notification.requestPermission().then(P=>{console.log("Notification permission:",P)}));let M=localStorage.getItem("location_offline_queue");M&&(this.offlineQueue=JSON.parse(M)),this.route.queryParams.subscribe(P=>{P.openShareModal==="true"&&this.isAffectedUser&&!this.isLocationSharing&&setTimeout(()=>{this.openShareLocationModal()},500)})}ngAfterViewInit(){this.initMap(),this.loadLocations()}ngOnDestroy(){this.webSocket&&(this.webSocket.close(),this.webSocket=void 0),this.currentSessionId=void 0,this.watchId&&this.locationService.clearWatch(this.watchId),this.locationSubscription&&this.locationSubscription.unsubscribe(),this.updateIntervalSubscription&&this.updateIntervalSubscription.unsubscribe(),this.trackingSubscription&&this.trackingSubscription.unsubscribe(),this.locationTrackingService.isCurrentlyTracking()&&this.locationTrackingService.stopTracking(),window.removeEventListener("online",()=>this.handleOnline()),window.removeEventListener("offline",()=>this.handleOffline())}initMap(){this.map=en.map("map").setView([11.05,124.005],13),en.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"\xA9 OpenStreetMap contributors"}).addTo(this.map);let C=en.icon({iconRetinaUrl:"assets/marker-icon-2x.png",iconUrl:"assets/marker-icon.png",shadowUrl:"assets/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]});en.Marker.prototype.options.icon=C}loadLocations(){this.loading=!0,this.locationService.getActiveAnonymousLocations().subscribe({next:c=>{this.locations=c,this.updateMapMarkers(c),this.loading=!1,this.cdr.detectChanges()},error:c=>{this.error="Failed to load locations",this.loading=!1,this.cdr.detectChanges(),console.error("Error loading locations:",c)}})}updateMapMarkers(c){this.markers.forEach(w=>w.remove()),this.markers=[],this.addDefaultBarangayMarkers(),c.forEach(w=>{let _=en.marker([w.latitude,w.longitude],{icon:en.icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]})}).addTo(this.map).on("click",()=>{this.openLocationCard(w)});this.markers.push(_)})}addDefaultBarangayMarkers(){this.defaultBarangayMarkers.forEach(c=>c.remove()),this.defaultBarangayMarkers=[],this.barangayLocations.forEach(c=>{let w=en.marker([c.lat,c.lng],{icon:en.icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-green.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]})}).addTo(this.map).bindPopup(`
          <div class="barangay-popup">
            <h4 style="margin: 0 0 8px 0; color: #059669; font-size: 14px;">
              \u{1F3DB}\uFE0F ${c.name}
            </h4>
            <p style="margin: 0; color: #666; font-size: 12px;">
              <strong>Address:</strong> ${c.address}<br>
              <strong>City:</strong> ${c.city}<br>
              <strong>Province:</strong> Cebu<br>
              <strong>Type:</strong> Government Building<br>
              <strong>Coordinates:</strong> ${c.lat.toFixed(4)}, ${c.lng.toFixed(4)}
            </p>
            <div style="margin-top: 8px; padding: 6px; background: #f0fdf4; border-radius: 4px; border-left: 3px solid #059669;">
              <small style="color: #065f46; font-weight: 500;">
                \u{1F4CB} Local Government Office for administrative services
              </small>
            </div>
          </div>
        `);this.defaultBarangayMarkers.push(w)})}openLocationCard(c){this.selectedLocation=c,this.cdr.detectChanges()}closeLocationCard(){this.selectedLocation=null,this.cdr.detectChanges()}formatDate(c){return new Date(c).toLocaleString()}copyCoordinates(c){let w=`${c.latitude}, ${c.longitude}`;navigator.clipboard.writeText(w).then(()=>{alert("Coordinates copied to clipboard!")}).catch(_=>{console.error("Failed to copy coordinates:",_)})}openInMaps(c){let w=`https://www.google.com/maps?q=${c.latitude},${c.longitude}`;window.open(w,"_blank")}openGoogleMapsDirections(c){if(!c){alert("Location not available for directions");return}if(navigator.geolocation)navigator.geolocation.getCurrentPosition(w=>{let _=w.coords.latitude,C=w.coords.longitude,M=c.latitude,P=c.longitude,H=`https://www.google.com/maps/dir/${_},${C}/${M},${P}`;window.open(H,"_blank")},w=>{console.error("Error getting current location for directions:",w);let _=`https://www.google.com/maps/dir//${c.latitude},${c.longitude}`;window.open(_,"_blank"),alert("Could not get your current location. Opening destination in Google Maps - you can set your starting point manually.")},{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5});else{let w=`https://www.google.com/maps/dir//${c.latitude},${c.longitude}`;window.open(w,"_blank"),alert("Geolocation not supported. Opening destination in Google Maps - you can set your starting point manually.")}}turnOffLocationSharing(){this.locationTrackingService.isCurrentlyTracking()&&(this.locationTrackingService.stopTracking(),this.trackingStatus={isTracking:!1},alert("Location sharing has been turned off. The affected user will no longer see your tracking updates."),this.cdr.detectChanges())}openCurrentLocationInGoogleMaps(){navigator.geolocation?navigator.geolocation.getCurrentPosition(c=>{let w=c.coords.latitude,_=c.coords.longitude,C=`https://www.google.com/maps?q=${w},${_}`;window.open(C,"_blank")},c=>{if(console.error("Error getting current location:",c),this.trackingStatus.lastUpdate){let w=this.trackingStatus.lastUpdate.latitude,_=this.trackingStatus.lastUpdate.longitude,C=`https://www.google.com/maps?q=${w},${_}`;window.open(C,"_blank"),alert("Using last known location for Google Maps.")}else alert("Could not access your current location. Please enable location permissions.")},{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5}):alert("Geolocation is not supported by this browser.")}getPhotoUrl(c){return c.startsWith("http")?c:`http://localhost:8000/${c}`}toggleLocationSharing(){this.isLocationSharing?this.stopSharingLocationInternal():this.startSharingLocation()}startSharingLocation(){return Gi(this,null,function*(){try{let c=yield this.locationService.getCurrentPosition();this.lastPosition=c,this.savePositionLocally(c),this.updateLocationOnServer(c),this.isLocationSharing=!0,localStorage.setItem("location_sharing_enabled","true"),this.watchId=this.locationService.watchPosition(w=>{this.lastPosition=w,this.savePositionLocally(w),this.updateCurrentUserMarker(w),this.hasSignificantMovement(c,w)&&this.updateLocationOnServer(w)}),this.updateIntervalSubscription=Mr(12e4).subscribe(()=>{this.lastPosition&&this.isLocationSharing&&this.updateLocationOnServer(this.lastPosition)}),this.updateCurrentUserMarker(c),this.error=""}catch(c){this.error="Unable to access your location. Please enable location permissions.",console.error("Geolocation error:",c),this.isLocationSharing=!1,localStorage.setItem("location_sharing_enabled","false")}})}updateLocationOnServer(c){let w={latitude:c.coords.latitude,longitude:c.coords.longitude,accuracy:c.coords.accuracy};this.isOnline?this.locationService.updateLocation(w).subscribe({next:()=>{this.processOfflineQueue()},error:_=>{console.error("Error updating location:",_),this.queueLocationUpdate(w)}}):this.queueLocationUpdate(w)}hasSignificantMovement(c,w){let C=c.coords.latitude*Math.PI/180,M=w.coords.latitude*Math.PI/180,P=(w.coords.latitude-c.coords.latitude)*Math.PI/180,H=(w.coords.longitude-c.coords.longitude)*Math.PI/180,E=Math.sin(P/2)*Math.sin(P/2)+Math.cos(C)*Math.cos(M)*Math.sin(H/2)*Math.sin(H/2);return 6371e3*(2*Math.atan2(Math.sqrt(E),Math.sqrt(1-E)))>10}updateCurrentUserMarker(c){let w=[c.coords.latitude,c.coords.longitude];this.currentUserMarker?this.currentUserMarker.setLatLng(w):this.currentUserMarker=en.marker(w,{icon:en.icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-blue.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]})}).addTo(this.map).bindPopup(`
          <div>
            <strong>Your Location</strong><br>
            <small>Accuracy: \xB1${c.coords.accuracy.toFixed(0)}m</small><br>
            <small>Updated: ${new Date().toLocaleTimeString()}</small>
          </div>
        `).openPopup()}savePositionLocally(c){let w={latitude:c.coords.latitude,longitude:c.coords.longitude,accuracy:c.coords.accuracy,timestamp:new Date().toISOString()};localStorage.setItem("last_known_position",JSON.stringify(w))}queueLocationUpdate(c){this.offlineQueue.push(os(rs({},c),{timestamp:new Date().toISOString()})),localStorage.setItem("location_offline_queue",JSON.stringify(this.offlineQueue))}saveOfflineQueue(){localStorage.setItem("location_offline_queue",JSON.stringify(this.offlineQueue))}processOfflineQueue(){if(this.offlineQueue.length===0)return;let c=this.offlineQueue[this.offlineQueue.length-1];this.locationService.updateLocation(c).subscribe({next:()=>{this.offlineQueue=[],localStorage.removeItem("location_offline_queue")},error:w=>{console.error("Failed to process offline queue:",w)}})}handleOnline(){this.isOnline=!0,console.log("Back online - processing queued updates"),this.processOfflineQueue(),this.isLocationSharing&&this.lastPosition&&this.updateLocationOnServer(this.lastPosition)}handleOffline(){this.isOnline=!1,console.log("Gone offline - will queue location updates")}stopSharingLocationInternal(){let c=localStorage.getItem("anonymous_location_id");console.log("Stopping location sharing. Location ID:",c),c?(console.log("Calling deactivate API for location ID:",c),this.locationService.deactivateAnonymousLocation(parseInt(c)).subscribe({next:w=>{console.log("Location sharing deactivated on server:",w),this.loadLocations(),this.currentUserMarker&&(this.currentUserMarker.remove(),this.currentUserMarker=void 0)},error:w=>{console.error("Error deactivating location:",w),console.error("Full error:",w)}})):console.log("No location ID found in localStorage"),this.watchId&&(this.locationService.clearWatch(this.watchId),this.watchId=void 0),this.updateIntervalSubscription&&this.updateIntervalSubscription.unsubscribe(),this.currentUserMarker&&(this.currentUserMarker.remove(),this.currentUserMarker=void 0),this.isLocationSharing=!1,localStorage.removeItem("location_sharing_enabled"),localStorage.removeItem("anonymous_session_id"),localStorage.removeItem("anonymous_location_id"),localStorage.removeItem("phone_number"),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("user"),this.router.navigate(["/"]),console.log("User logged out and redirected to home page")}centerOnMyLocation(){this.locationService.getCurrentPosition().then(c=>{this.map.setView([c.coords.latitude,c.coords.longitude],13)}).catch(c=>{let w=localStorage.getItem("last_known_position");if(w){let _=JSON.parse(w);this.map.setView([_.latitude,_.longitude],13),this.error="Showing last known location (offline)"}else this.error="Unable to access your location",console.error("Geolocation error:",c)})}openShareLocationModal(){let c=localStorage.getItem("shared_user_data");if(c)confirm("You are already sharing your location. Do you want to update your contact information?")&&(this.sharedUserData=JSON.parse(c),this.shareLocationForm.patchValue(this.sharedUserData),this.showShareModal=!0,this.currentStep=1);else{let w=this.authService.getCurrentUserValue();w?.phone_number&&this.shareLocationForm.patchValue({phone:w.phone_number}),this.showShareModal=!0,this.currentStep=1}}closeShareModal(){this.showShareModal=!1,this.shareLocationForm.reset(),this.currentStep=1,this.photoFile=null,this.photoPreview=null}goToRegistration(){this.router.navigate(["/register-affected"])}nextStep(){this.canProceedToNextStep()&&this.currentStep++}previousStep(){this.currentStep>1&&this.currentStep--}canProceedToNextStep(){switch(this.currentStep){case 1:return this.shareLocationForm.get("phone")?.valid||!1;case 2:return this.photoFile!==null;case 3:return this.shareLocationForm.get("supply_needs.people_count")?.valid||!1;default:return!1}}onPhotoSelected(c){let w=c.target.files?.[0];if(!w)return;let _=5*1024*1024;if(w.size>_){alert("Photo size must be less than 5MB. Please try again.");return}if(!w.type.startsWith("image/")){alert("Please capture an image.");return}this.photoFile=w;let C=new FileReader;C.onload=M=>{this.photoPreview=M.target?.result},C.readAsDataURL(w)}removePhoto(){this.photoFile=null,this.photoPreview=null}submitShareLocation(){return Gi(this,null,function*(){if(!this.shareLocationForm.invalid){this.submitting=!0,this.error="";try{let c=yield this.locationService.getCurrentPosition(),w=new FormData;w.append("phone",this.shareLocationForm.get("phone")?.value),w.append("facebook",this.shareLocationForm.get("facebook")?.value||""),w.append("email",this.shareLocationForm.get("email")?.value||""),w.append("notes",this.shareLocationForm.get("notes")?.value||""),w.append("latitude",c.coords.latitude.toString()),w.append("longitude",c.coords.longitude.toString()),w.append("accuracy",c.coords.accuracy.toString()),this.photoFile&&w.append("photo",this.photoFile);let _=this.shareLocationForm.get("supply_needs")?.value;w.append("supply_needs",JSON.stringify(_));let C=localStorage.getItem("anonymous_session_id");C||(C="anon_"+Date.now()+"_"+Math.random().toString(36).substr(2,9),localStorage.setItem("anonymous_session_id",C)),w.append("session_id",C);let M={phone:this.shareLocationForm.get("phone")?.value,facebook:this.shareLocationForm.get("facebook")?.value,email:this.shareLocationForm.get("email")?.value,notes:this.shareLocationForm.get("notes")?.value,supply_needs:_,latitude:c.coords.latitude,longitude:c.coords.longitude,accuracy:c.coords.accuracy,timestamp:new Date().toISOString(),session_id:C};localStorage.setItem("shared_user_data",JSON.stringify(M)),this.sharedUserData=M,this.lastPosition=c,this.isLocationSharing=!0,localStorage.setItem("location_sharing_enabled","true"),this.sendAnonymousLocation(w),this.watchId=this.locationService.watchPosition(P=>{if(this.lastPosition=P,this.savePositionLocally(P),this.updateCurrentUserMarker(P),this.hasSignificantMovement(c,P)){let H=new FormData;H.append("phone",M.phone),H.append("session_id",C),H.append("latitude",P.coords.latitude.toString()),H.append("longitude",P.coords.longitude.toString()),H.append("accuracy",P.coords.accuracy.toString()),this.sendAnonymousLocation(H)}}),this.updateIntervalSubscription=Mr(12e4).subscribe(()=>{if(this.lastPosition&&this.isLocationSharing&&this.sharedUserData){let P=new FormData;P.append("phone",this.sharedUserData.phone),P.append("session_id",C),P.append("latitude",this.lastPosition.coords.latitude.toString()),P.append("longitude",this.lastPosition.coords.longitude.toString()),P.append("accuracy",this.lastPosition.coords.accuracy.toString()),this.sendAnonymousLocation(P)}}),this.updateCurrentUserMarker(c),this.closeShareModal(),this.submitting=!1}catch(c){this.error="Unable to access your location. Please enable location permissions.",console.error("Geolocation error:",c),this.submitting=!1}}})}sendAnonymousLocation(c){this.isOnline?this.locationService.shareAnonymousLocation(c).subscribe({next:w=>{if(console.log("Location shared successfully:",w),w&&w.id){let _=localStorage.getItem("shared_user_data");if(_){let C=JSON.parse(_);C.backendId=w.id,localStorage.setItem("shared_user_data",JSON.stringify(C))}}},error:w=>{console.error("Error sharing location:",w),this.isOnline||(this.offlineQueue.push({type:"share",data:c}),this.saveOfflineQueue())}}):(this.offlineQueue.push({type:"share",data:c}),this.saveOfflineQueue())}stopSharingLocation(){confirm("Are you sure you want to stop sharing your location? You will be logged out and all your information will be deleted.")&&(this.loading=!0,this.error="",this.stopSharingLocationInternal())}openQRModal(){let c=localStorage.getItem("qr_code"),w=localStorage.getItem("currentUser");if(c)this.userQRCode=c,this.showQRModal=!0;else if(w)try{let _=JSON.parse(w);_.qr_code?(this.userQRCode=_.qr_code,this.showQRModal=!0):alert("QR code not found. Please register again.")}catch{alert("Error loading QR code")}else alert("QR code not found. Please register again.")}closeQRModal(){this.showQRModal=!1}downloadQRCode(){let c=document.querySelector(".qr-modal canvas");if(c){let w=c.toDataURL("image/png"),_=document.createElement("a");_.download=`my-donation-qr-${this.userQRCode}.png`,_.href=w,_.click()}}markAsOnTheWay(c){this.selectedLocationForDonation=c,this.showOnTheWayModal=!0}closeOnTheWayModal(){this.showOnTheWayModal=!1,this.selectedLocationForDonation=null}confirmOnTheWay(){if(!this.selectedLocationForDonation)return;let c=this.selectedLocationForDonation.id;if(!this.authService.getAccessToken()){alert("You must be logged in as a donator to mark yourself as on the way."),this.closeOnTheWayModal();return}this.loading=!0,this.locationService.markAsOnTheWay(c).subscribe({next:_=>{this.locationTrackingService.startTracking(c).then(()=>{alert("You have been marked as on the way! Location tracking started. The affected user will see your real-time updates."),this.closeOnTheWayModal(),this.loadLocations(),this.loading=!1}).catch(C=>{console.error("Error starting location tracking:",C),alert("Marked as on the way, but location tracking failed. Please enable location permissions."),this.closeOnTheWayModal(),this.loadLocations(),this.loading=!1})},error:_=>{console.error("Error marking as on the way:",_),_.status===401?alert("You must be logged in as a donator to mark yourself as on the way."):_.error?.error?alert(_.error.error):alert("Failed to mark as on the way. Please try again."),this.loading=!1,this.closeOnTheWayModal()}})}openScanner(){if(!this.authService.getAccessToken()){alert("You must be logged in as a donator to scan QR codes.");return}this.showScannerModal=!0}closeScannerModal(){this.showScannerModal=!1}onQRScanned(c){console.log("QR Code scanned:",c),this.closeScannerModal(),this.loading=!0,this.locationService.scanQRCode(c).subscribe({next:w=>{alert(`Donation confirmed! Thank you for helping.

The affected user's location has been removed and they can create a new request after 3 hours.`),this.loadLocations(),this.loading=!1},error:w=>{console.error("Error scanning QR code:",w),this.loading=!1,w.status===404?alert("Invalid QR code. Please make sure you scanned the correct code."):w.status===400?alert(w.error?.error||"This location has already received a donation."):w.status===401?alert("You must be logged in as a donator to scan QR codes."):alert("Failed to process QR code. Please try again.")}})}initializeWebSocket(){if(!this.currentSessionId)return;let c="ws://localhost:8000/ws/locations/";try{this.webSocket=new WebSocket(c),this.webSocket.onopen=()=>{console.log("WebSocket connected for session:",this.currentSessionId)},this.webSocket.onmessage=w=>{let _=JSON.parse(w.data);console.log("WebSocket message received:",_),_.type==="qr_scan_notification"?this.handleQRScanNotification(_.data):_.type==="donator_tracking_update"&&this.handleDonatorTrackingUpdate(_.data)},this.webSocket.onclose=()=>{console.log("WebSocket connection closed"),this.currentSessionId&&setTimeout(()=>{this.initializeWebSocket()},3e3)},this.webSocket.onerror=w=>{console.error("WebSocket error:",w)}}catch(w){console.error("Failed to initialize WebSocket:",w)}}handleQRScanNotification(c){console.log("Handling QR scan notification:",c),c.session_id===this.currentSessionId&&(console.log("QR scan notification matches current session - showing confirmation modal"),this.donationNotificationData=c,this.showDonationConfirmationModal=!0,this.cdr.detectChanges(),Notification.permission==="granted"&&new Notification("Donation Received!",{body:`${c.donator_name} has scanned your QR code and provided relief supplies.`,icon:"/assets/icons/donation-icon.png"}))}handleDonatorTrackingUpdate(c){console.log("Handling donator tracking update:",c);let w=this.authService.getCurrentUserValue(),_=w&&w.id===c.donatorId;(this.isAffectedUser&&!_||!this.isAffectedUser&&_)&&(c.status==="tracking_started"?this.trackingStatus={isTracking:!0,donatorInfo:{id:c.donatorId,username:c.donatorUsername,firstName:c.donatorFirstName,lastName:c.donatorLastName},lastUpdate:{latitude:c.latitude||0,longitude:c.longitude||0,accuracy:c.accuracy||0,timestamp:new Date(c.timestamp),donatorId:c.donatorId,donatorUsername:c.donatorUsername,locationId:c.locationId}}:c.status==="tracking_stopped"?this.trackingStatus={isTracking:!1}:c.latitude&&c.longitude&&this.trackingStatus.isTracking&&this.trackingStatus.donatorInfo?.id===c.donatorId&&(this.trackingStatus.lastUpdate={latitude:c.latitude,longitude:c.longitude,accuracy:c.accuracy,timestamp:new Date(c.timestamp),donatorId:c.donatorId,donatorUsername:c.donatorUsername,locationId:c.locationId}),this.cdr.detectChanges(),c.status==="tracking_started"&&this.isAffectedUser&&Notification.permission==="granted"&&new Notification("Donator On The Way!",{body:c.message,icon:"/assets/icons/donation-icon.png"}))}closeDonationConfirmationModal(){this.showDonationConfirmationModal=!1,this.donationNotificationData=null,this.cdr.detectChanges()}onSubmitRating(c){if(!this.donationNotificationData||!this.currentSessionId)return;let w={donation_history_id:this.donationNotificationData.donation_history_id,session_id:this.currentSessionId,rating:c.rating,comment:c.comment,supplies_confirmed:c.supplies_confirmed};this.donationService.submitRating(w).subscribe({next:_=>{console.log("Rating submitted successfully:",_),alert("Thank you for your feedback! Your rating has been submitted."),this.closeDonationConfirmationModal(),this.loadLocations()},error:_=>{console.error("Error submitting rating:",_),alert("Failed to submit rating. Please try again.")}})}formatTrackingTime(c){let _=new Date().getTime()-new Date(c).getTime(),C=Math.floor(_/1e3);if(C<60)return`${C} seconds ago`;if(C<3600){let M=Math.floor(C/60);return`${M} minute${M!==1?"s":""} ago`}else{let M=Math.floor(C/3600);return`${M} hour${M!==1?"s":""} ago`}}getIcon(c,w="md"){return this.iconService.getIcon(c,w)}onImageError(c){console.warn("Failed to load image:",c.target.src),c.target.style.display="none"}static{this.\u0275fac=function(w){return new(w||d)(vn(bs),vn(Ts),vn(Ji),vn(ha),vn($i),vn(Es),vn(ds),vn(ms),vn(qr))}}static{this.\u0275cmp=ji({type:d,selectors:[["app-map"]],standalone:!0,features:[Yi],decls:34,vars:24,consts:[[1,"container"],[1,"card"],[1,"card-header"],[1,"header-content"],[1,"title-section"],[1,"subtitle"],[1,"status-indicator",3,"ngClass"],[3,"innerHTML"],[4,"ngIf"],["class","alert alert-error",4,"ngIf"],[1,"map-controls"],["class","btn btn-emergency btn-lg",3,"click",4,"ngIf"],["class","btn btn-secondary",3,"click",4,"ngIf"],["class","btn btn-primary",3,"click",4,"ngIf"],[1,"btn","btn-outline",3,"click"],["class","modern-legend-panel",4,"ngIf"],["class","map-info modern-map-info",4,"ngIf"],["class","spinner",4,"ngIf"],["id","map",1,"map-container"],["class","modal-overlay",3,"click",4,"ngIf"],["class","modal",3,"click",4,"ngIf"],["class","modal-overlay qr-modal",3,"click",4,"ngIf"],["class","modal-overlay ontheway-modal",3,"click",4,"ngIf"],[3,"closeModal","submitRating","show","donationData"],[1,"alert","alert-error"],[1,"btn","btn-emergency","btn-lg",3,"click"],[1,"btn","btn-secondary",3,"click"],[1,"btn","btn-primary",3,"click"],[1,"modern-legend-panel"],[1,"legend-header"],[1,"legend-title"],[1,"legend-subtitle"],[1,"map-info","modern-map-info"],["class","alert alert-success tracking-notification",4,"ngIf"],["class","alert alert-info tracking-notification",4,"ngIf"],["class","alert alert-warning",4,"ngIf"],[1,"alert","alert-success","tracking-notification"],[1,"tracking-header"],[1,"tracking-icon",3,"innerHTML"],[1,"tracking-info"],[1,"tracking-message"],[1,"tracking-status","status-tracking"],[1,"pulse-dot"],["class","tracking-details",4,"ngIf"],[1,"tracking-details"],[1,"detail-item"],[1,"alert","alert-info","tracking-notification"],[1,"tracking-actions","flex","gap-2"],[1,"btn","btn-sm","btn-secondary",3,"click"],[1,"btn","btn-sm","btn-primary",3,"click"],[1,"alert","alert-warning"],[1,"spinner"],[1,"modal-overlay",3,"click"],[1,"modal","modal-lg",3,"click"],[1,"modal-header","modern-header"],[1,"modal-title-section"],[1,"title-icon"],[1,"title-content"],[1,"title-main"],[1,"title-subtitle"],[1,"modal-close","modern-close",3,"click"],[1,"modal-body","modern-body"],[1,"info-section"],[1,"info-grid"],[1,"info-item"],[1,"info-icon",3,"innerHTML"],[1,"info-content"],[1,"info-label"],[1,"info-value"],["class","info-item",4,"ngIf"],["class","info-section",4,"ngIf"],["class","info-section tracking-section",4,"ngIf"],[1,"modal-footer"],["class","btn btn-success btn-lg",3,"click",4,"ngIf"],[1,"verification-photo"],["alt","Emergency situation verification",1,"situation-image",3,"error","src"],[1,"photo-caption"],[1,"supply-grid"],["class","supply-item",4,"ngIf"],["class","other-needs",4,"ngIf"],[1,"supply-item"],[1,"supply-icon",3,"innerHTML"],[1,"supply-content"],[1,"supply-label"],[1,"supply-value"],[1,"other-needs"],[1,"notes-text"],[1,"donators-list"],["class","donator-item",4,"ngFor","ngForOf"],[1,"donators-count"],[1,"donator-item"],[1,"donator-icon"],[1,"donator-info"],[1,"donator-name"],[1,"donator-time"],["class","donator-status",4,"ngIf"],["class","donator-tracking",4,"ngIf"],[1,"donator-status"],[1,"donator-tracking"],["class","tracking-indicator",4,"ngIf"],[1,"tracking-indicator"],[1,"live-indicator"],[1,"info-section","tracking-section"],[1,"tracking-card"],[1,"tracking-pulse"],["class","tracking-info",4,"ngIf"],[1,"tracking-detail"],[1,"detail-icon"],[1,"detail-icon",3,"innerHTML"],[1,"btn","btn-success","btn-lg",3,"click"],[1,"modal",3,"click"],[1,"modal-content",3,"click"],[1,"modal-header"],[1,"modal-title"],[1,"modal-icon",3,"innerHTML"],[1,"modal-close","btn","btn-sm","btn-secondary",3,"click"],[1,"step-indicator"],[1,"step"],[1,"step-number"],[1,"step-label"],[3,"ngSubmit","formGroup"],["class","modal-body",4,"ngIf"],["class","modal-body","formGroupName","supply_needs",4,"ngIf"],["type","button","class","btn btn-secondary",3,"disabled","click",4,"ngIf"],["type","button","class","btn btn-primary",3,"disabled","click",4,"ngIf"],["type","submit","class","btn btn-success",3,"disabled",4,"ngIf"],[1,"modal-body"],[1,"help-section"],[1,"help-icon",3,"innerHTML"],[1,"help-text"],[1,"form-group"],["for","phone"],[1,"required"],["type","tel","id","phone","formControlName","phone","placeholder","09123456789",1,"form-control"],["class","error-message",4,"ngIf"],["for","facebook"],["type","text","id","facebook","formControlName","facebook","placeholder","facebook.com/yourprofile",1,"form-control"],["for","email"],["type","email","id","email","formControlName","email","placeholder","your@email.com",1,"form-control"],["for","notes"],["id","notes","formControlName","notes","placeholder","Any important information donators should know...","rows","3",1,"form-control"],[1,"error-message"],[1,"photo-upload-section"],["class","photo-preview",4,"ngIf"],["class","photo-upload-buttons",4,"ngIf"],[1,"photo-preview"],["alt","Location verification photo",3,"src"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"photo-upload-buttons"],["for","photo-camera",1,"btn","btn-primary","btn-lg","w-full"],["type","file","id","photo-camera","accept","image/*","capture","environment",2,"display","none",3,"change"],[1,"alert","alert-info","mt-4"],["formGroupName","supply_needs",1,"modal-body"],["for","people_count"],["type","number","id","people_count","formControlName","people_count","placeholder","e.g., 5","min","1",1,"form-control"],["for","water"],["type","number","id","water","formControlName","water","min","0",1,"form-control"],["for","food"],["type","number","id","food","formControlName","food","min","0",1,"form-control"],["for","medical_supplies"],["type","number","id","medical_supplies","formControlName","medical_supplies","min","0",1,"form-control"],["for","clothing"],["type","number","id","clothing","formControlName","clothing","min","0",1,"form-control"],["for","shelter_materials"],["type","number","id","shelter_materials","formControlName","shelter_materials","min","0",1,"form-control"],["for","other"],["id","other","formControlName","other","placeholder","Any other supplies you need...","rows","2",1,"form-control"],["type","button",1,"btn","btn-secondary",3,"click","disabled"],["type","button",1,"btn","btn-primary",3,"click","disabled"],["type","submit",1,"btn","btn-success",3,"disabled"],[1,"modal-overlay","qr-modal",3,"click"],[1,"close-button",3,"click"],[1,"qr-display-container"],[1,"qr-instructions"],[1,"qr-code-display"],[3,"qrdata","width","errorCorrectionLevel","elementType"],[1,"qr-code-value"],[1,"qr-info-box"],[1,"qr-actions"],["type","button",1,"btn","btn-primary",3,"click"],[1,"modal-overlay","ontheway-modal",3,"click"],[1,"ontheway-instructions"],[1,"instruction-box","warning"],[1,"instruction-box","info"],[1,"confirmation-question"],[1,"modal-actions"],[1,"btn","btn-info",3,"click"],[1,"btn","btn-warning",3,"click"],[1,"modal-content","scanner-modal",3,"click"],[3,"scanned","closed"]],template:function(w,_){w&1&&(T(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h2"),k(6,"Emergency Response Tracking"),O()(),T(7,"p",5),k(8," Real-time coordination for emergency supply distribution "),O(),T(9,"div",6),nt(10,"span",7),dt(11,"safeHtml"),Ht(12,sl,2,0,"span",8)(13,al,2,0,"span",8),O()()(),Ht(14,ll,2,1,"div",9),T(15,"div",10),Ht(16,cl,4,3,"button",11)(17,hl,4,3,"button",12)(18,ul,4,3,"button",13),T(19,"button",14),St("click",function(){return _.loadLocations()}),nt(20,"span",7),dt(21,"safeHtml"),k(22," Refresh Map "),O(),Ht(23,dl,4,3,"button",13)(24,fl,6,0,"div",15)(25,wl,4,3,"div",16)(26,yl,1,0,"div",17),nt(27,"div",18),O()(),Ht(28,Vl,47,28,"div",19)(29,ec,35,24,"div",20)(30,nc,43,14,"div",21)(31,ic,64,21,"div",22)(32,rc,3,0,"div",19),T(33,"app-donation-confirmation-modal",23),St("closeModal",function(){return _.closeDonationConfirmationModal()})("submitRating",function(M){return _.onSubmitRating(M)}),O()()),w&2&&(B(9),W("ngClass",_.isOnline?"status-active":"status-emergency"),B(),W("innerHTML",pt(11,20,_.getIcon(_.isOnline?"online":"offline")),ft),B(2),W("ngIf",_.isOnline),B(),W("ngIf",!_.isOnline),B(),W("ngIf",_.error),B(2),W("ngIf",_.isAffectedUser&&!_.isLocationSharing),B(),W("ngIf",_.isAffectedUser&&_.isLocationSharing),B(),W("ngIf",_.isAffectedUser&&_.isLocationSharing),B(2),W("innerHTML",pt(21,22,_.getIcon("refresh")),ft),B(3),W("ngIf",!_.isAffectedUser),B(),W("ngIf",!_.loading),B(),W("ngIf",!_.loading),B(),W("ngIf",_.loading),B(2),W("ngIf",_.selectedLocation),B(),W("ngIf",_.showShareModal),B(),W("ngIf",_.showQRModal),B(),W("ngIf",_.showOnTheWayModal),B(),W("ngIf",_.showScannerModal),B(),W("show",_.showDonationConfirmationModal)("donationData",_.donationNotificationData))},dependencies:[qi,fs,Xr,Qi,Yr,As,ws,tr,Jr,er,xs,$r,ys,vs,Cs,Is,Ss,la,ca,Ki],data:{animation:[gs("slideIn",[No(":enter",[Qr({transform:"translateX(100%)",opacity:0}),Mo("300ms ease-out",Qr({transform:"translateX(0)",opacity:1}))]),No(":leave",[Mo("300ms ease-in",Qr({transform:"translateX(100%)",opacity:0}))])])]}})}}return d})();export{$h as MapComponent};
