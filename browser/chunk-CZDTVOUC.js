import{a as D,b as z,c as A}from"./chunk-L4BQEWJK.js";import{b as k,c as u,d as I,e as E,g as O,i as F,k as T,p as R,r as G}from"./chunk-FKMIZAYU.js";import{c as w,d as L,g as M}from"./chunk-XMQ3WWIA.js";import{b as P}from"./chunk-TPXSCQ7K.js";import{Fb as y,Hb as S,Na as d,Pa as a,Sa as i,Ta as o,Ua as m,Wa as f,Xa as h,ab as l,ca as _,cb as C,ib as x,na as v,oa as b,ya as r,za as g}from"./chunk-LO2TXSAH.js";function V(e,s){if(e&1&&(i(0,"div",27),l(1),o()),e&2){let t=h();r(),C(" ",t.error," ")}}function N(e,s){e&1&&(i(0,"span"),l(1,"Email is required"),o())}function j(e,s){e&1&&(i(0,"span"),l(1,"Please enter a valid email"),o())}function H(e,s){if(e&1&&(i(0,"div",28),d(1,N,2,0,"span",13)(2,j,2,0,"span",13),o()),e&2){let t=h();r(),a("ngIf",t.email==null||t.email.errors==null?null:t.email.errors.required),r(),a("ngIf",t.email==null||t.email.errors==null?null:t.email.errors.email)}}function q(e,s){e&1&&(i(0,"span"),l(1,"Password is required"),o())}function B(e,s){e&1&&(i(0,"span"),l(1,"Password must be at least 6 characters"),o())}function W(e,s){if(e&1&&(i(0,"div",28),d(1,q,2,0,"span",13)(2,B,2,0,"span",13),o()),e&2){let t=h();r(),a("ngIf",t.password==null||t.password.errors==null?null:t.password.errors.required),r(),a("ngIf",t.password==null||t.password.errors==null?null:t.password.errors.minlength)}}function $(e,s){e&1&&(i(0,"span"),l(1,"Login"),o())}function J(e,s){e&1&&(i(0,"span"),l(1,"Logging in..."),o())}function K(e,s){e&1&&(i(0,"span"),l(1,"Continue with Google"),o())}function Q(e,s){e&1&&(i(0,"span"),l(1,"Initializing Google..."),o())}function U(e,s){e&1&&(i(0,"span"),l(1,"Continue with Facebook"),o())}function X(e,s){e&1&&(i(0,"span"),l(1,"Initializing Facebook..."),o())}var se=(()=>{class e{constructor(t,c,n,p){this.fb=t,this.authService=c,this.socialAuthService=n,this.router=p,this.loading=!1,this.error="",this.socialLoginReady=!1,this.loginForm=this.fb.group({email:["",[u.required,u.email]],password:["",[u.required,u.minLength(6)]]})}ngOnInit(){this.socialAuthService.initState.subscribe(()=>{this.socialLoginReady=!0,console.log("Social login providers are ready")}),this.socialAuthService.authState.subscribe(t=>{t&&this.handleSocialLogin(t)})}handleSocialLogin(t){this.loading=!0,this.error="";let c=t.provider==="GOOGLE"?t.idToken:t.authToken,n=t.provider==="GOOGLE"?"google":"facebook";this.authService.socialLogin(n,c).subscribe({next:()=>{this.router.navigate(["/map"])},error:p=>{this.error=p.error?.error||`${n} login failed. Please try again.`,this.loading=!1}})}onSubmit(){this.loginForm.valid&&(this.loading=!0,this.error="",this.authService.login(this.loginForm.value).subscribe({next:()=>{this.router.navigate(["/map"])},error:t=>{this.error=t.error?.error||"Login failed. Please check your credentials.",this.loading=!1}}))}signInWithGoogle(){if(!this.socialLoginReady){this.error="Social login is still initializing. Please wait a moment and try again.";return}this.loading=!0,this.error="",this.socialAuthService.signIn(D.PROVIDER_ID).catch(t=>{console.error("Google sign in error:",t),this.error="Google login was cancelled or failed.",this.loading=!1})}signInWithFacebook(){if(!this.socialLoginReady){this.error="Social login is still initializing. Please wait a moment and try again.";return}this.loading=!0,this.error="",this.socialAuthService.signIn(A.PROVIDER_ID).catch(t=>{console.error("Facebook sign in error:",t),this.error="Facebook login was cancelled or failed.",this.loading=!1})}get email(){return this.loginForm.get("email")}get password(){return this.loginForm.get("password")}static{this.\u0275fac=function(c){return new(c||e)(g(R),g(P),g(z),g(w))}}static{this.\u0275cmp=_({type:e,selectors:[["app-login"]],standalone:!0,features:[x],decls:43,vars:13,consts:[[1,"container"],[1,"auth-container"],[1,"card"],[1,"card-header"],["class","alert alert-error",4,"ngIf"],[3,"ngSubmit","formGroup"],[1,"form-group"],["for","email"],["type","email","id","email","formControlName","email","placeholder","Enter your email",1,"form-control"],["class","form-error",4,"ngIf"],["for","password"],["type","password","id","password","formControlName","password","placeholder","Enter your password",1,"form-control"],["type","submit",1,"btn","btn-primary","btn-block",3,"disabled"],[4,"ngIf"],[1,"divider"],[1,"social-login"],["type","button",1,"btn","btn-google","btn-block",3,"click","disabled"],["width","18","height","18","viewBox","0 0 18 18","xmlns","http://www.w3.org/2000/svg"],["d","M17.64 9.2c0-.637-.057-1.251-.164-1.84H9v3.481h4.844c-.209 1.125-.843 2.078-1.796 2.717v2.258h2.908c1.702-1.567 2.684-3.874 2.684-6.615z","fill","#4285F4"],["d","M9.003 18c2.43 0 4.467-.806 5.956-2.18L12.05 13.56c-.806.54-1.836.86-3.047.86-2.344 0-4.328-1.584-5.036-3.711H.96v2.332C2.438 15.983 5.482 18 9.003 18z","fill","#34A853"],["d","M3.964 10.71c-.18-.54-.282-1.117-.282-1.71s.102-1.17.282-1.71V4.958H.957C.347 6.173 0 7.548 0 9.001c0 1.452.348 2.827.957 4.041l3.007-2.332z","fill","#FBBC05"],["d","M9.003 3.58c1.321 0 2.508.454 3.44 1.345l2.582-2.58C13.464.891 11.426 0 9.002 0 5.482 0 2.438 2.017.96 4.958L3.967 7.29c.708-2.127 2.692-3.71 5.036-3.71z","fill","#EA4335"],["type","button",1,"btn","btn-facebook","btn-block",3,"click","disabled"],["width","18","height","18","viewBox","0 0 24 24","xmlns","http://www.w3.org/2000/svg"],["d","M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z","fill","#1877F2"],[1,"auth-footer"],["routerLink","/register"],[1,"alert","alert-error"],[1,"form-error"]],template:function(c,n){c&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2"),l(5,"Login"),o()(),d(6,V,2,1,"div",4),i(7,"form",5),f("ngSubmit",function(){return n.onSubmit()}),i(8,"div",6)(9,"label",7),l(10,"Email"),o(),m(11,"input",8),d(12,H,3,2,"div",9),o(),i(13,"div",6)(14,"label",10),l(15,"Password"),o(),m(16,"input",11),d(17,W,3,2,"div",9),o(),i(18,"button",12),d(19,$,2,0,"span",13)(20,J,2,0,"span",13),o()(),i(21,"div",14)(22,"span"),l(23,"OR"),o()(),i(24,"div",15)(25,"button",16),f("click",function(){return n.signInWithGoogle()}),v(),i(26,"svg",17),m(27,"path",18)(28,"path",19)(29,"path",20)(30,"path",21),o(),d(31,K,2,0,"span",13)(32,Q,2,0,"span",13),o(),b(),i(33,"button",22),f("click",function(){return n.signInWithFacebook()}),v(),i(34,"svg",23),m(35,"path",24),o(),d(36,U,2,0,"span",13)(37,X,2,0,"span",13),o()(),b(),i(38,"div",25)(39,"p"),l(40,"Don't have an account? "),i(41,"a",26),l(42,"Register here"),o()()()()()()),c&2&&(r(6),a("ngIf",n.error),r(),a("formGroup",n.loginForm),r(5),a("ngIf",(n.email==null?null:n.email.invalid)&&(n.email==null?null:n.email.touched)),r(5),a("ngIf",(n.password==null?null:n.password.invalid)&&(n.password==null?null:n.password.touched)),r(),a("disabled",n.loading||n.loginForm.invalid),r(),a("ngIf",!n.loading),r(),a("ngIf",n.loading),r(5),a("disabled",n.loading||!n.socialLoginReady),r(6),a("ngIf",n.socialLoginReady),r(),a("ngIf",!n.socialLoginReady),r(),a("disabled",n.loading||!n.socialLoginReady),r(3),a("ngIf",n.socialLoginReady),r(),a("ngIf",!n.socialLoginReady))},dependencies:[S,y,G,O,k,I,E,F,T,M,L],styles:['.auth-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:80vh;padding:20px}.card[_ngcontent-%COMP%]{max-width:450px;width:100%}.btn-block[_ngcontent-%COMP%]{width:100%}.auth-footer[_ngcontent-%COMP%]{text-align:center;margin-top:20px;padding-top:20px;border-top:1px solid #e5e7eb}.auth-footer[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#2563eb;text-decoration:none}.auth-footer[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}.divider[_ngcontent-%COMP%]{display:flex;align-items:center;text-align:center;margin:24px 0;color:#6b7280;font-size:14px}.divider[_ngcontent-%COMP%]:before, .divider[_ngcontent-%COMP%]:after{content:"";flex:1;border-bottom:1px solid #e5e7eb}.divider[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding:0 12px;font-weight:500}.social-login[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px;margin-bottom:20px}.btn-google[_ngcontent-%COMP%]{background-color:#fff;color:#3c4043;border:1px solid #dadce0;font-weight:500;display:flex;align-items:center;justify-content:center;gap:12px;padding:12px 24px;transition:all .2s ease}.btn-google[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#f8f9fa;border-color:#dadce0;box-shadow:0 1px 3px #0000001a}.btn-google[_ngcontent-%COMP%]:active:not(:disabled){background-color:#f1f3f4}.btn-facebook[_ngcontent-%COMP%]{background-color:#1877f2;color:#fff;border:none;font-weight:500;display:flex;align-items:center;justify-content:center;gap:12px;padding:12px 24px;transition:all .2s ease}.btn-facebook[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#166fe5;box-shadow:0 2px 4px #0003}.btn-facebook[_ngcontent-%COMP%]:active:not(:disabled){background-color:#1464d4}.btn-google[_ngcontent-%COMP%]:disabled, .btn-facebook[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.btn-google[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%], .btn-facebook[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{flex-shrink:0}'],changeDetection:0})}}return e})();export{se as LoginComponent};
