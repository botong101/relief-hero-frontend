import{Lb as c,R as r,U as n,Z as a,l as i}from"./chunk-LO2TXSAH.js";var l={production:!1,apiUrl:"https://relief-hero.onrender.com/api",wsUrl:"wss://relief-hero.onrender.com/ws"};var U=(()=>{class s{constructor(e){this.http=e,this.apiUrl=l.apiUrl,this.currentUserSubject=new i(null),this.currentUser$=this.currentUserSubject.asObservable(),this.loadCurrentUser()}register(e){return this.http.post(`${this.apiUrl}/auth/register/`,e).pipe(r(t=>{this.setSession(t)}))}registerAffected(e,t,o,u){return this.http.post(`${this.apiUrl}/auth/register-affected/`,{phone_number:e,first_name:t,last_name:o,address:u||""}).pipe(r(h=>{this.setSession(h)}))}login(e){return this.http.post(`${this.apiUrl}/auth/login/`,e).pipe(r(t=>{this.setSession(t)}))}loginAffected(e){return this.http.post(`${this.apiUrl}/auth/login-affected/`,{phone_number:e}).pipe(r(t=>{this.setSession(t)}))}socialLogin(e,t){return this.http.post(`${this.apiUrl}/auth/social/${e}/`,{access_token:t}).pipe(r(o=>{this.setSession(o)}))}logout(){localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("user"),this.currentUserSubject.next(null)}getCurrentUser(){return this.http.get(`${this.apiUrl}/auth/me/`).pipe(r(e=>{this.currentUserSubject.next(e),localStorage.setItem("user",JSON.stringify(e))}))}isAuthenticated(){return!!localStorage.getItem("access_token")}getAccessToken(){return localStorage.getItem("access_token")}getRefreshToken(){return localStorage.getItem("refresh_token")}getCurrentUserValue(){return this.currentUserSubject.value}setCurrentUser(e){localStorage.setItem("user",JSON.stringify(e)),this.currentUserSubject.next(e)}hasRole(e){return this.getCurrentUserValue()?.role===e}setSession(e){localStorage.setItem("access_token",e.tokens.access),localStorage.setItem("refresh_token",e.tokens.refresh),localStorage.setItem("user",JSON.stringify(e.user)),this.currentUserSubject.next(e.user)}loadCurrentUser(){let e=localStorage.getItem("user");if(e)try{let t=JSON.parse(e);this.currentUserSubject.next(t)}catch(t){console.error("Error parsing user from localStorage",t)}}static{this.\u0275fac=function(t){return new(t||s)(a(c))}}static{this.\u0275prov=n({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})();export{l as a,U as b};
